<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">

<head>
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
<link href="coqdoc.css" rel="stylesheet" type="text/css" />
<link href="coqdocjs.css" rel="stylesheet" type="text/css"/>
<link href="toc.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="config.js"></script>
<script type="text/javascript" src="coqdocjs.js"></script>
</head>

<body onload="document.getElementById('content').focus()">
  <div id="header">
    <span class="left">
      <span class="modulename"> <script> document.write(document.title) </script> </span>
    </span>

    <span class="button" id="toggle-proofs"></span>

    <span class="right">
      <a href="toc.html">Table of contents</a>
      <a href="https://github.com/AU-COBRA/ConCert" target="_balnk">Project Page</a>
    </span>
</div>
  <div id="content" tabindex="-1" onblur="document.getElementById('content').focus()">
    <div id="js-toc-header" class="toc-header">Contents:</div>
    <div id="js-toc" class="toc" data-toc="h1,h2,h3,h4" data-toc-container="doc">
    </div>
    <div id="main">
<h1 class="libtitle">Library ConCert.Execution.Blockchain</h1>

<div class="code">
<span class="comment">(*&nbsp;This&nbsp;file&nbsp;defines&nbsp;blockchains,&nbsp;both&nbsp;a&nbsp;contract's&nbsp;view&nbsp;(which&nbsp;is<br/>
more&nbsp;computational)&nbsp;and&nbsp;the&nbsp;semantics&nbsp;of&nbsp;executing&nbsp;smart&nbsp;contracts<br/>
in&nbsp;a&nbsp;blockchain.<br/>
<br/>
The&nbsp;most&nbsp;important&nbsp;types&nbsp;are:<br/>
<br/>
*&nbsp;The&nbsp;ChainBase&nbsp;type,&nbsp;describing&nbsp;basic&nbsp;assumptions&nbsp;made&nbsp;of&nbsp;any&nbsp;blockchain.<br/>
In&nbsp;most&nbsp;cases&nbsp;we&nbsp;will&nbsp;abstract&nbsp;over&nbsp;this&nbsp;type.<br/>
<br/>
*&nbsp;The&nbsp;Chain&nbsp;type,&nbsp;describing&nbsp;a&nbsp;smart&nbsp;contract's&nbsp;view&nbsp;of&nbsp;the&nbsp;blockchain.<br/>
This&nbsp;is&nbsp;the&nbsp;the&nbsp;data&nbsp;that&nbsp;can&nbsp;be&nbsp;accessed&nbsp;by&nbsp;smart&nbsp;contracts.<br/>
<br/>
*&nbsp;The&nbsp;Action&nbsp;type,&nbsp;describing&nbsp;how&nbsp;smart&nbsp;contracts&nbsp;(and&nbsp;external&nbsp;users)<br/>
interact&nbsp;with&nbsp;the&nbsp;blockchain.&nbsp;We&nbsp;allow&nbsp;transfers,&nbsp;calls&nbsp;and&nbsp;deployment<br/>
of&nbsp;contracts.<br/>
<br/>
*&nbsp;The&nbsp;WeakContract&nbsp;type,&nbsp;describing&nbsp;a&nbsp;"weak"&nbsp;or&nbsp;"stringly"&nbsp;typed<br/>
version&nbsp;of&nbsp;smart&nbsp;contracts.&nbsp;Contracts&nbsp;are&nbsp;just&nbsp;two&nbsp;functions&nbsp;init&nbsp;and<br/>
receive&nbsp;to&nbsp;respectively&nbsp;initialize&nbsp;state&nbsp;on&nbsp;deployment&nbsp;and&nbsp;to&nbsp;update<br/>
state&nbsp;when&nbsp;receiving&nbsp;messages.&nbsp;The&nbsp;weak&nbsp;version&nbsp;of&nbsp;contracts&nbsp;means&nbsp;that<br/>
the&nbsp;state/message/setup&nbsp;types,&nbsp;which&nbsp;would&nbsp;normally&nbsp;vary&nbsp;with&nbsp;contracts,<br/>
are&nbsp;stored&nbsp;in&nbsp;a&nbsp;serialized&nbsp;format.<br/>
<br/>
*&nbsp;The&nbsp;Contract&nbsp;type,&nbsp;describing&nbsp;a&nbsp;more&nbsp;strongly&nbsp;typed&nbsp;version&nbsp;of&nbsp;a&nbsp;contract.<br/>
This&nbsp;is&nbsp;the&nbsp;same&nbsp;as&nbsp;the&nbsp;above&nbsp;except&nbsp;we&nbsp;abstract&nbsp;over&nbsp;the&nbsp;appropriate&nbsp;types.<br/>
Users&nbsp;of&nbsp;the&nbsp;framework&nbsp;will&nbsp;mostly&nbsp;need&nbsp;to&nbsp;deal&nbsp;with&nbsp;this.<br/>
<br/>
The&nbsp;next&nbsp;types&nbsp;deal&nbsp;with&nbsp;semantics.<br/>
<br/>
*&nbsp;The&nbsp;Environment&nbsp;type.&nbsp;This&nbsp;augments&nbsp;the&nbsp;Chain&nbsp;type&nbsp;with&nbsp;more&nbsp;information.<br/>
Environment&nbsp;can&nbsp;be&nbsp;thought&nbsp;of&nbsp;as&nbsp;the&nbsp;information&nbsp;that&nbsp;a&nbsp;realistic&nbsp;blockchain<br/>
implementation&nbsp;would&nbsp;need&nbsp;to&nbsp;keep&nbsp;track&nbsp;of&nbsp;to&nbsp;implement&nbsp;operations.&nbsp;For&nbsp;instance,<br/>
it&nbsp;is&nbsp;reasonable&nbsp;to&nbsp;assume&nbsp;that&nbsp;an&nbsp;implementation&nbsp;needs&nbsp;to&nbsp;access&nbsp;the&nbsp;state&nbsp;of<br/>
contracts,&nbsp;but&nbsp;not&nbsp;to&nbsp;assume&nbsp;that&nbsp;it&nbsp;needs&nbsp;to&nbsp;store&nbsp;the&nbsp;full&nbsp;transaction&nbsp;history<br/>
of&nbsp;all&nbsp;addresses.<br/>
<br/>
*&nbsp;The&nbsp;ActionEvaluation&nbsp;type.&nbsp;This&nbsp;specifies&nbsp;how&nbsp;to&nbsp;evaluate&nbsp;actions&nbsp;returned&nbsp;by<br/>
contracts&nbsp;or&nbsp;input&nbsp;in&nbsp;blocks.&nbsp;This&nbsp;related&nbsp;an&nbsp;environment&nbsp;and&nbsp;action&nbsp;to&nbsp;a&nbsp;new<br/>
environment&nbsp;and&nbsp;list&nbsp;of&nbsp;new&nbsp;actions&nbsp;to&nbsp;execute.<br/>
<br/>
*&nbsp;The&nbsp;ChainState&nbsp;type.&nbsp;This&nbsp;augments&nbsp;the&nbsp;Environment&nbsp;type&nbsp;with&nbsp;a&nbsp;queue&nbsp;of<br/>
"outstanding"&nbsp;actions&nbsp;that&nbsp;need&nbsp;to&nbsp;be&nbsp;executed.&nbsp;For&nbsp;instance,&nbsp;when&nbsp;a&nbsp;block&nbsp;is<br/>
added,&nbsp;its&nbsp;actions&nbsp;are&nbsp;put&nbsp;into&nbsp;this&nbsp;queue.<br/>
<br/>
*&nbsp;The&nbsp;ChainStep&nbsp;type.&nbsp;This&nbsp;specifies&nbsp;how&nbsp;the&nbsp;blockchain&nbsp;should&nbsp;execute&nbsp;smart<br/>
contracts,&nbsp;and&nbsp;how&nbsp;new&nbsp;blocks&nbsp;are&nbsp;added.&nbsp;It&nbsp;relates&nbsp;a&nbsp;ChainState&nbsp;to&nbsp;a&nbsp;new&nbsp;ChainState.<br/>
There&nbsp;are&nbsp;steps&nbsp;to&nbsp;allow&nbsp;adding&nbsp;blocks,&nbsp;evaluating&nbsp;actions&nbsp;in&nbsp;the&nbsp;queue&nbsp;and&nbsp;to<br/>
permute&nbsp;the&nbsp;queue&nbsp;(allowing&nbsp;to&nbsp;model&nbsp;any&nbsp;execution&nbsp;order).<br/>
<br/>
*&nbsp;The&nbsp;ChainTrace&nbsp;type.&nbsp;This&nbsp;just&nbsp;represents&nbsp;a&nbsp;sequence&nbsp;of&nbsp;steps.&nbsp;If&nbsp;a&nbsp;trace&nbsp;ends<br/>
in&nbsp;a&nbsp;state&nbsp;it&nbsp;means&nbsp;that&nbsp;state&nbsp;is&nbsp;reachable&nbsp;and&nbsp;there&nbsp;is&nbsp;a&nbsp;"semantically&nbsp;correct"<br/>
way&nbsp;of&nbsp;executing&nbsp;to&nbsp;get&nbsp;to&nbsp;this&nbsp;state.&nbsp;This&nbsp;type&nbsp;records&nbsp;the&nbsp;full&nbsp;history&nbsp;of&nbsp;a<br/>
blockchain's&nbsp;execution&nbsp;and&nbsp;it&nbsp;would&nbsp;thus&nbsp;be&nbsp;unrealistic&nbsp;to&nbsp;extract.<br/>
<br/>
*&nbsp;The&nbsp;ChainBuilderType&nbsp;type.&nbsp;This&nbsp;is&nbsp;a&nbsp;typeclass&nbsp;for&nbsp;implementations&nbsp;of&nbsp;blockchains,<br/>
where&nbsp;these&nbsp;implementations&nbsp;need&nbsp;to&nbsp;prove&nbsp;that&nbsp;they&nbsp;satisfy&nbsp;our&nbsp;semantics.<br/>
<br/>
*)</span><br/>

<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">Coq</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.ZArith.ZArith.html#"><span class="id" title="library">ZArith</span></a>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">Coq</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#"><span class="id" title="library">List</span></a>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">Coq</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.micromega.Psatz.html#"><span class="id" title="library">Psatz</span></a>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">Coq</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Sorting.Permutation.html#"><span class="id" title="library">Permutation</span></a>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">Coq</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Classes.Morphisms.html#"><span class="id" title="library">Morphisms</span></a>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">ConCert.Execution</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="ConCert.Execution.ChainedList.html#"><span class="id" title="library">ChainedList</span></a>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">ConCert.Execution</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="ConCert.Execution.Monads.html#"><span class="id" title="library">Monads</span></a>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">ConCert.Execution</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="ConCert.Execution.ResultMonad.html#"><span class="id" title="library">ResultMonad</span></a>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">ConCert.Execution</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="ConCert.Execution.Serializable.html#"><span class="id" title="library">Serializable</span></a>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">ConCert.Utils</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="ConCert.Utils.Automation.html#"><span class="id" title="library">Automation</span></a>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">ConCert.Utils</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="ConCert.Utils.Extras.html#"><span class="id" title="library">Extras</span></a>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">ConCert.Utils</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="ConCert.Utils.RecordUpdate.html#"><span class="id" title="library">RecordUpdate</span></a>.<br/>

<br/>
<span class="id" title="keyword">Import</span> <span class="id" title="var">ListNotations</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a name="Amount"><span class="id" title="definition">Amount</span></a> := <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Numbers.BinNums.html#Z"><span class="id" title="inductive">Z</span></a>.<br/>
<span class="id" title="keyword">Bind</span> <span class="id" title="keyword">Scope</span> <span class="id" title="var">Z_scope</span> <span class="id" title="keyword">with</span> <span class="id" title="var">Amount</span>.<br/>

<br/>
<span class="id" title="keyword">Class</span> <a name="ChainBase"><span class="id" title="record">ChainBase</span></a> :=<br/>
&nbsp;&nbsp;<a name="build_chain_base"><span class="id" title="constructor">build_chain_base</span></a> {<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a name="Address"><span class="id" title="projection">Address</span></a> : <span class="id" title="keyword">Type</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a name="address_eqb"><span class="id" title="projection">address_eqb</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#Address"><span class="id" title="method">Address</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#Address"><span class="id" title="method">Address</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#bool"><span class="id" title="inductive">bool</span></a>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a name="address_eqb_spec"><span class="id" title="projection">address_eqb_spec</span></a> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">forall</span> (<span class="id" title="var">a</span> <span class="id" title="var">b</span> : <a class="idref" href="ConCert.Execution.Blockchain.html#Address"><span class="id" title="method">Address</span></a>), <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Bool.Bool.html#reflect"><span class="id" title="inductive">Bool.reflect</span></a> (<a class="idref" href="ConCert.Execution.Blockchain.html#a"><span class="id" title="variable">a</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#b"><span class="id" title="variable">b</span></a>) (<a class="idref" href="ConCert.Execution.Blockchain.html#address_eqb"><span class="id" title="method">address_eqb</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#a"><span class="id" title="variable">a</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#b"><span class="id" title="variable">b</span></a>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a name="address_eqdec"><span class="id" title="projection">address_eqdec</span></a> :&gt; <span class="id" title="abbreviation">stdpp.base.EqDecision</span> <a class="idref" href="ConCert.Execution.Blockchain.html#Address"><span class="id" title="method">Address</span></a>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a name="address_countable"><span class="id" title="projection">address_countable</span></a> :&gt; <span class="id" title="class">countable.Countable</span> <a class="idref" href="ConCert.Execution.Blockchain.html#Address"><span class="id" title="method">Address</span></a>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a name="address_serializable"><span class="id" title="projection">address_serializable</span></a> :&gt; <a class="idref" href="ConCert.Execution.Serializable.html#Serializable"><span class="id" title="class">Serializable</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#Address"><span class="id" title="method">Address</span></a>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a name="address_is_contract"><span class="id" title="projection">address_is_contract</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#Address"><span class="id" title="method">Address</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#bool"><span class="id" title="inductive">bool</span></a>;<br/>
&nbsp;&nbsp;}.<br/>

<br/>
<span class="id" title="keyword">Global Opaque</span> <a class="idref" href="ConCert.Execution.Blockchain.html#Address"><span class="id" title="method">Address</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#address_eqb"><span class="id" title="method">address_eqb</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#address_eqb_spec"><span class="id" title="method">address_eqb_spec</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#address_eqdec"><span class="id" title="method">address_eqdec</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#address_countable"><span class="id" title="method">address_countable</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#address_serializable"><span class="id" title="method">address_serializable</span></a>.<br/>

<br/>
<span class="id" title="keyword">Delimit</span> <span class="id" title="keyword">Scope</span> <span class="id" title="var">address_scope</span> <span class="id" title="keyword">with</span> <span class="id" title="var">address</span>.<br/>
<span class="id" title="keyword">Bind</span> <span class="id" title="keyword">Scope</span> <span class="id" title="var">address_scope</span> <span class="id" title="keyword">with</span> <span class="id" title="var">Address</span>.<br/>
<span class="id" title="keyword">Infix</span> <a name="6f617e0e5500b437e5aeb1eaa876d41f"><span class="id" title="notation">&quot;</span></a>=?" := <a class="idref" href="ConCert.Execution.Blockchain.html#address_eqb"><span class="id" title="method">address_eqb</span></a> (<span class="id" title="tactic">at</span> <span class="id" title="keyword">level</span> 70) : <span class="id" title="var">address_scope</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a name="address_eq_refl"><span class="id" title="lemma">address_eq_refl</span></a> `{<a class="idref" href="ConCert.Execution.Blockchain.html#ChainBase"><span class="id" title="class">ChainBase</span></a>} <span class="id" title="var">x</span> :<br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#address_eqb"><span class="id" title="method">address_eqb</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#x"><span class="id" title="variable">x</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#x"><span class="id" title="variable">x</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#true"><span class="id" title="constructor">true</span></a>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">destruct</span> (<a class="idref" href="ConCert.Execution.Blockchain.html#address_eqb_spec"><span class="id" title="method">address_eqb_spec</span></a> <span class="id" title="var">x</span> <span class="id" title="var">x</span>); <span class="id" title="tactic">auto</span>; <span class="id" title="tactic">congruence</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a name="address_eq_ne"><span class="id" title="lemma">address_eq_ne</span></a> `{<a class="idref" href="ConCert.Execution.Blockchain.html#ChainBase"><span class="id" title="class">ChainBase</span></a>} <span class="id" title="var">x</span> <span class="id" title="var">y</span> :<br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#x"><span class="id" title="variable">x</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#a0a5068f83a704fcfbda8cd473a6cfea"><span class="id" title="notation">&lt;&gt;</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#y"><span class="id" title="variable">y</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#address_eqb"><span class="id" title="method">address_eqb</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#x"><span class="id" title="variable">x</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#y"><span class="id" title="variable">y</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#false"><span class="id" title="constructor">false</span></a>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">destruct</span> (<a class="idref" href="ConCert.Execution.Blockchain.html#address_eqb_spec"><span class="id" title="method">address_eqb_spec</span></a> <span class="id" title="var">x</span> <span class="id" title="var">y</span>) <span class="id" title="keyword">as</span> [-&gt;|]; <span class="id" title="tactic">tauto</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a name="address_eq_sym"><span class="id" title="lemma">address_eq_sym</span></a> `{<a class="idref" href="ConCert.Execution.Blockchain.html#ChainBase"><span class="id" title="class">ChainBase</span></a>} <span class="id" title="var">x</span> <span class="id" title="var">y</span> :<br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#address_eqb"><span class="id" title="method">address_eqb</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#x"><span class="id" title="variable">x</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#y"><span class="id" title="variable">y</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#address_eqb"><span class="id" title="method">address_eqb</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#y"><span class="id" title="variable">y</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#x"><span class="id" title="variable">x</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<a class="idref" href="ConCert.Execution.Blockchain.html#address_eqb_spec"><span class="id" title="method">address_eqb_spec</span></a> <span class="id" title="var">x</span> <span class="id" title="var">y</span>) <span class="id" title="keyword">as</span> [-&gt;|].<br/>
&nbsp;&nbsp;- <span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <a class="idref" href="ConCert.Execution.Blockchain.html#address_eq_refl"><span class="id" title="lemma">address_eq_refl</span></a>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">rewrite</span> <a class="idref" href="ConCert.Execution.Blockchain.html#address_eq_ne"><span class="id" title="lemma">address_eq_ne</span></a>; <span class="id" title="tactic">auto</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Global Ltac</span> <span class="id" title="var">destruct_address_eq</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="tactic">repeat</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| [<span class="id" title="var">H</span>: <span class="id" title="keyword">context</span>[<a class="idref" href="ConCert.Execution.Blockchain.html#address_eqb"><span class="id" title="method">address_eqb</span></a> ?<span class="id" title="var">a</span> ?<span class="id" title="var">b</span>] |- <span class="id" title="var">_</span>] =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">try</span> <span class="id" title="tactic">rewrite</span> (<a class="idref" href="ConCert.Execution.Blockchain.html#address_eq_sym"><span class="id" title="lemma">address_eq_sym</span></a> <span class="id" title="var">b</span> <span class="id" title="var">a</span>) <span class="id" title="tactic">in</span> *; <span class="id" title="tactic">destruct</span> (<a class="idref" href="ConCert.Execution.Blockchain.html#address_eqb_spec"><span class="id" title="method">address_eqb_spec</span></a> <span class="id" title="var">a</span> <span class="id" title="var">b</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| [|- <span class="id" title="keyword">context</span>[<a class="idref" href="ConCert.Execution.Blockchain.html#address_eqb"><span class="id" title="method">address_eqb</span></a> ?<span class="id" title="var">a</span> ?<span class="id" title="var">b</span>]] =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">try</span> <span class="id" title="tactic">rewrite</span> (<a class="idref" href="ConCert.Execution.Blockchain.html#address_eq_sym"><span class="id" title="lemma">address_eq_sym</span></a> <span class="id" title="var">b</span> <span class="id" title="var">a</span>) <span class="id" title="tactic">in</span> *; <span class="id" title="tactic">destruct</span> (<a class="idref" href="ConCert.Execution.Blockchain.html#address_eqb_spec"><span class="id" title="method">address_eqb_spec</span></a> <span class="id" title="var">a</span> <span class="id" title="var">b</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Section</span> <a name="Blockchain"><span class="id" title="section">Blockchain</span></a>.<br/>
<span class="id" title="keyword">Context</span> {<span class="id" title="var">Base</span> : <a class="idref" href="ConCert.Execution.Blockchain.html#ChainBase"><span class="id" title="class">ChainBase</span></a>}.<br/>

<br/>
<span class="comment">(*&nbsp;This&nbsp;represents&nbsp;the&nbsp;view&nbsp;of&nbsp;the&nbsp;blockchain&nbsp;that&nbsp;a&nbsp;contract<br/>
can&nbsp;access&nbsp;and&nbsp;interact&nbsp;with.&nbsp;*)</span><br/>
<span class="id" title="keyword">Record</span> <a name="Chain"><span class="id" title="record">Chain</span></a> :=<br/>
&nbsp;&nbsp;<a name="build_chain"><span class="id" title="constructor">build_chain</span></a> {<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a name="chain_height"><span class="id" title="projection">chain_height</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a name="current_slot"><span class="id" title="projection">current_slot</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a name="finalized_height"><span class="id" title="projection">finalized_height</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a>;<br/>
&nbsp;&nbsp;}.<br/>

<br/>
<span class="id" title="keyword">Record</span> <a name="ContractCallContext"><span class="id" title="record">ContractCallContext</span></a> :=<br/>
&nbsp;&nbsp;<a name="build_ctx"><span class="id" title="constructor">build_ctx</span></a> {<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;Address&nbsp;that&nbsp;initiated&nbsp;the&nbsp;transaction&nbsp;(never&nbsp;a&nbsp;contract)&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a name="ctx_origin"><span class="id" title="projection">ctx_origin</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#Address"><span class="id" title="method">Address</span></a>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;Address&nbsp;of&nbsp;the&nbsp;immediate&nbsp;account&nbsp;that&nbsp;sent&nbsp;the&nbsp;call&nbsp;(can&nbsp;be&nbsp;a&nbsp;contract&nbsp;or&nbsp;a&nbsp;user&nbsp;account)&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a name="ctx_from"><span class="id" title="projection">ctx_from</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#Address"><span class="id" title="method">Address</span></a>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;Address&nbsp;of&nbsp;the&nbsp;contract&nbsp;being&nbsp;called&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a name="ctx_contract_address"><span class="id" title="projection">ctx_contract_address</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#Address"><span class="id" title="method">Address</span></a>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;Balance&nbsp;of&nbsp;the&nbsp;contract&nbsp;being&nbsp;called&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a name="ctx_contract_balance"><span class="id" title="projection">ctx_contract_balance</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#Amount"><span class="id" title="definition">Amount</span></a>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;Amount&nbsp;of&nbsp;currency&nbsp;passed&nbsp;in&nbsp;call&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a name="ctx_amount"><span class="id" title="projection">ctx_amount</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#Amount"><span class="id" title="definition">Amount</span></a>;<br/>
&nbsp;&nbsp;}.<br/>

<br/>
<span class="comment">(*&nbsp;Operations&nbsp;that&nbsp;a&nbsp;contract&nbsp;can&nbsp;return&nbsp;or&nbsp;that&nbsp;a&nbsp;user&nbsp;can&nbsp;use<br/>
to&nbsp;interact&nbsp;with&nbsp;a&nbsp;chain.&nbsp;*)</span><br/>
<span class="id" title="keyword">Inductive</span> <a name="ActionBody"><span class="id" title="inductive">ActionBody</span></a> :=<br/>
&nbsp;&nbsp;| <a name="act_transfer"><span class="id" title="constructor">act_transfer</span></a> (<span class="id" title="var">to</span> : <a class="idref" href="ConCert.Execution.Blockchain.html#Address"><span class="id" title="method">Address</span></a>) (<span class="id" title="var">amount</span> : <a class="idref" href="ConCert.Execution.Blockchain.html#Amount"><span class="id" title="definition">Amount</span></a>)<br/>
&nbsp;&nbsp;| <a name="act_call"><span class="id" title="constructor">act_call</span></a> (<span class="id" title="var">to</span> : <a class="idref" href="ConCert.Execution.Blockchain.html#Address"><span class="id" title="method">Address</span></a>) (<span class="id" title="var">amount</span> : <a class="idref" href="ConCert.Execution.Blockchain.html#Amount"><span class="id" title="definition">Amount</span></a>) (<span class="id" title="var">msg</span> : <a class="idref" href="ConCert.Execution.Serializable.html#SerializedValue"><span class="id" title="record">SerializedValue</span></a>)<br/>
&nbsp;&nbsp;| <a name="act_deploy"><span class="id" title="constructor">act_deploy</span></a> (<span class="id" title="var">amount</span> : <a class="idref" href="ConCert.Execution.Blockchain.html#Amount"><span class="id" title="definition">Amount</span></a>) (<span class="id" title="var">c</span> : <a class="idref" href="ConCert.Execution.Blockchain.html#WeakContract"><span class="id" title="inductive">WeakContract</span></a>) (<span class="id" title="var">setup</span> : <a class="idref" href="ConCert.Execution.Serializable.html#SerializedValue"><span class="id" title="record">SerializedValue</span></a>)<br/>
<span class="id" title="keyword">with</span> <a name="WeakContract"><span class="id" title="inductive">WeakContract</span></a> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a name="build_weak_contract"><span class="id" title="constructor">build_weak_contract</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">init</span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#Chain"><span class="id" title="record">Chain</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#ContractCallContext"><span class="id" title="record">ContractCallContext</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Serializable.html#SerializedValue"><span class="id" title="record">SerializedValue</span></a> <span class="comment">(*&nbsp;setup&nbsp;*)</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#option"><span class="id" title="inductive">option</span></a> <a class="idref" href="ConCert.Execution.Serializable.html#SerializedValue"><span class="id" title="record">SerializedValue</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">receive</span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#Chain"><span class="id" title="record">Chain</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#ContractCallContext"><span class="id" title="record">ContractCallContext</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Serializable.html#SerializedValue"><span class="id" title="record">SerializedValue</span></a> <span class="comment">(*&nbsp;state&nbsp;*)</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#option"><span class="id" title="inductive">option</span></a> <a class="idref" href="ConCert.Execution.Serializable.html#SerializedValue"><span class="id" title="record">SerializedValue</span></a> <span class="comment">(*&nbsp;message&nbsp;*)</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#option"><span class="id" title="inductive">option</span></a> (<a class="idref" href="ConCert.Execution.Serializable.html#SerializedValue"><span class="id" title="record">SerializedValue</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#11c698c8685bb8ab1cf725545c085ac4"><span class="id" title="notation">*</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#list"><span class="id" title="inductive">list</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#ActionBody"><span class="id" title="inductive">ActionBody</span></a>)).<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a name="act_body_amount"><span class="id" title="definition">act_body_amount</span></a> (<span class="id" title="var">ab</span> : <a class="idref" href="ConCert.Execution.Blockchain.html#ActionBody"><span class="id" title="inductive">ActionBody</span></a>) : <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Numbers.BinNums.html#Z"><span class="id" title="inductive">Z</span></a> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="ConCert.Execution.Blockchain.html#ab"><span class="id" title="variable">ab</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| <a class="idref" href="ConCert.Execution.Blockchain.html#act_transfer"><span class="id" title="constructor">act_transfer</span></a> <span class="id" title="var">_</span> <span class="id" title="var">amount</span><br/>
&nbsp;&nbsp;| <a class="idref" href="ConCert.Execution.Blockchain.html#act_call"><span class="id" title="constructor">act_call</span></a> <span class="id" title="var">_</span> <span class="id" title="var">amount</span> <span class="id" title="var">_</span><br/>
&nbsp;&nbsp;| <a class="idref" href="ConCert.Execution.Blockchain.html#act_deploy"><span class="id" title="constructor">act_deploy</span></a> <span class="id" title="var">amount</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> =&gt; <span class="id" title="var">amount</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a name="wc_init"><span class="id" title="definition">wc_init</span></a> (<span class="id" title="var">wc</span> : <a class="idref" href="ConCert.Execution.Blockchain.html#WeakContract"><span class="id" title="inductive">WeakContract</span></a>) :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">let</span> (<span class="id" title="var">i</span>, <span class="id" title="var">_</span>) := <a class="idref" href="ConCert.Execution.Blockchain.html#wc"><span class="id" title="variable">wc</span></a> <span class="id" title="tactic">in</span> <a class="idref" href="ConCert.Execution.Blockchain.html#i"><span class="id" title="variable">i</span></a>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a name="wc_receive"><span class="id" title="definition">wc_receive</span></a> (<span class="id" title="var">wc</span> : <a class="idref" href="ConCert.Execution.Blockchain.html#WeakContract"><span class="id" title="inductive">WeakContract</span></a>) :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">let</span> (<span class="id" title="var">_</span>, <span class="id" title="var">r</span>) := <a class="idref" href="ConCert.Execution.Blockchain.html#wc"><span class="id" title="variable">wc</span></a> <span class="id" title="tactic">in</span> <a class="idref" href="ConCert.Execution.Blockchain.html#r"><span class="id" title="variable">r</span></a>.<br/>

<br/>
<span class="id" title="keyword">Record</span> <a name="Action"><span class="id" title="record">Action</span></a> :=<br/>
&nbsp;&nbsp;<a name="build_act"><span class="id" title="constructor">build_act</span></a> {<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a name="act_origin"><span class="id" title="projection">act_origin</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#Address"><span class="id" title="method">Address</span></a>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a name="act_from"><span class="id" title="projection">act_from</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#Address"><span class="id" title="method">Address</span></a>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a name="act_body"><span class="id" title="projection">act_body</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#ActionBody"><span class="id" title="inductive">ActionBody</span></a>;<br/>
&nbsp;&nbsp;}.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a name="act_amount"><span class="id" title="definition">act_amount</span></a> (<span class="id" title="var">a</span> : <a class="idref" href="ConCert.Execution.Blockchain.html#Action"><span class="id" title="record">Action</span></a>) := <a class="idref" href="ConCert.Execution.Blockchain.html#act_body_amount"><span class="id" title="definition">act_body_amount</span></a> (<a class="idref" href="ConCert.Execution.Blockchain.html#act_body"><span class="id" title="projection">act_body</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#a"><span class="id" title="variable">a</span></a>).<br/>

<br/>
<span class="comment">(*&nbsp;Represents&nbsp;a&nbsp;strongly-typed&nbsp;contract.&nbsp;This&nbsp;is&nbsp;what&nbsp;user's&nbsp;will&nbsp;primarily<br/>
use&nbsp;and&nbsp;interact&nbsp;with&nbsp;when&nbsp;they&nbsp;want&nbsp;deployment.&nbsp;We&nbsp;keep&nbsp;the&nbsp;weak&nbsp;contract<br/>
only&nbsp;"internally"&nbsp;for&nbsp;blockchains,&nbsp;while&nbsp;any&nbsp;strongly-typed&nbsp;contract&nbsp;can<br/>
be&nbsp;converted&nbsp;to&nbsp;and&nbsp;from&nbsp;*)</span><br/>
<span class="id" title="keyword">Record</span> <a name="Contract"><span class="id" title="record">Contract</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">Setup</span> <span class="id" title="var">Msg</span> <span class="id" title="var">State</span> : <span class="id" title="keyword">Type</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;`{<a class="idref" href="ConCert.Execution.Serializable.html#Serializable"><span class="id" title="class">Serializable</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#Setup"><span class="id" title="variable">Setup</span></a>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;`{<a class="idref" href="ConCert.Execution.Serializable.html#Serializable"><span class="id" title="class">Serializable</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#Msg"><span class="id" title="variable">Msg</span></a>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;`{<a class="idref" href="ConCert.Execution.Serializable.html#Serializable"><span class="id" title="class">Serializable</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#State"><span class="id" title="variable">State</span></a>} :=<br/>
&nbsp;&nbsp;<a name="build_contract"><span class="id" title="constructor">build_contract</span></a> {<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a name="init"><span class="id" title="projection">init</span></a> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#Chain"><span class="id" title="record">Chain</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#ContractCallContext"><span class="id" title="record">ContractCallContext</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#Setup"><span class="id" title="variable">Setup</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#option"><span class="id" title="inductive">option</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#State"><span class="id" title="variable">State</span></a>;<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a name="receive"><span class="id" title="projection">receive</span></a> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#Chain"><span class="id" title="record">Chain</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#ContractCallContext"><span class="id" title="record">ContractCallContext</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#State"><span class="id" title="variable">State</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#option"><span class="id" title="inductive">option</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#Msg"><span class="id" title="variable">Msg</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#option"><span class="id" title="inductive">option</span></a> (<a class="idref" href="ConCert.Execution.Blockchain.html#State"><span class="id" title="variable">State</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#11c698c8685bb8ab1cf725545c085ac4"><span class="id" title="notation">*</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#list"><span class="id" title="inductive">list</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#ActionBody"><span class="id" title="inductive">ActionBody</span></a>);<br/>
&nbsp;&nbsp;}.<br/>

<br/>
<span class="id" title="keyword">Global</span> <span class="id" title="var">Arguments</span> <a class="idref" href="ConCert.Execution.Blockchain.html#init"><span class="id" title="projection">init</span></a> {<span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>}.<br/>
<span class="id" title="keyword">Global</span> <span class="id" title="var">Arguments</span> <a class="idref" href="ConCert.Execution.Blockchain.html#receive"><span class="id" title="projection">receive</span></a> {<span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>}.<br/>
<span class="id" title="keyword">Global</span> <span class="id" title="var">Arguments</span> <a class="idref" href="ConCert.Execution.Blockchain.html#build_contract"><span class="id" title="constructor">build_contract</span></a> {<span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>}.<br/>

<br/>
<span class="id" title="keyword">Program Definition</span> <a name="contract_to_weak_contract"><span class="id" title="definition">contract_to_weak_contract</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<span class="id" title="var">Setup</span> <span class="id" title="var">Msg</span> <span class="id" title="var">State</span> : <span class="id" title="keyword">Type</span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;`{<a class="idref" href="ConCert.Execution.Serializable.html#Serializable"><span class="id" title="class">Serializable</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#Setup"><span class="id" title="variable">Setup</span></a>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;`{<a class="idref" href="ConCert.Execution.Serializable.html#Serializable"><span class="id" title="class">Serializable</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#Msg"><span class="id" title="variable">Msg</span></a>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;`{<a class="idref" href="ConCert.Execution.Serializable.html#Serializable"><span class="id" title="class">Serializable</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#State"><span class="id" title="variable">State</span></a>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">c</span> : <a class="idref" href="ConCert.Execution.Blockchain.html#Contract"><span class="id" title="record">Contract</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#Setup"><span class="id" title="variable">Setup</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#Msg"><span class="id" title="variable">Msg</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#State"><span class="id" title="variable">State</span></a>) : <a class="idref" href="ConCert.Execution.Blockchain.html#WeakContract"><span class="id" title="inductive">WeakContract</span></a> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">weak_init</span> <span class="id" title="var">chain</span> <span class="id" title="var">ctx</span> <span class="id" title="var">ser_setup</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Monads.html#bbeef38f67325be53cb9324ba9182131"><span class="id" title="notation">do</span></a> <span class="id" title="var">setup</span> <a class="idref" href="ConCert.Execution.Monads.html#bbeef38f67325be53cb9324ba9182131"><span class="id" title="notation">&lt;-</span></a> <a class="idref" href="ConCert.Execution.Serializable.html#deserialize"><span class="id" title="method">deserialize</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#ser_setup"><span class="id" title="variable">ser_setup</span></a><a class="idref" href="ConCert.Execution.Monads.html#bbeef38f67325be53cb9324ba9182131"><span class="id" title="notation">;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Monads.html#bbeef38f67325be53cb9324ba9182131"><span class="id" title="notation">do</span></a> <span class="id" title="var">state</span> <a class="idref" href="ConCert.Execution.Monads.html#bbeef38f67325be53cb9324ba9182131"><span class="id" title="notation">&lt;-</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#c"><span class="id" title="variable">c</span></a>.(<a class="idref" href="ConCert.Execution.Blockchain.html#init"><span class="id" title="projection">init</span></a>) <a class="idref" href="ConCert.Execution.Blockchain.html#chain"><span class="id" title="variable">chain</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#ctx"><span class="id" title="variable">ctx</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#setup"><span class="id" title="variable">setup</span></a><a class="idref" href="ConCert.Execution.Monads.html#bbeef38f67325be53cb9324ba9182131"><span class="id" title="notation">;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> (<a class="idref" href="ConCert.Execution.Serializable.html#serialize"><span class="id" title="method">serialize</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#state"><span class="id" title="variable">state</span></a>) <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">weak_recv</span> <span class="id" title="var">chain</span> <span class="id" title="var">ctx</span> <span class="id" title="var">ser_state</span> <span class="id" title="var">ser_msg_opt</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Monads.html#bbeef38f67325be53cb9324ba9182131"><span class="id" title="notation">do</span></a> <span class="id" title="var">state</span> <a class="idref" href="ConCert.Execution.Monads.html#bbeef38f67325be53cb9324ba9182131"><span class="id" title="notation">&lt;-</span></a> <a class="idref" href="ConCert.Execution.Serializable.html#deserialize"><span class="id" title="method">deserialize</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#ser_state"><span class="id" title="variable">ser_state</span></a><a class="idref" href="ConCert.Execution.Monads.html#bbeef38f67325be53cb9324ba9182131"><span class="id" title="notation">;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="ConCert.Execution.Blockchain.html#ser_msg_opt"><span class="id" title="variable">ser_msg_opt</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <span class="id" title="var">ser_msg</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Monads.html#bbeef38f67325be53cb9324ba9182131"><span class="id" title="notation">do</span></a> <span class="id" title="var">msg</span> <a class="idref" href="ConCert.Execution.Monads.html#bbeef38f67325be53cb9324ba9182131"><span class="id" title="notation">&lt;-</span></a> <a class="idref" href="ConCert.Execution.Serializable.html#deserialize"><span class="id" title="method">deserialize</span></a> <span class="id" title="var">ser_msg</span><a class="idref" href="ConCert.Execution.Monads.html#bbeef38f67325be53cb9324ba9182131"><span class="id" title="notation">;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Monads.html#4842b7321410137459b4dcd7c5f317e4"><span class="id" title="notation">do</span></a> <a class="idref" href="ConCert.Execution.Monads.html#4842b7321410137459b4dcd7c5f317e4"><span class="id" title="notation">'</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><span class="id" title="var">new_state</span><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <span class="id" title="var">acts</span><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <a class="idref" href="ConCert.Execution.Monads.html#4842b7321410137459b4dcd7c5f317e4"><span class="id" title="notation">&lt;-</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#c"><span class="id" title="variable">c</span></a>.(<a class="idref" href="ConCert.Execution.Blockchain.html#receive"><span class="id" title="projection">receive</span></a>) <a class="idref" href="ConCert.Execution.Blockchain.html#chain"><span class="id" title="variable">chain</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#ctx"><span class="id" title="variable">ctx</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#state"><span class="id" title="variable">state</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#msg"><span class="id" title="variable">msg</span></a>)<a class="idref" href="ConCert.Execution.Monads.html#4842b7321410137459b4dcd7c5f317e4"><span class="id" title="notation">;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Execution.Serializable.html#serialize"><span class="id" title="method">serialize</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#new_state"><span class="id" title="variable">new_state</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#acts"><span class="id" title="variable">acts</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Monads.html#4842b7321410137459b4dcd7c5f317e4"><span class="id" title="notation">do</span></a> <a class="idref" href="ConCert.Execution.Monads.html#4842b7321410137459b4dcd7c5f317e4"><span class="id" title="notation">'</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><span class="id" title="var">new_state</span><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <span class="id" title="var">acts</span><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <a class="idref" href="ConCert.Execution.Monads.html#4842b7321410137459b4dcd7c5f317e4"><span class="id" title="notation">&lt;-</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#c"><span class="id" title="variable">c</span></a>.(<a class="idref" href="ConCert.Execution.Blockchain.html#receive"><span class="id" title="projection">receive</span></a>) <a class="idref" href="ConCert.Execution.Blockchain.html#chain"><span class="id" title="variable">chain</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#ctx"><span class="id" title="variable">ctx</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#state"><span class="id" title="variable">state</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a><a class="idref" href="ConCert.Execution.Monads.html#4842b7321410137459b4dcd7c5f317e4"><span class="id" title="notation">;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Execution.Serializable.html#serialize"><span class="id" title="method">serialize</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#new_state"><span class="id" title="variable">new_state</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#acts"><span class="id" title="variable">acts</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#build_weak_contract"><span class="id" title="constructor">build_weak_contract</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#weak_init"><span class="id" title="variable">weak_init</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#weak_recv"><span class="id" title="variable">weak_recv</span></a>.<br/>

<br/>
<span class="id" title="keyword">Coercion</span> <a class="idref" href="ConCert.Execution.Blockchain.html#contract_to_weak_contract"><span class="id" title="definition">contract_to_weak_contract</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#contract_to_weak_contract"><span class="id" title="definition">:</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#contract_to_weak_contract"><span class="id" title="definition">Contract</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#contract_to_weak_contract"><span class="id" title="definition">&gt;-&gt;</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#contract_to_weak_contract"><span class="id" title="definition">WeakContract</span></a>.<br/>

<br/>
<span class="comment">(*&nbsp;Deploy&nbsp;a&nbsp;strongly&nbsp;typed&nbsp;contract&nbsp;with&nbsp;some&nbsp;amount&nbsp;and&nbsp;setup&nbsp;*)</span><br/>
<span class="id" title="keyword">Definition</span> <a name="create_deployment"><span class="id" title="definition">create_deployment</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<span class="id" title="var">Setup</span> <span class="id" title="var">Msg</span> <span class="id" title="var">State</span> : <span class="id" title="keyword">Type</span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;`{<a class="idref" href="ConCert.Execution.Serializable.html#Serializable"><span class="id" title="class">Serializable</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#Setup"><span class="id" title="variable">Setup</span></a>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;`{<a class="idref" href="ConCert.Execution.Serializable.html#Serializable"><span class="id" title="class">Serializable</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#Msg"><span class="id" title="variable">Msg</span></a>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;`{<a class="idref" href="ConCert.Execution.Serializable.html#Serializable"><span class="id" title="class">Serializable</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#State"><span class="id" title="variable">State</span></a>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">amount</span> : <a class="idref" href="ConCert.Execution.Blockchain.html#Amount"><span class="id" title="definition">Amount</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">contract</span> : <a class="idref" href="ConCert.Execution.Blockchain.html#Contract"><span class="id" title="record">Contract</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#Setup"><span class="id" title="variable">Setup</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#Msg"><span class="id" title="variable">Msg</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#State"><span class="id" title="variable">State</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">setup</span> : <a class="idref" href="ConCert.Execution.Blockchain.html#Setup"><span class="id" title="variable">Setup</span></a>) : <a class="idref" href="ConCert.Execution.Blockchain.html#ActionBody"><span class="id" title="inductive">ActionBody</span></a> :=<br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#act_deploy"><span class="id" title="constructor">act_deploy</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#amount"><span class="id" title="variable">amount</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#contract"><span class="id" title="variable">contract</span></a> (<a class="idref" href="ConCert.Execution.Serializable.html#serialize"><span class="id" title="method">serialize</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#setup"><span class="id" title="variable">setup</span></a>).<br/>

<br/>
<span class="comment">(*&nbsp;The&nbsp;contract&nbsp;interface&nbsp;is&nbsp;the&nbsp;main&nbsp;mechanism&nbsp;allowing&nbsp;a&nbsp;deployed<br/>
contract&nbsp;to&nbsp;interact&nbsp;with&nbsp;another&nbsp;deployed&nbsp;contract.&nbsp;This&nbsp;hides<br/>
the&nbsp;ugly&nbsp;details&nbsp;of&nbsp;everything&nbsp;being&nbsp;SerializedValue&nbsp;away&nbsp;from&nbsp;contracts.&nbsp;*)</span><br/>
<span class="id" title="keyword">Record</span> <a name="ContractInterface"><span class="id" title="record">ContractInterface</span></a> {<span class="id" title="var">Msg</span> : <span class="id" title="keyword">Type</span>} :=<br/>
&nbsp;&nbsp;<a name="build_contract_interface"><span class="id" title="constructor">build_contract_interface</span></a> {<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;The&nbsp;address&nbsp;of&nbsp;the&nbsp;contract&nbsp;being&nbsp;interfaced&nbsp;with&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a name="contract_address"><span class="id" title="projection">contract_address</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#Address"><span class="id" title="method">Address</span></a>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;Make&nbsp;an&nbsp;action&nbsp;sending&nbsp;money&nbsp;and&nbsp;optionally&nbsp;a&nbsp;message&nbsp;to&nbsp;the&nbsp;contract&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a name="send"><span class="id" title="projection">send</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#Amount"><span class="id" title="definition">Amount</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#option"><span class="id" title="inductive">option</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#Msg"><span class="id" title="variable">Msg</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#ActionBody"><span class="id" title="inductive">ActionBody</span></a>;<br/>
&nbsp;&nbsp;}.<br/>

<br/>
<span class="id" title="keyword">Global</span> <span class="id" title="var">Arguments</span> <a class="idref" href="ConCert.Execution.Blockchain.html#ContractInterface"><span class="id" title="record">ContractInterface</span></a> <span class="id" title="var">_</span> : <span class="id" title="tactic">clear</span> <span class="id" title="var">implicits</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a name="get_contract_interface"><span class="id" title="definition">get_contract_interface</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">chain</span> : <a class="idref" href="ConCert.Execution.Blockchain.html#Chain"><span class="id" title="record">Chain</span></a>) (<span class="id" title="var">addr</span> : <a class="idref" href="ConCert.Execution.Blockchain.html#Address"><span class="id" title="method">Address</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">Msg</span> : <span class="id" title="keyword">Type</span>) `{<a class="idref" href="ConCert.Execution.Serializable.html#Serializable"><span class="id" title="class">Serializable</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#Msg"><span class="id" title="variable">Msg</span></a>}<br/>
&nbsp;&nbsp;: <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#option"><span class="id" title="inductive">option</span></a> (<a class="idref" href="ConCert.Execution.Blockchain.html#ContractInterface"><span class="id" title="record">ContractInterface</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#Msg"><span class="id" title="variable">Msg</span></a>) :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">ifc_send</span> <span class="id" title="var">amount</span> <span class="id" title="var">msg</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="ConCert.Execution.Blockchain.html#msg"><span class="id" title="variable">msg</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a> =&gt; <a class="idref" href="ConCert.Execution.Blockchain.html#act_transfer"><span class="id" title="constructor">act_transfer</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#addr"><span class="id" title="variable">addr</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#amount"><span class="id" title="variable">amount</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <span class="id" title="var">msg</span> =&gt; <a class="idref" href="ConCert.Execution.Blockchain.html#act_call"><span class="id" title="constructor">act_call</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#addr"><span class="id" title="variable">addr</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#amount"><span class="id" title="variable">amount</span></a> (<a class="idref" href="ConCert.Execution.Serializable.html#serialize"><span class="id" title="method">serialize</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#msg"><span class="id" title="variable">msg</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> {| <a class="idref" href="ConCert.Execution.Blockchain.html#build_contract_interface"><span class="id" title="constructor">contract_address</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#build_contract_interface"><span class="id" title="constructor">:=</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#build_contract_interface"><span class="id" title="constructor">addr</span></a><a class="idref" href="ConCert.Execution.Blockchain.html#build_contract_interface"><span class="id" title="constructor">;</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#build_contract_interface"><span class="id" title="constructor">send</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#build_contract_interface"><span class="id" title="constructor">:=</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#build_contract_interface"><span class="id" title="constructor">ifc_send</span></a><a class="idref" href="ConCert.Execution.Blockchain.html#build_contract_interface"><span class="id" title="constructor">;</span></a> |}.<br/>

<br/>
<span class="id" title="keyword">Section</span> <a name="Blockchain.Semantics"><span class="id" title="section">Semantics</span></a>.<br/>
<span class="id" title="var">MetaCoq</span> <span class="id" title="var">Run</span> (<a class="idref" href="ConCert.Utils.RecordSet.html#make_setters"><span class="id" title="definition">make_setters</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#Chain"><span class="id" title="record">Chain</span></a>).<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a name="add_balance"><span class="id" title="definition">add_balance</span></a> (<span class="id" title="var">addr</span> : <a class="idref" href="ConCert.Execution.Blockchain.html#Address"><span class="id" title="method">Address</span></a>) (<span class="id" title="var">amount</span> : <a class="idref" href="ConCert.Execution.Blockchain.html#Amount"><span class="id" title="definition">Amount</span></a>) (<span class="id" title="var">map</span> : <a class="idref" href="ConCert.Execution.Blockchain.html#Address"><span class="id" title="method">Address</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#Amount"><span class="id" title="definition">Amount</span></a>) :<br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#Address"><span class="id" title="method">Address</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#Amount"><span class="id" title="definition">Amount</span></a> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">fun</span> <span class="id" title="var">a</span> =&gt; <span class="id" title="keyword">if</span> (<a class="idref" href="ConCert.Execution.Blockchain.html#a"><span class="id" title="variable">a</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#6f617e0e5500b437e5aeb1eaa876d41f"><span class="id" title="notation">=?</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#addr"><span class="id" title="variable">addr</span></a>)%<span class="id" title="var">address</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">then</span> (<a class="idref" href="ConCert.Execution.Blockchain.html#amount"><span class="id" title="variable">amount</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.ZArith.BinInt.html#46584eddd5fdb16176a10a2843177d3a"><span class="id" title="notation">+</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#map"><span class="id" title="variable">map</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#a"><span class="id" title="variable">a</span></a>)%<span class="id" title="var">Z</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">else</span> <a class="idref" href="ConCert.Execution.Blockchain.html#map"><span class="id" title="variable">map</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#a"><span class="id" title="variable">a</span></a>.<br/>

<br/>
<span class="id" title="keyword">Global</span> <span class="id" title="var">Arguments</span> <a class="idref" href="ConCert.Execution.Blockchain.html#add_balance"><span class="id" title="definition">add_balance</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> /.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a name="set_chain_contract_state"><span class="id" title="definition">set_chain_contract_state</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">addr</span> : <a class="idref" href="ConCert.Execution.Blockchain.html#Address"><span class="id" title="method">Address</span></a>) (<span class="id" title="var">state</span> : <a class="idref" href="ConCert.Execution.Serializable.html#SerializedValue"><span class="id" title="record">SerializedValue</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">map</span> : <a class="idref" href="ConCert.Execution.Blockchain.html#Address"><span class="id" title="method">Address</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#option"><span class="id" title="inductive">option</span></a> <a class="idref" href="ConCert.Execution.Serializable.html#SerializedValue"><span class="id" title="record">SerializedValue</span></a>)<br/>
&nbsp;&nbsp;: <a class="idref" href="ConCert.Execution.Blockchain.html#Address"><span class="id" title="method">Address</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#option"><span class="id" title="inductive">option</span></a> <a class="idref" href="ConCert.Execution.Serializable.html#SerializedValue"><span class="id" title="record">SerializedValue</span></a> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">fun</span> <span class="id" title="var">a</span> =&gt; <span class="id" title="keyword">if</span> (<a class="idref" href="ConCert.Execution.Blockchain.html#a"><span class="id" title="variable">a</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#6f617e0e5500b437e5aeb1eaa876d41f"><span class="id" title="notation">=?</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#addr"><span class="id" title="variable">addr</span></a>)%<span class="id" title="var">address</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">then</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#state"><span class="id" title="variable">state</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">else</span> <a class="idref" href="ConCert.Execution.Blockchain.html#map"><span class="id" title="variable">map</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#a"><span class="id" title="variable">a</span></a>.<br/>

<br/>
<span class="id" title="keyword">Record</span> <a name="Environment"><span class="id" title="record">Environment</span></a> :=<br/>
&nbsp;&nbsp;<a name="build_env"><span class="id" title="constructor">build_env</span></a> {<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a name="env_chain"><span class="id" title="projection">env_chain</span></a> :&gt; <a class="idref" href="ConCert.Execution.Blockchain.html#Chain"><span class="id" title="record">Chain</span></a>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a name="env_account_balances"><span class="id" title="projection">env_account_balances</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#Address"><span class="id" title="method">Address</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#Amount"><span class="id" title="definition">Amount</span></a>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a name="env_contracts"><span class="id" title="projection">env_contracts</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#Address"><span class="id" title="method">Address</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#option"><span class="id" title="inductive">option</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#WeakContract"><span class="id" title="inductive">WeakContract</span></a>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a name="env_contract_states"><span class="id" title="projection">env_contract_states</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#Address"><span class="id" title="method">Address</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#option"><span class="id" title="inductive">option</span></a> <a class="idref" href="ConCert.Execution.Serializable.html#SerializedValue"><span class="id" title="record">SerializedValue</span></a>;<br/>
&nbsp;&nbsp;}.<br/>

<br/>
<span class="comment">(*&nbsp;Two&nbsp;environments&nbsp;are&nbsp;equivalent&nbsp;if&nbsp;they&nbsp;are&nbsp;extensionally&nbsp;equal&nbsp;*)</span><br/>
<span class="id" title="keyword">Record</span> <a name="EnvironmentEquiv"><span class="id" title="record">EnvironmentEquiv</span></a> (<span class="id" title="var">e1</span> <span class="id" title="var">e2</span> : <a class="idref" href="ConCert.Execution.Blockchain.html#Environment"><span class="id" title="record">Environment</span></a>) : <span class="id" title="keyword">Prop</span> :=<br/>
&nbsp;&nbsp;<a name="build_env_equiv"><span class="id" title="constructor">build_env_equiv</span></a> {<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a name="chain_eq"><span class="id" title="projection">chain_eq</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#env_chain"><span class="id" title="projection">env_chain</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#e1"><span class="id" title="variable">e1</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#env_chain"><span class="id" title="projection">env_chain</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#e2"><span class="id" title="variable">e2</span></a>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a name="account_balances_eq"><span class="id" title="projection">account_balances_eq</span></a> : <span class="id" title="keyword">forall</span> <span class="id" title="var">a</span>, <a class="idref" href="ConCert.Execution.Blockchain.html#env_account_balances"><span class="id" title="projection">env_account_balances</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#e1"><span class="id" title="variable">e1</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#a"><span class="id" title="variable">a</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#env_account_balances"><span class="id" title="projection">env_account_balances</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#e2"><span class="id" title="variable">e2</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#a"><span class="id" title="variable">a</span></a>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a name="contracts_eq"><span class="id" title="projection">contracts_eq</span></a> : <span class="id" title="keyword">forall</span> <span class="id" title="var">a</span>, <a class="idref" href="ConCert.Execution.Blockchain.html#env_contracts"><span class="id" title="projection">env_contracts</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#e1"><span class="id" title="variable">e1</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#a"><span class="id" title="variable">a</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#env_contracts"><span class="id" title="projection">env_contracts</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#e2"><span class="id" title="variable">e2</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#a"><span class="id" title="variable">a</span></a>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a name="contract_states_eq"><span class="id" title="projection">contract_states_eq</span></a> : <span class="id" title="keyword">forall</span> <span class="id" title="var">addr</span>, <a class="idref" href="ConCert.Execution.Blockchain.html#env_contract_states"><span class="id" title="projection">env_contract_states</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#e1"><span class="id" title="variable">e1</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#addr"><span class="id" title="variable">addr</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#env_contract_states"><span class="id" title="projection">env_contract_states</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#e2"><span class="id" title="variable">e2</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#addr"><span class="id" title="variable">addr</span></a>;<br/>
&nbsp;&nbsp;}.<br/>

<br/>
<span class="comment">(*&nbsp;Strongly&nbsp;typed&nbsp;version&nbsp;of&nbsp;contract&nbsp;state&nbsp;*)</span><br/>
<span class="id" title="keyword">Definition</span> <a name="contract_state"><span class="id" title="definition">contract_state</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<span class="id" title="var">A</span> : <span class="id" title="keyword">Type</span>} `{<a class="idref" href="ConCert.Execution.Serializable.html#Serializable"><span class="id" title="class">Serializable</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#A"><span class="id" title="variable">A</span></a>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">env</span> : <a class="idref" href="ConCert.Execution.Blockchain.html#Environment"><span class="id" title="record">Environment</span></a>) (<span class="id" title="var">addr</span> : <a class="idref" href="ConCert.Execution.Blockchain.html#Address"><span class="id" title="method">Address</span></a>) : <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#option"><span class="id" title="inductive">option</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#A"><span class="id" title="variable">A</span></a> :=<br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#env_contract_states"><span class="id" title="projection">env_contract_states</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#env"><span class="id" title="variable">env</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#addr"><span class="id" title="variable">addr</span></a> <a class="idref" href="ConCert.Execution.Monads.html#f1146025ce6377896c1a30f88a02c8cb"><span class="id" title="notation">&gt;&gt;=</span></a> <a class="idref" href="ConCert.Execution.Serializable.html#deserialize"><span class="id" title="method">deserialize</span></a>.<br/>

<br/>
<span class="id" title="keyword">Global</span> <span class="id" title="var">Program</span> <span class="id" title="keyword">Instance</span> <a name="environment_equiv_equivalence"><span class="id" title="instance">environment_equiv_equivalence</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Classes.RelationClasses.html#Equivalence"><span class="id" title="class">Equivalence</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#EnvironmentEquiv"><span class="id" title="record">EnvironmentEquiv</span></a>.<br/>
<span class="id" title="keyword">Next</span> <span class="id" title="keyword">Obligation</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="ConCert.Execution.Blockchain.html#build_env_equiv"><span class="id" title="constructor">build_env_equiv</span></a>; <span class="id" title="tactic">reflexivity</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>
<span class="id" title="keyword">Next</span> <span class="id" title="keyword">Obligation</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">H</span>; <span class="id" title="tactic">apply</span> <a class="idref" href="ConCert.Execution.Blockchain.html#build_env_equiv"><span class="id" title="constructor">build_env_equiv</span></a>; <span class="id" title="var">now</span> <span class="id" title="tactic">symmetry</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>
<span class="id" title="keyword">Next</span> <span class="id" title="keyword">Obligation</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">H</span>, <span class="id" title="var">H0</span>; <span class="id" title="tactic">apply</span> <a class="idref" href="ConCert.Execution.Blockchain.html#build_env_equiv"><span class="id" title="constructor">build_env_equiv</span></a>; <span class="id" title="tactic">try</span> <span class="id" title="tactic">congruence</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Global Instance</span> <a name="environment_equiv_env_account_balances_proper"><span class="id" title="instance">environment_equiv_env_account_balances_proper</span></a> :<br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Classes.Morphisms.html#Proper"><span class="id" title="class">Proper</span></a> (<a class="idref" href="ConCert.Execution.Blockchain.html#EnvironmentEquiv"><span class="id" title="record">EnvironmentEquiv</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Classes.Morphisms.html#8dc5652698a6e16f72dd37bd17d3b973"><span class="id" title="notation">==&gt;</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#eq"><span class="id" title="inductive">eq</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Classes.Morphisms.html#8dc5652698a6e16f72dd37bd17d3b973"><span class="id" title="notation">==&gt;</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#eq"><span class="id" title="inductive">eq</span></a>) <a class="idref" href="ConCert.Execution.Blockchain.html#env_account_balances"><span class="id" title="projection">env_account_balances</span></a>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">repeat</span> <span class="id" title="tactic">intro</span>; <span class="id" title="tactic">subst</span>; <span class="id" title="tactic">apply</span> <a class="idref" href="ConCert.Execution.Blockchain.html#account_balances_eq"><span class="id" title="projection">account_balances_eq</span></a>; <span class="id" title="tactic">assumption</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Global Instance</span> <a name="environment_equiv_env_contracts_proper"><span class="id" title="instance">environment_equiv_env_contracts_proper</span></a> :<br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Classes.Morphisms.html#Proper"><span class="id" title="class">Proper</span></a> (<a class="idref" href="ConCert.Execution.Blockchain.html#EnvironmentEquiv"><span class="id" title="record">EnvironmentEquiv</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Classes.Morphisms.html#8dc5652698a6e16f72dd37bd17d3b973"><span class="id" title="notation">==&gt;</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#eq"><span class="id" title="inductive">eq</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Classes.Morphisms.html#8dc5652698a6e16f72dd37bd17d3b973"><span class="id" title="notation">==&gt;</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#eq"><span class="id" title="inductive">eq</span></a>) <a class="idref" href="ConCert.Execution.Blockchain.html#env_contracts"><span class="id" title="projection">env_contracts</span></a>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">repeat</span> <span class="id" title="tactic">intro</span>; <span class="id" title="tactic">subst</span>; <span class="id" title="tactic">apply</span> <a class="idref" href="ConCert.Execution.Blockchain.html#contracts_eq"><span class="id" title="projection">contracts_eq</span></a>; <span class="id" title="tactic">assumption</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Global Instance</span> <a name="environment_equiv_env_contract_states_proper"><span class="id" title="instance">environment_equiv_env_contract_states_proper</span></a> :<br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Classes.Morphisms.html#Proper"><span class="id" title="class">Proper</span></a> (<a class="idref" href="ConCert.Execution.Blockchain.html#EnvironmentEquiv"><span class="id" title="record">EnvironmentEquiv</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Classes.Morphisms.html#8dc5652698a6e16f72dd37bd17d3b973"><span class="id" title="notation">==&gt;</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#eq"><span class="id" title="inductive">eq</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Classes.Morphisms.html#8dc5652698a6e16f72dd37bd17d3b973"><span class="id" title="notation">==&gt;</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#eq"><span class="id" title="inductive">eq</span></a>) <a class="idref" href="ConCert.Execution.Blockchain.html#env_contract_states"><span class="id" title="projection">env_contract_states</span></a>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">repeat</span> <span class="id" title="tactic">intro</span>; <span class="id" title="tactic">subst</span>; <span class="id" title="tactic">apply</span> <a class="idref" href="ConCert.Execution.Blockchain.html#contract_states_eq"><span class="id" title="projection">contract_states_eq</span></a>; <span class="id" title="tactic">assumption</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Global Instance</span> <a name="environment_equiv_env_chain_equiv_proper"><span class="id" title="instance">environment_equiv_env_chain_equiv_proper</span></a> :<br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Classes.Morphisms.html#Proper"><span class="id" title="class">Proper</span></a> (<a class="idref" href="ConCert.Execution.Blockchain.html#EnvironmentEquiv"><span class="id" title="record">EnvironmentEquiv</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Classes.Morphisms.html#8dc5652698a6e16f72dd37bd17d3b973"><span class="id" title="notation">==&gt;</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#eq"><span class="id" title="inductive">eq</span></a>) <a class="idref" href="ConCert.Execution.Blockchain.html#env_chain"><span class="id" title="projection">env_chain</span></a>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">repeat</span> <span class="id" title="tactic">intro</span>; <span class="id" title="tactic">apply</span> <a class="idref" href="ConCert.Execution.Blockchain.html#chain_eq"><span class="id" title="projection">chain_eq</span></a>; <span class="id" title="tactic">assumption</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Global Instance</span> <a name="environment_equiv_contract_state_proper"><span class="id" title="instance">environment_equiv_contract_state_proper</span></a><br/>
&nbsp;&nbsp;{<span class="id" title="var">A</span> : <span class="id" title="keyword">Type</span>} `{<a class="idref" href="ConCert.Execution.Serializable.html#Serializable"><span class="id" title="class">Serializable</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#A"><span class="id" title="variable">A</span></a>} :<br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Classes.Morphisms.html#Proper"><span class="id" title="class">Proper</span></a> (<a class="idref" href="ConCert.Execution.Blockchain.html#EnvironmentEquiv"><span class="id" title="record">EnvironmentEquiv</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Classes.Morphisms.html#8dc5652698a6e16f72dd37bd17d3b973"><span class="id" title="notation">==&gt;</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#eq"><span class="id" title="inductive">eq</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Classes.Morphisms.html#8dc5652698a6e16f72dd37bd17d3b973"><span class="id" title="notation">==&gt;</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Classes.Morphisms.html#8dc5652698a6e16f72dd37bd17d3b973"><span class="id" title="notation">(</span></a>@<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#eq"><span class="id" title="inductive">eq</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#option"><span class="id" title="inductive">option</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#A"><span class="id" title="variable">A</span></a>)<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Classes.Morphisms.html#8dc5652698a6e16f72dd37bd17d3b973"><span class="id" title="notation">)</span></a>) <a class="idref" href="ConCert.Execution.Blockchain.html#contract_state"><span class="id" title="definition">contract_state</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> ? ? <span class="id" title="var">env_eq</span> ? ? ?.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">subst</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="ConCert.Execution.Blockchain.html#contract_state"><span class="id" title="definition">contract_state</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="var">env_eq</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="var">MetaCoq</span> <span class="id" title="var">Run</span> (<a class="idref" href="ConCert.Utils.RecordSet.html#make_setters"><span class="id" title="definition">make_setters</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#Environment"><span class="id" title="record">Environment</span></a>).<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a name="transfer_balance"><span class="id" title="definition">transfer_balance</span></a> (<span class="id" title="var">from</span> <span class="id" title="var">to</span> : <a class="idref" href="ConCert.Execution.Blockchain.html#Address"><span class="id" title="method">Address</span></a>) (<span class="id" title="var">amount</span> : <a class="idref" href="ConCert.Execution.Blockchain.html#Amount"><span class="id" title="definition">Amount</span></a>) (<span class="id" title="var">env</span> : <a class="idref" href="ConCert.Execution.Blockchain.html#Environment"><span class="id" title="record">Environment</span></a>) :=<br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#env"><span class="id" title="variable">env</span></a><a class="idref" href="ConCert.Utils.RecordSet.html#394068d0cf93ac4dd96dfc7ba41b06b2"><span class="id" title="notation">&lt;|</span></a><a class="idref" href="ConCert.Execution.Blockchain.html#env_account_balances"><span class="id" title="projection">env_account_balances</span></a> <a class="idref" href="ConCert.Utils.RecordSet.html#394068d0cf93ac4dd96dfc7ba41b06b2"><span class="id" title="notation">::=</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#add_balance"><span class="id" title="definition">add_balance</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#to"><span class="id" title="variable">to</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#amount"><span class="id" title="variable">amount</span></a><a class="idref" href="ConCert.Utils.RecordSet.html#394068d0cf93ac4dd96dfc7ba41b06b2"><span class="id" title="notation">|&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Utils.RecordSet.html#394068d0cf93ac4dd96dfc7ba41b06b2"><span class="id" title="notation">&lt;|</span></a><a class="idref" href="ConCert.Execution.Blockchain.html#env_account_balances"><span class="id" title="projection">env_account_balances</span></a> <a class="idref" href="ConCert.Utils.RecordSet.html#394068d0cf93ac4dd96dfc7ba41b06b2"><span class="id" title="notation">::=</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#add_balance"><span class="id" title="definition">add_balance</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#from"><span class="id" title="variable">from</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.ZArith.BinInt.html#84c6e304dcb36f79add2a7dcc558eca1"><span class="id" title="notation">-</span></a><a class="idref" href="ConCert.Execution.Blockchain.html#amount"><span class="id" title="variable">amount</span></a>)<a class="idref" href="ConCert.Utils.RecordSet.html#394068d0cf93ac4dd96dfc7ba41b06b2"><span class="id" title="notation">|&gt;</span></a>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a name="add_contract"><span class="id" title="definition">add_contract</span></a> (<span class="id" title="var">addr</span> : <a class="idref" href="ConCert.Execution.Blockchain.html#Address"><span class="id" title="method">Address</span></a>) (<span class="id" title="var">contract</span> : <a class="idref" href="ConCert.Execution.Blockchain.html#WeakContract"><span class="id" title="inductive">WeakContract</span></a>) (<span class="id" title="var">env</span> : <a class="idref" href="ConCert.Execution.Blockchain.html#Environment"><span class="id" title="record">Environment</span></a>)<br/>
&nbsp;&nbsp;: <a class="idref" href="ConCert.Execution.Blockchain.html#Environment"><span class="id" title="record">Environment</span></a> :=<br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#env"><span class="id" title="variable">env</span></a><a class="idref" href="ConCert.Utils.RecordSet.html#394068d0cf93ac4dd96dfc7ba41b06b2"><span class="id" title="notation">&lt;|</span></a><a class="idref" href="ConCert.Execution.Blockchain.html#env_contracts"><span class="id" title="projection">env_contracts</span></a> <a class="idref" href="ConCert.Utils.RecordSet.html#394068d0cf93ac4dd96dfc7ba41b06b2"><span class="id" title="notation">::=</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">fun</span> <span class="id" title="var">f</span> <span class="id" title="var">a</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">if</span> (<a class="idref" href="ConCert.Execution.Blockchain.html#a"><span class="id" title="variable">a</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#6f617e0e5500b437e5aeb1eaa876d41f"><span class="id" title="notation">=?</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#addr"><span class="id" title="variable">addr</span></a>)%<span class="id" title="var">address</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">then</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#contract"><span class="id" title="variable">contract</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">else</span> <a class="idref" href="ConCert.Execution.Blockchain.html#f"><span class="id" title="variable">f</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#a"><span class="id" title="variable">a</span></a><a class="idref" href="ConCert.Utils.RecordSet.html#394068d0cf93ac4dd96dfc7ba41b06b2"><span class="id" title="notation">|&gt;</span></a>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a name="set_contract_state"><span class="id" title="definition">set_contract_state</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">addr</span> : <a class="idref" href="ConCert.Execution.Blockchain.html#Address"><span class="id" title="method">Address</span></a>) (<span class="id" title="var">state</span> : <a class="idref" href="ConCert.Execution.Serializable.html#SerializedValue"><span class="id" title="record">SerializedValue</span></a>) (<span class="id" title="var">env</span> : <a class="idref" href="ConCert.Execution.Blockchain.html#Environment"><span class="id" title="record">Environment</span></a>) :=<br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#env"><span class="id" title="variable">env</span></a><a class="idref" href="ConCert.Utils.RecordSet.html#394068d0cf93ac4dd96dfc7ba41b06b2"><span class="id" title="notation">&lt;|</span></a><a class="idref" href="ConCert.Execution.Blockchain.html#env_contract_states"><span class="id" title="projection">env_contract_states</span></a> <a class="idref" href="ConCert.Utils.RecordSet.html#394068d0cf93ac4dd96dfc7ba41b06b2"><span class="id" title="notation">::=</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#set_chain_contract_state"><span class="id" title="definition">set_chain_contract_state</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#addr"><span class="id" title="variable">addr</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#state"><span class="id" title="variable">state</span></a><a class="idref" href="ConCert.Utils.RecordSet.html#394068d0cf93ac4dd96dfc7ba41b06b2"><span class="id" title="notation">|&gt;</span></a>.<br/>

<br/>
<span class="comment">(*&nbsp;set_chain_contract_state&nbsp;updates&nbsp;a&nbsp;map&nbsp;(function)&nbsp;by&nbsp;returning&nbsp;a<br/>
&nbsp;&nbsp;&nbsp;new&nbsp;map&nbsp;(function).&nbsp;&nbsp;If&nbsp;this&nbsp;function&nbsp;is&nbsp;immediately&nbsp;applied&nbsp;to&nbsp;a<br/>
&nbsp;&nbsp;&nbsp;key,&nbsp;then&nbsp;unfold&nbsp;it.&nbsp;*)</span><br/>
<span class="id" title="keyword">Global</span> <span class="id" title="var">Arguments</span> <a class="idref" href="ConCert.Execution.Blockchain.html#set_chain_contract_state"><span class="id" title="definition">set_chain_contract_state</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> /.<br/>

<br/>
<span class="id" title="keyword">Ltac</span> <span class="id" title="var">rewrite_environment_equiv</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| [<span class="id" title="var">H</span>: <a class="idref" href="ConCert.Execution.Blockchain.html#EnvironmentEquiv"><span class="id" title="record">EnvironmentEquiv</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> |- <span class="id" title="var">_</span>] =&gt; <span class="id" title="tactic">try</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="var">H</span> <span class="id" title="tactic">in</span> *<br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Ltac</span> <span class="id" title="var">solve_proper</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="ConCert.Execution.Blockchain.html#build_env_equiv"><span class="id" title="constructor">build_env_equiv</span></a>;<br/>
&nbsp;&nbsp;<span class="id" title="var">cbn</span>;<br/>
&nbsp;&nbsp;<span class="id" title="tactic">repeat</span> <span class="id" title="tactic">intro</span>;<br/>
&nbsp;&nbsp;<span class="id" title="tactic">repeat</span> <span class="id" title="var">rewrite_environment_equiv</span>;<br/>
&nbsp;&nbsp;<span class="id" title="tactic">auto</span>.<br/>

<br/>
<span class="id" title="keyword">Global Instance</span> <a name="transfer_balance_proper"><span class="id" title="instance">transfer_balance_proper</span></a> :<br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Classes.Morphisms.html#Proper"><span class="id" title="class">Proper</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#eq"><span class="id" title="inductive">eq</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Classes.Morphisms.html#8dc5652698a6e16f72dd37bd17d3b973"><span class="id" title="notation">==&gt;</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#eq"><span class="id" title="inductive">eq</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Classes.Morphisms.html#8dc5652698a6e16f72dd37bd17d3b973"><span class="id" title="notation">==&gt;</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#eq"><span class="id" title="inductive">eq</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Classes.Morphisms.html#8dc5652698a6e16f72dd37bd17d3b973"><span class="id" title="notation">==&gt;</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#EnvironmentEquiv"><span class="id" title="record">EnvironmentEquiv</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Classes.Morphisms.html#8dc5652698a6e16f72dd37bd17d3b973"><span class="id" title="notation">==&gt;</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#EnvironmentEquiv"><span class="id" title="record">EnvironmentEquiv</span></a>) <a class="idref" href="ConCert.Execution.Blockchain.html#transfer_balance"><span class="id" title="definition">transfer_balance</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">repeat</span> <span class="id" title="tactic">intro</span>; <span class="id" title="tactic">subst</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="ConCert.Execution.Blockchain.html#transfer_balance"><span class="id" title="definition">transfer_balance</span></a>, <a class="idref" href="ConCert.Execution.Blockchain.html#add_balance"><span class="id" title="definition">add_balance</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="var">solve_proper</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Global Instance</span> <a name="add_contract_proper"><span class="id" title="instance">add_contract_proper</span></a> :<br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Classes.Morphisms.html#Proper"><span class="id" title="class">Proper</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#eq"><span class="id" title="inductive">eq</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Classes.Morphisms.html#8dc5652698a6e16f72dd37bd17d3b973"><span class="id" title="notation">==&gt;</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#eq"><span class="id" title="inductive">eq</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Classes.Morphisms.html#8dc5652698a6e16f72dd37bd17d3b973"><span class="id" title="notation">==&gt;</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#EnvironmentEquiv"><span class="id" title="record">EnvironmentEquiv</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Classes.Morphisms.html#8dc5652698a6e16f72dd37bd17d3b973"><span class="id" title="notation">==&gt;</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#EnvironmentEquiv"><span class="id" title="record">EnvironmentEquiv</span></a>) <a class="idref" href="ConCert.Execution.Blockchain.html#add_contract"><span class="id" title="definition">add_contract</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">repeat</span> <span class="id" title="tactic">intro</span>; <span class="id" title="tactic">subst</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="ConCert.Execution.Blockchain.html#add_contract"><span class="id" title="definition">add_contract</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="var">solve_proper</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Global Instance</span> <a name="set_contract_state_proper"><span class="id" title="instance">set_contract_state_proper</span></a> :<br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Classes.Morphisms.html#Proper"><span class="id" title="class">Proper</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#eq"><span class="id" title="inductive">eq</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Classes.Morphisms.html#8dc5652698a6e16f72dd37bd17d3b973"><span class="id" title="notation">==&gt;</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#eq"><span class="id" title="inductive">eq</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Classes.Morphisms.html#8dc5652698a6e16f72dd37bd17d3b973"><span class="id" title="notation">==&gt;</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#EnvironmentEquiv"><span class="id" title="record">EnvironmentEquiv</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Classes.Morphisms.html#8dc5652698a6e16f72dd37bd17d3b973"><span class="id" title="notation">==&gt;</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#EnvironmentEquiv"><span class="id" title="record">EnvironmentEquiv</span></a>) <a class="idref" href="ConCert.Execution.Blockchain.html#set_contract_state"><span class="id" title="definition">set_contract_state</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">repeat</span> <span class="id" title="tactic">intro</span>; <span class="id" title="tactic">subst</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="ConCert.Execution.Blockchain.html#set_contract_state"><span class="id" title="definition">set_contract_state</span></a>, <a class="idref" href="ConCert.Execution.Blockchain.html#set_chain_contract_state"><span class="id" title="definition">set_chain_contract_state</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="var">solve_proper</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Local Open</span> <span class="id" title="keyword">Scope</span> <span class="id" title="var">Z</span>.<br/>
<span class="comment">(*&nbsp;Next&nbsp;we&nbsp;define&nbsp;how&nbsp;actions&nbsp;are&nbsp;executed.&nbsp;It&nbsp;specifies&nbsp;how&nbsp;an&nbsp;action<br/>
changes&nbsp;an&nbsp;environment&nbsp;and&nbsp;which&nbsp;external&nbsp;actions&nbsp;to&nbsp;execute&nbsp;after&nbsp;it.<br/>
Note&nbsp;that&nbsp;there&nbsp;can&nbsp;be&nbsp;multiple&nbsp;ways&nbsp;to&nbsp;execute&nbsp;an&nbsp;action.&nbsp;For&nbsp;example,&nbsp;if<br/>
the&nbsp;action&nbsp;says&nbsp;to&nbsp;deploy&nbsp;a&nbsp;contract,&nbsp;the&nbsp;implementation&nbsp;is&nbsp;responsible&nbsp;for<br/>
selecting&nbsp;which&nbsp;address&nbsp;the&nbsp;new&nbsp;contract&nbsp;should&nbsp;get.&nbsp;*)</span><br/>
<span class="id" title="keyword">Inductive</span> <a name="ActionEvaluation"><span class="id" title="inductive">ActionEvaluation</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">prev_env</span> : <a class="idref" href="ConCert.Execution.Blockchain.html#Environment"><span class="id" title="record">Environment</span></a>) (<span class="id" title="var">act</span> : <a class="idref" href="ConCert.Execution.Blockchain.html#Action"><span class="id" title="record">Action</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">new_env</span> : <a class="idref" href="ConCert.Execution.Blockchain.html#Environment"><span class="id" title="record">Environment</span></a>) (<span class="id" title="var">new_acts</span> : <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#list"><span class="id" title="inductive">list</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#Action"><span class="id" title="record">Action</span></a>) : <span class="id" title="keyword">Type</span> :=<br/>
&nbsp;&nbsp;| <a name="eval_transfer"><span class="id" title="constructor">eval_transfer</span></a> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">forall</span> (<span class="id" title="var">origin</span> <span class="id" title="var">from_addr</span> <span class="id" title="var">to_addr</span> : <a class="idref" href="ConCert.Execution.Blockchain.html#Address"><span class="id" title="method">Address</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">amount</span> : <a class="idref" href="ConCert.Execution.Blockchain.html#Amount"><span class="id" title="definition">Amount</span></a>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#amount"><span class="id" title="variable">amount</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.ZArith.BinInt.html#b1f0780291abe9bd18804d2c9a5039d4"><span class="id" title="notation">&gt;=</span></a> 0 <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#amount"><span class="id" title="variable">amount</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.ZArith.BinInt.html#306329b0eca7a2b86c198702f594ad8e"><span class="id" title="notation">&lt;=</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#env_account_balances"><span class="id" title="projection">env_account_balances</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#prev_env"><span class="id" title="variable">prev_env</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#from_addr"><span class="id" title="variable">from_addr</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#address_is_contract"><span class="id" title="method">address_is_contract</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#to_addr"><span class="id" title="variable">to_addr</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#false"><span class="id" title="constructor">false</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#act"><span class="id" title="variable">act</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#build_act"><span class="id" title="constructor">build_act</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#origin"><span class="id" title="variable">origin</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#from_addr"><span class="id" title="variable">from_addr</span></a> (<a class="idref" href="ConCert.Execution.Blockchain.html#act_transfer"><span class="id" title="constructor">act_transfer</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#to_addr"><span class="id" title="variable">to_addr</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#amount"><span class="id" title="variable">amount</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#EnvironmentEquiv"><span class="id" title="record">EnvironmentEquiv</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#new_env"><span class="id" title="variable">new_env</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="ConCert.Execution.Blockchain.html#transfer_balance"><span class="id" title="definition">transfer_balance</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#from_addr"><span class="id" title="variable">from_addr</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#to_addr"><span class="id" title="variable">to_addr</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#amount"><span class="id" title="variable">amount</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#prev_env"><span class="id" title="variable">prev_env</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#new_acts"><span class="id" title="variable">new_acts</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#ae9a5e1034e143b218b09d8e454472bd"><span class="id" title="notation">[]</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#ActionEvaluation"><span class="id" title="inductive">ActionEvaluation</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#prev_env"><span class="id" title="variable">prev_env</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#act"><span class="id" title="variable">act</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#new_env"><span class="id" title="variable">new_env</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#new_acts"><span class="id" title="variable">new_acts</span></a><br/>
&nbsp;&nbsp;| <a name="eval_deploy"><span class="id" title="constructor">eval_deploy</span></a> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">forall</span> (<span class="id" title="var">origin</span> <span class="id" title="var">from_addr</span> <span class="id" title="var">to_addr</span> : <a class="idref" href="ConCert.Execution.Blockchain.html#Address"><span class="id" title="method">Address</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">amount</span> : <a class="idref" href="ConCert.Execution.Blockchain.html#Amount"><span class="id" title="definition">Amount</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">wc</span> : <a class="idref" href="ConCert.Execution.Blockchain.html#WeakContract"><span class="id" title="inductive">WeakContract</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">setup</span> : <a class="idref" href="ConCert.Execution.Serializable.html#SerializedValue"><span class="id" title="record">SerializedValue</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">state</span> : <a class="idref" href="ConCert.Execution.Serializable.html#SerializedValue"><span class="id" title="record">SerializedValue</span></a>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#amount"><span class="id" title="variable">amount</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.ZArith.BinInt.html#b1f0780291abe9bd18804d2c9a5039d4"><span class="id" title="notation">&gt;=</span></a> 0 <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#amount"><span class="id" title="variable">amount</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.ZArith.BinInt.html#306329b0eca7a2b86c198702f594ad8e"><span class="id" title="notation">&lt;=</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#env_account_balances"><span class="id" title="projection">env_account_balances</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#prev_env"><span class="id" title="variable">prev_env</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#from_addr"><span class="id" title="variable">from_addr</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#address_is_contract"><span class="id" title="method">address_is_contract</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#to_addr"><span class="id" title="variable">to_addr</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#true"><span class="id" title="constructor">true</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#env_contracts"><span class="id" title="projection">env_contracts</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#prev_env"><span class="id" title="variable">prev_env</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#to_addr"><span class="id" title="variable">to_addr</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#act"><span class="id" title="variable">act</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#build_act"><span class="id" title="constructor">build_act</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#origin"><span class="id" title="variable">origin</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#from_addr"><span class="id" title="variable">from_addr</span></a> (<a class="idref" href="ConCert.Execution.Blockchain.html#act_deploy"><span class="id" title="constructor">act_deploy</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#amount"><span class="id" title="variable">amount</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#wc"><span class="id" title="variable">wc</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#setup"><span class="id" title="variable">setup</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#wc_init"><span class="id" title="definition">wc_init</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#wc"><span class="id" title="variable">wc</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="ConCert.Execution.Blockchain.html#transfer_balance"><span class="id" title="definition">transfer_balance</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#from_addr"><span class="id" title="variable">from_addr</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#to_addr"><span class="id" title="variable">to_addr</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#amount"><span class="id" title="variable">amount</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#prev_env"><span class="id" title="variable">prev_env</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="ConCert.Execution.Blockchain.html#build_ctx"><span class="id" title="constructor">build_ctx</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#origin"><span class="id" title="variable">origin</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#from_addr"><span class="id" title="variable">from_addr</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#to_addr"><span class="id" title="variable">to_addr</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#amount"><span class="id" title="variable">amount</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#amount"><span class="id" title="variable">amount</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#setup"><span class="id" title="variable">setup</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#state"><span class="id" title="variable">state</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#EnvironmentEquiv"><span class="id" title="record">EnvironmentEquiv</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#new_env"><span class="id" title="variable">new_env</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="ConCert.Execution.Blockchain.html#set_contract_state"><span class="id" title="definition">set_contract_state</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#to_addr"><span class="id" title="variable">to_addr</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#state"><span class="id" title="variable">state</span></a> (<a class="idref" href="ConCert.Execution.Blockchain.html#add_contract"><span class="id" title="definition">add_contract</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#to_addr"><span class="id" title="variable">to_addr</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#wc"><span class="id" title="variable">wc</span></a> (<a class="idref" href="ConCert.Execution.Blockchain.html#transfer_balance"><span class="id" title="definition">transfer_balance</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#from_addr"><span class="id" title="variable">from_addr</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#to_addr"><span class="id" title="variable">to_addr</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#amount"><span class="id" title="variable">amount</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#prev_env"><span class="id" title="variable">prev_env</span></a>))) <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#new_acts"><span class="id" title="variable">new_acts</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#ae9a5e1034e143b218b09d8e454472bd"><span class="id" title="notation">[]</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#ActionEvaluation"><span class="id" title="inductive">ActionEvaluation</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#prev_env"><span class="id" title="variable">prev_env</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#act"><span class="id" title="variable">act</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#new_env"><span class="id" title="variable">new_env</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#new_acts"><span class="id" title="variable">new_acts</span></a><br/>
&nbsp;&nbsp;| <a name="eval_call"><span class="id" title="constructor">eval_call</span></a> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">forall</span> (<span class="id" title="var">origin</span> <span class="id" title="var">from_addr</span> <span class="id" title="var">to_addr</span> : <a class="idref" href="ConCert.Execution.Blockchain.html#Address"><span class="id" title="method">Address</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">amount</span> : <a class="idref" href="ConCert.Execution.Blockchain.html#Amount"><span class="id" title="definition">Amount</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">wc</span> : <a class="idref" href="ConCert.Execution.Blockchain.html#WeakContract"><span class="id" title="inductive">WeakContract</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">msg</span> : <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#option"><span class="id" title="inductive">option</span></a> <a class="idref" href="ConCert.Execution.Serializable.html#SerializedValue"><span class="id" title="record">SerializedValue</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">prev_state</span> : <a class="idref" href="ConCert.Execution.Serializable.html#SerializedValue"><span class="id" title="record">SerializedValue</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">new_state</span> : <a class="idref" href="ConCert.Execution.Serializable.html#SerializedValue"><span class="id" title="record">SerializedValue</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">resp_acts</span> : <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#list"><span class="id" title="inductive">list</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#ActionBody"><span class="id" title="inductive">ActionBody</span></a>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#amount"><span class="id" title="variable">amount</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.ZArith.BinInt.html#b1f0780291abe9bd18804d2c9a5039d4"><span class="id" title="notation">&gt;=</span></a> 0 <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#amount"><span class="id" title="variable">amount</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.ZArith.BinInt.html#306329b0eca7a2b86c198702f594ad8e"><span class="id" title="notation">&lt;=</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#env_account_balances"><span class="id" title="projection">env_account_balances</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#prev_env"><span class="id" title="variable">prev_env</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#from_addr"><span class="id" title="variable">from_addr</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#env_contracts"><span class="id" title="projection">env_contracts</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#prev_env"><span class="id" title="variable">prev_env</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#to_addr"><span class="id" title="variable">to_addr</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#wc"><span class="id" title="variable">wc</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#env_contract_states"><span class="id" title="projection">env_contract_states</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#prev_env"><span class="id" title="variable">prev_env</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#to_addr"><span class="id" title="variable">to_addr</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#prev_state"><span class="id" title="variable">prev_state</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#act"><span class="id" title="variable">act</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#build_act"><span class="id" title="constructor">build_act</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#origin"><span class="id" title="variable">origin</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#from_addr"><span class="id" title="variable">from_addr</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="keyword">match</span> <a class="idref" href="ConCert.Execution.Blockchain.html#msg"><span class="id" title="variable">msg</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a> =&gt; <a class="idref" href="ConCert.Execution.Blockchain.html#act_transfer"><span class="id" title="constructor">act_transfer</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#to_addr"><span class="id" title="variable">to_addr</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#amount"><span class="id" title="variable">amount</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <span class="id" title="var">msg</span> =&gt; <a class="idref" href="ConCert.Execution.Blockchain.html#act_call"><span class="id" title="constructor">act_call</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#to_addr"><span class="id" title="variable">to_addr</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#amount"><span class="id" title="variable">amount</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#msg"><span class="id" title="variable">msg</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>) <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#wc_receive"><span class="id" title="definition">wc_receive</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#wc"><span class="id" title="variable">wc</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="ConCert.Execution.Blockchain.html#transfer_balance"><span class="id" title="definition">transfer_balance</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#from_addr"><span class="id" title="variable">from_addr</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#to_addr"><span class="id" title="variable">to_addr</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#amount"><span class="id" title="variable">amount</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#prev_env"><span class="id" title="variable">prev_env</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="ConCert.Execution.Blockchain.html#build_ctx"><span class="id" title="constructor">build_ctx</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#origin"><span class="id" title="variable">origin</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#from_addr"><span class="id" title="variable">from_addr</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#to_addr"><span class="id" title="variable">to_addr</span></a> (<a class="idref" href="ConCert.Execution.Blockchain.html#env_account_balances"><span class="id" title="projection">env_account_balances</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#new_env"><span class="id" title="variable">new_env</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#to_addr"><span class="id" title="variable">to_addr</span></a>) <a class="idref" href="ConCert.Execution.Blockchain.html#amount"><span class="id" title="variable">amount</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#prev_state"><span class="id" title="variable">prev_state</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#msg"><span class="id" title="variable">msg</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Execution.Blockchain.html#new_state"><span class="id" title="variable">new_state</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#resp_acts"><span class="id" title="variable">resp_acts</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#new_acts"><span class="id" title="variable">new_acts</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#map"><span class="id" title="definition">map</span></a> (<a class="idref" href="ConCert.Execution.Blockchain.html#build_act"><span class="id" title="constructor">build_act</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#origin"><span class="id" title="variable">origin</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#to_addr"><span class="id" title="variable">to_addr</span></a>) <a class="idref" href="ConCert.Execution.Blockchain.html#resp_acts"><span class="id" title="variable">resp_acts</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#EnvironmentEquiv"><span class="id" title="record">EnvironmentEquiv</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#new_env"><span class="id" title="variable">new_env</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="ConCert.Execution.Blockchain.html#set_contract_state"><span class="id" title="definition">set_contract_state</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#to_addr"><span class="id" title="variable">to_addr</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#new_state"><span class="id" title="variable">new_state</span></a> (<a class="idref" href="ConCert.Execution.Blockchain.html#transfer_balance"><span class="id" title="definition">transfer_balance</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#from_addr"><span class="id" title="variable">from_addr</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#to_addr"><span class="id" title="variable">to_addr</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#amount"><span class="id" title="variable">amount</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#prev_env"><span class="id" title="variable">prev_env</span></a>)) <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#ActionEvaluation"><span class="id" title="inductive">ActionEvaluation</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#prev_env"><span class="id" title="variable">prev_env</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#act"><span class="id" title="variable">act</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#new_env"><span class="id" title="variable">new_env</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#new_acts"><span class="id" title="variable">new_acts</span></a>.<br/>

<br/>
<span class="id" title="keyword">Global</span> <span class="id" title="var">Arguments</span> <a class="idref" href="ConCert.Execution.Blockchain.html#eval_transfer"><span class="id" title="constructor">eval_transfer</span></a> {<span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> }.<br/>
<span class="id" title="keyword">Global</span> <span class="id" title="var">Arguments</span> <a class="idref" href="ConCert.Execution.Blockchain.html#eval_deploy"><span class="id" title="constructor">eval_deploy</span></a> {<span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> }.<br/>
<span class="id" title="keyword">Global</span> <span class="id" title="var">Arguments</span> <a class="idref" href="ConCert.Execution.Blockchain.html#eval_call"><span class="id" title="constructor">eval_call</span></a> {<span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>}.<br/>

<br/>
<span class="id" title="keyword">Section</span> <a name="Blockchain.Semantics.Accessors"><span class="id" title="section">Accessors</span></a>.<br/>
<span class="id" title="keyword">Context</span> {<span class="id" title="var">origin</span> : <a class="idref" href="ConCert.Execution.Blockchain.html#Address"><span class="id" title="method">Address</span></a>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<span class="id" title="var">pre</span> : <a class="idref" href="ConCert.Execution.Blockchain.html#Environment"><span class="id" title="record">Environment</span></a>} {<span class="id" title="var">act</span> : <a class="idref" href="ConCert.Execution.Blockchain.html#Action"><span class="id" title="record">Action</span></a>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<span class="id" title="var">post</span> : <a class="idref" href="ConCert.Execution.Blockchain.html#Environment"><span class="id" title="record">Environment</span></a>} {<span class="id" title="var">new_acts</span> : <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#list"><span class="id" title="inductive">list</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#Action"><span class="id" title="record">Action</span></a>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="tactic">eval</span> : <a class="idref" href="ConCert.Execution.Blockchain.html#ActionEvaluation"><span class="id" title="inductive">ActionEvaluation</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#pre"><span class="id" title="variable">pre</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#act"><span class="id" title="variable">act</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#post"><span class="id" title="variable">post</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#new_acts"><span class="id" title="variable">new_acts</span></a>).<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a name="eval_origin"><span class="id" title="definition">eval_origin</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#Address"><span class="id" title="method">Address</span></a> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="ConCert.Execution.Blockchain.html#Blockchain.Semantics.Accessors.eval"><span class="id" title="variable">eval</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| <a class="idref" href="ConCert.Execution.Blockchain.html#eval_transfer"><span class="id" title="constructor">eval_transfer</span></a> <span class="id" title="var">origin</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span><br/>
&nbsp;&nbsp;| <a class="idref" href="ConCert.Execution.Blockchain.html#eval_deploy"><span class="id" title="constructor">eval_deploy</span></a> <span class="id" title="var">origin</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span><br/>
&nbsp;&nbsp;| <a class="idref" href="ConCert.Execution.Blockchain.html#eval_call"><span class="id" title="constructor">eval_call</span></a> <span class="id" title="var">origin</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> =&gt; <span class="id" title="var">origin</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a name="eval_from"><span class="id" title="definition">eval_from</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#Address"><span class="id" title="method">Address</span></a> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="ConCert.Execution.Blockchain.html#Blockchain.Semantics.Accessors.eval"><span class="id" title="variable">eval</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| <a class="idref" href="ConCert.Execution.Blockchain.html#eval_transfer"><span class="id" title="constructor">eval_transfer</span></a> <span class="id" title="var">_</span> <span class="id" title="var">from</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span><br/>
&nbsp;&nbsp;| <a class="idref" href="ConCert.Execution.Blockchain.html#eval_deploy"><span class="id" title="constructor">eval_deploy</span></a> <span class="id" title="var">_</span> <span class="id" title="var">from</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span><br/>
&nbsp;&nbsp;| <a class="idref" href="ConCert.Execution.Blockchain.html#eval_call"><span class="id" title="constructor">eval_call</span></a> <span class="id" title="var">_</span> <span class="id" title="var">from</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> =&gt; <span class="id" title="var">from</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a name="eval_to"><span class="id" title="definition">eval_to</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#Address"><span class="id" title="method">Address</span></a> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="ConCert.Execution.Blockchain.html#Blockchain.Semantics.Accessors.eval"><span class="id" title="variable">eval</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| <a class="idref" href="ConCert.Execution.Blockchain.html#eval_transfer"><span class="id" title="constructor">eval_transfer</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">to</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span><br/>
&nbsp;&nbsp;| <a class="idref" href="ConCert.Execution.Blockchain.html#eval_deploy"><span class="id" title="constructor">eval_deploy</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">to</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span><br/>
&nbsp;&nbsp;| <a class="idref" href="ConCert.Execution.Blockchain.html#eval_call"><span class="id" title="constructor">eval_call</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">to</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> =&gt; <span class="id" title="var">to</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a name="eval_amount"><span class="id" title="definition">eval_amount</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#Amount"><span class="id" title="definition">Amount</span></a> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="ConCert.Execution.Blockchain.html#Blockchain.Semantics.Accessors.eval"><span class="id" title="variable">eval</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| <a class="idref" href="ConCert.Execution.Blockchain.html#eval_transfer"><span class="id" title="constructor">eval_transfer</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">amount</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span><br/>
&nbsp;&nbsp;| <a class="idref" href="ConCert.Execution.Blockchain.html#eval_deploy"><span class="id" title="constructor">eval_deploy</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">amount</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span><br/>
&nbsp;&nbsp;| <a class="idref" href="ConCert.Execution.Blockchain.html#eval_call"><span class="id" title="constructor">eval_call</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">amount</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> =&gt; <span class="id" title="var">amount</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>
<span class="id" title="keyword">End</span> <a class="idref" href="ConCert.Execution.Blockchain.html#Blockchain.Semantics.Accessors"><span class="id" title="section">Accessors</span></a>.<br/>

<br/>
<span class="id" title="keyword">Section</span> <a name="Blockchain.Semantics.Theories"><span class="id" title="section">Theories</span></a>.<br/>
<span class="id" title="keyword">Context</span> {<span class="id" title="var">origin</span> : <a class="idref" href="ConCert.Execution.Blockchain.html#Address"><span class="id" title="method">Address</span></a>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<span class="id" title="var">pre</span> : <a class="idref" href="ConCert.Execution.Blockchain.html#Environment"><span class="id" title="record">Environment</span></a>} {<span class="id" title="var">act</span> : <a class="idref" href="ConCert.Execution.Blockchain.html#Action"><span class="id" title="record">Action</span></a>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<span class="id" title="var">post</span> : <a class="idref" href="ConCert.Execution.Blockchain.html#Environment"><span class="id" title="record">Environment</span></a>} {<span class="id" title="var">new_acts</span> : <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#list"><span class="id" title="inductive">list</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#Action"><span class="id" title="record">Action</span></a>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="tactic">eval</span> : <a class="idref" href="ConCert.Execution.Blockchain.html#ActionEvaluation"><span class="id" title="inductive">ActionEvaluation</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#pre"><span class="id" title="variable">pre</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#act"><span class="id" title="variable">act</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#post"><span class="id" title="variable">post</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#new_acts"><span class="id" title="variable">new_acts</span></a>).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a name="account_balance_post"><span class="id" title="lemma">account_balance_post</span></a> (<span class="id" title="var">addr</span> : <a class="idref" href="ConCert.Execution.Blockchain.html#Address"><span class="id" title="method">Address</span></a>) :<br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#env_account_balances"><span class="id" title="projection">env_account_balances</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#Blockchain.Semantics.Theories.post"><span class="id" title="variable">post</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#addr"><span class="id" title="variable">addr</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#env_account_balances"><span class="id" title="projection">env_account_balances</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#Blockchain.Semantics.Theories.pre"><span class="id" title="variable">pre</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#addr"><span class="id" title="variable">addr</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.ZArith.BinInt.html#46584eddd5fdb16176a10a2843177d3a"><span class="id" title="notation">+</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.ZArith.BinInt.html#46584eddd5fdb16176a10a2843177d3a"><span class="id" title="notation">(</span></a><span class="id" title="keyword">if</span> (<a class="idref" href="ConCert.Execution.Blockchain.html#addr"><span class="id" title="variable">addr</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#6f617e0e5500b437e5aeb1eaa876d41f"><span class="id" title="notation">=?</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#eval_to"><span class="id" title="definition">eval_to</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#Blockchain.Semantics.Theories.eval"><span class="id" title="variable">eval</span></a>)%<span class="id" title="var">address</span> <span class="id" title="keyword">then</span> <a class="idref" href="ConCert.Execution.Blockchain.html#eval_amount"><span class="id" title="definition">eval_amount</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#Blockchain.Semantics.Theories.eval"><span class="id" title="variable">eval</span></a> <span class="id" title="keyword">else</span> 0<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.ZArith.BinInt.html#46584eddd5fdb16176a10a2843177d3a"><span class="id" title="notation">)</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.ZArith.BinInt.html#fa12f60d56cf7225f009c889c0622139"><span class="id" title="notation">-</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.ZArith.BinInt.html#fa12f60d56cf7225f009c889c0622139"><span class="id" title="notation">(</span></a><span class="id" title="keyword">if</span> (<a class="idref" href="ConCert.Execution.Blockchain.html#addr"><span class="id" title="variable">addr</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#6f617e0e5500b437e5aeb1eaa876d41f"><span class="id" title="notation">=?</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#eval_from"><span class="id" title="definition">eval_from</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#Blockchain.Semantics.Theories.eval"><span class="id" title="variable">eval</span></a>)%<span class="id" title="var">address</span> <span class="id" title="keyword">then</span> <a class="idref" href="ConCert.Execution.Blockchain.html#eval_amount"><span class="id" title="definition">eval_amount</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#Blockchain.Semantics.Theories.eval"><span class="id" title="variable">eval</span></a> <span class="id" title="keyword">else</span> 0<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.ZArith.BinInt.html#fa12f60d56cf7225f009c889c0622139"><span class="id" title="notation">)</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <a class="idref" href="ConCert.Execution.Blockchain.html#Blockchain.Semantics.Theories.eval"><span class="id" title="variable">eval</span></a>; <span class="id" title="var">cbn</span>; <span class="id" title="var">rewrite_environment_equiv</span>; <span class="id" title="var">cbn</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">destruct_address_eq</span>; <span class="id" title="var">lia</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a name="account_balance_post_to"><span class="id" title="lemma">account_balance_post_to</span></a> :<br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#eval_from"><span class="id" title="definition">eval_from</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#Blockchain.Semantics.Theories.eval"><span class="id" title="variable">eval</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#a0a5068f83a704fcfbda8cd473a6cfea"><span class="id" title="notation">&lt;&gt;</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#eval_to"><span class="id" title="definition">eval_to</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#Blockchain.Semantics.Theories.eval"><span class="id" title="variable">eval</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#env_account_balances"><span class="id" title="projection">env_account_balances</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#Blockchain.Semantics.Theories.post"><span class="id" title="variable">post</span></a> (<a class="idref" href="ConCert.Execution.Blockchain.html#eval_to"><span class="id" title="definition">eval_to</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#Blockchain.Semantics.Theories.eval"><span class="id" title="variable">eval</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#env_account_balances"><span class="id" title="projection">env_account_balances</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#Blockchain.Semantics.Theories.pre"><span class="id" title="variable">pre</span></a> (<a class="idref" href="ConCert.Execution.Blockchain.html#eval_to"><span class="id" title="definition">eval_to</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#Blockchain.Semantics.Theories.eval"><span class="id" title="variable">eval</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.ZArith.BinInt.html#46584eddd5fdb16176a10a2843177d3a"><span class="id" title="notation">+</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#eval_amount"><span class="id" title="definition">eval_amount</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#Blockchain.Semantics.Theories.eval"><span class="id" title="variable">eval</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">neq</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="ConCert.Execution.Blockchain.html#account_balance_post"><span class="id" title="lemma">account_balance_post</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="ConCert.Execution.Blockchain.html#address_eq_refl"><span class="id" title="lemma">address_eq_refl</span></a>, <a class="idref" href="ConCert.Execution.Blockchain.html#address_eq_ne"><span class="id" title="lemma">address_eq_ne</span></a> <span class="id" title="tactic">by</span> <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">lia</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a name="account_balance_post_from"><span class="id" title="lemma">account_balance_post_from</span></a> :<br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#eval_from"><span class="id" title="definition">eval_from</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#Blockchain.Semantics.Theories.eval"><span class="id" title="variable">eval</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#a0a5068f83a704fcfbda8cd473a6cfea"><span class="id" title="notation">&lt;&gt;</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#eval_to"><span class="id" title="definition">eval_to</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#Blockchain.Semantics.Theories.eval"><span class="id" title="variable">eval</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#env_account_balances"><span class="id" title="projection">env_account_balances</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#Blockchain.Semantics.Theories.post"><span class="id" title="variable">post</span></a> (<a class="idref" href="ConCert.Execution.Blockchain.html#eval_from"><span class="id" title="definition">eval_from</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#Blockchain.Semantics.Theories.eval"><span class="id" title="variable">eval</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#env_account_balances"><span class="id" title="projection">env_account_balances</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#Blockchain.Semantics.Theories.pre"><span class="id" title="variable">pre</span></a> (<a class="idref" href="ConCert.Execution.Blockchain.html#eval_from"><span class="id" title="definition">eval_from</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#Blockchain.Semantics.Theories.eval"><span class="id" title="variable">eval</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.ZArith.BinInt.html#fa12f60d56cf7225f009c889c0622139"><span class="id" title="notation">-</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#eval_amount"><span class="id" title="definition">eval_amount</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#Blockchain.Semantics.Theories.eval"><span class="id" title="variable">eval</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">neq</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="ConCert.Execution.Blockchain.html#account_balance_post"><span class="id" title="lemma">account_balance_post</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="ConCert.Execution.Blockchain.html#address_eq_refl"><span class="id" title="lemma">address_eq_refl</span></a>, <a class="idref" href="ConCert.Execution.Blockchain.html#address_eq_ne"><span class="id" title="lemma">address_eq_ne</span></a> <span class="id" title="tactic">by</span> <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">lia</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a name="account_balance_post_irrelevant"><span class="id" title="lemma">account_balance_post_irrelevant</span></a> (<span class="id" title="var">addr</span> : <a class="idref" href="ConCert.Execution.Blockchain.html#Address"><span class="id" title="method">Address</span></a>) :<br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#addr"><span class="id" title="variable">addr</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#a0a5068f83a704fcfbda8cd473a6cfea"><span class="id" title="notation">&lt;&gt;</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#eval_from"><span class="id" title="definition">eval_from</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#Blockchain.Semantics.Theories.eval"><span class="id" title="variable">eval</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#addr"><span class="id" title="variable">addr</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#a0a5068f83a704fcfbda8cd473a6cfea"><span class="id" title="notation">&lt;&gt;</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#eval_to"><span class="id" title="definition">eval_to</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#Blockchain.Semantics.Theories.eval"><span class="id" title="variable">eval</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#env_account_balances"><span class="id" title="projection">env_account_balances</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#Blockchain.Semantics.Theories.post"><span class="id" title="variable">post</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#addr"><span class="id" title="variable">addr</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#env_account_balances"><span class="id" title="projection">env_account_balances</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#Blockchain.Semantics.Theories.pre"><span class="id" title="variable">pre</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#addr"><span class="id" title="variable">addr</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">neq_from</span> <span class="id" title="var">neq_to</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="ConCert.Execution.Blockchain.html#account_balance_post"><span class="id" title="lemma">account_balance_post</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">repeat</span> <span class="id" title="tactic">rewrite</span> <a class="idref" href="ConCert.Execution.Blockchain.html#address_eq_ne"><span class="id" title="lemma">address_eq_ne</span></a> <span class="id" title="tactic">by</span> <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">lia</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a name="chain_height_post_action"><span class="id" title="lemma">chain_height_post_action</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#chain_height"><span class="id" title="projection">chain_height</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#Blockchain.Semantics.Theories.post"><span class="id" title="variable">post</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#chain_height"><span class="id" title="projection">chain_height</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#Blockchain.Semantics.Theories.pre"><span class="id" title="variable">pre</span></a>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">destruct</span> <a class="idref" href="ConCert.Execution.Blockchain.html#Blockchain.Semantics.Theories.eval"><span class="id" title="variable">eval</span></a>; <span class="id" title="var">rewrite_environment_equiv</span>; <span class="id" title="tactic">auto</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a name="current_slot_post_action"><span class="id" title="lemma">current_slot_post_action</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#current_slot"><span class="id" title="projection">current_slot</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#Blockchain.Semantics.Theories.post"><span class="id" title="variable">post</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#current_slot"><span class="id" title="projection">current_slot</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#Blockchain.Semantics.Theories.pre"><span class="id" title="variable">pre</span></a>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">destruct</span> <a class="idref" href="ConCert.Execution.Blockchain.html#Blockchain.Semantics.Theories.eval"><span class="id" title="variable">eval</span></a>; <span class="id" title="var">rewrite_environment_equiv</span>; <span class="id" title="tactic">auto</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a name="finalized_height_post_action"><span class="id" title="lemma">finalized_height_post_action</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#finalized_height"><span class="id" title="projection">finalized_height</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#Blockchain.Semantics.Theories.post"><span class="id" title="variable">post</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#finalized_height"><span class="id" title="projection">finalized_height</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#Blockchain.Semantics.Theories.pre"><span class="id" title="variable">pre</span></a>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">destruct</span> <a class="idref" href="ConCert.Execution.Blockchain.html#Blockchain.Semantics.Theories.eval"><span class="id" title="variable">eval</span></a>; <span class="id" title="var">rewrite_environment_equiv</span>; <span class="id" title="tactic">auto</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a name="contracts_post_pre_none"><span class="id" title="lemma">contracts_post_pre_none</span></a> <span class="id" title="var">contract</span> :<br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#env_contracts"><span class="id" title="projection">env_contracts</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#Blockchain.Semantics.Theories.post"><span class="id" title="variable">post</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#contract"><span class="id" title="variable">contract</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#env_contracts"><span class="id" title="projection">env_contracts</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#Blockchain.Semantics.Theories.pre"><span class="id" title="variable">pre</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#contract"><span class="id" title="variable">contract</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">H</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <a class="idref" href="ConCert.Execution.Blockchain.html#Blockchain.Semantics.Theories.eval"><span class="id" title="variable">eval</span></a>; <span class="id" title="var">rewrite_environment_equiv</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;<span class="id" title="var">destruct_address_eq</span>; <span class="id" title="tactic">congruence</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a name="eval_amount_nonnegative"><span class="id" title="lemma">eval_amount_nonnegative</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#eval_amount"><span class="id" title="definition">eval_amount</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#Blockchain.Semantics.Theories.eval"><span class="id" title="variable">eval</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.ZArith.BinInt.html#b1f0780291abe9bd18804d2c9a5039d4"><span class="id" title="notation">&gt;=</span></a> 0.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="var">now</span> <span class="id" title="tactic">destruct</span> <a class="idref" href="ConCert.Execution.Blockchain.html#Blockchain.Semantics.Theories.eval"><span class="id" title="variable">eval</span></a>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a name="eval_amount_le_account_balance"><span class="id" title="lemma">eval_amount_le_account_balance</span></a> :<br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#eval_amount"><span class="id" title="definition">eval_amount</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#Blockchain.Semantics.Theories.eval"><span class="id" title="variable">eval</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.ZArith.BinInt.html#306329b0eca7a2b86c198702f594ad8e"><span class="id" title="notation">&lt;=</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#env_account_balances"><span class="id" title="projection">env_account_balances</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#Blockchain.Semantics.Theories.pre"><span class="id" title="variable">pre</span></a> (<a class="idref" href="ConCert.Execution.Blockchain.html#eval_from"><span class="id" title="definition">eval_from</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#Blockchain.Semantics.Theories.eval"><span class="id" title="variable">eval</span></a>).<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="var">now</span> <span class="id" title="tactic">destruct</span> <a class="idref" href="ConCert.Execution.Blockchain.html#Blockchain.Semantics.Theories.eval"><span class="id" title="variable">eval</span></a>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">End</span> <a class="idref" href="ConCert.Execution.Blockchain.html#Blockchain.Semantics.Theories"><span class="id" title="section">Theories</span></a>.<br/>

<br/>
<span class="id" title="keyword">Section</span> <a name="Blockchain.Semantics.Trace"><span class="id" title="section">Trace</span></a>.<br/>

<br/>
<span class="id" title="keyword">Record</span> <a name="BlockHeader"><span class="id" title="record">BlockHeader</span></a> :=<br/>
&nbsp;&nbsp;<a name="build_block_Header"><span class="id" title="constructor">build_block_Header</span></a> {<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a name="block_height"><span class="id" title="projection">block_height</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a name="block_slot"><span class="id" title="projection">block_slot</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a name="block_finalized_height"><span class="id" title="projection">block_finalized_height</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a name="block_reward"><span class="id" title="projection">block_reward</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#Amount"><span class="id" title="definition">Amount</span></a>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a name="block_creator"><span class="id" title="projection">block_creator</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#Address"><span class="id" title="method">Address</span></a>;<br/>
&nbsp;&nbsp;}.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a name="add_new_block_to_env"><span class="id" title="definition">add_new_block_to_env</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">header</span> : <a class="idref" href="ConCert.Execution.Blockchain.html#BlockHeader"><span class="id" title="record">BlockHeader</span></a>) (<span class="id" title="var">env</span> : <a class="idref" href="ConCert.Execution.Blockchain.html#Environment"><span class="id" title="record">Environment</span></a>) : <a class="idref" href="ConCert.Execution.Blockchain.html#Environment"><span class="id" title="record">Environment</span></a> :=<br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#env"><span class="id" title="variable">env</span></a><a class="idref" href="ConCert.Utils.RecordSet.html#d8ee35e247a15fc7b8a66b09a91f7b72"><span class="id" title="notation">&lt;|</span></a><a class="idref" href="ConCert.Execution.Blockchain.html#env_chain"><span class="id" title="projection">env_chain</span></a><a class="idref" href="ConCert.Utils.RecordSet.html#d8ee35e247a15fc7b8a66b09a91f7b72"><span class="id" title="notation">;</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#chain_height"><span class="id" title="projection">chain_height</span></a> <a class="idref" href="ConCert.Utils.RecordSet.html#d8ee35e247a15fc7b8a66b09a91f7b72"><span class="id" title="notation">:=</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#block_height"><span class="id" title="projection">block_height</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#header"><span class="id" title="variable">header</span></a><a class="idref" href="ConCert.Utils.RecordSet.html#d8ee35e247a15fc7b8a66b09a91f7b72"><span class="id" title="notation">|&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Utils.RecordSet.html#d8ee35e247a15fc7b8a66b09a91f7b72"><span class="id" title="notation">&lt;|</span></a><a class="idref" href="ConCert.Execution.Blockchain.html#env_chain"><span class="id" title="projection">env_chain</span></a><a class="idref" href="ConCert.Utils.RecordSet.html#d8ee35e247a15fc7b8a66b09a91f7b72"><span class="id" title="notation">;</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#current_slot"><span class="id" title="projection">current_slot</span></a> <a class="idref" href="ConCert.Utils.RecordSet.html#d8ee35e247a15fc7b8a66b09a91f7b72"><span class="id" title="notation">:=</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#block_slot"><span class="id" title="projection">block_slot</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#header"><span class="id" title="variable">header</span></a><a class="idref" href="ConCert.Utils.RecordSet.html#d8ee35e247a15fc7b8a66b09a91f7b72"><span class="id" title="notation">|&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Utils.RecordSet.html#d8ee35e247a15fc7b8a66b09a91f7b72"><span class="id" title="notation">&lt;|</span></a><a class="idref" href="ConCert.Execution.Blockchain.html#env_chain"><span class="id" title="projection">env_chain</span></a><a class="idref" href="ConCert.Utils.RecordSet.html#d8ee35e247a15fc7b8a66b09a91f7b72"><span class="id" title="notation">;</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#finalized_height"><span class="id" title="projection">finalized_height</span></a> <a class="idref" href="ConCert.Utils.RecordSet.html#d8ee35e247a15fc7b8a66b09a91f7b72"><span class="id" title="notation">:=</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#block_finalized_height"><span class="id" title="projection">block_finalized_height</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#header"><span class="id" title="variable">header</span></a><a class="idref" href="ConCert.Utils.RecordSet.html#d8ee35e247a15fc7b8a66b09a91f7b72"><span class="id" title="notation">|&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Utils.RecordSet.html#394068d0cf93ac4dd96dfc7ba41b06b2"><span class="id" title="notation">&lt;|</span></a><a class="idref" href="ConCert.Execution.Blockchain.html#env_account_balances"><span class="id" title="projection">env_account_balances</span></a> <a class="idref" href="ConCert.Utils.RecordSet.html#394068d0cf93ac4dd96dfc7ba41b06b2"><span class="id" title="notation">::=</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#add_balance"><span class="id" title="definition">add_balance</span></a> (<a class="idref" href="ConCert.Execution.Blockchain.html#block_creator"><span class="id" title="projection">block_creator</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#header"><span class="id" title="variable">header</span></a>) (<a class="idref" href="ConCert.Execution.Blockchain.html#block_reward"><span class="id" title="projection">block_reward</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#header"><span class="id" title="variable">header</span></a>)<a class="idref" href="ConCert.Utils.RecordSet.html#394068d0cf93ac4dd96dfc7ba41b06b2"><span class="id" title="notation">|&gt;</span></a>.<br/>

<br/>
<span class="comment">(*&nbsp;Todo:&nbsp;this&nbsp;should&nbsp;just&nbsp;be&nbsp;a&nbsp;computation.&nbsp;But&nbsp;I&nbsp;still&nbsp;do&nbsp;not&nbsp;*)</span><br/>
<span class="comment">(*&nbsp;know&nbsp;exactly&nbsp;what&nbsp;the&nbsp;best&nbsp;way&nbsp;of&nbsp;working&nbsp;with&nbsp;reflect&nbsp;is&nbsp;*)</span><br/>
<span class="id" title="keyword">Local Open</span> <span class="id" title="keyword">Scope</span> <span class="id" title="var">nat</span>.<br/>
<span class="id" title="keyword">Definition</span> <a name="act_is_from_account"><span class="id" title="definition">act_is_from_account</span></a> (<span class="id" title="var">act</span> : <a class="idref" href="ConCert.Execution.Blockchain.html#Action"><span class="id" title="record">Action</span></a>) : <span class="id" title="keyword">Prop</span> :=<br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#address_is_contract"><span class="id" title="method">address_is_contract</span></a> (<a class="idref" href="ConCert.Execution.Blockchain.html#act_from"><span class="id" title="projection">act_from</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#act"><span class="id" title="variable">act</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#false"><span class="id" title="constructor">false</span></a>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a name="act_origin_is_account"><span class="id" title="definition">act_origin_is_account</span></a> (<span class="id" title="var">act</span> : <a class="idref" href="ConCert.Execution.Blockchain.html#Action"><span class="id" title="record">Action</span></a>) : <span class="id" title="keyword">Prop</span> :=<br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#address_is_contract"><span class="id" title="method">address_is_contract</span></a> (<a class="idref" href="ConCert.Execution.Blockchain.html#act_origin"><span class="id" title="projection">act_origin</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#act"><span class="id" title="variable">act</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#false"><span class="id" title="constructor">false</span></a>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a name="act_origin_is_eq_from"><span class="id" title="definition">act_origin_is_eq_from</span></a> (<span class="id" title="var">act</span> : <a class="idref" href="ConCert.Execution.Blockchain.html#Action"><span class="id" title="record">Action</span></a>) : <span class="id" title="keyword">Prop</span> :=<br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#address_eqb"><span class="id" title="method">address_eqb</span></a> (<a class="idref" href="ConCert.Execution.Blockchain.html#act_origin"><span class="id" title="projection">act_origin</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#act"><span class="id" title="variable">act</span></a>) (<a class="idref" href="ConCert.Execution.Blockchain.html#act_from"><span class="id" title="projection">act_from</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#act"><span class="id" title="variable">act</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#true"><span class="id" title="constructor">true</span></a>.<br/>

<br/>
<span class="id" title="keyword">Record</span> <a name="IsValidNextBlock"><span class="id" title="record">IsValidNextBlock</span></a> (<span class="id" title="var">header</span> : <a class="idref" href="ConCert.Execution.Blockchain.html#BlockHeader"><span class="id" title="record">BlockHeader</span></a>) (<span class="id" title="var">chain</span> : <a class="idref" href="ConCert.Execution.Blockchain.html#Chain"><span class="id" title="record">Chain</span></a>) : <span class="id" title="keyword">Prop</span> :=<br/>
&nbsp;&nbsp;<a name="build_is_valid_next_block"><span class="id" title="constructor">build_is_valid_next_block</span></a> {<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a name="valid_height"><span class="id" title="projection">valid_height</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#block_height"><span class="id" title="projection">block_height</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#header"><span class="id" title="variable">header</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#S"><span class="id" title="constructor">S</span></a> (<a class="idref" href="ConCert.Execution.Blockchain.html#chain_height"><span class="id" title="projection">chain_height</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#chain"><span class="id" title="variable">chain</span></a>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a name="valid_slot"><span class="id" title="projection">valid_slot</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#block_slot"><span class="id" title="projection">block_slot</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#header"><span class="id" title="variable">header</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Peano.html#7f2a7ef2c63af7359b22787a9daf336e"><span class="id" title="notation">&gt;</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#current_slot"><span class="id" title="projection">current_slot</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#chain"><span class="id" title="variable">chain</span></a>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a name="valid_finalized_height"><span class="id" title="projection">valid_finalized_height</span></a> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#block_finalized_height"><span class="id" title="projection">block_finalized_height</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#header"><span class="id" title="variable">header</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Peano.html#73030c22bc0b1fa771c65aa5414c65f9"><span class="id" title="notation">&gt;=</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#finalized_height"><span class="id" title="projection">finalized_height</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#chain"><span class="id" title="variable">chain</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">/\</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#block_finalized_height"><span class="id" title="projection">block_finalized_height</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#header"><span class="id" title="variable">header</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Peano.html#00fe0eaf5e6949f0a31725357afa4bba"><span class="id" title="notation">&lt;</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#block_height"><span class="id" title="projection">block_height</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#header"><span class="id" title="variable">header</span></a>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a name="valid_creator"><span class="id" title="projection">valid_creator</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#address_is_contract"><span class="id" title="method">address_is_contract</span></a> (<a class="idref" href="ConCert.Execution.Blockchain.html#block_creator"><span class="id" title="projection">block_creator</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#header"><span class="id" title="variable">header</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#false"><span class="id" title="constructor">false</span></a>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a name="valid_reward"><span class="id" title="projection">valid_reward</span></a> : (<a class="idref" href="ConCert.Execution.Blockchain.html#block_reward"><span class="id" title="projection">block_reward</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#header"><span class="id" title="variable">header</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.ZArith.BinInt.html#b1f0780291abe9bd18804d2c9a5039d4"><span class="id" title="notation">&gt;=</span></a> 0)%<span class="id" title="var">Z</span>;<br/>
&nbsp;&nbsp;}.<br/>

<br/>
<span class="id" title="keyword">Record</span> <a name="ChainState"><span class="id" title="record">ChainState</span></a> :=<br/>
&nbsp;&nbsp;<a name="build_chain_state"><span class="id" title="constructor">build_chain_state</span></a> {<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a name="chain_state_env"><span class="id" title="projection">chain_state_env</span></a> :&gt; <a class="idref" href="ConCert.Execution.Blockchain.html#Environment"><span class="id" title="record">Environment</span></a>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a name="chain_state_queue"><span class="id" title="projection">chain_state_queue</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#list"><span class="id" title="inductive">list</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#Action"><span class="id" title="record">Action</span></a>;<br/>
&nbsp;&nbsp;}.<br/>

<br/>
<span class="id" title="var">MetaCoq</span> <span class="id" title="var">Run</span> (<a class="idref" href="ConCert.Utils.RecordSet.html#make_setters"><span class="id" title="definition">make_setters</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#ChainState"><span class="id" title="record">ChainState</span></a>).<br/>

<br/>
<span class="id" title="keyword">Inductive</span> <a name="ChainStep"><span class="id" title="inductive">ChainStep</span></a> (<span class="id" title="var">prev_bstate</span> : <a class="idref" href="ConCert.Execution.Blockchain.html#ChainState"><span class="id" title="record">ChainState</span></a>) (<span class="id" title="var">next_bstate</span> : <a class="idref" href="ConCert.Execution.Blockchain.html#ChainState"><span class="id" title="record">ChainState</span></a>) :=<br/>
| <a name="step_block"><span class="id" title="constructor">step_block</span></a> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">forall</span> (<span class="id" title="var">header</span> : <a class="idref" href="ConCert.Execution.Blockchain.html#BlockHeader"><span class="id" title="record">BlockHeader</span></a>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#chain_state_queue"><span class="id" title="projection">chain_state_queue</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#prev_bstate"><span class="id" title="variable">prev_bstate</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#ae9a5e1034e143b218b09d8e454472bd"><span class="id" title="notation">[]</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#IsValidNextBlock"><span class="id" title="record">IsValidNextBlock</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#header"><span class="id" title="variable">header</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#prev_bstate"><span class="id" title="variable">prev_bstate</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#Forall"><span class="id" title="inductive">Forall</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#act_is_from_account"><span class="id" title="definition">act_is_from_account</span></a> (<a class="idref" href="ConCert.Execution.Blockchain.html#chain_state_queue"><span class="id" title="projection">chain_state_queue</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#next_bstate"><span class="id" title="variable">next_bstate</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#Forall"><span class="id" title="inductive">Forall</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#act_origin_is_eq_from"><span class="id" title="definition">act_origin_is_eq_from</span></a> (<a class="idref" href="ConCert.Execution.Blockchain.html#chain_state_queue"><span class="id" title="projection">chain_state_queue</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#next_bstate"><span class="id" title="variable">next_bstate</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#EnvironmentEquiv"><span class="id" title="record">EnvironmentEquiv</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#next_bstate"><span class="id" title="variable">next_bstate</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="ConCert.Execution.Blockchain.html#add_new_block_to_env"><span class="id" title="definition">add_new_block_to_env</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#header"><span class="id" title="variable">header</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#prev_bstate"><span class="id" title="variable">prev_bstate</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#ChainStep"><span class="id" title="inductive">ChainStep</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#prev_bstate"><span class="id" title="variable">prev_bstate</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#next_bstate"><span class="id" title="variable">next_bstate</span></a><br/>
| <a name="step_action"><span class="id" title="constructor">step_action</span></a> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">forall</span> (<span class="id" title="var">act</span> : <a class="idref" href="ConCert.Execution.Blockchain.html#Action"><span class="id" title="record">Action</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">acts</span> : <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#list"><span class="id" title="inductive">list</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#Action"><span class="id" title="record">Action</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">new_acts</span> : <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#list"><span class="id" title="inductive">list</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#Action"><span class="id" title="record">Action</span></a>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#chain_state_queue"><span class="id" title="projection">chain_state_queue</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#prev_bstate"><span class="id" title="variable">prev_bstate</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#act"><span class="id" title="variable">act</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#cbcf67aac0c2a85b8d93d37de9969adf"><span class="id" title="notation">::</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#acts"><span class="id" title="variable">acts</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#ActionEvaluation"><span class="id" title="inductive">ActionEvaluation</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#prev_bstate"><span class="id" title="variable">prev_bstate</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#act"><span class="id" title="variable">act</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#next_bstate"><span class="id" title="variable">next_bstate</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#new_acts"><span class="id" title="variable">new_acts</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#chain_state_queue"><span class="id" title="projection">chain_state_queue</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#next_bstate"><span class="id" title="variable">next_bstate</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#new_acts"><span class="id" title="variable">new_acts</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#bc347c51eaf667706ae54503b26d52c6"><span class="id" title="notation">++</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#acts"><span class="id" title="variable">acts</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#ChainStep"><span class="id" title="inductive">ChainStep</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#prev_bstate"><span class="id" title="variable">prev_bstate</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#next_bstate"><span class="id" title="variable">next_bstate</span></a><br/>
| <a name="step_action_invalid"><span class="id" title="constructor">step_action_invalid</span></a> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">forall</span> (<span class="id" title="var">act</span> : <a class="idref" href="ConCert.Execution.Blockchain.html#Action"><span class="id" title="record">Action</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">acts</span> : <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#list"><span class="id" title="inductive">list</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#Action"><span class="id" title="record">Action</span></a>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#EnvironmentEquiv"><span class="id" title="record">EnvironmentEquiv</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#next_bstate"><span class="id" title="variable">next_bstate</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#prev_bstate"><span class="id" title="variable">prev_bstate</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#chain_state_queue"><span class="id" title="projection">chain_state_queue</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#prev_bstate"><span class="id" title="variable">prev_bstate</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#act"><span class="id" title="variable">act</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#cbcf67aac0c2a85b8d93d37de9969adf"><span class="id" title="notation">::</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#acts"><span class="id" title="variable">acts</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#chain_state_queue"><span class="id" title="projection">chain_state_queue</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#next_bstate"><span class="id" title="variable">next_bstate</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#acts"><span class="id" title="variable">acts</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#act_is_from_account"><span class="id" title="definition">act_is_from_account</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#act"><span class="id" title="variable">act</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">(</span></a><span class="id" title="keyword">forall</span> <span class="id" title="var">bstate</span> <span class="id" title="var">new_acts</span>, <a class="idref" href="ConCert.Execution.Blockchain.html#ActionEvaluation"><span class="id" title="inductive">ActionEvaluation</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#prev_bstate"><span class="id" title="variable">prev_bstate</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#act"><span class="id" title="variable">act</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#bstate"><span class="id" title="variable">bstate</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#new_acts"><span class="id" title="variable">new_acts</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#False"><span class="id" title="inductive">False</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#ChainStep"><span class="id" title="inductive">ChainStep</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#prev_bstate"><span class="id" title="variable">prev_bstate</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#next_bstate"><span class="id" title="variable">next_bstate</span></a><br/>
| <a name="step_permute"><span class="id" title="constructor">step_permute</span></a> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#EnvironmentEquiv"><span class="id" title="record">EnvironmentEquiv</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#next_bstate"><span class="id" title="variable">next_bstate</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#prev_bstate"><span class="id" title="variable">prev_bstate</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Sorting.Permutation.html#Permutation"><span class="id" title="inductive">Permutation</span></a> (<a class="idref" href="ConCert.Execution.Blockchain.html#chain_state_queue"><span class="id" title="projection">chain_state_queue</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#prev_bstate"><span class="id" title="variable">prev_bstate</span></a>) (<a class="idref" href="ConCert.Execution.Blockchain.html#chain_state_queue"><span class="id" title="projection">chain_state_queue</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#next_bstate"><span class="id" title="variable">next_bstate</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#ChainStep"><span class="id" title="inductive">ChainStep</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#prev_bstate"><span class="id" title="variable">prev_bstate</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#next_bstate"><span class="id" title="variable">next_bstate</span></a>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a name="origin_is_account"><span class="id" title="lemma">origin_is_account</span></a> <span class="id" title="var">acts</span> :<br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#Forall"><span class="id" title="inductive">Forall</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#act_is_from_account"><span class="id" title="definition">act_is_from_account</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#acts"><span class="id" title="variable">acts</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#Forall"><span class="id" title="inductive">Forall</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#act_origin_is_eq_from"><span class="id" title="definition">act_origin_is_eq_from</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#acts"><span class="id" title="variable">acts</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#Forall"><span class="id" title="inductive">Forall</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#act_origin_is_account"><span class="id" title="definition">act_origin_is_account</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#acts"><span class="id" title="variable">acts</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">Hall</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">Hall</span> <span class="id" title="keyword">as</span> [| <span class="id" title="var">a</span> <span class="id" title="var">Ha</span>];<span class="id" title="tactic">intros</span> <span class="id" title="var">Hall0</span>;<span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">inversion</span> <span class="id" title="var">Hall0</span>;<span class="id" title="tactic">subst</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">constructor</span>;<span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">specialize</span> (<a class="idref" href="ConCert.Execution.Blockchain.html#address_eqb_spec"><span class="id" title="method">address_eqb_spec</span></a> (<a class="idref" href="ConCert.Execution.Blockchain.html#act_origin"><span class="id" title="projection">act_origin</span></a> <span class="id" title="var">a</span>) (<a class="idref" href="ConCert.Execution.Blockchain.html#act_from"><span class="id" title="projection">act_from</span></a> <span class="id" title="var">a</span>)) <span class="id" title="keyword">as</span> <span class="id" title="var">Haddr</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="ConCert.Execution.Blockchain.html#act_origin_is_eq_from"><span class="id" title="definition">act_origin_is_eq_from</span></a> <span class="id" title="tactic">in</span> *; <span class="id" title="tactic">destruct</span> <span class="id" title="var">Haddr</span>;<span class="id" title="var">easy</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a name="empty_state"><span class="id" title="definition">empty_state</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#ChainState"><span class="id" title="record">ChainState</span></a> :=<br/>
&nbsp;&nbsp;{| <a class="idref" href="ConCert.Execution.Blockchain.html#build_chain_state"><span class="id" title="constructor">chain_state_env</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#build_chain_state"><span class="id" title="constructor">:=</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#build_chain_state"><span class="id" title="constructor">{|</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#build_chain_state"><span class="id" title="constructor">env_chain</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#build_chain_state"><span class="id" title="constructor">:=</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#build_chain_state"><span class="id" title="constructor">{|</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#build_chain_state"><span class="id" title="constructor">chain_height</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#build_chain_state"><span class="id" title="constructor">:=</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#build_chain_state"><span class="id" title="constructor">0;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#build_chain_state"><span class="id" title="constructor">current_slot</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#build_chain_state"><span class="id" title="constructor">:=</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#build_chain_state"><span class="id" title="constructor">0;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#build_chain_state"><span class="id" title="constructor">finalized_height</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#build_chain_state"><span class="id" title="constructor">:=</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#build_chain_state"><span class="id" title="constructor">0;</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#build_chain_state"><span class="id" title="constructor">|};</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#build_chain_state"><span class="id" title="constructor">env_account_balances</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#build_chain_state"><span class="id" title="constructor">a</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#build_chain_state"><span class="id" title="constructor">:=</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#build_chain_state"><span class="id" title="constructor">0%</span></a><a class="idref" href="ConCert.Execution.Blockchain.html#build_chain_state"><span class="id" title="constructor">Z</span></a><a class="idref" href="ConCert.Execution.Blockchain.html#build_chain_state"><span class="id" title="constructor">;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#build_chain_state"><span class="id" title="constructor">env_contract_states</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#build_chain_state"><span class="id" title="constructor">a</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#build_chain_state"><span class="id" title="constructor">:=</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#build_chain_state"><span class="id" title="constructor">None</span></a><a class="idref" href="ConCert.Execution.Blockchain.html#build_chain_state"><span class="id" title="constructor">;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#build_chain_state"><span class="id" title="constructor">env_contracts</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#build_chain_state"><span class="id" title="constructor">a</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#build_chain_state"><span class="id" title="constructor">:=</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#build_chain_state"><span class="id" title="constructor">None</span></a><a class="idref" href="ConCert.Execution.Blockchain.html#build_chain_state"><span class="id" title="constructor">;</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#build_chain_state"><span class="id" title="constructor">|};</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#build_chain_state"><span class="id" title="constructor">chain_state_queue</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#build_chain_state"><span class="id" title="constructor">:=</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#build_chain_state"><span class="id" title="constructor">[]</span></a> |}.<br/>

<br/>
<span class="comment">(*&nbsp;The&nbsp;ChainTrace&nbsp;captures&nbsp;that&nbsp;there&nbsp;is&nbsp;a&nbsp;valid&nbsp;execution&nbsp;where,<br/>
starting&nbsp;from&nbsp;one&nbsp;environment&nbsp;and&nbsp;queue&nbsp;of&nbsp;actions,&nbsp;we&nbsp;end&nbsp;up&nbsp;in&nbsp;a<br/>
different&nbsp;environment&nbsp;and&nbsp;queue&nbsp;of&nbsp;actions.&nbsp;*)</span><br/>
<span class="id" title="keyword">Definition</span> <a name="ChainTrace"><span class="id" title="definition">ChainTrace</span></a> := <a class="idref" href="ConCert.Execution.ChainedList.html#ChainedList"><span class="id" title="inductive">ChainedList</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#ChainState"><span class="id" title="record">ChainState</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#ChainStep"><span class="id" title="inductive">ChainStep</span></a>.<br/>

<br/>
<span class="comment">(*&nbsp;Additionally,&nbsp;a&nbsp;state&nbsp;is&nbsp;reachable&nbsp;if&nbsp;there&nbsp;is&nbsp;a&nbsp;trace&nbsp;ending&nbsp;in&nbsp;this&nbsp;trace.&nbsp;*)</span><br/>
<span class="id" title="keyword">Definition</span> <a name="reachable"><span class="id" title="definition">reachable</span></a> (<span class="id" title="var">state</span> : <a class="idref" href="ConCert.Execution.Blockchain.html#ChainState"><span class="id" title="record">ChainState</span></a>) : <span class="id" title="keyword">Prop</span> :=<br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#inhabited"><span class="id" title="inductive">inhabited</span></a> (<a class="idref" href="ConCert.Execution.Blockchain.html#ChainTrace"><span class="id" title="definition">ChainTrace</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#empty_state"><span class="id" title="definition">empty_state</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#state"><span class="id" title="variable">state</span></a>).<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a name="outgoing_acts"><span class="id" title="definition">outgoing_acts</span></a> (<span class="id" title="var">state</span> : <a class="idref" href="ConCert.Execution.Blockchain.html#ChainState"><span class="id" title="record">ChainState</span></a>) (<span class="id" title="var">addr</span> : <a class="idref" href="ConCert.Execution.Blockchain.html#Address"><span class="id" title="method">Address</span></a>) : <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#list"><span class="id" title="inductive">list</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#ActionBody"><span class="id" title="inductive">ActionBody</span></a> :=<br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#map"><span class="id" title="definition">map</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#act_body"><span class="id" title="projection">act_body</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#filter"><span class="id" title="definition">filter</span></a> (<span class="id" title="keyword">fun</span> <span class="id" title="var">act</span> =&gt; (<a class="idref" href="ConCert.Execution.Blockchain.html#act_from"><span class="id" title="projection">act_from</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#act"><span class="id" title="variable">act</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#6f617e0e5500b437e5aeb1eaa876d41f"><span class="id" title="notation">=?</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#addr"><span class="id" title="variable">addr</span></a>)%<span class="id" title="var">address</span>) (<a class="idref" href="ConCert.Execution.Blockchain.html#chain_state_queue"><span class="id" title="projection">chain_state_queue</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#state"><span class="id" title="variable">state</span></a>)).<br/>

<br/>
<span class="comment">(*&nbsp;We&nbsp;define&nbsp;a&nbsp;transaction&nbsp;as&nbsp;a&nbsp;"fully&nbsp;specified"&nbsp;action,&nbsp;recording&nbsp;all&nbsp;info.&nbsp;For<br/>
example,&nbsp;a&nbsp;transaction&nbsp;contains&nbsp;the&nbsp;contract&nbsp;address&nbsp;that&nbsp;was&nbsp;created&nbsp;when&nbsp;a&nbsp;contract<br/>
is&nbsp;deployed.&nbsp;This&nbsp;is&nbsp;more&nbsp;about&nbsp;bridging&nbsp;the&nbsp;gap&nbsp;between&nbsp;our&nbsp;definitions&nbsp;and&nbsp;what<br/>
a&nbsp;normal&nbsp;blockchain&nbsp;is.&nbsp;Each&nbsp;evaluation&nbsp;of&nbsp;an&nbsp;action&nbsp;in&nbsp;the&nbsp;blockchain&nbsp;corresponds&nbsp;to<br/>
a&nbsp;transaction,&nbsp;so&nbsp;we&nbsp;can&nbsp;go&nbsp;from&nbsp;a&nbsp;trace&nbsp;to&nbsp;a&nbsp;list&nbsp;of&nbsp;transactions.&nbsp;*)</span><br/>
<span class="id" title="keyword">Inductive</span> <a name="TxBody"><span class="id" title="inductive">TxBody</span></a> :=<br/>
&nbsp;&nbsp;| <a name="tx_empty"><span class="id" title="constructor">tx_empty</span></a><br/>
&nbsp;&nbsp;| <a name="tx_deploy"><span class="id" title="constructor">tx_deploy</span></a> (<span class="id" title="var">wc</span> : <a class="idref" href="ConCert.Execution.Blockchain.html#WeakContract"><span class="id" title="inductive">WeakContract</span></a>) (<span class="id" title="var">setup</span> : <a class="idref" href="ConCert.Execution.Serializable.html#SerializedValue"><span class="id" title="record">SerializedValue</span></a>)<br/>
&nbsp;&nbsp;| <a name="tx_call"><span class="id" title="constructor">tx_call</span></a> (<span class="id" title="var">msg</span> : <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#option"><span class="id" title="inductive">option</span></a> <a class="idref" href="ConCert.Execution.Serializable.html#SerializedValue"><span class="id" title="record">SerializedValue</span></a>).<br/>

<br/>
<span class="id" title="keyword">Record</span> <a name="Tx"><span class="id" title="record">Tx</span></a> :=<br/>
&nbsp;&nbsp;<a name="build_tx"><span class="id" title="constructor">build_tx</span></a> {<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name="tx_origin"><span class="id" title="projection">tx_origin</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#Address"><span class="id" title="method">Address</span></a>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name="tx_from"><span class="id" title="projection">tx_from</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#Address"><span class="id" title="method">Address</span></a>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name="tx_to"><span class="id" title="projection">tx_to</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#Address"><span class="id" title="method">Address</span></a>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name="tx_amount"><span class="id" title="projection">tx_amount</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#Amount"><span class="id" title="definition">Amount</span></a>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name="tx_body"><span class="id" title="projection">tx_body</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#TxBody"><span class="id" title="inductive">TxBody</span></a>;<br/>
&nbsp;&nbsp;}.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a name="eval_tx"><span class="id" title="definition">eval_tx</span></a> {<span class="id" title="var">pre</span> : <a class="idref" href="ConCert.Execution.Blockchain.html#Environment"><span class="id" title="record">Environment</span></a>} {<span class="id" title="var">act</span> : <a class="idref" href="ConCert.Execution.Blockchain.html#Action"><span class="id" title="record">Action</span></a>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<span class="id" title="var">post</span> : <a class="idref" href="ConCert.Execution.Blockchain.html#Environment"><span class="id" title="record">Environment</span></a>} {<span class="id" title="var">new_acts</span> : <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#list"><span class="id" title="inductive">list</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#Action"><span class="id" title="record">Action</span></a>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">step</span> : <a class="idref" href="ConCert.Execution.Blockchain.html#ActionEvaluation"><span class="id" title="inductive">ActionEvaluation</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#pre"><span class="id" title="variable">pre</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#act"><span class="id" title="variable">act</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#post"><span class="id" title="variable">post</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#new_acts"><span class="id" title="variable">new_acts</span></a>) : <a class="idref" href="ConCert.Execution.Blockchain.html#Tx"><span class="id" title="record">Tx</span></a> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="ConCert.Execution.Blockchain.html#step"><span class="id" title="variable">step</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| <a class="idref" href="ConCert.Execution.Blockchain.html#eval_transfer"><span class="id" title="constructor">eval_transfer</span></a> <span class="id" title="var">origin</span> <span class="id" title="var">from</span> <span class="id" title="var">to</span> <span class="id" title="var">amount</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#build_tx"><span class="id" title="constructor">build_tx</span></a> <span class="id" title="var">origin</span> <span class="id" title="var">from</span> <span class="id" title="var">to</span> <span class="id" title="var">amount</span> <a class="idref" href="ConCert.Execution.Blockchain.html#tx_empty"><span class="id" title="constructor">tx_empty</span></a><br/>
&nbsp;&nbsp;| <a class="idref" href="ConCert.Execution.Blockchain.html#eval_deploy"><span class="id" title="constructor">eval_deploy</span></a> <span class="id" title="var">origin</span> <span class="id" title="var">from</span> <span class="id" title="var">to</span> <span class="id" title="var">amount</span> <span class="id" title="var">wc</span> <span class="id" title="var">setup</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#build_tx"><span class="id" title="constructor">build_tx</span></a> <span class="id" title="var">origin</span> <span class="id" title="var">from</span> <span class="id" title="var">to</span> <span class="id" title="var">amount</span> (<a class="idref" href="ConCert.Execution.Blockchain.html#tx_deploy"><span class="id" title="constructor">tx_deploy</span></a> <span class="id" title="var">wc</span> <span class="id" title="var">setup</span>)<br/>
&nbsp;&nbsp;| <a class="idref" href="ConCert.Execution.Blockchain.html#eval_call"><span class="id" title="constructor">eval_call</span></a> <span class="id" title="var">origin</span> <span class="id" title="var">from</span> <span class="id" title="var">to</span> <span class="id" title="var">amount</span> <span class="id" title="var">_</span> <span class="id" title="var">msg</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#build_tx"><span class="id" title="constructor">build_tx</span></a> <span class="id" title="var">origin</span> <span class="id" title="var">from</span> <span class="id" title="var">to</span> <span class="id" title="var">amount</span> (<a class="idref" href="ConCert.Execution.Blockchain.html#tx_call"><span class="id" title="constructor">tx_call</span></a> <span class="id" title="var">msg</span>)<br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Fixpoint</span> <a name="trace_txs"><span class="id" title="definition">trace_txs</span></a> {<span class="id" title="var">from</span> <span class="id" title="var">to</span> : <a class="idref" href="ConCert.Execution.Blockchain.html#ChainState"><span class="id" title="record">ChainState</span></a>} (<span class="id" title="var">trace</span> : <a class="idref" href="ConCert.Execution.Blockchain.html#ChainTrace"><span class="id" title="definition">ChainTrace</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#from"><span class="id" title="variable">from</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#to"><span class="id" title="variable">to</span></a>) : <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#list"><span class="id" title="inductive">list</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#Tx"><span class="id" title="record">Tx</span></a> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="ConCert.Execution.Blockchain.html#trace"><span class="id" title="variable">trace</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| <a class="idref" href="ConCert.Execution.ChainedList.html#snoc"><span class="id" title="constructor">snoc</span></a> <span class="id" title="var">trace'</span> <span class="id" title="var">step</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">step</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="ConCert.Execution.Blockchain.html#step_action"><span class="id" title="constructor">step_action</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="tactic">eval</span> <span class="id" title="var">_</span> =&gt; <a class="idref" href="ConCert.Execution.Blockchain.html#eval_tx"><span class="id" title="definition">eval_tx</span></a> <span class="id" title="tactic">eval</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#cbcf67aac0c2a85b8d93d37de9969adf"><span class="id" title="notation">::</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#trace_txs"><span class="id" title="definition">trace_txs</span></a> <span class="id" title="var">trace'</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">_</span> =&gt; <a class="idref" href="ConCert.Execution.Blockchain.html#trace_txs"><span class="id" title="definition">trace_txs</span></a> <span class="id" title="var">trace'</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span><br/>
&nbsp;&nbsp;| <span class="id" title="var">_</span> =&gt; <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#ae9a5e1034e143b218b09d8e454472bd"><span class="id" title="notation">[]</span></a><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a name="incoming_txs"><span class="id" title="definition">incoming_txs</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<span class="id" title="var">from</span> <span class="id" title="var">to</span> : <a class="idref" href="ConCert.Execution.Blockchain.html#ChainState"><span class="id" title="record">ChainState</span></a>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">trace</span> : <a class="idref" href="ConCert.Execution.Blockchain.html#ChainTrace"><span class="id" title="definition">ChainTrace</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#from"><span class="id" title="variable">from</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#to"><span class="id" title="variable">to</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">addr</span> : <a class="idref" href="ConCert.Execution.Blockchain.html#Address"><span class="id" title="method">Address</span></a>) : <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#list"><span class="id" title="inductive">list</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#Tx"><span class="id" title="record">Tx</span></a> :=<br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#filter"><span class="id" title="definition">filter</span></a> (<span class="id" title="keyword">fun</span> <span class="id" title="var">tx</span> =&gt; (<a class="idref" href="ConCert.Execution.Blockchain.html#tx_to"><span class="id" title="projection">tx_to</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#tx"><span class="id" title="variable">tx</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#6f617e0e5500b437e5aeb1eaa876d41f"><span class="id" title="notation">=?</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#addr"><span class="id" title="variable">addr</span></a>)%<span class="id" title="var">address</span>) (<a class="idref" href="ConCert.Execution.Blockchain.html#trace_txs"><span class="id" title="definition">trace_txs</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#trace"><span class="id" title="variable">trace</span></a>).<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a name="outgoing_txs"><span class="id" title="definition">outgoing_txs</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<span class="id" title="var">from</span> <span class="id" title="var">to</span> : <a class="idref" href="ConCert.Execution.Blockchain.html#ChainState"><span class="id" title="record">ChainState</span></a>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">trace</span> : <a class="idref" href="ConCert.Execution.Blockchain.html#ChainTrace"><span class="id" title="definition">ChainTrace</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#from"><span class="id" title="variable">from</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#to"><span class="id" title="variable">to</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">addr</span> : <a class="idref" href="ConCert.Execution.Blockchain.html#Address"><span class="id" title="method">Address</span></a>) : <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#list"><span class="id" title="inductive">list</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#Tx"><span class="id" title="record">Tx</span></a> :=<br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#filter"><span class="id" title="definition">filter</span></a> (<span class="id" title="keyword">fun</span> <span class="id" title="var">tx</span> =&gt; (<a class="idref" href="ConCert.Execution.Blockchain.html#tx_from"><span class="id" title="projection">tx_from</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#tx"><span class="id" title="variable">tx</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#6f617e0e5500b437e5aeb1eaa876d41f"><span class="id" title="notation">=?</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#addr"><span class="id" title="variable">addr</span></a>)%<span class="id" title="var">address</span>) (<a class="idref" href="ConCert.Execution.Blockchain.html#trace_txs"><span class="id" title="definition">trace_txs</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#trace"><span class="id" title="variable">trace</span></a>).<br/>

<br/>
<span class="id" title="keyword">Record</span> <a name="ContractCallInfo"><span class="id" title="record">ContractCallInfo</span></a> (<span class="id" title="var">Msg</span> : <span class="id" title="keyword">Type</span>) :=<br/>
&nbsp;&nbsp;<a name="build_call_info"><span class="id" title="constructor">build_call_info</span></a><br/>
&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a name="call_origin"><span class="id" title="projection">call_origin</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#Address"><span class="id" title="method">Address</span></a>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a name="call_from"><span class="id" title="projection">call_from</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#Address"><span class="id" title="method">Address</span></a>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a name="call_amount"><span class="id" title="projection">call_amount</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#Amount"><span class="id" title="definition">Amount</span></a>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a name="call_msg"><span class="id" title="projection">call_msg</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#option"><span class="id" title="inductive">option</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#Msg"><span class="id" title="variable">Msg</span></a>;<br/>
&nbsp;&nbsp;}.<br/>

<br/>
<span class="id" title="keyword">Global</span> <span class="id" title="var">Arguments</span> <a class="idref" href="ConCert.Execution.Blockchain.html#build_call_info"><span class="id" title="constructor">build_call_info</span></a> {<span class="id" title="var">_</span>}.<br/>
<span class="id" title="keyword">Global</span> <span class="id" title="var">Arguments</span> <a class="idref" href="ConCert.Execution.Blockchain.html#call_origin"><span class="id" title="projection">call_origin</span></a> {<span class="id" title="var">_</span>}.<br/>
<span class="id" title="keyword">Global</span> <span class="id" title="var">Arguments</span> <a class="idref" href="ConCert.Execution.Blockchain.html#call_from"><span class="id" title="projection">call_from</span></a> {<span class="id" title="var">_</span>}.<br/>
<span class="id" title="keyword">Global</span> <span class="id" title="var">Arguments</span> <a class="idref" href="ConCert.Execution.Blockchain.html#call_amount"><span class="id" title="projection">call_amount</span></a> {<span class="id" title="var">_</span>}.<br/>
<span class="id" title="keyword">Global</span> <span class="id" title="var">Arguments</span> <a class="idref" href="ConCert.Execution.Blockchain.html#call_msg"><span class="id" title="projection">call_msg</span></a> {<span class="id" title="var">_</span>}.<br/>

<br/>
<span class="id" title="keyword">Fixpoint</span> <a name="incoming_calls"><span class="id" title="definition">incoming_calls</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">Msg</span> : <span class="id" title="keyword">Type</span>) `{<a class="idref" href="ConCert.Execution.Serializable.html#Serializable"><span class="id" title="class">Serializable</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#Msg"><span class="id" title="variable">Msg</span></a>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<span class="id" title="var">from</span> <span class="id" title="var">to</span> : <a class="idref" href="ConCert.Execution.Blockchain.html#ChainState"><span class="id" title="record">ChainState</span></a>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">trace</span> : <a class="idref" href="ConCert.Execution.Blockchain.html#ChainTrace"><span class="id" title="definition">ChainTrace</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#from"><span class="id" title="variable">from</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#to"><span class="id" title="variable">to</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">caddr</span> : <a class="idref" href="ConCert.Execution.Blockchain.html#Address"><span class="id" title="method">Address</span></a>) : <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#option"><span class="id" title="inductive">option</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#list"><span class="id" title="inductive">list</span></a> (<a class="idref" href="ConCert.Execution.Blockchain.html#ContractCallInfo"><span class="id" title="record">ContractCallInfo</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#Msg"><span class="id" title="variable">Msg</span></a>)) :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="ConCert.Execution.Blockchain.html#trace"><span class="id" title="variable">trace</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| <a class="idref" href="ConCert.Execution.ChainedList.html#snoc"><span class="id" title="constructor">snoc</span></a> <span class="id" title="var">trace'</span> <span class="id" title="var">step</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">step</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="ConCert.Execution.Blockchain.html#step_action"><span class="id" title="constructor">step_action</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> (<a class="idref" href="ConCert.Execution.Blockchain.html#eval_call"><span class="id" title="constructor">eval_call</span></a> <span class="id" title="var">origin</span> <span class="id" title="var">from</span> <span class="id" title="var">to</span> <span class="id" title="var">amount</span> <span class="id" title="var">_</span> <span class="id" title="var">msg</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>) <span class="id" title="var">_</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">if</span> (<a class="idref" href="ConCert.Execution.Blockchain.html#to"><span class="id" title="variable">to</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#6f617e0e5500b437e5aeb1eaa876d41f"><span class="id" title="notation">=?</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#caddr"><span class="id" title="variable">caddr</span></a>)%<span class="id" title="var">address</span> <span class="id" title="keyword">then</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;If&nbsp;there&nbsp;is&nbsp;a&nbsp;message&nbsp;it&nbsp;should&nbsp;deserialize&nbsp;correctly,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;otherwise&nbsp;the&nbsp;entire&nbsp;operation&nbsp;returns&nbsp;None.&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Monads.html#bbeef38f67325be53cb9324ba9182131"><span class="id" title="notation">do</span></a> <span class="id" title="var">hd_msg</span> <a class="idref" href="ConCert.Execution.Monads.html#bbeef38f67325be53cb9324ba9182131"><span class="id" title="notation">&lt;-</span></a> <span class="id" title="keyword">match</span> <span class="id" title="var">msg</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <span class="id" title="var">msg</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="ConCert.Execution.Serializable.html#deserialize"><span class="id" title="method">deserialize</span></a> <span class="id" title="var">msg</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <span class="id" title="var">msg</span> =&gt; <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <span class="id" title="var">msg</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a> =&gt; <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a> =&gt; <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span><a class="idref" href="ConCert.Execution.Monads.html#bbeef38f67325be53cb9324ba9182131"><span class="id" title="notation">;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Monads.html#bbeef38f67325be53cb9324ba9182131"><span class="id" title="notation">do</span></a> <span class="id" title="var">tl</span> <a class="idref" href="ConCert.Execution.Monads.html#bbeef38f67325be53cb9324ba9182131"><span class="id" title="notation">&lt;-</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#incoming_calls"><span class="id" title="definition">incoming_calls</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#Msg"><span class="id" title="variable">Msg</span></a> <span class="id" title="var">trace'</span> <a class="idref" href="ConCert.Execution.Blockchain.html#caddr"><span class="id" title="variable">caddr</span></a><a class="idref" href="ConCert.Execution.Monads.html#bbeef38f67325be53cb9324ba9182131"><span class="id" title="notation">;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> (<a class="idref" href="ConCert.Execution.Blockchain.html#build_call_info"><span class="id" title="constructor">build_call_info</span></a> <span class="id" title="var">origin</span> <a class="idref" href="ConCert.Execution.Blockchain.html#from"><span class="id" title="variable">from</span></a> <span class="id" title="var">amount</span> <a class="idref" href="ConCert.Execution.Blockchain.html#hd_msg"><span class="id" title="variable">hd_msg</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#cbcf67aac0c2a85b8d93d37de9969adf"><span class="id" title="notation">::</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#tl"><span class="id" title="variable">tl</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">else</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#incoming_calls"><span class="id" title="definition">incoming_calls</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#Msg"><span class="id" title="variable">Msg</span></a> <span class="id" title="var">trace'</span> <a class="idref" href="ConCert.Execution.Blockchain.html#caddr"><span class="id" title="variable">caddr</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">_</span> =&gt; <a class="idref" href="ConCert.Execution.Blockchain.html#incoming_calls"><span class="id" title="definition">incoming_calls</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#Msg"><span class="id" title="variable">Msg</span></a> <span class="id" title="var">trace'</span> <a class="idref" href="ConCert.Execution.Blockchain.html#caddr"><span class="id" title="variable">caddr</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span><br/>
&nbsp;&nbsp;| <span class="id" title="var">_</span> =&gt; <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#ae9a5e1034e143b218b09d8e454472bd"><span class="id" title="notation">[]</span></a><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Record</span> <a name="DeploymentInfo"><span class="id" title="record">DeploymentInfo</span></a> (<span class="id" title="var">Setup</span> : <span class="id" title="keyword">Type</span>) :=<br/>
&nbsp;&nbsp;<a name="build_deployment_info"><span class="id" title="constructor">build_deployment_info</span></a><br/>
&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a name="deployment_origin"><span class="id" title="projection">deployment_origin</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#Address"><span class="id" title="method">Address</span></a>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a name="deployment_from"><span class="id" title="projection">deployment_from</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#Address"><span class="id" title="method">Address</span></a>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a name="deployment_amount"><span class="id" title="projection">deployment_amount</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#Amount"><span class="id" title="definition">Amount</span></a>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a name="deployment_setup"><span class="id" title="projection">deployment_setup</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#Setup"><span class="id" title="variable">Setup</span></a>;<br/>
&nbsp;&nbsp;}.<br/>

<br/>
<span class="id" title="keyword">Global</span> <span class="id" title="var">Arguments</span> <a class="idref" href="ConCert.Execution.Blockchain.html#build_deployment_info"><span class="id" title="constructor">build_deployment_info</span></a> {<span class="id" title="var">_</span>}.<br/>
<span class="id" title="keyword">Global</span> <span class="id" title="var">Arguments</span> <a class="idref" href="ConCert.Execution.Blockchain.html#deployment_origin"><span class="id" title="projection">deployment_origin</span></a> {<span class="id" title="var">_</span>}.<br/>
<span class="id" title="keyword">Global</span> <span class="id" title="var">Arguments</span> <a class="idref" href="ConCert.Execution.Blockchain.html#deployment_from"><span class="id" title="projection">deployment_from</span></a> {<span class="id" title="var">_</span>}.<br/>
<span class="id" title="keyword">Global</span> <span class="id" title="var">Arguments</span> <a class="idref" href="ConCert.Execution.Blockchain.html#deployment_amount"><span class="id" title="projection">deployment_amount</span></a> {<span class="id" title="var">_</span>}.<br/>
<span class="id" title="keyword">Global</span> <span class="id" title="var">Arguments</span> <a class="idref" href="ConCert.Execution.Blockchain.html#deployment_setup"><span class="id" title="projection">deployment_setup</span></a> {<span class="id" title="var">_</span>}.<br/>

<br/>
<span class="id" title="keyword">Fixpoint</span> <a name="deployment_info"><span class="id" title="definition">deployment_info</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">Setup</span> : <span class="id" title="keyword">Type</span>) `{<a class="idref" href="ConCert.Execution.Serializable.html#Serializable"><span class="id" title="class">Serializable</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#Setup"><span class="id" title="variable">Setup</span></a>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<span class="id" title="var">from</span> <span class="id" title="var">to</span> : <a class="idref" href="ConCert.Execution.Blockchain.html#ChainState"><span class="id" title="record">ChainState</span></a>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">trace</span> : <a class="idref" href="ConCert.Execution.Blockchain.html#ChainTrace"><span class="id" title="definition">ChainTrace</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#from"><span class="id" title="variable">from</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#to"><span class="id" title="variable">to</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">caddr</span> : <a class="idref" href="ConCert.Execution.Blockchain.html#Address"><span class="id" title="method">Address</span></a>) : <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#option"><span class="id" title="inductive">option</span></a> (<a class="idref" href="ConCert.Execution.Blockchain.html#DeploymentInfo"><span class="id" title="record">DeploymentInfo</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#Setup"><span class="id" title="variable">Setup</span></a>) :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="ConCert.Execution.Blockchain.html#trace"><span class="id" title="variable">trace</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| <a class="idref" href="ConCert.Execution.ChainedList.html#snoc"><span class="id" title="constructor">snoc</span></a> <span class="id" title="var">trace'</span> <span class="id" title="var">step</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">step</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="ConCert.Execution.Blockchain.html#step_action"><span class="id" title="constructor">step_action</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> (<a class="idref" href="ConCert.Execution.Blockchain.html#eval_deploy"><span class="id" title="constructor">eval_deploy</span></a> <span class="id" title="var">origin</span> <span class="id" title="var">from</span> <span class="id" title="var">to</span> <span class="id" title="var">amount</span> <span class="id" title="var">_</span> <span class="id" title="var">setup</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>) <span class="id" title="var">_</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">if</span> (<a class="idref" href="ConCert.Execution.Blockchain.html#to"><span class="id" title="variable">to</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#6f617e0e5500b437e5aeb1eaa876d41f"><span class="id" title="notation">=?</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#caddr"><span class="id" title="variable">caddr</span></a>)%<span class="id" title="var">address</span> <span class="id" title="keyword">then</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Monads.html#bbeef38f67325be53cb9324ba9182131"><span class="id" title="notation">do</span></a> <span class="id" title="var">setup</span> <a class="idref" href="ConCert.Execution.Monads.html#bbeef38f67325be53cb9324ba9182131"><span class="id" title="notation">&lt;-</span></a> <a class="idref" href="ConCert.Execution.Serializable.html#deserialize"><span class="id" title="method">deserialize</span></a> <span class="id" title="var">setup</span><a class="idref" href="ConCert.Execution.Monads.html#bbeef38f67325be53cb9324ba9182131"><span class="id" title="notation">;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> (<a class="idref" href="ConCert.Execution.Blockchain.html#build_deployment_info"><span class="id" title="constructor">build_deployment_info</span></a> <span class="id" title="var">origin</span> <a class="idref" href="ConCert.Execution.Blockchain.html#from"><span class="id" title="variable">from</span></a> <span class="id" title="var">amount</span> <a class="idref" href="ConCert.Execution.Blockchain.html#setup"><span class="id" title="variable">setup</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">else</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#deployment_info"><span class="id" title="definition">deployment_info</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#Setup"><span class="id" title="variable">Setup</span></a> <span class="id" title="var">trace'</span> <a class="idref" href="ConCert.Execution.Blockchain.html#caddr"><span class="id" title="variable">caddr</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">_</span> =&gt; <a class="idref" href="ConCert.Execution.Blockchain.html#deployment_info"><span class="id" title="definition">deployment_info</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#Setup"><span class="id" title="variable">Setup</span></a> <span class="id" title="var">trace'</span> <a class="idref" href="ConCert.Execution.Blockchain.html#caddr"><span class="id" title="variable">caddr</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span><br/>
&nbsp;&nbsp;| <a class="idref" href="ConCert.Execution.ChainedList.html#clnil"><span class="id" title="constructor">clnil</span></a> =&gt; <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Fixpoint</span> <a name="trace_blocks"><span class="id" title="definition">trace_blocks</span></a> {<span class="id" title="var">from</span> <span class="id" title="var">to</span> : <a class="idref" href="ConCert.Execution.Blockchain.html#ChainState"><span class="id" title="record">ChainState</span></a>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">trace</span> : <a class="idref" href="ConCert.Execution.Blockchain.html#ChainTrace"><span class="id" title="definition">ChainTrace</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#from"><span class="id" title="variable">from</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#to"><span class="id" title="variable">to</span></a>) : <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#list"><span class="id" title="inductive">list</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#BlockHeader"><span class="id" title="record">BlockHeader</span></a> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="ConCert.Execution.Blockchain.html#trace"><span class="id" title="variable">trace</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| <a class="idref" href="ConCert.Execution.ChainedList.html#snoc"><span class="id" title="constructor">snoc</span></a> <span class="id" title="var">trace'</span> <span class="id" title="var">step</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">step</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="ConCert.Execution.Blockchain.html#step_block"><span class="id" title="constructor">step_block</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">header</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">header</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#cbcf67aac0c2a85b8d93d37de9969adf"><span class="id" title="notation">::</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#trace_blocks"><span class="id" title="definition">trace_blocks</span></a> <span class="id" title="var">trace'</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">_</span> =&gt; <a class="idref" href="ConCert.Execution.Blockchain.html#trace_blocks"><span class="id" title="definition">trace_blocks</span></a> <span class="id" title="var">trace'</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span><br/>
&nbsp;&nbsp;| <a class="idref" href="ConCert.Execution.ChainedList.html#clnil"><span class="id" title="constructor">clnil</span></a> =&gt; <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#ae9a5e1034e143b218b09d8e454472bd"><span class="id" title="notation">[]</span></a><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a name="created_blocks"><span class="id" title="definition">created_blocks</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<span class="id" title="var">from</span> <span class="id" title="var">to</span> : <a class="idref" href="ConCert.Execution.Blockchain.html#ChainState"><span class="id" title="record">ChainState</span></a>} (<span class="id" title="var">trace</span> : <a class="idref" href="ConCert.Execution.Blockchain.html#ChainTrace"><span class="id" title="definition">ChainTrace</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#from"><span class="id" title="variable">from</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#to"><span class="id" title="variable">to</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">creator</span> : <a class="idref" href="ConCert.Execution.Blockchain.html#Address"><span class="id" title="method">Address</span></a>) : <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#list"><span class="id" title="inductive">list</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#BlockHeader"><span class="id" title="record">BlockHeader</span></a> :=<br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#filter"><span class="id" title="definition">filter</span></a> (<span class="id" title="keyword">fun</span> <span class="id" title="var">b</span> =&gt; (<a class="idref" href="ConCert.Execution.Blockchain.html#block_creator"><span class="id" title="projection">block_creator</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#b"><span class="id" title="variable">b</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#6f617e0e5500b437e5aeb1eaa876d41f"><span class="id" title="notation">=?</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#creator"><span class="id" title="variable">creator</span></a>)%<span class="id" title="var">address</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="ConCert.Execution.Blockchain.html#trace_blocks"><span class="id" title="definition">trace_blocks</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#trace"><span class="id" title="variable">trace</span></a>).<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a name="is_deploy"><span class="id" title="definition">is_deploy</span></a> (<span class="id" title="var">ac</span> : <a class="idref" href="ConCert.Execution.Blockchain.html#ActionBody"><span class="id" title="inductive">ActionBody</span></a>) : <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#bool"><span class="id" title="inductive">bool</span></a> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="ConCert.Execution.Blockchain.html#ac"><span class="id" title="variable">ac</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| <a class="idref" href="ConCert.Execution.Blockchain.html#act_transfer"><span class="id" title="constructor">act_transfer</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> =&gt; <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#false"><span class="id" title="constructor">false</span></a><br/>
&nbsp;&nbsp;| <a class="idref" href="ConCert.Execution.Blockchain.html#act_call"><span class="id" title="constructor">act_call</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> =&gt; <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#false"><span class="id" title="constructor">false</span></a><br/>
&nbsp;&nbsp;| <a class="idref" href="ConCert.Execution.Blockchain.html#act_deploy"><span class="id" title="constructor">act_deploy</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> =&gt; <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#true"><span class="id" title="constructor">true</span></a><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a name="is_call"><span class="id" title="definition">is_call</span></a> (<span class="id" title="var">ac</span> : <a class="idref" href="ConCert.Execution.Blockchain.html#ActionBody"><span class="id" title="inductive">ActionBody</span></a>) : <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#bool"><span class="id" title="inductive">bool</span></a> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="ConCert.Execution.Blockchain.html#ac"><span class="id" title="variable">ac</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| <a class="idref" href="ConCert.Execution.Blockchain.html#act_transfer"><span class="id" title="constructor">act_transfer</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> =&gt; <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#false"><span class="id" title="constructor">false</span></a><br/>
&nbsp;&nbsp;| <a class="idref" href="ConCert.Execution.Blockchain.html#act_call"><span class="id" title="constructor">act_call</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> =&gt; <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#true"><span class="id" title="constructor">true</span></a><br/>
&nbsp;&nbsp;| <a class="idref" href="ConCert.Execution.Blockchain.html#act_deploy"><span class="id" title="constructor">act_deploy</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> =&gt; <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#false"><span class="id" title="constructor">false</span></a><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a name="is_transfer"><span class="id" title="definition">is_transfer</span></a> (<span class="id" title="var">ac</span> : <a class="idref" href="ConCert.Execution.Blockchain.html#ActionBody"><span class="id" title="inductive">ActionBody</span></a>) : <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#bool"><span class="id" title="inductive">bool</span></a> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="ConCert.Execution.Blockchain.html#ac"><span class="id" title="variable">ac</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| <a class="idref" href="ConCert.Execution.Blockchain.html#act_transfer"><span class="id" title="constructor">act_transfer</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> =&gt; <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#true"><span class="id" title="constructor">true</span></a><br/>
&nbsp;&nbsp;| <a class="idref" href="ConCert.Execution.Blockchain.html#act_call"><span class="id" title="constructor">act_call</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> =&gt; <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#false"><span class="id" title="constructor">false</span></a><br/>
&nbsp;&nbsp;| <a class="idref" href="ConCert.Execution.Blockchain.html#act_deploy"><span class="id" title="constructor">act_deploy</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> =&gt; <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#false"><span class="id" title="constructor">false</span></a><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Section</span> <a name="Blockchain.Semantics.Trace.Theories"><span class="id" title="section">Theories</span></a>.<br/>
<span class="id" title="keyword">Ltac</span> <span class="id" title="var">destruct_chain_step</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| [<span class="id" title="var">step</span>: <a class="idref" href="ConCert.Execution.Blockchain.html#ChainStep"><span class="id" title="inductive">ChainStep</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> |- <span class="id" title="var">_</span>] =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">step</span> <span class="id" title="keyword">as</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[<span class="id" title="var">header</span> <span class="id" title="var">queue_prev</span> <span class="id" title="var">valid_header</span> <span class="id" title="var">acts_from_accs</span> <span class="id" title="var">origin_correct</span> <span class="id" title="var">env_eq</span>|<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">act</span> <span class="id" title="var">acts</span> <span class="id" title="var">new_acts</span> <span class="id" title="var">queue_prev</span> <span class="id" title="tactic">eval</span> <span class="id" title="var">queue_new</span>|<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">act</span> <span class="id" title="var">acts</span> <span class="id" title="var">env_eq</span> <span class="id" title="var">queue_prev</span> <span class="id" title="var">queue_new</span> <span class="id" title="var">act_from_acc</span> <span class="id" title="var">no_eval</span>|<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">env_eq</span> <span class="id" title="var">perm</span>]<br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Ltac</span> <span class="id" title="var">destruct_action_eval</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| [<span class="id" title="tactic">eval</span>: <a class="idref" href="ConCert.Execution.Blockchain.html#ActionEvaluation"><span class="id" title="inductive">ActionEvaluation</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> |- <span class="id" title="var">_</span>] =&gt; <span class="id" title="tactic">destruct</span> <span class="id" title="tactic">eval</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a name="contract_addr_format"><span class="id" title="lemma">contract_addr_format</span></a> {<span class="id" title="var">to</span>} (<span class="id" title="var">addr</span> : <a class="idref" href="ConCert.Execution.Blockchain.html#Address"><span class="id" title="method">Address</span></a>) (<span class="id" title="var">wc</span> : <a class="idref" href="ConCert.Execution.Blockchain.html#WeakContract"><span class="id" title="inductive">WeakContract</span></a>) :<br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#reachable"><span class="id" title="definition">reachable</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#to"><span class="id" title="variable">to</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#env_contracts"><span class="id" title="projection">env_contracts</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#to"><span class="id" title="variable">to</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#addr"><span class="id" title="variable">addr</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#wc"><span class="id" title="variable">wc</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#address_is_contract"><span class="id" title="method">address_is_contract</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#addr"><span class="id" title="variable">addr</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#true"><span class="id" title="constructor">true</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> [<span class="id" title="var">trace</span>] <span class="id" title="var">contract_at_addr</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">remember</span> <a class="idref" href="ConCert.Execution.Blockchain.html#empty_state"><span class="id" title="definition">empty_state</span></a> <span class="id" title="var">eqn</span>:<span class="id" title="var">eq</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">trace</span>; <span class="id" title="tactic">rewrite</span> <span class="id" title="var">eq</span> <span class="id" title="tactic">in</span> *; <span class="id" title="tactic">clear</span> <span class="id" title="var">eq</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *; <span class="id" title="tactic">congruence</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">destruct_chain_step</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">try</span> <span class="id" title="var">now</span> <span class="id" title="var">rewrite_environment_equiv</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">destruct_action_eval</span>; <span class="id" title="var">rewrite_environment_equiv</span>; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *; <span class="id" title="var">destruct_address_eq</span>; <span class="id" title="tactic">subst</span>; <span class="id" title="tactic">auto</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a name="new_acts_no_out_queue"><span class="id" title="lemma">new_acts_no_out_queue</span></a> <span class="id" title="var">orig</span> <span class="id" title="var">addr1</span> <span class="id" title="var">addr2</span> <span class="id" title="var">new_acts</span> <span class="id" title="var">resp_acts</span> :<br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#addr1"><span class="id" title="variable">addr1</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#a0a5068f83a704fcfbda8cd473a6cfea"><span class="id" title="notation">&lt;&gt;</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#addr2"><span class="id" title="variable">addr2</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#new_acts"><span class="id" title="variable">new_acts</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#map"><span class="id" title="definition">map</span></a> (<a class="idref" href="ConCert.Execution.Blockchain.html#build_act"><span class="id" title="constructor">build_act</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#orig"><span class="id" title="variable">orig</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#addr2"><span class="id" title="variable">addr2</span></a>) <a class="idref" href="ConCert.Execution.Blockchain.html#resp_acts"><span class="id" title="variable">resp_acts</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#Forall"><span class="id" title="inductive">Forall</span></a> (<span class="id" title="keyword">fun</span> <span class="id" title="var">a</span> =&gt; (<a class="idref" href="ConCert.Execution.Blockchain.html#act_from"><span class="id" title="projection">act_from</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#a"><span class="id" title="variable">a</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#6f617e0e5500b437e5aeb1eaa876d41f"><span class="id" title="notation">=?</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#addr1"><span class="id" title="variable">addr1</span></a>)%<span class="id" title="var">address</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#false"><span class="id" title="constructor">false</span></a>) <a class="idref" href="ConCert.Execution.Blockchain.html#new_acts"><span class="id" title="variable">new_acts</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">neq</span> ?; <span class="id" title="tactic">subst</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">resp_acts</span>; <span class="id" title="var">cbn</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">constructor</span>; <span class="id" title="var">destruct_address_eq</span>; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *; <span class="id" title="tactic">congruence</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a name="outgoing_acts_after_block_nil"><span class="id" title="lemma">outgoing_acts_after_block_nil</span></a> <span class="id" title="var">bstate</span> <span class="id" title="var">addr</span> :<br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#Forall"><span class="id" title="inductive">Forall</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#act_is_from_account"><span class="id" title="definition">act_is_from_account</span></a> (<a class="idref" href="ConCert.Execution.Blockchain.html#chain_state_queue"><span class="id" title="projection">chain_state_queue</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#bstate"><span class="id" title="variable">bstate</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#address_is_contract"><span class="id" title="method">address_is_contract</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#addr"><span class="id" title="variable">addr</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#true"><span class="id" title="constructor">true</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#outgoing_acts"><span class="id" title="definition">outgoing_acts</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#bstate"><span class="id" title="variable">bstate</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#addr"><span class="id" title="variable">addr</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#ae9a5e1034e143b218b09d8e454472bd"><span class="id" title="notation">[]</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">all</span> <span class="id" title="var">is_contract</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="ConCert.Execution.Blockchain.html#outgoing_acts"><span class="id" title="definition">outgoing_acts</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> (<a class="idref" href="ConCert.Execution.Blockchain.html#chain_state_queue"><span class="id" title="projection">chain_state_queue</span></a> <span class="id" title="var">bstate</span>); <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">inversion_clear</span> <span class="id" title="var">all</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">destruct_address_eq</span>; <span class="id" title="tactic">subst</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="ConCert.Execution.Blockchain.html#act_is_from_account"><span class="id" title="definition">act_is_from_account</span></a> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">congruence</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a name="outgoing_acts_after_deploy_nil"><span class="id" title="lemma">outgoing_acts_after_deploy_nil</span></a> <span class="id" title="var">bstate</span> <span class="id" title="var">addr</span> :<br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#Forall"><span class="id" title="inductive">Forall</span></a> (<span class="id" title="keyword">fun</span> <span class="id" title="var">act</span> =&gt; (<a class="idref" href="ConCert.Execution.Blockchain.html#act_from"><span class="id" title="projection">act_from</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#act"><span class="id" title="variable">act</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#6f617e0e5500b437e5aeb1eaa876d41f"><span class="id" title="notation">=?</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#addr"><span class="id" title="variable">addr</span></a>)%<span class="id" title="var">address</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#false"><span class="id" title="constructor">false</span></a>) (<a class="idref" href="ConCert.Execution.Blockchain.html#chain_state_queue"><span class="id" title="projection">chain_state_queue</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#bstate"><span class="id" title="variable">bstate</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#outgoing_acts"><span class="id" title="definition">outgoing_acts</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#bstate"><span class="id" title="variable">bstate</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#addr"><span class="id" title="variable">addr</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#ae9a5e1034e143b218b09d8e454472bd"><span class="id" title="notation">[]</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">all</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="ConCert.Execution.Blockchain.html#outgoing_acts"><span class="id" title="definition">outgoing_acts</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> (<a class="idref" href="ConCert.Execution.Blockchain.html#chain_state_queue"><span class="id" title="projection">chain_state_queue</span></a> <span class="id" title="var">bstate</span>) <span class="id" title="keyword">as</span> [|<span class="id" title="var">hd</span> <span class="id" title="var">tl</span> <span class="id" title="var">IH</span>]; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">inversion_clear</span> <span class="id" title="var">all</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">H</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">auto</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Local Open</span> <span class="id" title="keyword">Scope</span> <span class="id" title="var">address</span>.<br/>
<span class="comment">(*&nbsp;This&nbsp;next&nbsp;lemma&nbsp;shows&nbsp;that&nbsp;any&nbsp;for&nbsp;a&nbsp;full&nbsp;chain&nbsp;trace,<br/>
the&nbsp;ending&nbsp;state&nbsp;will&nbsp;not&nbsp;have&nbsp;any&nbsp;queued&nbsp;actions&nbsp;from<br/>
undeployed&nbsp;contracts.&nbsp;*)</span><br/>
<span class="id" title="keyword">Lemma</span> <a name="undeployed_contract_no_out_queue"><span class="id" title="lemma">undeployed_contract_no_out_queue</span></a> <span class="id" title="var">contract</span> <span class="id" title="var">state</span> :<br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#reachable"><span class="id" title="definition">reachable</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#state"><span class="id" title="variable">state</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#address_is_contract"><span class="id" title="method">address_is_contract</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#contract"><span class="id" title="variable">contract</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#true"><span class="id" title="constructor">true</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#env_contracts"><span class="id" title="projection">env_contracts</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#state"><span class="id" title="variable">state</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#contract"><span class="id" title="variable">contract</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#Forall"><span class="id" title="inductive">Forall</span></a> (<span class="id" title="keyword">fun</span> <span class="id" title="var">act</span> =&gt; <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Execution.Blockchain.html#act_from"><span class="id" title="projection">act_from</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#act"><span class="id" title="variable">act</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#6f617e0e5500b437e5aeb1eaa876d41f"><span class="id" title="notation">=?</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#contract"><span class="id" title="variable">contract</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#false"><span class="id" title="constructor">false</span></a>) (<a class="idref" href="ConCert.Execution.Blockchain.html#chain_state_queue"><span class="id" title="projection">chain_state_queue</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#state"><span class="id" title="variable">state</span></a>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> [<span class="id" title="var">trace</span>] <span class="id" title="var">is_contract</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">remember</span> <a class="idref" href="ConCert.Execution.Blockchain.html#empty_state"><span class="id" title="definition">empty_state</span></a> <span class="id" title="var">eqn</span>:<span class="id" title="var">eq</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">trace</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">undeployed</span>; <span class="id" title="tactic">rewrite</span> <span class="id" title="var">eq</span> <span class="id" title="tactic">in</span> *; <span class="id" title="tactic">clear</span> <span class="id" title="var">eq</span>; <span class="id" title="var">cbn</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">destruct_chain_step</span>; [|<span class="id" title="var">destruct_action_eval</span>| |];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">try</span> <span class="id" title="var">rewrite_environment_equiv</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">repeat</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| [<span class="id" title="var">H</span>: <a class="idref" href="ConCert.Execution.Blockchain.html#chain_state_queue"><span class="id" title="projection">chain_state_queue</span></a> <span class="id" title="var">_</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <span class="id" title="var">_</span> |- <span class="id" title="var">_</span>] =&gt; <span class="id" title="tactic">rewrite</span> <span class="id" title="var">H</span> <span class="id" title="tactic">in</span> *; <span class="id" title="tactic">clear</span> <span class="id" title="var">H</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">subst</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;- <span class="comment">(*&nbsp;New&nbsp;block&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| [<span class="id" title="var">H</span>: <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#Forall"><span class="id" title="inductive">Forall</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#act_is_from_account"><span class="id" title="definition">act_is_from_account</span></a> <span class="id" title="var">_</span> |- <span class="id" title="var">_</span>] =&gt; <span class="id" title="tactic">induction</span> <span class="id" title="var">H</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| [<span class="id" title="var">H</span>: <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#Forall"><span class="id" title="inductive">Forall</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#act_origin_is_eq_from"><span class="id" title="definition">act_origin_is_eq_from</span></a> <span class="id" title="var">_</span> |- <span class="id" title="var">_</span>] =&gt; <span class="id" title="tactic">inversion</span> <span class="id" title="var">H</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>; <span class="id" title="tactic">constructor</span>; <span class="id" title="tactic">auto</span>; <span class="id" title="var">destruct_address_eq</span>; <span class="id" title="tactic">congruence</span>.<br/>
&nbsp;&nbsp;- <span class="comment">(*&nbsp;Transfer&nbsp;step,&nbsp;just&nbsp;use&nbsp;IH&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <span class="id" title="lemma">list.Forall_cons</span>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;- <span class="comment">(*&nbsp;Deploy&nbsp;step.&nbsp;First&nbsp;show&nbsp;that&nbsp;it&nbsp;is&nbsp;not&nbsp;to&nbsp;contract&nbsp;and&nbsp;then&nbsp;use&nbsp;IH.&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">destruct_address_eq</span>; <span class="id" title="tactic">try</span> <span class="id" title="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <span class="id" title="lemma">list.Forall_cons</span>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;- <span class="comment">(*&nbsp;Call.&nbsp;Show&nbsp;that&nbsp;it&nbsp;holds&nbsp;for&nbsp;new&nbsp;actions&nbsp;as&nbsp;it&nbsp;is&nbsp;from&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;another&nbsp;contract,&nbsp;and&nbsp;use&nbsp;IH&nbsp;for&nbsp;remaining.&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="lemma">list.Forall_app</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">contract</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#a0a5068f83a704fcfbda8cd473a6cfea"><span class="id" title="notation">&lt;&gt;</span></a> <span class="id" title="var">to_addr</span>) <span class="id" title="tactic">by</span> <span class="id" title="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>; [<span class="id" title="tactic">eapply</span> <a class="idref" href="ConCert.Execution.Blockchain.html#new_acts_no_out_queue"><span class="id" title="lemma">new_acts_no_out_queue</span></a>|<span class="id" title="tactic">eapply</span> <span class="id" title="lemma">list.Forall_cons</span>]; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;- <span class="comment">(*&nbsp;Invalid&nbsp;User&nbsp;Action&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#Forall_inv_tail"><span class="id" title="lemma">Forall_inv_tail</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">IHtrace</span>.<br/>
&nbsp;&nbsp;- <span class="comment">(*&nbsp;Permutation&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">specialize_hypotheses</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="var">perm</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Local Hint Resolve</span> <span class="id" title="var">contracts_post_pre_none</span> : <span class="id" title="var">core</span>.<br/>
<span class="id" title="keyword">Local Hint Unfold</span> <a class="idref" href="ConCert.Execution.Blockchain.html#reachable"><span class="id" title="definition">reachable</span></a> : <span class="id" title="var">core</span>.<br/>

<br/>
<span class="comment">(*&nbsp;With&nbsp;this&nbsp;lemma&nbsp;proven,&nbsp;we&nbsp;can&nbsp;show&nbsp;that&nbsp;the&nbsp;(perhaps&nbsp;seemingly&nbsp;stronger)<br/>
fact,&nbsp;that&nbsp;an&nbsp;undeployed&nbsp;contract&nbsp;has&nbsp;no&nbsp;outgoing&nbsp;txs,&nbsp;holds.&nbsp;*)</span><br/>
<span class="id" title="keyword">Lemma</span> <a name="undeployed_contract_no_out_txs"><span class="id" title="lemma">undeployed_contract_no_out_txs</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">contract</span> <span class="id" title="var">state</span> (<span class="id" title="var">trace</span> : <a class="idref" href="ConCert.Execution.Blockchain.html#ChainTrace"><span class="id" title="definition">ChainTrace</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#empty_state"><span class="id" title="definition">empty_state</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#state"><span class="id" title="variable">state</span></a>) :<br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#address_is_contract"><span class="id" title="method">address_is_contract</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#contract"><span class="id" title="variable">contract</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#true"><span class="id" title="constructor">true</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#env_contracts"><span class="id" title="projection">env_contracts</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#state"><span class="id" title="variable">state</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#contract"><span class="id" title="variable">contract</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#outgoing_txs"><span class="id" title="definition">outgoing_txs</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#trace"><span class="id" title="variable">trace</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#contract"><span class="id" title="variable">contract</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#ae9a5e1034e143b218b09d8e454472bd"><span class="id" title="notation">[]</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">is_contract</span> <span class="id" title="var">undeployed</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">remember</span> <a class="idref" href="ConCert.Execution.Blockchain.html#empty_state"><span class="id" title="definition">empty_state</span></a>; <span class="id" title="tactic">induction</span> <span class="id" title="var">trace</span>; <span class="id" title="tactic">subst</span>; <span class="id" title="var">cbn</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">destruct_chain_step</span>; <span class="id" title="tactic">try</span> <span class="id" title="var">now</span> <span class="id" title="var">rewrite_environment_equiv</span>.<br/>
&nbsp;&nbsp;- <span class="comment">(*&nbsp;In&nbsp;these&nbsp;steps&nbsp;we&nbsp;will&nbsp;use&nbsp;that&nbsp;the&nbsp;queue&nbsp;did&nbsp;not&nbsp;contain&nbsp;txs&nbsp;to&nbsp;the&nbsp;contract.&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">pose</span> <span class="id" title="var">proof</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="ConCert.Execution.Blockchain.html#undeployed_contract_no_out_queue"><span class="id" title="lemma">undeployed_contract_no_out_queue</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">contract</span> <span class="id" title="var">mid</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">ltac</span>:(<span class="id" title="tactic">auto</span>) <span class="id" title="keyword">ltac</span>:(<span class="id" title="tactic">auto</span>) <span class="id" title="keyword">ltac</span>:(<span class="id" title="tactic">eauto</span>)) <span class="id" title="keyword">as</span> <span class="id" title="var">Hqueue</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">repeat</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| [<span class="id" title="var">H</span>: <a class="idref" href="ConCert.Execution.Blockchain.html#chain_state_queue"><span class="id" title="projection">chain_state_queue</span></a> <span class="id" title="var">_</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <span class="id" title="var">_</span> |- <span class="id" title="var">_</span>] =&gt; <span class="id" title="tactic">rewrite</span> <span class="id" title="var">H</span> <span class="id" title="tactic">in</span> *; <span class="id" title="tactic">clear</span> <span class="id" title="var">H</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">inversion_clear</span> <span class="id" title="var">Hqueue</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">act</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">destruct_action_eval</span>; <span class="id" title="var">rewrite_environment_equiv</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">subst</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">destruct_address_eq</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">try</span> <span class="id" title="tactic">tauto</span>; <span class="id" title="tactic">try</span> <span class="id" title="tactic">congruence</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a name="undeployed_contract_no_in_txs"><span class="id" title="lemma">undeployed_contract_no_in_txs</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">contract</span> <span class="id" title="var">state</span> (<span class="id" title="var">trace</span> : <a class="idref" href="ConCert.Execution.Blockchain.html#ChainTrace"><span class="id" title="definition">ChainTrace</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#empty_state"><span class="id" title="definition">empty_state</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#state"><span class="id" title="variable">state</span></a>) :<br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#address_is_contract"><span class="id" title="method">address_is_contract</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#contract"><span class="id" title="variable">contract</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#true"><span class="id" title="constructor">true</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#env_contracts"><span class="id" title="projection">env_contracts</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#state"><span class="id" title="variable">state</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#contract"><span class="id" title="variable">contract</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#incoming_txs"><span class="id" title="definition">incoming_txs</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#trace"><span class="id" title="variable">trace</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#contract"><span class="id" title="variable">contract</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#ae9a5e1034e143b218b09d8e454472bd"><span class="id" title="notation">[]</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">is_contract</span> <span class="id" title="var">undeployed</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">remember</span> <a class="idref" href="ConCert.Execution.Blockchain.html#empty_state"><span class="id" title="definition">empty_state</span></a>; <span class="id" title="tactic">induction</span> <span class="id" title="var">trace</span>; <span class="id" title="tactic">subst</span>; <span class="id" title="var">cbn</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">destruct_chain_step</span>; <span class="id" title="tactic">try</span> <span class="id" title="var">now</span> <span class="id" title="var">rewrite_environment_equiv</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">destruct_action_eval</span>; <span class="id" title="var">rewrite_environment_equiv</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">destruct_address_eq</span>; <span class="id" title="tactic">auto</span>; <span class="id" title="tactic">subst</span>; <span class="id" title="tactic">congruence</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a name="deployment_info_some"><span class="id" title="lemma">deployment_info_some</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Setup</span> `{<a class="idref" href="ConCert.Execution.Serializable.html#Serializable"><span class="id" title="class">Serializable</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#Setup"><span class="id" title="variable">Setup</span></a>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<span class="id" title="var">to</span>} (<span class="id" title="var">trace</span> : <a class="idref" href="ConCert.Execution.Blockchain.html#ChainTrace"><span class="id" title="definition">ChainTrace</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#empty_state"><span class="id" title="definition">empty_state</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#to"><span class="id" title="variable">to</span></a>) <span class="id" title="var">caddr</span> :<br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#deployment_info"><span class="id" title="definition">deployment_info</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#Setup"><span class="id" title="variable">Setup</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#trace"><span class="id" title="variable">trace</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#caddr"><span class="id" title="variable">caddr</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#a0a5068f83a704fcfbda8cd473a6cfea"><span class="id" title="notation">&lt;&gt;</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#env_contracts"><span class="id" title="projection">env_contracts</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#to"><span class="id" title="variable">to</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#caddr"><span class="id" title="variable">caddr</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#a0a5068f83a704fcfbda8cd473a6cfea"><span class="id" title="notation">&lt;&gt;</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">remember</span> <a class="idref" href="ConCert.Execution.Blockchain.html#empty_state"><span class="id" title="definition">empty_state</span></a>; <span class="id" title="tactic">induction</span> <span class="id" title="var">trace</span> <span class="id" title="keyword">as</span> [|? ? ? ? <span class="id" title="var">IH</span>]; <span class="id" title="tactic">subst</span>; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *; <span class="id" title="tactic">try</span> <span class="id" title="tactic">tauto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">destruct_chain_step</span>; <span class="id" title="tactic">try</span> <span class="id" title="var">now</span> <span class="id" title="var">rewrite_environment_equiv</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">destruct_action_eval</span>; <span class="id" title="var">rewrite_environment_equiv</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;Deploy&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> (<a class="idref" href="ConCert.Execution.Blockchain.html#address_eq_sym"><span class="id" title="lemma">address_eq_sym</span></a> <span class="id" title="var">caddr</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">destruct_address_eq</span>; <span class="id" title="tactic">try</span> <span class="id" title="tactic">discriminate</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">auto</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a name="deployment_info_addr_format"><span class="id" title="lemma">deployment_info_addr_format</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Setup</span> `{<a class="idref" href="ConCert.Execution.Serializable.html#Serializable"><span class="id" title="class">Serializable</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#Setup"><span class="id" title="variable">Setup</span></a>} {<span class="id" title="var">to</span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">trace</span> : <a class="idref" href="ConCert.Execution.Blockchain.html#ChainTrace"><span class="id" title="definition">ChainTrace</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#empty_state"><span class="id" title="definition">empty_state</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#to"><span class="id" title="variable">to</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">caddr</span> :<br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#deployment_info"><span class="id" title="definition">deployment_info</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#Setup"><span class="id" title="variable">Setup</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#trace"><span class="id" title="variable">trace</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#caddr"><span class="id" title="variable">caddr</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#a0a5068f83a704fcfbda8cd473a6cfea"><span class="id" title="notation">&lt;&gt;</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#address_is_contract"><span class="id" title="method">address_is_contract</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#caddr"><span class="id" title="variable">caddr</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#true"><span class="id" title="constructor">true</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">has_deployment_info</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">pose</span> <span class="id" title="var">proof</span> (<a class="idref" href="ConCert.Execution.Blockchain.html#deployment_info_some"><span class="id" title="lemma">deployment_info_some</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">has_deployment_info</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<a class="idref" href="ConCert.Execution.Blockchain.html#env_contracts"><span class="id" title="projection">env_contracts</span></a> <span class="id" title="var">to</span> <span class="id" title="var">caddr</span>) <span class="id" title="keyword">as</span> [<span class="id" title="var">wc</span>|] <span class="id" title="var">eqn</span>:?; <span class="id" title="tactic">try</span> <span class="id" title="tactic">congruence</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="ConCert.Execution.Blockchain.html#contract_addr_format"><span class="id" title="lemma">contract_addr_format</span></a>; <span class="id" title="tactic">eauto</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a name="incoming_txs_contract"><span class="id" title="lemma">incoming_txs_contract</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">caddr</span> <span class="id" title="var">bstate</span> (<span class="id" title="var">trace</span> : <a class="idref" href="ConCert.Execution.Blockchain.html#ChainTrace"><span class="id" title="definition">ChainTrace</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#empty_state"><span class="id" title="definition">empty_state</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#bstate"><span class="id" title="variable">bstate</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Setup</span> `{<a class="idref" href="ConCert.Execution.Serializable.html#Serializable"><span class="id" title="class">Serializable</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#Setup"><span class="id" title="variable">Setup</span></a>} (<span class="id" title="var">depinfo</span> : <a class="idref" href="ConCert.Execution.Blockchain.html#DeploymentInfo"><span class="id" title="record">DeploymentInfo</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#Setup"><span class="id" title="variable">Setup</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Msg</span> `{<a class="idref" href="ConCert.Execution.Serializable.html#Serializable"><span class="id" title="class">Serializable</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#Msg"><span class="id" title="variable">Msg</span></a>} (<span class="id" title="var">msgs</span> : <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#list"><span class="id" title="inductive">list</span></a> (<a class="idref" href="ConCert.Execution.Blockchain.html#ContractCallInfo"><span class="id" title="record">ContractCallInfo</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#Msg"><span class="id" title="variable">Msg</span></a>)) :<br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#deployment_info"><span class="id" title="definition">deployment_info</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#Setup"><span class="id" title="variable">Setup</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#trace"><span class="id" title="variable">trace</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#caddr"><span class="id" title="variable">caddr</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#depinfo"><span class="id" title="variable">depinfo</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#incoming_calls"><span class="id" title="definition">incoming_calls</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#Msg"><span class="id" title="variable">Msg</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#trace"><span class="id" title="variable">trace</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#caddr"><span class="id" title="variable">caddr</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#msgs"><span class="id" title="variable">msgs</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#map"><span class="id" title="definition">map</span></a> (<span class="id" title="keyword">fun</span> <span class="id" title="var">tx</span> =&gt; <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Execution.Blockchain.html#tx_from"><span class="id" title="projection">tx_from</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#tx"><span class="id" title="variable">tx</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#tx_to"><span class="id" title="projection">tx_to</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#tx"><span class="id" title="variable">tx</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#tx_amount"><span class="id" title="projection">tx_amount</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#tx"><span class="id" title="variable">tx</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a>) (<a class="idref" href="ConCert.Execution.Blockchain.html#incoming_txs"><span class="id" title="definition">incoming_txs</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#trace"><span class="id" title="variable">trace</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#caddr"><span class="id" title="variable">caddr</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#map"><span class="id" title="definition">map</span></a> (<span class="id" title="keyword">fun</span> <span class="id" title="var">call</span> =&gt; <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Execution.Blockchain.html#call_from"><span class="id" title="projection">call_from</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#call"><span class="id" title="variable">call</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#caddr"><span class="id" title="variable">caddr</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#call_amount"><span class="id" title="projection">call_amount</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#call"><span class="id" title="variable">call</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a>) <a class="idref" href="ConCert.Execution.Blockchain.html#msgs"><span class="id" title="variable">msgs</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#bc347c51eaf667706ae54503b26d52c6"><span class="id" title="notation">++</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#ddd65c2f7ee73ecec433744948d846bb"><span class="id" title="notation">[</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Execution.Blockchain.html#deployment_from"><span class="id" title="projection">deployment_from</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#depinfo"><span class="id" title="variable">depinfo</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#caddr"><span class="id" title="variable">caddr</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#deployment_amount"><span class="id" title="projection">deployment_amount</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#depinfo"><span class="id" title="variable">depinfo</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#ddd65c2f7ee73ecec433744948d846bb"><span class="id" title="notation">]</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">depinfo_eq</span> <span class="id" title="var">calls_eq</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">enough</span> (<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Execution.Blockchain.html#env_contracts"><span class="id" title="projection">env_contracts</span></a> <span class="id" title="var">bstate</span> <span class="id" title="var">caddr</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#incoming_txs"><span class="id" title="definition">incoming_txs</span></a> <span class="id" title="var">trace</span> <span class="id" title="var">caddr</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#ae9a5e1034e143b218b09d8e454472bd"><span class="id" title="notation">[]</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">/\</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#deployment_info"><span class="id" title="definition">deployment_info</span></a> <span class="id" title="var">Setup</span> <span class="id" title="var">trace</span> <span class="id" title="var">caddr</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">/\</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#incoming_calls"><span class="id" title="definition">incoming_calls</span></a> <span class="id" title="var">Msg</span> <span class="id" title="var">trace</span> <span class="id" title="var">caddr</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#ae9a5e1034e143b218b09d8e454472bd"><span class="id" title="notation">[]</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">/\</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Execution.Blockchain.html#env_contracts"><span class="id" title="projection">env_contracts</span></a> <span class="id" title="var">bstate</span> <span class="id" title="var">caddr</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#a0a5068f83a704fcfbda8cd473a6cfea"><span class="id" title="notation">&lt;&gt;</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#deployment_info"><span class="id" title="definition">deployment_info</span></a> <span class="id" title="var">Setup</span> <span class="id" title="var">trace</span> <span class="id" title="var">caddr</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#a0a5068f83a704fcfbda8cd473a6cfea"><span class="id" title="notation">&lt;&gt;</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#incoming_calls"><span class="id" title="definition">incoming_calls</span></a> <span class="id" title="var">Msg</span> <span class="id" title="var">trace</span> <span class="id" title="var">caddr</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#a0a5068f83a704fcfbda8cd473a6cfea"><span class="id" title="notation">&lt;&gt;</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">exists</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">(</span></a><span class="id" title="var">depinfo</span> : <a class="idref" href="ConCert.Execution.Blockchain.html#DeploymentInfo"><span class="id" title="record">DeploymentInfo</span></a> <span class="id" title="var">Setup</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">inc_calls</span> : <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#list"><span class="id" title="inductive">list</span></a> (<a class="idref" href="ConCert.Execution.Blockchain.html#ContractCallInfo"><span class="id" title="record">ContractCallInfo</span></a> <span class="id" title="var">Msg</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">call_txs</span> : <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#list"><span class="id" title="inductive">list</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#Tx"><span class="id" title="record">Tx</span></a>) (<span class="id" title="var">dep_tx</span> : <a class="idref" href="ConCert.Execution.Blockchain.html#Tx"><span class="id" title="record">Tx</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">),</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#deployment_info"><span class="id" title="definition">deployment_info</span></a> <span class="id" title="var">Setup</span> <span class="id" title="var">trace</span> <span class="id" title="var">caddr</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#depinfo"><span class="id" title="variable">depinfo</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">/\</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#incoming_calls"><span class="id" title="definition">incoming_calls</span></a> <span class="id" title="var">Msg</span> <span class="id" title="var">trace</span> <span class="id" title="var">caddr</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#inc_calls"><span class="id" title="variable">inc_calls</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">/\</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#incoming_txs"><span class="id" title="definition">incoming_txs</span></a> <span class="id" title="var">trace</span> <span class="id" title="var">caddr</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#call_txs"><span class="id" title="variable">call_txs</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#bc347c51eaf667706ae54503b26d52c6"><span class="id" title="notation">++</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#ddd65c2f7ee73ecec433744948d846bb"><span class="id" title="notation">[</span></a><a class="idref" href="ConCert.Execution.Blockchain.html#dep_tx"><span class="id" title="variable">dep_tx</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#ddd65c2f7ee73ecec433744948d846bb"><span class="id" title="notation">]</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">/\</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#map"><span class="id" title="definition">map</span></a> (<span class="id" title="keyword">fun</span> <span class="id" title="var">tx</span> =&gt; <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Execution.Blockchain.html#tx_from"><span class="id" title="projection">tx_from</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#tx"><span class="id" title="variable">tx</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#tx_to"><span class="id" title="projection">tx_to</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#tx"><span class="id" title="variable">tx</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#tx_amount"><span class="id" title="projection">tx_amount</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#tx"><span class="id" title="variable">tx</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a>) <a class="idref" href="ConCert.Execution.Blockchain.html#call_txs"><span class="id" title="variable">call_txs</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#map"><span class="id" title="definition">map</span></a> (<span class="id" title="keyword">fun</span> <span class="id" title="var">call</span> =&gt; <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Execution.Blockchain.html#call_from"><span class="id" title="projection">call_from</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#call"><span class="id" title="variable">call</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <span class="id" title="var">caddr</span><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#call_amount"><span class="id" title="projection">call_amount</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#call"><span class="id" title="variable">call</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a>) <a class="idref" href="ConCert.Execution.Blockchain.html#inc_calls"><span class="id" title="variable">inc_calls</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">/\</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Execution.Blockchain.html#tx_from"><span class="id" title="projection">tx_from</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#dep_tx"><span class="id" title="variable">dep_tx</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#tx_to"><span class="id" title="projection">tx_to</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#dep_tx"><span class="id" title="variable">dep_tx</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#tx_amount"><span class="id" title="projection">tx_amount</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#dep_tx"><span class="id" title="variable">dep_tx</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Execution.Blockchain.html#deployment_from"><span class="id" title="projection">deployment_from</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#depinfo"><span class="id" title="variable">depinfo</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <span class="id" title="var">caddr</span><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#deployment_amount"><span class="id" title="projection">deployment_amount</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#depinfo"><span class="id" title="variable">depinfo</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">)</span></a>) <span class="id" title="keyword">as</span> <span class="id" title="var">generalized</span>.<br/>
&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">depinfo_eq</span>, <span class="id" title="var">calls_eq</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<a class="idref" href="ConCert.Execution.Blockchain.html#env_contracts"><span class="id" title="projection">env_contracts</span></a> <span class="id" title="var">bstate</span> <span class="id" title="var">caddr</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">destruct</span> <span class="id" title="var">generalized</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">_</span> <span class="id" title="var">generalized</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">specialize</span> (<span class="id" title="var">generalized</span> <span class="id" title="keyword">ltac</span>:(<span class="id" title="tactic">discriminate</span>) <span class="id" title="keyword">ltac</span>:(<span class="id" title="tactic">discriminate</span>) <span class="id" title="keyword">ltac</span>:(<span class="id" title="tactic">discriminate</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">generalized</span> <span class="id" title="keyword">as</span> [? [? [? [? [? [? [-&gt; [? ?]]]]]]]].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#map_app"><span class="id" title="lemma">map_app</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">destruct</span> <span class="id" title="var">generalized</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">generalized</span> <span class="id" title="var">_</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">specialize</span> (<span class="id" title="var">generalized</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#eq_refl"><span class="id" title="constructor">eq_refl</span></a>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">generalized</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">_</span> [? <span class="id" title="var">_</span>]]; <span class="id" title="tactic">congruence</span>.<br/>
&nbsp;&nbsp;}<br/>
<br/>
&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">is_contract</span>: <a class="idref" href="ConCert.Execution.Blockchain.html#address_is_contract"><span class="id" title="method">address_is_contract</span></a> <span class="id" title="var">caddr</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#true"><span class="id" title="constructor">true</span></a>).<br/>
&nbsp;&nbsp;{ <span class="id" title="tactic">assert</span> (<a class="idref" href="ConCert.Execution.Blockchain.html#deployment_info"><span class="id" title="definition">deployment_info</span></a> <span class="id" title="var">Setup</span> <span class="id" title="var">trace</span> <span class="id" title="var">caddr</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#a0a5068f83a704fcfbda8cd473a6cfea"><span class="id" title="notation">&lt;&gt;</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a>) <span class="id" title="tactic">by</span> <span class="id" title="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> (<a class="idref" href="ConCert.Execution.Blockchain.html#deployment_info_addr_format"><span class="id" title="lemma">deployment_info_addr_format</span></a> <span class="id" title="var">Setup</span>); <span class="id" title="var">eassumption</span>. }<br/>
<br/>
&nbsp;&nbsp;<span class="id" title="tactic">clear</span> <span class="id" title="var">depinfo_eq</span> <span class="id" title="var">calls_eq</span> <span class="id" title="var">depinfo</span> <span class="id" title="var">msgs</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="var">remember</span> <a class="idref" href="ConCert.Execution.Blockchain.html#empty_state"><span class="id" title="definition">empty_state</span></a>; <span class="id" title="tactic">induction</span> <span class="id" title="var">trace</span> <span class="id" title="keyword">as</span> [|? ? ? ? <span class="id" title="var">IH</span>]; <span class="id" title="tactic">subst</span>; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">try</span> <span class="id" title="tactic">tauto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">destruct_chain_step</span>; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *; <span class="id" title="tactic">try</span> <span class="id" title="var">now</span> <span class="id" title="var">rewrite_environment_equiv</span>.<br/>
&nbsp;&nbsp;- <span class="comment">(*&nbsp;Evaluation&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">destruct_action_eval</span>; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *; <span class="id" title="var">rewrite_environment_equiv</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="comment">(*&nbsp;Transfer&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">destruct_address_eq</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="comment">(*&nbsp;Deploy&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> (<a class="idref" href="ConCert.Execution.Blockchain.html#address_eq_sym"><span class="id" title="lemma">address_eq_sym</span></a> <span class="id" title="var">caddr</span>) <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">destruct_address_eq</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>; <span class="id" title="tactic">try</span> <span class="id" title="tactic">discriminate</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">_</span> <span class="id" title="var">depinfo_ne_none</span> <span class="id" title="var">calls_ne_none</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<a class="idref" href="ConCert.Execution.Serializable.html#deserialize"><span class="id" title="method">deserialize</span></a> <span class="id" title="var">setup</span>); <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *; <span class="id" title="tactic">try</span> <span class="id" title="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">remember</span> (<a class="idref" href="ConCert.Execution.Blockchain.html#build_deployment_info"><span class="id" title="constructor">build_deployment_info</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>) <span class="id" title="keyword">as</span> <span class="id" title="var">depinfo</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">remember</span> (<a class="idref" href="ConCert.Execution.Blockchain.html#build_tx"><span class="id" title="constructor">build_tx</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>) <span class="id" title="keyword">as</span> <span class="id" title="var">deptx</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">IH</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">IH</span> <span class="id" title="var">_</span>]; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">specialize</span> (<span class="id" title="var">IH</span> <span class="id" title="keyword">ltac</span>:(<span class="id" title="tactic">auto</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">fold</span> (<a class="idref" href="ConCert.Execution.Blockchain.html#incoming_txs"><span class="id" title="definition">incoming_txs</span></a> <span class="id" title="var">trace</span> <span class="id" title="var">caddr</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">IH</span> <span class="id" title="keyword">as</span> [-&gt; [? -&gt;]].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">exists</span> <span class="id" title="var">depinfo</span>, <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#ae9a5e1034e143b218b09d8e454472bd"><span class="id" title="notation">[]</span></a>, <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#ae9a5e1034e143b218b09d8e454472bd"><span class="id" title="notation">[]</span></a>, <span class="id" title="var">deptx</span>; <span class="id" title="tactic">subst</span>; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">tauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="comment">(*&nbsp;Call&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">destruct_address_eq</span>; <span class="id" title="tactic">subst</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>; [<span class="id" title="tactic">intros</span>; <span class="id" title="tactic">congruence</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">IH</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">_</span> <span class="id" title="var">IH</span>]; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">_</span> <span class="id" title="var">deploy_info</span> <span class="id" title="var">calls</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<span class="id" title="keyword">match</span> <span class="id" title="var">msg</span> <span class="id" title="keyword">with</span> | <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <span class="id" title="var">_</span> =&gt; <span class="id" title="var">_</span> | <span class="id" title="var">_</span> =&gt; <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a> <span class="id" title="keyword">end</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *; <span class="id" title="tactic">try</span> <span class="id" title="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<a class="idref" href="ConCert.Execution.Blockchain.html#incoming_calls"><span class="id" title="definition">incoming_calls</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span>) <span class="id" title="keyword">as</span> [<span class="id" title="var">inc_calls</span>|]; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *; <span class="id" title="tactic">try</span> <span class="id" title="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">unshelve</span> <span class="id" title="var">epose</span> <span class="id" title="var">proof</span> (<span class="id" title="var">IH</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>) <span class="id" title="keyword">as</span> <span class="id" title="var">IH</span>; <span class="id" title="tactic">auto</span>; <span class="id" title="tactic">try</span> <span class="id" title="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">IH</span> <span class="id" title="keyword">as</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[<span class="id" title="var">depinfo</span> [<span class="id" title="var">prev_calls</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[<span class="id" title="var">prev_call_txs</span> [<span class="id" title="var">dep_tx</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[<span class="id" title="var">depinfo_eq</span> [<span class="id" title="var">inc_calls_eq</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[<span class="id" title="var">inc_txs_eq</span> [<span class="id" title="var">map_eq</span> ?]]]]]]]].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">remember</span> (<a class="idref" href="ConCert.Execution.Blockchain.html#build_tx"><span class="id" title="constructor">build_tx</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>) <span class="id" title="keyword">as</span> <span class="id" title="var">new_tx</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">remember</span> (<a class="idref" href="ConCert.Execution.Blockchain.html#build_call_info"><span class="id" title="constructor">build_call_info</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>) <span class="id" title="keyword">as</span> <span class="id" title="var">new_call</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">exists</span> <span class="id" title="var">depinfo</span>, (<span class="id" title="var">new_call</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#cbcf67aac0c2a85b8d93d37de9969adf"><span class="id" title="notation">::</span></a> <span class="id" title="var">inc_calls</span>), (<span class="id" title="var">new_tx</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#cbcf67aac0c2a85b8d93d37de9969adf"><span class="id" title="notation">::</span></a> <span class="id" title="var">prev_call_txs</span>), <span class="id" title="var">dep_tx</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">fold</span> (<a class="idref" href="ConCert.Execution.Blockchain.html#incoming_txs"><span class="id" title="definition">incoming_txs</span></a> <span class="id" title="var">trace</span> <span class="id" title="var">caddr</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">inc_txs_eq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>; [<span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#app_comm_cons"><span class="id" title="lemma">app_comm_cons</span></a>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">inversion_clear</span> <span class="id" title="var">inc_calls_eq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">map_eq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">subst</span>; <span class="id" title="tactic">tauto</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a name="undeployed_contract_no_in_calls"><span class="id" title="lemma">undeployed_contract_no_in_calls</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<span class="id" title="var">Msg</span>} `{<a class="idref" href="ConCert.Execution.Serializable.html#Serializable"><span class="id" title="class">Serializable</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#Msg"><span class="id" title="variable">Msg</span></a>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">contract</span> <span class="id" title="var">state</span> (<span class="id" title="var">trace</span> : <a class="idref" href="ConCert.Execution.Blockchain.html#ChainTrace"><span class="id" title="definition">ChainTrace</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#empty_state"><span class="id" title="definition">empty_state</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#state"><span class="id" title="variable">state</span></a>) :<br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#env_contracts"><span class="id" title="projection">env_contracts</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#state"><span class="id" title="variable">state</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#contract"><span class="id" title="variable">contract</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#incoming_calls"><span class="id" title="definition">incoming_calls</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#Msg"><span class="id" title="variable">Msg</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#trace"><span class="id" title="variable">trace</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#contract"><span class="id" title="variable">contract</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#ae9a5e1034e143b218b09d8e454472bd"><span class="id" title="notation">[]</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="ConCert.Execution.Blockchain.html#incoming_calls"><span class="id" title="definition">incoming_calls</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">undeployed</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">remember</span> <a class="idref" href="ConCert.Execution.Blockchain.html#empty_state"><span class="id" title="definition">empty_state</span></a>; <span class="id" title="tactic">induction</span> <span class="id" title="var">trace</span>; <span class="id" title="tactic">subst</span>; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">destruct_chain_step</span>; <span class="id" title="tactic">try</span> <span class="id" title="var">now</span> <span class="id" title="var">rewrite_environment_equiv</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">destruct_action_eval</span>; <span class="id" title="var">rewrite_environment_equiv</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">destruct_address_eq</span>; <span class="id" title="tactic">auto</span>; <span class="id" title="tactic">subst</span>; <span class="id" title="tactic">congruence</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Local Open</span> <span class="id" title="keyword">Scope</span> <span class="id" title="var">Z</span>.<br/>
<span class="id" title="keyword">Lemma</span> <a name="account_balance_trace"><span class="id" title="lemma">account_balance_trace</span></a> <span class="id" title="var">state</span> (<span class="id" title="var">trace</span> : <a class="idref" href="ConCert.Execution.Blockchain.html#ChainTrace"><span class="id" title="definition">ChainTrace</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#empty_state"><span class="id" title="definition">empty_state</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#state"><span class="id" title="variable">state</span></a>) <span class="id" title="var">addr</span> :<br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#env_account_balances"><span class="id" title="projection">env_account_balances</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#state"><span class="id" title="variable">state</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#addr"><span class="id" title="variable">addr</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Utils.Extras.html#sumZ"><span class="id" title="definition">sumZ</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#tx_amount"><span class="id" title="projection">tx_amount</span></a> (<a class="idref" href="ConCert.Execution.Blockchain.html#incoming_txs"><span class="id" title="definition">incoming_txs</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#trace"><span class="id" title="variable">trace</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#addr"><span class="id" title="variable">addr</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.ZArith.BinInt.html#46584eddd5fdb16176a10a2843177d3a"><span class="id" title="notation">+</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Utils.Extras.html#sumZ"><span class="id" title="definition">sumZ</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#block_reward"><span class="id" title="projection">block_reward</span></a> (<a class="idref" href="ConCert.Execution.Blockchain.html#created_blocks"><span class="id" title="definition">created_blocks</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#trace"><span class="id" title="variable">trace</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#addr"><span class="id" title="variable">addr</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.ZArith.BinInt.html#fa12f60d56cf7225f009c889c0622139"><span class="id" title="notation">-</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Utils.Extras.html#sumZ"><span class="id" title="definition">sumZ</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#tx_amount"><span class="id" title="projection">tx_amount</span></a> (<a class="idref" href="ConCert.Execution.Blockchain.html#outgoing_txs"><span class="id" title="definition">outgoing_txs</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#trace"><span class="id" title="variable">trace</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#addr"><span class="id" title="variable">addr</span></a>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="ConCert.Execution.Blockchain.html#incoming_txs"><span class="id" title="definition">incoming_txs</span></a>, <a class="idref" href="ConCert.Execution.Blockchain.html#outgoing_txs"><span class="id" title="definition">outgoing_txs</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="var">remember</span> <a class="idref" href="ConCert.Execution.Blockchain.html#empty_state"><span class="id" title="definition">empty_state</span></a> <span class="id" title="keyword">as</span> <span class="id" title="var">from_state</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">trace</span>; [|<span class="id" title="var">destruct_chain_step</span>].<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">subst</span>. <span class="id" title="var">cbn</span>. <span class="id" title="var">lia</span>.<br/>
&nbsp;&nbsp;- <span class="comment">(*&nbsp;Block&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">rewrite_environment_equiv</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">fold</span> (<a class="idref" href="ConCert.Execution.Blockchain.html#created_blocks"><span class="id" title="definition">created_blocks</span></a> <span class="id" title="var">trace</span> <span class="id" title="var">addr</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">IHtrace</span> <span class="id" title="tactic">by</span> <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">destruct_address_eq</span>; <span class="id" title="tactic">subst</span>; <span class="id" title="var">cbn</span>; <span class="id" title="var">lia</span>.<br/>
&nbsp;&nbsp;- <span class="comment">(*&nbsp;Step&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">destruct_action_eval</span>; <span class="id" title="var">cbn</span>; <span class="id" title="var">rewrite_environment_equiv</span>; <span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">all</span>: <span class="id" title="tactic">fold</span> (<a class="idref" href="ConCert.Execution.Blockchain.html#created_blocks"><span class="id" title="definition">created_blocks</span></a> <span class="id" title="var">trace</span> <span class="id" title="var">addr</span>); <span class="id" title="tactic">rewrite</span> <span class="id" title="var">IHtrace</span> <span class="id" title="tactic">by</span> <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">all</span>: <span class="id" title="var">destruct_address_eq</span>; <span class="id" title="var">cbn</span>; <span class="id" title="var">lia</span>.<br/>
&nbsp;&nbsp;- <span class="comment">(*&nbsp;Invalid&nbsp;User&nbsp;Action&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="var">rewrite_environment_equiv</span>.<br/>
&nbsp;&nbsp;- <span class="comment">(*&nbsp;Permutation&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="var">rewrite_environment_equiv</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a name="contract_no_created_blocks"><span class="id" title="lemma">contract_no_created_blocks</span></a> <span class="id" title="var">state</span> (<span class="id" title="var">trace</span> : <a class="idref" href="ConCert.Execution.Blockchain.html#ChainTrace"><span class="id" title="definition">ChainTrace</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#empty_state"><span class="id" title="definition">empty_state</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#state"><span class="id" title="variable">state</span></a>) <span class="id" title="var">addr</span> :<br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#address_is_contract"><span class="id" title="method">address_is_contract</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#addr"><span class="id" title="variable">addr</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#true"><span class="id" title="constructor">true</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#created_blocks"><span class="id" title="definition">created_blocks</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#trace"><span class="id" title="variable">trace</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#addr"><span class="id" title="variable">addr</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#ae9a5e1034e143b218b09d8e454472bd"><span class="id" title="notation">[]</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">is_contract</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">remember</span> <a class="idref" href="ConCert.Execution.Blockchain.html#empty_state"><span class="id" title="definition">empty_state</span></a> <span class="id" title="var">eqn</span>:<span class="id" title="var">eq</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">trace</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">destruct_chain_step</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">subst</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">inversion</span> <span class="id" title="var">valid_header</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<a class="idref" href="ConCert.Execution.Blockchain.html#address_eqb_spec"><span class="id" title="method">address_eqb_spec</span></a> (<a class="idref" href="ConCert.Execution.Blockchain.html#block_creator"><span class="id" title="projection">block_creator</span></a> <span class="id" title="var">header</span>) <span class="id" title="var">addr</span>); <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">congruence</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a name="undeployed_contract_balance_0"><span class="id" title="lemma">undeployed_contract_balance_0</span></a> <span class="id" title="var">state</span> <span class="id" title="var">addr</span> :<br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#reachable"><span class="id" title="definition">reachable</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#state"><span class="id" title="variable">state</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#address_is_contract"><span class="id" title="method">address_is_contract</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#addr"><span class="id" title="variable">addr</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#true"><span class="id" title="constructor">true</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#env_contracts"><span class="id" title="projection">env_contracts</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#state"><span class="id" title="variable">state</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#addr"><span class="id" title="variable">addr</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#env_account_balances"><span class="id" title="projection">env_account_balances</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#state"><span class="id" title="variable">state</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#addr"><span class="id" title="variable">addr</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> 0.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> [<span class="id" title="var">trace</span>] <span class="id" title="var">is_contract</span> <span class="id" title="var">no_contract</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> (<a class="idref" href="ConCert.Execution.Blockchain.html#account_balance_trace"><span class="id" title="lemma">account_balance_trace</span></a> <span class="id" title="var">_</span> <span class="id" title="var">trace</span>); <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="ConCert.Execution.Blockchain.html#undeployed_contract_no_out_txs"><span class="id" title="lemma">undeployed_contract_no_out_txs</span></a>, <a class="idref" href="ConCert.Execution.Blockchain.html#undeployed_contract_no_in_txs"><span class="id" title="lemma">undeployed_contract_no_in_txs</span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#contract_no_created_blocks"><span class="id" title="lemma">contract_no_created_blocks</span></a>; <span class="id" title="tactic">auto</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a name="account_balance_nonnegative"><span class="id" title="lemma">account_balance_nonnegative</span></a> <span class="id" title="var">state</span> <span class="id" title="var">addr</span> :<br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#reachable"><span class="id" title="definition">reachable</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#state"><span class="id" title="variable">state</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#env_account_balances"><span class="id" title="projection">env_account_balances</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#state"><span class="id" title="variable">state</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#addr"><span class="id" title="variable">addr</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.ZArith.BinInt.html#b1f0780291abe9bd18804d2c9a5039d4"><span class="id" title="notation">&gt;=</span></a> 0.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> [<span class="id" title="var">trace</span>].<br/>
&nbsp;&nbsp;<span class="id" title="var">remember</span> <a class="idref" href="ConCert.Execution.Blockchain.html#empty_state"><span class="id" title="definition">empty_state</span></a> <span class="id" title="var">eqn</span>:<span class="id" title="var">eq</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">trace</span>; <span class="id" title="tactic">subst</span>; <span class="id" title="var">cbn</span>; <span class="id" title="tactic">try</span> <span class="id" title="var">lia</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">specialize</span> (<span class="id" title="var">IHtrace</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#eq_refl"><span class="id" title="constructor">eq_refl</span></a>).<br/>
&nbsp;&nbsp;<span class="id" title="var">destruct_chain_step</span>.<br/>
&nbsp;&nbsp;- <span class="comment">(*&nbsp;New&nbsp;block&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">rewrite_environment_equiv</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">inversion</span> <span class="id" title="var">valid_header</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">destruct_address_eq</span>; <span class="id" title="var">lia</span>.<br/>
&nbsp;&nbsp;- <span class="comment">(*&nbsp;Action&nbsp;evaluation&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> (<a class="idref" href="ConCert.Execution.Blockchain.html#account_balance_post"><span class="id" title="lemma">account_balance_post</span></a> <span class="id" title="tactic">eval</span> <span class="id" title="var">addr</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">pose</span> <span class="id" title="var">proof</span> (<a class="idref" href="ConCert.Execution.Blockchain.html#eval_amount_nonnegative"><span class="id" title="lemma">eval_amount_nonnegative</span></a> <span class="id" title="tactic">eval</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">pose</span> <span class="id" title="var">proof</span> (<a class="idref" href="ConCert.Execution.Blockchain.html#eval_amount_le_account_balance"><span class="id" title="lemma">eval_amount_le_account_balance</span></a> <span class="id" title="tactic">eval</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">destruct_address_eq</span>; <span class="id" title="tactic">subst</span>; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *; <span class="id" title="var">lia</span>.<br/>
&nbsp;&nbsp;- <span class="comment">(*&nbsp;Invalid&nbsp;User&nbsp;Action&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="var">rewrite_environment_equiv</span>.<br/>
&nbsp;&nbsp;- <span class="comment">(*&nbsp;Permutation&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="var">rewrite_environment_equiv</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a name="wc_init_strong"><span class="id" title="lemma">wc_init_strong</span></a> {<span class="id" title="var">Setup</span> <span class="id" title="var">Msg</span> <span class="id" title="var">State</span> : <span class="id" title="keyword">Type</span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;`{<a class="idref" href="ConCert.Execution.Serializable.html#Serializable"><span class="id" title="class">Serializable</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#Setup"><span class="id" title="variable">Setup</span></a>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;`{<a class="idref" href="ConCert.Execution.Serializable.html#Serializable"><span class="id" title="class">Serializable</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#Msg"><span class="id" title="variable">Msg</span></a>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;`{<a class="idref" href="ConCert.Execution.Serializable.html#Serializable"><span class="id" title="class">Serializable</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#State"><span class="id" title="variable">State</span></a>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<span class="id" title="var">contract</span> : <a class="idref" href="ConCert.Execution.Blockchain.html#Contract"><span class="id" title="record">Contract</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#Setup"><span class="id" title="variable">Setup</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#Msg"><span class="id" title="variable">Msg</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#State"><span class="id" title="variable">State</span></a>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<span class="id" title="var">chain</span> <span class="id" title="var">ctx</span> <span class="id" title="var">setup</span> <span class="id" title="var">result</span>} :<br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#wc_init"><span class="id" title="definition">wc_init</span></a> (<a class="idref" href="ConCert.Execution.Blockchain.html#contract"><span class="id" title="variable">contract</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#WeakContract"><span class="id" title="inductive">WeakContract</span></a>) <a class="idref" href="ConCert.Execution.Blockchain.html#chain"><span class="id" title="variable">chain</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#ctx"><span class="id" title="variable">ctx</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#setup"><span class="id" title="variable">setup</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#result"><span class="id" title="variable">result</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">exists</span></a> <span class="id" title="var">setup_strong</span> <span class="id" title="var">result_strong</span><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">,</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Serializable.html#deserialize"><span class="id" title="method">deserialize</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#setup"><span class="id" title="variable">setup</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#setup_strong"><span class="id" title="variable">setup_strong</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">/\</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Serializable.html#serialize"><span class="id" title="method">serialize</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#result_strong"><span class="id" title="variable">result_strong</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#result"><span class="id" title="variable">result</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">/\</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#init"><span class="id" title="projection">Blockchain.init</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#contract"><span class="id" title="variable">contract</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#chain"><span class="id" title="variable">chain</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#ctx"><span class="id" title="variable">ctx</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#setup_strong"><span class="id" title="variable">setup_strong</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#result_strong"><span class="id" title="variable">result_strong</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">init</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<a class="idref" href="ConCert.Execution.Serializable.html#deserialize"><span class="id" title="method">deserialize</span></a> <span class="id" title="var">setup</span>) <span class="id" title="keyword">as</span> [<span class="id" title="var">setup_strong</span>|] <span class="id" title="var">eqn</span>:<span class="id" title="var">deser_setup</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *; <span class="id" title="tactic">try</span> <span class="id" title="tactic">congruence</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">exists</span> <span class="id" title="var">setup_strong</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<a class="idref" href="ConCert.Execution.Blockchain.html#init"><span class="id" title="projection">Blockchain.init</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>) <span class="id" title="keyword">as</span> [<span class="id" title="var">result_strong</span>|] <span class="id" title="var">eqn</span>:<span class="id" title="var">result_eq</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *; <span class="id" title="tactic">try</span> <span class="id" title="tactic">congruence</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">exists</span> <span class="id" title="var">result_strong</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">repeat</span> <span class="id" title="tactic">split</span>; <span class="id" title="tactic">auto</span> <span class="id" title="keyword">with</span> <span class="id" title="tactic">congruence</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a name="wc_receive_strong"><span class="id" title="lemma">wc_receive_strong</span></a> {<span class="id" title="var">Setup</span> <span class="id" title="var">Msg</span> <span class="id" title="var">State</span> : <span class="id" title="keyword">Type</span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;`{<a class="idref" href="ConCert.Execution.Serializable.html#Serializable"><span class="id" title="class">Serializable</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#Setup"><span class="id" title="variable">Setup</span></a>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;`{<a class="idref" href="ConCert.Execution.Serializable.html#Serializable"><span class="id" title="class">Serializable</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#Msg"><span class="id" title="variable">Msg</span></a>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;`{<a class="idref" href="ConCert.Execution.Serializable.html#Serializable"><span class="id" title="class">Serializable</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#State"><span class="id" title="variable">State</span></a>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<span class="id" title="var">contract</span> : <a class="idref" href="ConCert.Execution.Blockchain.html#Contract"><span class="id" title="record">Contract</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#Setup"><span class="id" title="variable">Setup</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#Msg"><span class="id" title="variable">Msg</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#State"><span class="id" title="variable">State</span></a>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<span class="id" title="var">chain</span> <span class="id" title="var">ctx</span> <span class="id" title="var">prev_state</span> <span class="id" title="var">msg</span> <span class="id" title="var">new_state</span> <span class="id" title="var">new_acts</span>} :<br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#wc_receive"><span class="id" title="definition">wc_receive</span></a> (<a class="idref" href="ConCert.Execution.Blockchain.html#contract"><span class="id" title="variable">contract</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#WeakContract"><span class="id" title="inductive">WeakContract</span></a>) <a class="idref" href="ConCert.Execution.Blockchain.html#chain"><span class="id" title="variable">chain</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#ctx"><span class="id" title="variable">ctx</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#prev_state"><span class="id" title="variable">prev_state</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#msg"><span class="id" title="variable">msg</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Execution.Blockchain.html#new_state"><span class="id" title="variable">new_state</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#new_acts"><span class="id" title="variable">new_acts</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">exists</span></a> <span class="id" title="var">prev_state_strong</span> <span class="id" title="var">msg_strong</span> <span class="id" title="var">new_state_strong</span><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">,</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Serializable.html#deserialize"><span class="id" title="method">deserialize</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#prev_state"><span class="id" title="variable">prev_state</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#prev_state_strong"><span class="id" title="variable">prev_state_strong</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">/\</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="ConCert.Execution.Blockchain.html#msg_strong"><span class="id" title="variable">msg_strong</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <span class="id" title="var">msg_strong</span> =&gt; <a class="idref" href="ConCert.Execution.Blockchain.html#msg"><span class="id" title="variable">msg</span></a> <a class="idref" href="ConCert.Execution.Monads.html#f1146025ce6377896c1a30f88a02c8cb"><span class="id" title="notation">&gt;&gt;=</span></a> <a class="idref" href="ConCert.Execution.Serializable.html#deserialize"><span class="id" title="method">deserialize</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#msg_strong"><span class="id" title="variable">msg_strong</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a> =&gt; <a class="idref" href="ConCert.Execution.Blockchain.html#msg"><span class="id" title="variable">msg</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">/\</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Serializable.html#serialize"><span class="id" title="method">serialize</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#new_state_strong"><span class="id" title="variable">new_state_strong</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#new_state"><span class="id" title="variable">new_state</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">/\</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#receive"><span class="id" title="projection">Blockchain.receive</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#contract"><span class="id" title="variable">contract</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#chain"><span class="id" title="variable">chain</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#ctx"><span class="id" title="variable">ctx</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#prev_state_strong"><span class="id" title="variable">prev_state_strong</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#msg_strong"><span class="id" title="variable">msg_strong</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Execution.Blockchain.html#new_state_strong"><span class="id" title="variable">new_state_strong</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#new_acts"><span class="id" title="variable">new_acts</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">receive</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<a class="idref" href="ConCert.Execution.Serializable.html#deserialize"><span class="id" title="method">deserialize</span></a> <span class="id" title="var">prev_state</span>) <span class="id" title="keyword">as</span> [<span class="id" title="var">prev_state_strong</span>|] <span class="id" title="var">eqn</span>:<span class="id" title="var">deser_state</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *; <span class="id" title="tactic">try</span> <span class="id" title="tactic">congruence</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">exists</span> <span class="id" title="var">prev_state_strong</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">exists</span> (<span class="id" title="var">msg</span> <a class="idref" href="ConCert.Execution.Monads.html#f1146025ce6377896c1a30f88a02c8cb"><span class="id" title="notation">&gt;&gt;=</span></a> <a class="idref" href="ConCert.Execution.Serializable.html#deserialize"><span class="id" title="method">deserialize</span></a>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">msg</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">msg</span>|]; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;1: <span class="id" title="tactic">destruct</span> (<a class="idref" href="ConCert.Execution.Serializable.html#deserialize"><span class="id" title="method">deserialize</span></a> <span class="id" title="var">msg</span>) <span class="id" title="keyword">as</span> [<span class="id" title="var">msg_strong</span>|];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *; <span class="id" title="tactic">try</span> <span class="id" title="tactic">congruence</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">all</span>: <span class="id" title="tactic">destruct</span> (<a class="idref" href="ConCert.Execution.Blockchain.html#receive"><span class="id" title="projection">Blockchain.receive</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">as</span> [[<span class="id" title="var">resp_state_strong</span> <span class="id" title="var">resp_acts_strong</span>]|] <span class="id" title="var">eqn</span>:<span class="id" title="var">result_eq</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *; <span class="id" title="tactic">try</span> <span class="id" title="tactic">congruence</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">all</span>: <span class="id" title="tactic">exists</span> <span class="id" title="var">resp_state_strong</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">all</span>: <span class="id" title="tactic">inversion_clear</span> <span class="id" title="var">receive</span>; <span class="id" title="tactic">auto</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a name="deployed_contract_state_typed"><span class="id" title="lemma">deployed_contract_state_typed</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<span class="id" title="var">Setup</span> <span class="id" title="var">Msg</span> <span class="id" title="var">State</span> : <span class="id" title="keyword">Type</span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;`{<a class="idref" href="ConCert.Execution.Serializable.html#Serializable"><span class="id" title="class">Serializable</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#Setup"><span class="id" title="variable">Setup</span></a>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;`{<a class="idref" href="ConCert.Execution.Serializable.html#Serializable"><span class="id" title="class">Serializable</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#Msg"><span class="id" title="variable">Msg</span></a>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;`{<a class="idref" href="ConCert.Execution.Serializable.html#Serializable"><span class="id" title="class">Serializable</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#State"><span class="id" title="variable">State</span></a>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<span class="id" title="var">contract</span> : <a class="idref" href="ConCert.Execution.Blockchain.html#Contract"><span class="id" title="record">Contract</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#Setup"><span class="id" title="variable">Setup</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#Msg"><span class="id" title="variable">Msg</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#State"><span class="id" title="variable">State</span></a>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<span class="id" title="var">bstate</span> : <a class="idref" href="ConCert.Execution.Blockchain.html#ChainState"><span class="id" title="record">ChainState</span></a>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<span class="id" title="var">caddr</span>} :<br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#env_contracts"><span class="id" title="projection">env_contracts</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#bstate"><span class="id" title="variable">bstate</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#caddr"><span class="id" title="variable">caddr</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> (<a class="idref" href="ConCert.Execution.Blockchain.html#contract"><span class="id" title="variable">contract</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#WeakContract"><span class="id" title="inductive">WeakContract</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#reachable"><span class="id" title="definition">reachable</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#bstate"><span class="id" title="variable">bstate</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">exists</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">(</span></a><span class="id" title="var">cstate</span> : <a class="idref" href="ConCert.Execution.Blockchain.html#State"><span class="id" title="variable">State</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">),</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#contract_state"><span class="id" title="definition">contract_state</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#bstate"><span class="id" title="variable">bstate</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#caddr"><span class="id" title="variable">caddr</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#cstate"><span class="id" title="variable">cstate</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">contract_deployed</span> [<span class="id" title="var">trace</span>].<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<a class="idref" href="ConCert.Execution.Blockchain.html#contract_state"><span class="id" title="definition">contract_state</span></a> <span class="id" title="var">bstate</span> <span class="id" title="var">caddr</span>) <span class="id" title="keyword">as</span> [<span class="id" title="var">cstate</span>|] <span class="id" title="var">eqn</span>:<span class="id" title="var">eq</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;[<span class="id" title="tactic">exists</span> <span class="id" title="var">cstate</span>; <span class="id" title="tactic">auto</span>|].<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="ConCert.Execution.Blockchain.html#contract_state"><span class="id" title="definition">contract_state</span></a> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;Show&nbsp;that&nbsp;eq&nbsp;is&nbsp;a&nbsp;contradiction.&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id" title="var">remember</span> <a class="idref" href="ConCert.Execution.Blockchain.html#empty_state"><span class="id" title="definition">empty_state</span></a>; <span class="id" title="tactic">induction</span> <span class="id" title="var">trace</span>; <span class="id" title="tactic">subst</span>; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *; <span class="id" title="tactic">try</span> <span class="id" title="tactic">congruence</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">destruct_chain_step</span>; <span class="id" title="tactic">try</span> <span class="id" title="var">now</span> <span class="id" title="var">rewrite_environment_equiv</span>.<br/>
&nbsp;&nbsp;- <span class="comment">(*&nbsp;Action&nbsp;evaluation&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">destruct_action_eval</span>; <span class="id" title="tactic">subst</span>; <span class="id" title="var">rewrite_environment_equiv</span>; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="comment">(*&nbsp;Transfer,&nbsp;use&nbsp;IH&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="comment">(*&nbsp;Deployment&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">destruct_address_eq</span>; <span class="id" title="tactic">subst</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;To&nbsp;this&nbsp;contract,&nbsp;show&nbsp;that&nbsp;deserialization&nbsp;would&nbsp;not&nbsp;fail.&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">replace</span> <span class="id" title="var">wc</span> <span class="id" title="keyword">with</span> (<span class="id" title="var">contract</span> : <a class="idref" href="ConCert.Execution.Blockchain.html#WeakContract"><span class="id" title="inductive">WeakContract</span></a>) <span class="id" title="tactic">in</span> * <span class="id" title="tactic">by</span> <span class="id" title="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<a class="idref" href="ConCert.Execution.Blockchain.html#wc_init_strong"><span class="id" title="lemma">wc_init_strong</span></a> <span class="id" title="keyword">ltac</span>:(<span class="id" title="var">eassumption</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">as</span> [<span class="id" title="var">setup_strong</span> [<span class="id" title="var">result_strong</span> [? [&lt;- <span class="id" title="var">init</span>]]]].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> <span class="id" title="var">eq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="ConCert.Execution.Serializable.html#deserialize_serialize"><span class="id" title="method">deserialize_serialize</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">eq</span>; <span class="id" title="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="comment">(*&nbsp;Call&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<a class="idref" href="ConCert.Execution.Blockchain.html#address_eqb_spec"><span class="id" title="method">address_eqb_spec</span></a> <span class="id" title="var">caddr</span> <span class="id" title="var">to_addr</span>); <span class="id" title="tactic">subst</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;To&nbsp;this&nbsp;contract,&nbsp;show&nbsp;that&nbsp;deserialization&nbsp;would&nbsp;not&nbsp;fail.&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">replace</span> <span class="id" title="var">wc</span> <span class="id" title="keyword">with</span> (<span class="id" title="var">contract</span> : <a class="idref" href="ConCert.Execution.Blockchain.html#WeakContract"><span class="id" title="inductive">WeakContract</span></a>) <span class="id" title="tactic">in</span> * <span class="id" title="tactic">by</span> <span class="id" title="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<a class="idref" href="ConCert.Execution.Blockchain.html#wc_receive_strong"><span class="id" title="lemma">wc_receive_strong</span></a> <span class="id" title="keyword">ltac</span>:(<span class="id" title="var">eassumption</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">as</span> [<span class="id" title="var">state_strong</span> [<span class="id" title="var">msg_strong</span> [<span class="id" title="var">resp_state_strong</span> [? [? [&lt;- <span class="id" title="var">receive</span>]]]]]].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> <span class="id" title="var">eq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="ConCert.Execution.Serializable.html#deserialize_serialize"><span class="id" title="method">deserialize_serialize</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">eq</span>; <span class="id" title="tactic">congruence</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a name="origin_is_always_account"><span class="id" title="lemma">origin_is_always_account</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<span class="id" title="var">Setup</span> <span class="id" title="var">Msg</span> <span class="id" title="var">State</span> : <span class="id" title="keyword">Type</span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;`{<a class="idref" href="ConCert.Execution.Serializable.html#Serializable"><span class="id" title="class">Serializable</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#Setup"><span class="id" title="variable">Setup</span></a>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;`{<a class="idref" href="ConCert.Execution.Serializable.html#Serializable"><span class="id" title="class">Serializable</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#Msg"><span class="id" title="variable">Msg</span></a>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;`{<a class="idref" href="ConCert.Execution.Serializable.html#Serializable"><span class="id" title="class">Serializable</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#State"><span class="id" title="variable">State</span></a>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<span class="id" title="var">bstate</span> : <a class="idref" href="ConCert.Execution.Blockchain.html#ChainState"><span class="id" title="record">ChainState</span></a>} :<br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#reachable"><span class="id" title="definition">reachable</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#bstate"><span class="id" title="variable">bstate</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#Forall"><span class="id" title="inductive">Forall</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#act_origin_is_account"><span class="id" title="definition">act_origin_is_account</span></a> (<a class="idref" href="ConCert.Execution.Blockchain.html#chain_state_queue"><span class="id" title="projection">chain_state_queue</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#bstate"><span class="id" title="variable">bstate</span></a>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> [<span class="id" title="var">trace</span>].<br/>
&nbsp;&nbsp;<span class="id" title="var">remember</span> <a class="idref" href="ConCert.Execution.Blockchain.html#empty_state"><span class="id" title="definition">empty_state</span></a>; <span class="id" title="tactic">induction</span> <span class="id" title="var">trace</span>;<span class="id" title="tactic">subst</span>; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *; <span class="id" title="tactic">try</span> <span class="id" title="tactic">constructor</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">destruct_chain_step</span>.<br/>
&nbsp;&nbsp;- <span class="comment">(*&nbsp;New&nbsp;block,&nbsp;use&nbsp;the&nbsp;fact&nbsp;that&nbsp;<span class="inlinecode"><span class="id" title="var">act_origin</span></span>&nbsp;is&nbsp;the&nbsp;same&nbsp;as&nbsp;<span class="inlinecode"><span class="id" title="var">act_from</span></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;and&nbsp;<span class="inlinecode"><span class="id" title="var">act_from</span></span>&nbsp;is&nbsp;an&nbsp;account&nbsp;address*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <a class="idref" href="ConCert.Execution.Blockchain.html#origin_is_account"><span class="id" title="lemma">origin_is_account</span></a>.<br/>
&nbsp;&nbsp;- <span class="comment">(*&nbsp;Action&nbsp;evaluation&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">destruct_action_eval</span>; <span class="id" title="tactic">subst</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">queue_new</span> <span class="id" title="tactic">in</span> *;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">queue_prev</span> <span class="id" title="tactic">in</span> *;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">specialize_hypotheses</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">inversion</span> <span class="id" title="var">IHtrace</span>;<span class="id" title="tactic">subst</span>; <span class="id" title="tactic">try</span> <span class="id" title="var">easy</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="ConCert.Utils.Extras.html#Forall_app"><span class="id" title="lemma">Forall_app</span></a>. <span class="id" title="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="tactic">apply</span> <span class="id" title="lemma">All_Forall.Forall_map</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#Forall_forall"><span class="id" title="lemma">Forall_forall</span></a>; <span class="id" title="var">easy</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;- <span class="comment">(*&nbsp;Invalid&nbsp;User&nbsp;Action&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">queue_new</span> <span class="id" title="tactic">in</span> *; <span class="id" title="tactic">rewrite</span> <span class="id" title="var">queue_prev</span> <span class="id" title="tactic">in</span> *; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">specialize_hypotheses</span>; <span class="id" title="tactic">inversion</span> <span class="id" title="var">IHtrace</span>; <span class="id" title="tactic">subst</span>; <span class="id" title="var">easy</span>.<br/>
&nbsp;&nbsp;- <span class="comment">(*&nbsp;Permutation&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="ConCert.Utils.Extras.html#forall_respects_permutation"><span class="id" title="lemma">forall_respects_permutation</span></a>; <span class="id" title="tactic">eauto</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Inductive</span> <a name="TagFacts"><span class="id" title="inductive">TagFacts</span></a> := <a name="tag_facts"><span class="id" title="constructor">tag_facts</span></a>.<br/>
<span class="id" title="keyword">Inductive</span> <a name="TagAddBlock"><span class="id" title="inductive">TagAddBlock</span></a> := <a name="tag_add_block"><span class="id" title="constructor">tag_add_block</span></a>.<br/>
<span class="id" title="keyword">Inductive</span> <a name="TagDeployment"><span class="id" title="inductive">TagDeployment</span></a> := <a name="tag_deployment"><span class="id" title="constructor">tag_deployment</span></a>.<br/>
<span class="id" title="keyword">Inductive</span> <a name="TagOutgoingAct"><span class="id" title="inductive">TagOutgoingAct</span></a> := <a name="tag_outgoing_act"><span class="id" title="constructor">tag_outgoing_act</span></a>.<br/>
<span class="id" title="keyword">Inductive</span> <a name="TagNonrecursiveCall"><span class="id" title="inductive">TagNonrecursiveCall</span></a> := <a name="tag_nonrecursive_call"><span class="id" title="constructor">tag_nonrecursive_call</span></a>.<br/>
<span class="id" title="keyword">Inductive</span> <a name="TagRecursiveCall"><span class="id" title="inductive">TagRecursiveCall</span></a> := <a name="tag_recursive_call"><span class="id" title="constructor">tag_recursive_call</span></a>.<br/>
<span class="id" title="keyword">Inductive</span> <a name="TagPermuteQueue"><span class="id" title="inductive">TagPermuteQueue</span></a> := <a name="tag_permute_queue"><span class="id" title="constructor">tag_permute_queue</span></a>.<br/>

<br/>
<span class="id" title="keyword">Hint Constructors</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#TagFacts"><span class="id" title="inductive">TagFacts</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#TagAddBlock"><span class="id" title="inductive">TagAddBlock</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#TagDeployment"><span class="id" title="inductive">TagDeployment</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#TagOutgoingAct"><span class="id" title="inductive">TagOutgoingAct</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#TagNonrecursiveCall"><span class="id" title="inductive">TagNonrecursiveCall</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#TagRecursiveCall"><span class="id" title="inductive">TagRecursiveCall</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#TagPermuteQueue"><span class="id" title="inductive">TagPermuteQueue</span></a> : <span class="id" title="var">core</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a name="contract_induction"><span class="id" title="lemma">contract_induction</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<span class="id" title="var">Setup</span> <span class="id" title="var">Msg</span> <span class="id" title="var">State</span> : <span class="id" title="keyword">Type</span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;`{<a class="idref" href="ConCert.Execution.Serializable.html#Serializable"><span class="id" title="class">Serializable</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#Setup"><span class="id" title="variable">Setup</span></a>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;`{<a class="idref" href="ConCert.Execution.Serializable.html#Serializable"><span class="id" title="class">Serializable</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#Msg"><span class="id" title="variable">Msg</span></a>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;`{<a class="idref" href="ConCert.Execution.Serializable.html#Serializable"><span class="id" title="class">Serializable</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#State"><span class="id" title="variable">State</span></a>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">contract</span> : <a class="idref" href="ConCert.Execution.Blockchain.html#Contract"><span class="id" title="record">Contract</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#Setup"><span class="id" title="variable">Setup</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#Msg"><span class="id" title="variable">Msg</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#State"><span class="id" title="variable">State</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">AddBlockFacts</span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">forall</span> (<span class="id" title="var">chain_height</span> : <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a>) (<span class="id" title="var">current_slot</span> : <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a>) (<span class="id" title="var">finalized_height</span> : <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">new_height</span> : <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a>) (<span class="id" title="var">new_slot</span> : <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a>) (<span class="id" title="var">new_finalized_height</span> : <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a>), <span class="id" title="keyword">Prop</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">DeployFacts</span> : <span class="id" title="keyword">forall</span> (<span class="id" title="var">chain</span> : <a class="idref" href="ConCert.Execution.Blockchain.html#Chain"><span class="id" title="record">Chain</span></a>) (<span class="id" title="var">ctx</span> : <a class="idref" href="ConCert.Execution.Blockchain.html#ContractCallContext"><span class="id" title="record">ContractCallContext</span></a>), <span class="id" title="keyword">Prop</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">CallFacts</span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">forall</span> (<span class="id" title="var">chain</span> : <a class="idref" href="ConCert.Execution.Blockchain.html#Chain"><span class="id" title="record">Chain</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">ctx</span> : <a class="idref" href="ConCert.Execution.Blockchain.html#ContractCallContext"><span class="id" title="record">ContractCallContext</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">cstate</span> : <a class="idref" href="ConCert.Execution.Blockchain.html#State"><span class="id" title="variable">State</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">outgoing_actions</span> : <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#list"><span class="id" title="inductive">list</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#ActionBody"><span class="id" title="inductive">ActionBody</span></a>), <span class="id" title="keyword">Prop</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">P</span> : <span class="id" title="keyword">forall</span> (<span class="id" title="var">chain_height</span> : <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">current_slot</span> : <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">finalized_height</span> : <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">caddr</span> : <a class="idref" href="ConCert.Execution.Blockchain.html#Address"><span class="id" title="method">Address</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">deployment_info</span> : <a class="idref" href="ConCert.Execution.Blockchain.html#DeploymentInfo"><span class="id" title="record">DeploymentInfo</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#Setup"><span class="id" title="variable">Setup</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">cstate</span> : <a class="idref" href="ConCert.Execution.Blockchain.html#State"><span class="id" title="variable">State</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">balance</span> : <a class="idref" href="ConCert.Execution.Blockchain.html#Amount"><span class="id" title="definition">Amount</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">outgoing_actions_queued</span> : <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#list"><span class="id" title="inductive">list</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#ActionBody"><span class="id" title="inductive">ActionBody</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">incoming_calls_seen</span> : <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#list"><span class="id" title="inductive">list</span></a> (<a class="idref" href="ConCert.Execution.Blockchain.html#ContractCallInfo"><span class="id" title="record">ContractCallInfo</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#Msg"><span class="id" title="variable">Msg</span></a>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">outgoing_txs_seen</span> : <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#list"><span class="id" title="inductive">list</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#Tx"><span class="id" title="record">Tx</span></a>), <span class="id" title="keyword">Prop</span>) :<br/>
<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;Facts&nbsp;*)</span><br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">(</span></a><span class="id" title="keyword">forall</span> (<span class="id" title="var">bstate_from</span> <span class="id" title="var">bstate_to</span> : <a class="idref" href="ConCert.Execution.Blockchain.html#ChainState"><span class="id" title="record">ChainState</span></a>) (<span class="id" title="var">step</span> : <a class="idref" href="ConCert.Execution.Blockchain.html#ChainStep"><span class="id" title="inductive">ChainStep</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#bstate_from"><span class="id" title="variable">bstate_from</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#bstate_to"><span class="id" title="variable">bstate_to</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">from_reachable</span> : <a class="idref" href="ConCert.Execution.Blockchain.html#reachable"><span class="id" title="definition">reachable</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#bstate_from"><span class="id" title="variable">bstate_from</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">tag</span> : <a class="idref" href="ConCert.Execution.Blockchain.html#TagFacts"><span class="id" title="inductive">TagFacts</span></a>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="ConCert.Execution.Blockchain.html#step"><span class="id" title="variable">step</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="ConCert.Execution.Blockchain.html#step_block"><span class="id" title="constructor">step_block</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">header</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#AddBlockFacts"><span class="id" title="variable">AddBlockFacts</span></a> (<a class="idref" href="ConCert.Execution.Blockchain.html#chain_height"><span class="id" title="projection">chain_height</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#bstate_from"><span class="id" title="variable">bstate_from</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="ConCert.Execution.Blockchain.html#current_slot"><span class="id" title="projection">current_slot</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#bstate_from"><span class="id" title="variable">bstate_from</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="ConCert.Execution.Blockchain.html#finalized_height"><span class="id" title="projection">finalized_height</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#bstate_from"><span class="id" title="variable">bstate_from</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="ConCert.Execution.Blockchain.html#block_height"><span class="id" title="projection">block_height</span></a> <span class="id" title="var">header</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="ConCert.Execution.Blockchain.html#block_slot"><span class="id" title="projection">block_slot</span></a> <span class="id" title="var">header</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="ConCert.Execution.Blockchain.html#block_finalized_height"><span class="id" title="projection">block_finalized_height</span></a> <span class="id" title="var">header</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="ConCert.Execution.Blockchain.html#step_action"><span class="id" title="constructor">step_action</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">act</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> (<a class="idref" href="ConCert.Execution.Blockchain.html#eval_deploy"><span class="id" title="constructor">eval_deploy</span></a> <span class="id" title="var">origin</span> <span class="id" title="var">from</span> <span class="id" title="var">to</span> <span class="id" title="var">amount</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>) <span class="id" title="var">_</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#DeployFacts"><span class="id" title="variable">DeployFacts</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="ConCert.Execution.Blockchain.html#transfer_balance"><span class="id" title="definition">transfer_balance</span></a> <span class="id" title="var">from</span> <span class="id" title="var">to</span> <span class="id" title="var">amount</span> <a class="idref" href="ConCert.Execution.Blockchain.html#bstate_from"><span class="id" title="variable">bstate_from</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="ConCert.Execution.Blockchain.html#build_ctx"><span class="id" title="constructor">build_ctx</span></a> <span class="id" title="var">origin</span> <span class="id" title="var">from</span> <span class="id" title="var">to</span> <span class="id" title="var">amount</span> <span class="id" title="var">amount</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="ConCert.Execution.Blockchain.html#step_action"><span class="id" title="constructor">step_action</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">act</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> (<a class="idref" href="ConCert.Execution.Blockchain.html#eval_call"><span class="id" title="constructor">eval_call</span></a> <span class="id" title="var">origin</span> <span class="id" title="var">from</span> <span class="id" title="var">to</span> <span class="id" title="var">amount</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>) <span class="id" title="var">_</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">new_state</span> := <a class="idref" href="ConCert.Execution.Blockchain.html#transfer_balance"><span class="id" title="definition">transfer_balance</span></a> <span class="id" title="var">from</span> <span class="id" title="var">to</span> <span class="id" title="var">amount</span> <a class="idref" href="ConCert.Execution.Blockchain.html#bstate_from"><span class="id" title="variable">bstate_from</span></a> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">forall</span> (<span class="id" title="var">cstate</span> : <a class="idref" href="ConCert.Execution.Blockchain.html#State"><span class="id" title="variable">State</span></a>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#env_contracts"><span class="id" title="projection">env_contracts</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#bstate_from"><span class="id" title="variable">bstate_from</span></a> <span class="id" title="var">to</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> (<a class="idref" href="ConCert.Execution.Blockchain.html#contract"><span class="id" title="variable">contract</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#WeakContract"><span class="id" title="inductive">WeakContract</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#contract_state"><span class="id" title="definition">contract_state</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#bstate_from"><span class="id" title="variable">bstate_from</span></a> <span class="id" title="var">to</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#cstate"><span class="id" title="variable">cstate</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#CallFacts"><span class="id" title="variable">CallFacts</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#new_state"><span class="id" title="variable">new_state</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="ConCert.Execution.Blockchain.html#build_ctx"><span class="id" title="constructor">build_ctx</span></a> <span class="id" title="var">origin</span> <span class="id" title="var">from</span> <span class="id" title="var">to</span> (<a class="idref" href="ConCert.Execution.Blockchain.html#env_account_balances"><span class="id" title="projection">env_account_balances</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#new_state"><span class="id" title="variable">new_state</span></a> <span class="id" title="var">to</span>) <span class="id" title="var">amount</span>) <a class="idref" href="ConCert.Execution.Blockchain.html#cstate"><span class="id" title="variable">cstate</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="ConCert.Execution.Blockchain.html#outgoing_acts"><span class="id" title="definition">outgoing_acts</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#bstate_from"><span class="id" title="variable">bstate_from</span></a> <span class="id" title="var">to</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">_</span> =&gt; <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#True"><span class="id" title="inductive">Logic.True</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;Add&nbsp;block&nbsp;*)</span><br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">(</span></a><span class="id" title="keyword">forall</span> <span class="id" title="var">old_chain_height</span> <span class="id" title="var">old_cur_slot</span> <span class="id" title="var">old_fin_height</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">new_chain_height</span> <span class="id" title="var">new_cur_slot</span> <span class="id" title="var">new_fin_height</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">caddr</span> <span class="id" title="var">dep_info</span> <span class="id" title="var">state</span> <span class="id" title="var">balance</span> <span class="id" title="var">inc_calls</span> <span class="id" title="var">out_txs</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">facts</span> : <a class="idref" href="ConCert.Execution.Blockchain.html#AddBlockFacts"><span class="id" title="variable">AddBlockFacts</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#old_chain_height"><span class="id" title="variable">old_chain_height</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#old_cur_slot"><span class="id" title="variable">old_cur_slot</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#old_fin_height"><span class="id" title="variable">old_fin_height</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#new_chain_height"><span class="id" title="variable">new_chain_height</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#new_cur_slot"><span class="id" title="variable">new_cur_slot</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#new_fin_height"><span class="id" title="variable">new_fin_height</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">IH</span> : <a class="idref" href="ConCert.Execution.Blockchain.html#P"><span class="id" title="variable">P</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#old_chain_height"><span class="id" title="variable">old_chain_height</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#old_cur_slot"><span class="id" title="variable">old_cur_slot</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#old_fin_height"><span class="id" title="variable">old_fin_height</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#caddr"><span class="id" title="variable">caddr</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#dep_info"><span class="id" title="variable">dep_info</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#state"><span class="id" title="variable">state</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#balance"><span class="id" title="variable">balance</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#ae9a5e1034e143b218b09d8e454472bd"><span class="id" title="notation">[]</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#inc_calls"><span class="id" title="variable">inc_calls</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#out_txs"><span class="id" title="variable">out_txs</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">tag</span> : <a class="idref" href="ConCert.Execution.Blockchain.html#TagAddBlock"><span class="id" title="inductive">TagAddBlock</span></a>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#P"><span class="id" title="variable">P</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#new_chain_height"><span class="id" title="variable">new_chain_height</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#new_cur_slot"><span class="id" title="variable">new_cur_slot</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#new_fin_height"><span class="id" title="variable">new_fin_height</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#caddr"><span class="id" title="variable">caddr</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#dep_info"><span class="id" title="variable">dep_info</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#state"><span class="id" title="variable">state</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#balance"><span class="id" title="variable">balance</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#ae9a5e1034e143b218b09d8e454472bd"><span class="id" title="notation">[]</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#inc_calls"><span class="id" title="variable">inc_calls</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#out_txs"><span class="id" title="variable">out_txs</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;Deploy&nbsp;contract&nbsp;*)</span><br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">(</span></a><span class="id" title="keyword">forall</span> <span class="id" title="var">chain</span> <span class="id" title="var">ctx</span> <span class="id" title="var">setup</span> <span class="id" title="var">result</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">facts</span> : <a class="idref" href="ConCert.Execution.Blockchain.html#DeployFacts"><span class="id" title="variable">DeployFacts</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#chain"><span class="id" title="variable">chain</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#ctx"><span class="id" title="variable">ctx</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">init_some</span> : <a class="idref" href="ConCert.Execution.Blockchain.html#init"><span class="id" title="projection">init</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#contract"><span class="id" title="variable">contract</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#chain"><span class="id" title="variable">chain</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#ctx"><span class="id" title="variable">ctx</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#setup"><span class="id" title="variable">setup</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#result"><span class="id" title="variable">result</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">tag</span> : <a class="idref" href="ConCert.Execution.Blockchain.html#TagDeployment"><span class="id" title="inductive">TagDeployment</span></a>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#P"><span class="id" title="variable">P</span></a> (<a class="idref" href="ConCert.Execution.Blockchain.html#chain_height"><span class="id" title="projection">chain_height</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#chain"><span class="id" title="variable">chain</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="ConCert.Execution.Blockchain.html#current_slot"><span class="id" title="projection">current_slot</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#chain"><span class="id" title="variable">chain</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="ConCert.Execution.Blockchain.html#finalized_height"><span class="id" title="projection">finalized_height</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#chain"><span class="id" title="variable">chain</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="ConCert.Execution.Blockchain.html#ctx_contract_address"><span class="id" title="projection">ctx_contract_address</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#ctx"><span class="id" title="variable">ctx</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="ConCert.Execution.Blockchain.html#build_deployment_info"><span class="id" title="constructor">build_deployment_info</span></a> (<a class="idref" href="ConCert.Execution.Blockchain.html#ctx_origin"><span class="id" title="projection">ctx_origin</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#ctx"><span class="id" title="variable">ctx</span></a>) (<a class="idref" href="ConCert.Execution.Blockchain.html#ctx_from"><span class="id" title="projection">ctx_from</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#ctx"><span class="id" title="variable">ctx</span></a>) (<a class="idref" href="ConCert.Execution.Blockchain.html#ctx_amount"><span class="id" title="projection">ctx_amount</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#ctx"><span class="id" title="variable">ctx</span></a>) <a class="idref" href="ConCert.Execution.Blockchain.html#setup"><span class="id" title="variable">setup</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#result"><span class="id" title="variable">result</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="ConCert.Execution.Blockchain.html#ctx_amount"><span class="id" title="projection">ctx_amount</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#ctx"><span class="id" title="variable">ctx</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#ae9a5e1034e143b218b09d8e454472bd"><span class="id" title="notation">[]</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#ae9a5e1034e143b218b09d8e454472bd"><span class="id" title="notation">[]</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#ae9a5e1034e143b218b09d8e454472bd"><span class="id" title="notation">[]</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;Transfer/call/deploy&nbsp;to&nbsp;someone&nbsp;else&nbsp;*)</span><br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">(</span></a><span class="id" title="keyword">forall</span> <span class="id" title="var">height</span> <span class="id" title="var">slot</span> <span class="id" title="var">fin_height</span> <span class="id" title="var">caddr</span> <span class="id" title="var">dep_info</span> <span class="id" title="var">cstate</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">balance</span> <span class="id" title="var">out_act</span> <span class="id" title="var">out_acts</span> <span class="id" title="var">inc_calls</span> <span class="id" title="var">prev_out_txs</span> <span class="id" title="var">tx</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">IH</span> : <a class="idref" href="ConCert.Execution.Blockchain.html#P"><span class="id" title="variable">P</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#height"><span class="id" title="variable">height</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#slot"><span class="id" title="variable">slot</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#fin_height"><span class="id" title="variable">fin_height</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#caddr"><span class="id" title="variable">caddr</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#dep_info"><span class="id" title="variable">dep_info</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#cstate"><span class="id" title="variable">cstate</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#balance"><span class="id" title="variable">balance</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="ConCert.Execution.Blockchain.html#out_act"><span class="id" title="variable">out_act</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#cbcf67aac0c2a85b8d93d37de9969adf"><span class="id" title="notation">::</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#out_acts"><span class="id" title="variable">out_acts</span></a>) <a class="idref" href="ConCert.Execution.Blockchain.html#inc_calls"><span class="id" title="variable">inc_calls</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#prev_out_txs"><span class="id" title="variable">prev_out_txs</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">tx_from_caddr</span> : <a class="idref" href="ConCert.Execution.Blockchain.html#tx_from"><span class="id" title="projection">tx_from</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#tx"><span class="id" title="variable">tx</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#caddr"><span class="id" title="variable">caddr</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">tx_amount_eq</span> : <a class="idref" href="ConCert.Execution.Blockchain.html#tx_amount"><span class="id" title="projection">tx_amount</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#tx"><span class="id" title="variable">tx</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#act_body_amount"><span class="id" title="definition">act_body_amount</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#out_act"><span class="id" title="variable">out_act</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">tx_act_match</span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="ConCert.Execution.Blockchain.html#out_act"><span class="id" title="variable">out_act</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="ConCert.Execution.Blockchain.html#act_transfer"><span class="id" title="constructor">act_transfer</span></a> <span class="id" title="var">to</span> <span class="id" title="var">amount</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#tx_to"><span class="id" title="projection">tx_to</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#tx"><span class="id" title="variable">tx</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <span class="id" title="var">to</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">/\</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#tx_amount"><span class="id" title="projection">tx_amount</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#tx"><span class="id" title="variable">tx</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <span class="id" title="var">amount</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">/\</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Execution.Blockchain.html#tx_body"><span class="id" title="projection">tx_body</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#tx"><span class="id" title="variable">tx</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#tx_empty"><span class="id" title="constructor">tx_empty</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#f031fe1957c4a4a8e217aa46af2b4e25"><span class="id" title="notation">\/</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#tx_body"><span class="id" title="projection">tx_body</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#tx"><span class="id" title="variable">tx</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#tx_call"><span class="id" title="constructor">tx_call</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">)</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="ConCert.Execution.Blockchain.html#act_deploy"><span class="id" title="constructor">act_deploy</span></a> <span class="id" title="var">amount</span> <span class="id" title="var">wc</span> <span class="id" title="var">setup</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#tx_amount"><span class="id" title="projection">tx_amount</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#tx"><span class="id" title="variable">tx</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <span class="id" title="var">amount</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">/\</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#tx_body"><span class="id" title="projection">tx_body</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#tx"><span class="id" title="variable">tx</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#tx_deploy"><span class="id" title="constructor">tx_deploy</span></a> <span class="id" title="var">wc</span> <span class="id" title="var">setup</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="ConCert.Execution.Blockchain.html#act_call"><span class="id" title="constructor">act_call</span></a> <span class="id" title="var">to</span> <span class="id" title="var">amount</span> <span class="id" title="var">msg</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#tx_to"><span class="id" title="projection">tx_to</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#tx"><span class="id" title="variable">tx</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <span class="id" title="var">to</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">/\</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#tx_amount"><span class="id" title="projection">tx_amount</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#tx"><span class="id" title="variable">tx</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <span class="id" title="var">amount</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">/\</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#tx_body"><span class="id" title="projection">tx_body</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#tx"><span class="id" title="variable">tx</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#tx_call"><span class="id" title="constructor">tx_call</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <span class="id" title="var">msg</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">tag</span> : <a class="idref" href="ConCert.Execution.Blockchain.html#TagOutgoingAct"><span class="id" title="inductive">TagOutgoingAct</span></a>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#P"><span class="id" title="variable">P</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#height"><span class="id" title="variable">height</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#slot"><span class="id" title="variable">slot</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#fin_height"><span class="id" title="variable">fin_height</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#caddr"><span class="id" title="variable">caddr</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#dep_info"><span class="id" title="variable">dep_info</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#cstate"><span class="id" title="variable">cstate</span></a> (<a class="idref" href="ConCert.Execution.Blockchain.html#balance"><span class="id" title="variable">balance</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.ZArith.BinInt.html#fa12f60d56cf7225f009c889c0622139"><span class="id" title="notation">-</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#act_body_amount"><span class="id" title="definition">act_body_amount</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#out_act"><span class="id" title="variable">out_act</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#out_acts"><span class="id" title="variable">out_acts</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#inc_calls"><span class="id" title="variable">inc_calls</span></a> (<a class="idref" href="ConCert.Execution.Blockchain.html#tx"><span class="id" title="variable">tx</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#cbcf67aac0c2a85b8d93d37de9969adf"><span class="id" title="notation">::</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#prev_out_txs"><span class="id" title="variable">prev_out_txs</span></a>)<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;Non-recursive&nbsp;call&nbsp;*)</span><br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">(</span></a><span class="id" title="keyword">forall</span> <span class="id" title="var">chain</span> <span class="id" title="var">ctx</span> <span class="id" title="var">dep_info</span> <span class="id" title="var">prev_state</span> <span class="id" title="var">msg</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">prev_out_queue</span> <span class="id" title="var">prev_inc_calls</span> <span class="id" title="var">prev_out_txs</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">new_state</span> <span class="id" title="var">new_acts</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">from_other</span> : <a class="idref" href="ConCert.Execution.Blockchain.html#ctx_from"><span class="id" title="projection">ctx_from</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#ctx"><span class="id" title="variable">ctx</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#a0a5068f83a704fcfbda8cd473a6cfea"><span class="id" title="notation">&lt;&gt;</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#ctx_contract_address"><span class="id" title="projection">ctx_contract_address</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#ctx"><span class="id" title="variable">ctx</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">facts</span> : <a class="idref" href="ConCert.Execution.Blockchain.html#CallFacts"><span class="id" title="variable">CallFacts</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#chain"><span class="id" title="variable">chain</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#ctx"><span class="id" title="variable">ctx</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#prev_state"><span class="id" title="variable">prev_state</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#prev_out_queue"><span class="id" title="variable">prev_out_queue</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">IH</span> : <a class="idref" href="ConCert.Execution.Blockchain.html#P"><span class="id" title="variable">P</span></a> (<a class="idref" href="ConCert.Execution.Blockchain.html#chain_height"><span class="id" title="projection">chain_height</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#chain"><span class="id" title="variable">chain</span></a>) (<a class="idref" href="ConCert.Execution.Blockchain.html#current_slot"><span class="id" title="projection">current_slot</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#chain"><span class="id" title="variable">chain</span></a>) (<a class="idref" href="ConCert.Execution.Blockchain.html#finalized_height"><span class="id" title="projection">finalized_height</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#chain"><span class="id" title="variable">chain</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="ConCert.Execution.Blockchain.html#ctx_contract_address"><span class="id" title="projection">ctx_contract_address</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#ctx"><span class="id" title="variable">ctx</span></a>) <a class="idref" href="ConCert.Execution.Blockchain.html#dep_info"><span class="id" title="variable">dep_info</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#prev_state"><span class="id" title="variable">prev_state</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="ConCert.Execution.Blockchain.html#ctx_contract_balance"><span class="id" title="projection">ctx_contract_balance</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#ctx"><span class="id" title="variable">ctx</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.ZArith.BinInt.html#fa12f60d56cf7225f009c889c0622139"><span class="id" title="notation">-</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#ctx_amount"><span class="id" title="projection">ctx_amount</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#ctx"><span class="id" title="variable">ctx</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#prev_out_queue"><span class="id" title="variable">prev_out_queue</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#prev_inc_calls"><span class="id" title="variable">prev_inc_calls</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#prev_out_txs"><span class="id" title="variable">prev_out_txs</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">receive_some</span> : <a class="idref" href="ConCert.Execution.Blockchain.html#receive"><span class="id" title="projection">receive</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#contract"><span class="id" title="variable">contract</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#chain"><span class="id" title="variable">chain</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#ctx"><span class="id" title="variable">ctx</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#prev_state"><span class="id" title="variable">prev_state</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#msg"><span class="id" title="variable">msg</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Execution.Blockchain.html#new_state"><span class="id" title="variable">new_state</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#new_acts"><span class="id" title="variable">new_acts</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">tag</span> : <a class="idref" href="ConCert.Execution.Blockchain.html#TagNonrecursiveCall"><span class="id" title="inductive">TagNonrecursiveCall</span></a>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#P"><span class="id" title="variable">P</span></a> (<a class="idref" href="ConCert.Execution.Blockchain.html#chain_height"><span class="id" title="projection">chain_height</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#chain"><span class="id" title="variable">chain</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="ConCert.Execution.Blockchain.html#current_slot"><span class="id" title="projection">current_slot</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#chain"><span class="id" title="variable">chain</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="ConCert.Execution.Blockchain.html#finalized_height"><span class="id" title="projection">finalized_height</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#chain"><span class="id" title="variable">chain</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="ConCert.Execution.Blockchain.html#ctx_contract_address"><span class="id" title="projection">ctx_contract_address</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#ctx"><span class="id" title="variable">ctx</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#dep_info"><span class="id" title="variable">dep_info</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#new_state"><span class="id" title="variable">new_state</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="ConCert.Execution.Blockchain.html#ctx_contract_balance"><span class="id" title="projection">ctx_contract_balance</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#ctx"><span class="id" title="variable">ctx</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="ConCert.Execution.Blockchain.html#new_acts"><span class="id" title="variable">new_acts</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#bc347c51eaf667706ae54503b26d52c6"><span class="id" title="notation">++</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#prev_out_queue"><span class="id" title="variable">prev_out_queue</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="ConCert.Execution.Blockchain.html#build_call_info"><span class="id" title="constructor">build_call_info</span></a> (<a class="idref" href="ConCert.Execution.Blockchain.html#ctx_origin"><span class="id" title="projection">ctx_origin</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#ctx"><span class="id" title="variable">ctx</span></a>) (<a class="idref" href="ConCert.Execution.Blockchain.html#ctx_from"><span class="id" title="projection">ctx_from</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#ctx"><span class="id" title="variable">ctx</span></a>) (<a class="idref" href="ConCert.Execution.Blockchain.html#ctx_amount"><span class="id" title="projection">ctx_amount</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#ctx"><span class="id" title="variable">ctx</span></a>) <a class="idref" href="ConCert.Execution.Blockchain.html#msg"><span class="id" title="variable">msg</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#cbcf67aac0c2a85b8d93d37de9969adf"><span class="id" title="notation">::</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#prev_inc_calls"><span class="id" title="variable">prev_inc_calls</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#prev_out_txs"><span class="id" title="variable">prev_out_txs</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;Recursive&nbsp;call&nbsp;*)</span><br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">(</span></a><span class="id" title="keyword">forall</span> <span class="id" title="var">chain</span> <span class="id" title="var">ctx</span> <span class="id" title="var">dep_info</span> <span class="id" title="var">prev_state</span> <span class="id" title="var">msg</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">head</span> <span class="id" title="var">prev_out_queue</span> <span class="id" title="var">prev_inc_calls</span> <span class="id" title="var">prev_out_txs</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">new_state</span> <span class="id" title="var">new_acts</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">from_self</span> : <a class="idref" href="ConCert.Execution.Blockchain.html#ctx_from"><span class="id" title="projection">ctx_from</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#ctx"><span class="id" title="variable">ctx</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#ctx_contract_address"><span class="id" title="projection">ctx_contract_address</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#ctx"><span class="id" title="variable">ctx</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">facts</span> : <a class="idref" href="ConCert.Execution.Blockchain.html#CallFacts"><span class="id" title="variable">CallFacts</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#chain"><span class="id" title="variable">chain</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#ctx"><span class="id" title="variable">ctx</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#prev_state"><span class="id" title="variable">prev_state</span></a> (<a class="idref" href="ConCert.Execution.Blockchain.html#head"><span class="id" title="variable">head</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#cbcf67aac0c2a85b8d93d37de9969adf"><span class="id" title="notation">::</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#prev_out_queue"><span class="id" title="variable">prev_out_queue</span></a>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">IH</span> : <a class="idref" href="ConCert.Execution.Blockchain.html#P"><span class="id" title="variable">P</span></a> (<a class="idref" href="ConCert.Execution.Blockchain.html#chain_height"><span class="id" title="projection">chain_height</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#chain"><span class="id" title="variable">chain</span></a>) (<a class="idref" href="ConCert.Execution.Blockchain.html#current_slot"><span class="id" title="projection">current_slot</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#chain"><span class="id" title="variable">chain</span></a>) (<a class="idref" href="ConCert.Execution.Blockchain.html#finalized_height"><span class="id" title="projection">finalized_height</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#chain"><span class="id" title="variable">chain</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="ConCert.Execution.Blockchain.html#ctx_contract_address"><span class="id" title="projection">ctx_contract_address</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#ctx"><span class="id" title="variable">ctx</span></a>) <a class="idref" href="ConCert.Execution.Blockchain.html#dep_info"><span class="id" title="variable">dep_info</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#prev_state"><span class="id" title="variable">prev_state</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="ConCert.Execution.Blockchain.html#ctx_contract_balance"><span class="id" title="projection">ctx_contract_balance</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#ctx"><span class="id" title="variable">ctx</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="ConCert.Execution.Blockchain.html#head"><span class="id" title="variable">head</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#cbcf67aac0c2a85b8d93d37de9969adf"><span class="id" title="notation">::</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#prev_out_queue"><span class="id" title="variable">prev_out_queue</span></a>) <a class="idref" href="ConCert.Execution.Blockchain.html#prev_inc_calls"><span class="id" title="variable">prev_inc_calls</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#prev_out_txs"><span class="id" title="variable">prev_out_txs</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">action_facts</span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="ConCert.Execution.Blockchain.html#head"><span class="id" title="variable">head</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="ConCert.Execution.Blockchain.html#act_transfer"><span class="id" title="constructor">act_transfer</span></a> <span class="id" title="var">to</span> <span class="id" title="var">amount</span> =&gt; <span class="id" title="var">to</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#ctx_contract_address"><span class="id" title="projection">ctx_contract_address</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#ctx"><span class="id" title="variable">ctx</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">/\</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">amount</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#ctx_amount"><span class="id" title="projection">ctx_amount</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#ctx"><span class="id" title="variable">ctx</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">/\</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#msg"><span class="id" title="variable">msg</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="ConCert.Execution.Blockchain.html#act_call"><span class="id" title="constructor">act_call</span></a> <span class="id" title="var">to</span> <span class="id" title="var">amount</span> <span class="id" title="var">msg_ser</span> =&gt; <span class="id" title="var">to</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#ctx_contract_address"><span class="id" title="projection">ctx_contract_address</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#ctx"><span class="id" title="variable">ctx</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">/\</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">amount</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#ctx_amount"><span class="id" title="projection">ctx_amount</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#ctx"><span class="id" title="variable">ctx</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">/\</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#msg"><span class="id" title="variable">msg</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#a0a5068f83a704fcfbda8cd473a6cfea"><span class="id" title="notation">&lt;&gt;</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">/\</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Serializable.html#deserialize"><span class="id" title="method">deserialize</span></a> <span class="id" title="var">msg_ser</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#msg"><span class="id" title="variable">msg</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">_</span> =&gt; <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#False"><span class="id" title="inductive">False</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">receive_some</span> : <a class="idref" href="ConCert.Execution.Blockchain.html#receive"><span class="id" title="projection">receive</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#contract"><span class="id" title="variable">contract</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#chain"><span class="id" title="variable">chain</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#ctx"><span class="id" title="variable">ctx</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#prev_state"><span class="id" title="variable">prev_state</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#msg"><span class="id" title="variable">msg</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Execution.Blockchain.html#new_state"><span class="id" title="variable">new_state</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#new_acts"><span class="id" title="variable">new_acts</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">tag</span> : <a class="idref" href="ConCert.Execution.Blockchain.html#TagRecursiveCall"><span class="id" title="inductive">TagRecursiveCall</span></a>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#P"><span class="id" title="variable">P</span></a> (<a class="idref" href="ConCert.Execution.Blockchain.html#chain_height"><span class="id" title="projection">chain_height</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#chain"><span class="id" title="variable">chain</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="ConCert.Execution.Blockchain.html#current_slot"><span class="id" title="projection">current_slot</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#chain"><span class="id" title="variable">chain</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="ConCert.Execution.Blockchain.html#finalized_height"><span class="id" title="projection">finalized_height</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#chain"><span class="id" title="variable">chain</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="ConCert.Execution.Blockchain.html#ctx_contract_address"><span class="id" title="projection">ctx_contract_address</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#ctx"><span class="id" title="variable">ctx</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#dep_info"><span class="id" title="variable">dep_info</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#new_state"><span class="id" title="variable">new_state</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="ConCert.Execution.Blockchain.html#ctx_contract_balance"><span class="id" title="projection">ctx_contract_balance</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#ctx"><span class="id" title="variable">ctx</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="ConCert.Execution.Blockchain.html#new_acts"><span class="id" title="variable">new_acts</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#bc347c51eaf667706ae54503b26d52c6"><span class="id" title="notation">++</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#prev_out_queue"><span class="id" title="variable">prev_out_queue</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="ConCert.Execution.Blockchain.html#build_call_info"><span class="id" title="constructor">build_call_info</span></a> (<a class="idref" href="ConCert.Execution.Blockchain.html#ctx_origin"><span class="id" title="projection">ctx_origin</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#ctx"><span class="id" title="variable">ctx</span></a>) (<a class="idref" href="ConCert.Execution.Blockchain.html#ctx_from"><span class="id" title="projection">ctx_from</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#ctx"><span class="id" title="variable">ctx</span></a>) (<a class="idref" href="ConCert.Execution.Blockchain.html#ctx_amount"><span class="id" title="projection">ctx_amount</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#ctx"><span class="id" title="variable">ctx</span></a>) <a class="idref" href="ConCert.Execution.Blockchain.html#msg"><span class="id" title="variable">msg</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#cbcf67aac0c2a85b8d93d37de9969adf"><span class="id" title="notation">::</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#prev_inc_calls"><span class="id" title="variable">prev_inc_calls</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="ConCert.Execution.Blockchain.html#build_tx"><span class="id" title="constructor">build_tx</span></a> (<a class="idref" href="ConCert.Execution.Blockchain.html#ctx_origin"><span class="id" title="projection">ctx_origin</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#ctx"><span class="id" title="variable">ctx</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="ConCert.Execution.Blockchain.html#ctx_from"><span class="id" title="projection">ctx_from</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#ctx"><span class="id" title="variable">ctx</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="ConCert.Execution.Blockchain.html#ctx_contract_address"><span class="id" title="projection">ctx_contract_address</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#ctx"><span class="id" title="variable">ctx</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="ConCert.Execution.Blockchain.html#ctx_amount"><span class="id" title="projection">ctx_amount</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#ctx"><span class="id" title="variable">ctx</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="ConCert.Execution.Blockchain.html#tx_call"><span class="id" title="constructor">tx_call</span></a> (<span class="id" title="keyword">match</span> <a class="idref" href="ConCert.Execution.Blockchain.html#head"><span class="id" title="variable">head</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="ConCert.Execution.Blockchain.html#act_call"><span class="id" title="constructor">act_call</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">msg</span> =&gt; <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#msg"><span class="id" title="variable">msg</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">_</span> =&gt; <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>)) <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#cbcf67aac0c2a85b8d93d37de9969adf"><span class="id" title="notation">::</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#prev_out_txs"><span class="id" title="variable">prev_out_txs</span></a>)<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;Queue&nbsp;permutation&nbsp;*)</span><br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">(</span></a><span class="id" title="keyword">forall</span> <span class="id" title="var">height</span> <span class="id" title="var">slot</span> <span class="id" title="var">fin_height</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">caddr</span> <span class="id" title="var">dep_info</span> <span class="id" title="var">cstate</span> <span class="id" title="var">balance</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">out_queue</span> <span class="id" title="var">inc_calls</span> <span class="id" title="var">out_txs</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">out_queue'</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">IH</span> : <a class="idref" href="ConCert.Execution.Blockchain.html#P"><span class="id" title="variable">P</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#height"><span class="id" title="variable">height</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#slot"><span class="id" title="variable">slot</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#fin_height"><span class="id" title="variable">fin_height</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#caddr"><span class="id" title="variable">caddr</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#dep_info"><span class="id" title="variable">dep_info</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#cstate"><span class="id" title="variable">cstate</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#balance"><span class="id" title="variable">balance</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#out_queue"><span class="id" title="variable">out_queue</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#inc_calls"><span class="id" title="variable">inc_calls</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#out_txs"><span class="id" title="variable">out_txs</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">perm</span> : <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Sorting.Permutation.html#Permutation"><span class="id" title="inductive">Permutation</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#out_queue"><span class="id" title="variable">out_queue</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#out_queue'"><span class="id" title="variable">out_queue'</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">tag</span> : <a class="idref" href="ConCert.Execution.Blockchain.html#TagPermuteQueue"><span class="id" title="inductive">TagPermuteQueue</span></a>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#P"><span class="id" title="variable">P</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#height"><span class="id" title="variable">height</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#slot"><span class="id" title="variable">slot</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#fin_height"><span class="id" title="variable">fin_height</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#caddr"><span class="id" title="variable">caddr</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#dep_info"><span class="id" title="variable">dep_info</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#cstate"><span class="id" title="variable">cstate</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#balance"><span class="id" title="variable">balance</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#out_queue'"><span class="id" title="variable">out_queue'</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#inc_calls"><span class="id" title="variable">inc_calls</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#out_txs"><span class="id" title="variable">out_txs</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
<br/>
&nbsp;&nbsp;<span class="id" title="keyword">forall</span> <span class="id" title="var">bstate</span> <span class="id" title="var">caddr</span> (<span class="id" title="var">trace</span> : <a class="idref" href="ConCert.Execution.Blockchain.html#ChainTrace"><span class="id" title="definition">ChainTrace</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#empty_state"><span class="id" title="definition">empty_state</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#bstate"><span class="id" title="variable">bstate</span></a>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#env_contracts"><span class="id" title="projection">env_contracts</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#bstate"><span class="id" title="variable">bstate</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#caddr"><span class="id" title="variable">caddr</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> (<a class="idref" href="ConCert.Execution.Blockchain.html#contract"><span class="id" title="variable">contract</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#WeakContract"><span class="id" title="inductive">WeakContract</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">exists</span></a> <span class="id" title="var">dep</span> <span class="id" title="var">cstate</span> <span class="id" title="var">inc_calls</span><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">,</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#deployment_info"><span class="id" title="definition">deployment_info</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#Setup"><span class="id" title="variable">Setup</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#trace"><span class="id" title="variable">trace</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#caddr"><span class="id" title="variable">caddr</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#dep"><span class="id" title="variable">dep</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">/\</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#contract_state"><span class="id" title="definition">contract_state</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#bstate"><span class="id" title="variable">bstate</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#caddr"><span class="id" title="variable">caddr</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#cstate"><span class="id" title="variable">cstate</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">/\</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#incoming_calls"><span class="id" title="definition">incoming_calls</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#Msg"><span class="id" title="variable">Msg</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#trace"><span class="id" title="variable">trace</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#caddr"><span class="id" title="variable">caddr</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#inc_calls"><span class="id" title="variable">inc_calls</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">/\</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#P"><span class="id" title="variable">P</span></a> (<a class="idref" href="ConCert.Execution.Blockchain.html#chain_height"><span class="id" title="projection">chain_height</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#bstate"><span class="id" title="variable">bstate</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="ConCert.Execution.Blockchain.html#current_slot"><span class="id" title="projection">current_slot</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#bstate"><span class="id" title="variable">bstate</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="ConCert.Execution.Blockchain.html#finalized_height"><span class="id" title="projection">finalized_height</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#bstate"><span class="id" title="variable">bstate</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#caddr"><span class="id" title="variable">caddr</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#dep"><span class="id" title="variable">dep</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#cstate"><span class="id" title="variable">cstate</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="ConCert.Execution.Blockchain.html#env_account_balances"><span class="id" title="projection">env_account_balances</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#bstate"><span class="id" title="variable">bstate</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#caddr"><span class="id" title="variable">caddr</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="ConCert.Execution.Blockchain.html#outgoing_acts"><span class="id" title="definition">outgoing_acts</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#bstate"><span class="id" title="variable">bstate</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#caddr"><span class="id" title="variable">caddr</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#inc_calls"><span class="id" title="variable">inc_calls</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="ConCert.Execution.Blockchain.html#outgoing_txs"><span class="id" title="definition">outgoing_txs</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#trace"><span class="id" title="variable">trace</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#caddr"><span class="id" title="variable">caddr</span></a>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">establish_facts</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">add_block_case</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">init_case</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">transfer_case</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">nonrecursive_call_case</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">recursive_call_case</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">permute_queue_case</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">bstate</span> <span class="id" title="var">caddr</span> <span class="id" title="var">trace</span> <span class="id" title="var">contract_deployed</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<a class="idref" href="ConCert.Execution.Blockchain.html#address_is_contract"><span class="id" title="method">address_is_contract</span></a> <span class="id" title="var">caddr</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#true"><span class="id" title="constructor">true</span></a>) <span class="id" title="keyword">as</span> <span class="id" title="var">is_contract</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">by</span> (<span class="id" title="tactic">eapply</span> <a class="idref" href="ConCert.Execution.Blockchain.html#contract_addr_format"><span class="id" title="lemma">contract_addr_format</span></a>; <span class="id" title="tactic">eauto</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="ConCert.Execution.Blockchain.html#contract_state"><span class="id" title="definition">contract_state</span></a> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;<span class="id" title="var">remember</span> <a class="idref" href="ConCert.Execution.Blockchain.html#empty_state"><span class="id" title="definition">empty_state</span></a>; <span class="id" title="tactic">induction</span> <span class="id" title="var">trace</span> <span class="id" title="keyword">as</span> [|? ? ? ? <span class="id" title="var">IH</span>];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span>; <span class="id" title="tactic">subst</span>; <span class="id" title="tactic">try</span> <span class="id" title="tactic">solve</span> [<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *; <span class="id" title="tactic">congruence</span>].<br/>
&nbsp;&nbsp;<span class="id" title="tactic">specialize</span> (<span class="id" title="var">establish_facts</span> <span class="id" title="var">mid</span> <span class="id" title="var">to</span> <span class="id" title="keyword">ltac</span>:(<span class="id" title="tactic">auto</span>) <span class="id" title="keyword">ltac</span>:(<span class="id" title="tactic">auto</span>) <a class="idref" href="ConCert.Execution.Blockchain.html#tag_facts"><span class="id" title="constructor">tag_facts</span></a>).<br/>
&nbsp;&nbsp;<span class="id" title="var">destruct_chain_step</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;[|<span class="id" title="tactic">clear</span> <span class="id" title="var">add_block_case</span>; <span class="id" title="var">destruct_action_eval</span>; <span class="id" title="var">rewrite_environment_equiv</span>; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *| |].<br/>
&nbsp;&nbsp;- <span class="comment">(*&nbsp;New&nbsp;block&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">clear</span> <span class="id" title="var">init_case</span> <span class="id" title="var">recursive_call_case</span> <span class="id" title="var">nonrecursive_call_case</span> <span class="id" title="var">permute_queue_case</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">rewrite_environment_equiv</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">specialize_hypotheses</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">IH</span> <span class="id" title="keyword">as</span> (<span class="id" title="var">depinfo'</span> &amp; <span class="id" title="var">cstate'</span> &amp; <span class="id" title="var">inc_calls'</span> &amp; -&gt; &amp; ? &amp; -&gt; &amp; ?).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">exists</span> <span class="id" title="var">depinfo'</span>, <span class="id" title="var">cstate'</span>, <span class="id" title="var">inc_calls'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">rewrite_environment_equiv</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">repeat</span> <span class="id" title="tactic">split</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">inversion</span> <span class="id" title="var">valid_header</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">destruct_address_eq</span>; <span class="id" title="tactic">try</span> <span class="id" title="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="ConCert.Execution.Blockchain.html#outgoing_acts_after_block_nil"><span class="id" title="lemma">outgoing_acts_after_block_nil</span></a> <span class="id" title="tactic">by</span> <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="ConCert.Execution.Blockchain.html#outgoing_acts"><span class="id" title="definition">outgoing_acts</span></a> <span class="id" title="tactic">in</span> *; <span class="id" title="tactic">rewrite</span> <span class="id" title="var">queue_prev</span> <span class="id" title="tactic">in</span> *; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <span class="id" title="var">add_block_case</span>; <span class="id" title="tactic">try</span> <span class="id" title="tactic">constructor</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">apply</span> <span class="id" title="var">establish_facts</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;- <span class="comment">(*&nbsp;Evaluation:&nbsp;transfer&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">clear</span> <span class="id" title="var">init_case</span> <span class="id" title="var">recursive_call_case</span> <span class="id" title="var">nonrecursive_call_case</span> <span class="id" title="var">permute_queue_case</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">specialize_hypotheses</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">IH</span> <span class="id" title="keyword">as</span> (<span class="id" title="var">depinfo'</span> &amp; <span class="id" title="var">cstate'</span> &amp; <span class="id" title="var">inc_calls'</span> &amp; -&gt; &amp; ? &amp; -&gt; &amp; ?).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">exists</span> <span class="id" title="var">depinfo'</span>, <span class="id" title="var">cstate'</span>, <span class="id" title="var">inc_calls'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">rewrite_environment_equiv</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">repeat</span> <span class="id" title="tactic">split</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> (<a class="idref" href="ConCert.Execution.Blockchain.html#address_eq_sym"><span class="id" title="lemma">address_eq_sym</span></a> <span class="id" title="var">from_addr</span>) <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;Transfer&nbsp;cannot&nbsp;be&nbsp;to&nbsp;contract&nbsp;as&nbsp;that&nbsp;would&nbsp;be&nbsp;a<br/>
&nbsp;&nbsp;&nbsp;&nbsp;call.&nbsp;Resolve&nbsp;this&nbsp;now.&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<a class="idref" href="ConCert.Execution.Blockchain.html#address_eqb_spec"><span class="id" title="method">address_eqb_spec</span></a> <span class="id" title="var">caddr</span> <span class="id" title="var">to_addr</span>) <span class="id" title="keyword">as</span> [-&gt;|];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *; <span class="id" title="tactic">try</span> <span class="id" title="tactic">congruence</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="ConCert.Execution.Blockchain.html#outgoing_acts"><span class="id" title="definition">outgoing_acts</span></a> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">queue_prev</span>, <span class="id" title="var">queue_new</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| [ <span class="id" title="var">H</span> : <span class="id" title="var">act</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <span class="id" title="var">_</span> |- <span class="id" title="var">_</span> ] =&gt; <span class="id" title="tactic">rewrite</span> <span class="id" title="var">H</span> <span class="id" title="tactic">in</span> *<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> (<a class="idref" href="ConCert.Execution.Blockchain.html#address_eq_sym"><span class="id" title="lemma">address_eq_sym</span></a> <span class="id" title="var">from_addr</span>) <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<a class="idref" href="ConCert.Execution.Blockchain.html#address_eqb_spec"><span class="id" title="method">address_eqb_spec</span></a> <span class="id" title="var">caddr</span> <span class="id" title="var">from_addr</span>) <span class="id" title="keyword">as</span> [&lt;-|];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="comment">(*&nbsp;Transfer&nbsp;from&nbsp;contract&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">remember</span> (<a class="idref" href="ConCert.Execution.Blockchain.html#act_transfer"><span class="id" title="constructor">act_transfer</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span>) <span class="id" title="keyword">as</span> <span class="id" title="var">out_act</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">replace</span> (<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.ZArith.BinInt.html#84c6e304dcb36f79add2a7dcc558eca1"><span class="id" title="notation">-</span></a><span class="id" title="var">amount</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.ZArith.BinInt.html#46584eddd5fdb16176a10a2843177d3a"><span class="id" title="notation">+</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#env_account_balances"><span class="id" title="projection">env_account_balances</span></a> <span class="id" title="var">mid</span> <span class="id" title="var">caddr</span>) <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="ConCert.Execution.Blockchain.html#env_account_balances"><span class="id" title="projection">env_account_balances</span></a> <span class="id" title="var">mid</span> <span class="id" title="var">caddr</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.ZArith.BinInt.html#fa12f60d56cf7225f009c889c0622139"><span class="id" title="notation">-</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#act_body_amount"><span class="id" title="definition">act_body_amount</span></a> <span class="id" title="var">out_act</span>) <span class="id" title="tactic">by</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="tactic">subst</span>; <span class="id" title="var">cbn</span>; <span class="id" title="var">lia</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">transfer_case</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="comment">(*&nbsp;Irrelevant&nbsp;transfer&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;- <span class="comment">(*&nbsp;Evaluation:&nbsp;Deploy&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">clear</span> <span class="id" title="var">recursive_call_case</span> <span class="id" title="var">nonrecursive_call_case</span> <span class="id" title="var">permute_queue_case</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> (<a class="idref" href="ConCert.Execution.Blockchain.html#address_eq_sym"><span class="id" title="lemma">address_eq_sym</span></a> <span class="id" title="var">to_addr</span> <span class="id" title="var">caddr</span>) <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<a class="idref" href="ConCert.Execution.Blockchain.html#address_eqb_spec"><span class="id" title="method">address_eqb_spec</span></a> <span class="id" title="var">caddr</span> <span class="id" title="var">to_addr</span>) <span class="id" title="keyword">as</span> [-&gt;|]; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="comment">(*&nbsp;Deployment&nbsp;of&nbsp;this&nbsp;contract&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">replace</span> <span class="id" title="var">wc</span> <span class="id" title="keyword">with</span> (<span class="id" title="var">contract</span> : <a class="idref" href="ConCert.Execution.Blockchain.html#WeakContract"><span class="id" title="inductive">WeakContract</span></a>) <span class="id" title="tactic">in</span> * <span class="id" title="tactic">by</span> <span class="id" title="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| [ <span class="id" title="var">H</span> : <a class="idref" href="ConCert.Execution.Blockchain.html#wc_init"><span class="id" title="definition">wc_init</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <span class="id" title="var">_</span> |- <span class="id" title="var">_</span> ] =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<a class="idref" href="ConCert.Execution.Blockchain.html#wc_init_strong"><span class="id" title="lemma">wc_init_strong</span></a> <span class="id" title="var">H</span>) <span class="id" title="keyword">as</span> (<span class="id" title="var">setup_strong</span> &amp; <span class="id" title="var">result_strong</span> &amp; <span class="id" title="var">deser_setup_eq</span> &amp; &lt;- &amp; <span class="id" title="var">init</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">deser_setup_eq</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">exists</span> (<a class="idref" href="ConCert.Execution.Blockchain.html#build_deployment_info"><span class="id" title="constructor">build_deployment_info</span></a> <span class="id" title="var">origin</span> <span class="id" title="var">from_addr</span> <span class="id" title="var">amount</span> <span class="id" title="var">setup_strong</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">result_strong</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#ae9a5e1034e143b218b09d8e454472bd"><span class="id" title="notation">[]</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">rewrite_environment_equiv</span>; <span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="ConCert.Execution.Blockchain.html#address_eq_refl"><span class="id" title="lemma">address_eq_refl</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="ConCert.Execution.Serializable.html#deserialize_serialize"><span class="id" title="method">deserialize_serialize</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<a class="idref" href="ConCert.Execution.Blockchain.html#incoming_calls"><span class="id" title="definition">incoming_calls</span></a> <span class="id" title="var">Msg</span> <span class="id" title="var">trace</span> <span class="id" title="var">to_addr</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#ae9a5e1034e143b218b09d8e454472bd"><span class="id" title="notation">[]</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">by</span> (<span class="id" title="tactic">apply</span> <a class="idref" href="ConCert.Execution.Blockchain.html#undeployed_contract_no_in_calls"><span class="id" title="lemma">undeployed_contract_no_in_calls</span></a>; <span class="id" title="tactic">auto</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="ConCert.Execution.Blockchain.html#incoming_calls"><span class="id" title="definition">incoming_calls</span></a> <span class="id" title="tactic">in</span> *; <span class="id" title="tactic">rewrite</span> <span class="id" title="var">is_contract</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">repeat</span> <span class="id" title="tactic">split</span>; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *; <span class="id" title="tactic">subst</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="ConCert.Execution.Blockchain.html#outgoing_acts"><span class="id" title="definition">outgoing_acts</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">queue_new</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> (<a class="idref" href="ConCert.Execution.Blockchain.html#address_eq_sym"><span class="id" title="lemma">address_eq_sym</span></a> <span class="id" title="var">to_addr</span>) <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">fold</span> (<a class="idref" href="ConCert.Execution.Blockchain.html#outgoing_txs"><span class="id" title="definition">outgoing_txs</span></a> <span class="id" title="var">trace</span> <span class="id" title="var">to_addr</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">pose</span> <span class="id" title="var">proof</span> (<a class="idref" href="ConCert.Execution.Blockchain.html#undeployed_contract_no_out_queue"><span class="id" title="lemma">undeployed_contract_no_out_queue</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">to_addr</span> <span class="id" title="var">mid</span> <span class="id" title="keyword">ltac</span>:(<span class="id" title="tactic">auto</span>) <span class="id" title="keyword">ltac</span>:(<span class="id" title="tactic">auto</span>) <span class="id" title="keyword">ltac</span>:(<span class="id" title="tactic">auto</span>)) <span class="id" title="keyword">as</span> <span class="id" title="var">queue_ne_to</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">queue_prev</span> <span class="id" title="tactic">in</span> <span class="id" title="var">queue_ne_to</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">inversion_clear</span> <span class="id" title="var">queue_ne_to</span> <span class="id" title="keyword">as</span> [|? ? <span class="id" title="var">from_ne_to</span> <span class="id" title="var">rest_ne_to</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> <span class="id" title="var">from_ne_to</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> (<a class="idref" href="ConCert.Execution.Blockchain.html#address_eq_ne"><span class="id" title="lemma">address_eq_ne</span></a> <span class="id" title="var">from_addr</span> <span class="id" title="var">to_addr</span>) <span class="id" title="tactic">by</span> (<span class="id" title="var">destruct_address_eq</span>; <span class="id" title="tactic">auto</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="ConCert.Utils.Extras.html#Forall_false_filter_nil"><span class="id" title="lemma">Forall_false_filter_nil</span></a> <span class="id" title="tactic">by</span> <span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="ConCert.Execution.Blockchain.html#undeployed_contract_no_out_txs"><span class="id" title="lemma">undeployed_contract_no_out_txs</span></a>, <a class="idref" href="ConCert.Execution.Blockchain.html#undeployed_contract_balance_0"><span class="id" title="lemma">undeployed_contract_balance_0</span></a> <span class="id" title="tactic">by</span> <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">remember</span> (<a class="idref" href="ConCert.Execution.Blockchain.html#build_ctx"><span class="id" title="constructor">build_ctx</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>) <span class="id" title="keyword">as</span> <span class="id" title="var">ctx</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">replace</span> <span class="id" title="var">origin</span> <span class="id" title="keyword">with</span> (<a class="idref" href="ConCert.Execution.Blockchain.html#ctx_origin"><span class="id" title="projection">ctx_origin</span></a> <span class="id" title="var">ctx</span>) <span class="id" title="tactic">by</span> (<span class="id" title="tactic">subst</span>; <span class="id" title="tactic">auto</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">replace</span> <span class="id" title="var">from_addr</span> <span class="id" title="keyword">with</span> (<a class="idref" href="ConCert.Execution.Blockchain.html#ctx_from"><span class="id" title="projection">ctx_from</span></a> <span class="id" title="var">ctx</span>) <span class="id" title="tactic">by</span> (<span class="id" title="tactic">subst</span>; <span class="id" title="tactic">auto</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">replace</span> <span class="id" title="var">to_addr</span> <span class="id" title="keyword">with</span> (<a class="idref" href="ConCert.Execution.Blockchain.html#ctx_contract_address"><span class="id" title="projection">ctx_contract_address</span></a> <span class="id" title="var">ctx</span>) <span class="id" title="tactic">by</span> (<span class="id" title="tactic">subst</span>; <span class="id" title="tactic">auto</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">replace</span> <span class="id" title="var">amount</span> <span class="id" title="keyword">with</span> (<a class="idref" href="ConCert.Execution.Blockchain.html#ctx_amount"><span class="id" title="projection">ctx_amount</span></a> <span class="id" title="var">ctx</span>) <span class="id" title="tactic">by</span> (<span class="id" title="tactic">subst</span>; <span class="id" title="tactic">auto</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.ZArith.BinInt.html#Z.add_0_r"><span class="id" title="lemma">Z.add_0_r</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">init_case</span>;<span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="comment">(*&nbsp;Deployment&nbsp;of&nbsp;other&nbsp;contract,&nbsp;might&nbsp;be&nbsp;by&nbsp;this&nbsp;contract.&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">specialize_hypotheses</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">IH</span> <span class="id" title="keyword">as</span> (<span class="id" title="var">depinfo</span> &amp; <span class="id" title="var">cstate</span> &amp; <span class="id" title="var">inc_calls</span> &amp; -&gt; &amp; ? &amp; -&gt; &amp; ?).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">exists</span> <span class="id" title="var">depinfo</span>, <span class="id" title="var">cstate</span>, <span class="id" title="var">inc_calls</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">rewrite_environment_equiv</span>; <span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="ConCert.Execution.Blockchain.html#address_eq_ne"><span class="id" title="lemma">address_eq_ne</span></a> <span class="id" title="tactic">by</span> <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">repeat</span> <span class="id" title="tactic">split</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> (<a class="idref" href="ConCert.Execution.Blockchain.html#address_eq_sym"><span class="id" title="lemma">address_eq_sym</span></a> <span class="id" title="var">caddr</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="ConCert.Execution.Blockchain.html#outgoing_acts"><span class="id" title="definition">outgoing_acts</span></a> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">queue_prev</span>, <span class="id" title="var">queue_new</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| [ <span class="id" title="var">H</span> : <span class="id" title="var">act</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <span class="id" title="var">_</span> |- <span class="id" title="var">_</span> ] =&gt; <span class="id" title="tactic">rewrite</span> <span class="id" title="var">H</span> <span class="id" title="tactic">in</span> *<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">subst</span> <span class="id" title="var">new_acts</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">fold</span> (<a class="idref" href="ConCert.Execution.Blockchain.html#outgoing_txs"><span class="id" title="definition">outgoing_txs</span></a> <span class="id" title="var">trace</span> <span class="id" title="var">caddr</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">destruct_address_eq</span>; <span class="id" title="tactic">subst</span>; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;This&nbsp;contract&nbsp;deploys&nbsp;other&nbsp;contract&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">remember</span> (<a class="idref" href="ConCert.Execution.Blockchain.html#act_deploy"><span class="id" title="constructor">act_deploy</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>) <span class="id" title="keyword">as</span> <span class="id" title="var">abody</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">replace</span> (<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.ZArith.BinInt.html#84c6e304dcb36f79add2a7dcc558eca1"><span class="id" title="notation">-</span></a><span class="id" title="var">amount</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.ZArith.BinInt.html#46584eddd5fdb16176a10a2843177d3a"><span class="id" title="notation">+</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#env_account_balances"><span class="id" title="projection">env_account_balances</span></a> <span class="id" title="var">mid</span> <span class="id" title="var">caddr</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">with</span> (<a class="idref" href="ConCert.Execution.Blockchain.html#env_account_balances"><span class="id" title="projection">env_account_balances</span></a> <span class="id" title="var">mid</span> <span class="id" title="var">caddr</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.ZArith.BinInt.html#fa12f60d56cf7225f009c889c0622139"><span class="id" title="notation">-</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#act_body_amount"><span class="id" title="definition">act_body_amount</span></a> <span class="id" title="var">abody</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">by</span> (<span class="id" title="tactic">subst</span>; <span class="id" title="var">cbn</span>; <span class="id" title="var">lia</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">transfer_case</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;- <span class="comment">(*&nbsp;Evaluation:&nbsp;Call&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">clear</span> <span class="id" title="var">init_case</span> <span class="id" title="var">permute_queue_case</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">specialize_hypotheses</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| [ <span class="id" title="var">H</span> : <span class="id" title="var">act</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <span class="id" title="var">_</span> |- <span class="id" title="var">_</span> ] =&gt; <span class="id" title="tactic">rewrite</span> <span class="id" title="var">H</span> <span class="id" title="tactic">in</span> *<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">subst</span> <span class="id" title="var">new_acts</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">IH</span> <span class="id" title="keyword">as</span> (<span class="id" title="var">depinfo</span> &amp; <span class="id" title="var">cstate</span> &amp; <span class="id" title="var">inc_calls</span> &amp; -&gt; &amp; ? &amp; -&gt; &amp; <span class="id" title="var">IH</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="ConCert.Execution.Blockchain.html#outgoing_acts"><span class="id" title="definition">outgoing_acts</span></a> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">queue_prev</span>, <span class="id" title="var">queue_new</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="ConCert.Utils.Extras.html#filter_app"><span class="id" title="lemma">filter_app</span></a>, <a class="idref" href="ConCert.Utils.Extras.html#filter_map"><span class="id" title="lemma">filter_map</span></a>, <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#map_app"><span class="id" title="lemma">map_app</span></a>, <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#map_map"><span class="id" title="lemma">map_map</span></a>; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<a class="idref" href="ConCert.Execution.Blockchain.html#address_eqb_spec"><span class="id" title="method">address_eqb_spec</span></a> <span class="id" title="var">to_addr</span> <span class="id" title="var">caddr</span>) <span class="id" title="keyword">as</span> [-&gt;|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="comment">(*&nbsp;Call&nbsp;to&nbsp;contract&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">replace</span> <span class="id" title="var">wc</span> <span class="id" title="keyword">with</span> (<span class="id" title="var">contract</span> : <a class="idref" href="ConCert.Execution.Blockchain.html#WeakContract"><span class="id" title="inductive">WeakContract</span></a>) <span class="id" title="tactic">in</span> * <span class="id" title="tactic">by</span> <span class="id" title="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<a class="idref" href="ConCert.Execution.Blockchain.html#wc_receive_strong"><span class="id" title="lemma">wc_receive_strong</span></a> <span class="id" title="keyword">ltac</span>:(<span class="id" title="var">eassumption</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">as</span> (<span class="id" title="var">prev_state_strong</span> &amp; <span class="id" title="var">msg_strong</span> &amp; <span class="id" title="var">resp_state_strong</span> &amp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">deser_state</span> &amp; <span class="id" title="var">deser_msg</span> &amp; &lt;- &amp; <span class="id" title="var">receive</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">replace</span> (<a class="idref" href="ConCert.Execution.Blockchain.html#env_contract_states"><span class="id" title="projection">env_contract_states</span></a> <span class="id" title="var">mid</span> <span class="id" title="var">caddr</span>) <span class="id" title="keyword">with</span> (<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <span class="id" title="var">prev_state</span>) <span class="id" title="tactic">in</span> * <span class="id" title="tactic">by</span> <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">replace</span> <span class="id" title="var">prev_state_strong</span> <span class="id" title="keyword">with</span> <span class="id" title="var">cstate</span> <span class="id" title="tactic">in</span> * <span class="id" title="tactic">by</span> <span class="id" title="tactic">congruence</span>; <span class="id" title="tactic">clear</span> <span class="id" title="var">prev_state_strong</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">exists</span> <span class="id" title="var">depinfo</span>, <span class="id" title="var">resp_state_strong</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">exists</span> (<a class="idref" href="ConCert.Execution.Blockchain.html#build_call_info"><span class="id" title="constructor">build_call_info</span></a> <span class="id" title="var">origin</span> <span class="id" title="var">from_addr</span> <span class="id" title="var">amount</span> <span class="id" title="var">msg_strong</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#cbcf67aac0c2a85b8d93d37de9969adf"><span class="id" title="notation">::</span></a> <span class="id" title="var">inc_calls</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">rewrite_environment_equiv</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="ConCert.Execution.Blockchain.html#address_eq_refl"><span class="id" title="lemma">address_eq_refl</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="ConCert.Execution.Serializable.html#deserialize_serialize"><span class="id" title="method">deserialize_serialize</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">repeat</span> <span class="id" title="tactic">split</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">msg_strong</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">msg_strong</span>|], <span class="id" title="var">msg</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">msg</span>|];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">try</span> <span class="id" title="tactic">solve</span> [<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *; <span class="id" title="tactic">congruence</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">replace</span> (<a class="idref" href="ConCert.Execution.Serializable.html#deserialize"><span class="id" title="method">deserialize</span></a> <span class="id" title="var">msg</span>) <span class="id" title="keyword">with</span> (<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <span class="id" title="var">msg_strong</span>) <span class="id" title="tactic">by</span> <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> (<a class="idref" href="ConCert.Execution.Blockchain.html#address_eq_sym"><span class="id" title="lemma">address_eq_sym</span></a> <span class="id" title="var">caddr</span>), <a class="idref" href="ConCert.Utils.Extras.html#filter_true"><span class="id" title="lemma">filter_true</span></a>, <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#map_id"><span class="id" title="lemma">map_id</span></a>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<a class="idref" href="ConCert.Execution.Blockchain.html#address_eqb_spec"><span class="id" title="method">address_eqb_spec</span></a> <span class="id" title="var">from_addr</span> <span class="id" title="var">caddr</span>) <span class="id" title="keyword">as</span> [-&gt;|?]; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">all</span>: <span class="id" title="tactic">rewrite</span> (<a class="idref" href="ConCert.Execution.Blockchain.html#address_eq_refl"><span class="id" title="lemma">address_eq_refl</span></a> <span class="id" title="var">caddr</span>) <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="comment">(*&nbsp;Recursive&nbsp;call&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">remember</span> (<a class="idref" href="ConCert.Execution.Blockchain.html#build_ctx"><span class="id" title="constructor">build_ctx</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>) <span class="id" title="keyword">as</span> <span class="id" title="var">ctx</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">pose</span> <span class="id" title="var">proof</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">recursive_call_case</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="ConCert.Execution.Blockchain.html#transfer_balance"><span class="id" title="definition">transfer_balance</span></a> <span class="id" title="var">caddr</span> <span class="id" title="var">caddr</span> <span class="id" title="var">amount</span> <span class="id" title="var">mid</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">ctx</span> <span class="id" title="var">depinfo</span> <span class="id" title="var">cstate</span> <span class="id" title="var">msg_strong</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="keyword">match</span> <span class="id" title="var">msg</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <span class="id" title="var">msg</span> =&gt; <a class="idref" href="ConCert.Execution.Blockchain.html#act_call"><span class="id" title="constructor">act_call</span></a> <span class="id" title="var">caddr</span> <span class="id" title="var">amount</span> <span class="id" title="var">msg</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a> =&gt; <a class="idref" href="ConCert.Execution.Blockchain.html#act_transfer"><span class="id" title="constructor">act_transfer</span></a> <span class="id" title="var">caddr</span> <span class="id" title="var">amount</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>)) <span class="id" title="keyword">as</span> <span class="id" title="tactic">case</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">subst</span> <span class="id" title="var">ctx</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> <span class="id" title="tactic">case</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">replace</span> (<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.ZArith.BinInt.html#84c6e304dcb36f79add2a7dcc558eca1"><span class="id" title="notation">-</span></a><span class="id" title="var">amount</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.ZArith.BinInt.html#46584eddd5fdb16176a10a2843177d3a"><span class="id" title="notation">+</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.ZArith.BinInt.html#46584eddd5fdb16176a10a2843177d3a"><span class="id" title="notation">(</span></a><span class="id" title="var">amount</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.ZArith.BinInt.html#46584eddd5fdb16176a10a2843177d3a"><span class="id" title="notation">+</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#env_account_balances"><span class="id" title="projection">env_account_balances</span></a> <span class="id" title="var">mid</span> <span class="id" title="var">caddr</span><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.ZArith.BinInt.html#46584eddd5fdb16176a10a2843177d3a"><span class="id" title="notation">)</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">with</span> (<a class="idref" href="ConCert.Execution.Blockchain.html#env_account_balances"><span class="id" title="projection">env_account_balances</span></a> <span class="id" title="var">mid</span> <span class="id" title="var">caddr</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">in</span> * <span class="id" title="tactic">by</span> <span class="id" title="var">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">msg_strong</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">msg_strong</span>|], <span class="id" title="var">msg</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">msg</span>|];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *; <span class="id" title="tactic">try</span> <span class="id" title="tactic">congruence</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="comment">(*&nbsp;Someone&nbsp;else&nbsp;calls&nbsp;contract&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">remember</span> (<a class="idref" href="ConCert.Execution.Blockchain.html#build_ctx"><span class="id" title="constructor">build_ctx</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>) <span class="id" title="keyword">as</span> <span class="id" title="var">ctx</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">pose</span> <span class="id" title="var">proof</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">nonrecursive_call_case</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="ConCert.Execution.Blockchain.html#transfer_balance"><span class="id" title="definition">transfer_balance</span></a> <span class="id" title="var">from_addr</span> <span class="id" title="var">caddr</span> <span class="id" title="var">amount</span> <span class="id" title="var">mid</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">ctx</span> <span class="id" title="var">depinfo</span> <span class="id" title="var">cstate</span> <span class="id" title="var">msg_strong</span>) <span class="id" title="keyword">as</span> <span class="id" title="tactic">case</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">subst</span> <span class="id" title="var">ctx</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> <span class="id" title="tactic">case</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> (<a class="idref" href="ConCert.Execution.Blockchain.html#address_eq_ne"><span class="id" title="lemma">address_eq_ne</span></a> <span class="id" title="var">caddr</span> <span class="id" title="var">from_addr</span>) <span class="id" title="tactic">in</span> * <span class="id" title="tactic">by</span> (<span class="id" title="tactic">subst</span>; <span class="id" title="tactic">auto</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">replace</span> (<span class="id" title="var">amount</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.ZArith.BinInt.html#46584eddd5fdb16176a10a2843177d3a"><span class="id" title="notation">+</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#env_account_balances"><span class="id" title="projection">env_account_balances</span></a> <span class="id" title="var">mid</span> <span class="id" title="var">caddr</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.ZArith.BinInt.html#fa12f60d56cf7225f009c889c0622139"><span class="id" title="notation">-</span></a> <span class="id" title="var">amount</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">with</span> (<a class="idref" href="ConCert.Execution.Blockchain.html#env_account_balances"><span class="id" title="projection">env_account_balances</span></a> <span class="id" title="var">mid</span> <span class="id" title="var">caddr</span>) <span class="id" title="tactic">in</span> <span class="id" title="tactic">case</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="var">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">fold</span> (<a class="idref" href="ConCert.Execution.Blockchain.html#outgoing_txs"><span class="id" title="definition">outgoing_txs</span></a> <span class="id" title="var">trace</span> <span class="id" title="var">caddr</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="tactic">case</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="comment">(*&nbsp;Call&nbsp;to&nbsp;other&nbsp;contract&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">exists</span> <span class="id" title="var">depinfo</span>, <span class="id" title="var">cstate</span>, <span class="id" title="var">inc_calls</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">rewrite_environment_equiv</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="ConCert.Utils.Extras.html#filter_false"><span class="id" title="lemma">filter_false</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="ConCert.Execution.Blockchain.html#address_eq_ne"><span class="id" title="lemma">address_eq_ne</span></a> <span class="id" title="tactic">by</span> <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> (<a class="idref" href="ConCert.Execution.Blockchain.html#address_eq_sym"><span class="id" title="lemma">address_eq_sym</span></a> <span class="id" title="var">caddr</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<a class="idref" href="ConCert.Execution.Blockchain.html#address_eqb_spec"><span class="id" title="method">address_eqb_spec</span></a> <span class="id" title="var">from_addr</span> <span class="id" title="var">caddr</span>) <span class="id" title="keyword">as</span> [-&gt;|?].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="comment">(*&nbsp;Call&nbsp;from&nbsp;us&nbsp;to&nbsp;other&nbsp;contract&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">repeat</span> <span class="id" title="tactic">split</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">fold</span> (<a class="idref" href="ConCert.Execution.Blockchain.html#outgoing_txs"><span class="id" title="definition">outgoing_txs</span></a> <span class="id" title="var">trace</span> <span class="id" title="var">caddr</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">msg</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">msg</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1: <span class="id" title="var">remember</span> (<a class="idref" href="ConCert.Execution.Blockchain.html#act_call"><span class="id" title="constructor">act_call</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>) <span class="id" title="keyword">as</span> <span class="id" title="var">abody</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2: <span class="id" title="var">remember</span> (<a class="idref" href="ConCert.Execution.Blockchain.html#act_transfer"><span class="id" title="constructor">act_transfer</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span>) <span class="id" title="keyword">as</span> <span class="id" title="var">abody</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1, 2: <span class="id" title="tactic">replace</span> (<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.ZArith.BinInt.html#84c6e304dcb36f79add2a7dcc558eca1"><span class="id" title="notation">-</span></a><span class="id" title="var">amount</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.ZArith.BinInt.html#46584eddd5fdb16176a10a2843177d3a"><span class="id" title="notation">+</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#env_account_balances"><span class="id" title="projection">env_account_balances</span></a> <span class="id" title="var">mid</span> <span class="id" title="var">caddr</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">with</span> (<a class="idref" href="ConCert.Execution.Blockchain.html#env_account_balances"><span class="id" title="projection">env_account_balances</span></a> <span class="id" title="var">mid</span> <span class="id" title="var">caddr</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.ZArith.BinInt.html#fa12f60d56cf7225f009c889c0622139"><span class="id" title="notation">-</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#act_body_amount"><span class="id" title="definition">act_body_amount</span></a> <span class="id" title="var">abody</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">by</span> (<span class="id" title="tactic">subst</span>; <span class="id" title="var">cbn</span>; <span class="id" title="var">lia</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1, 2: <span class="id" title="tactic">subst</span>; <span class="id" title="tactic">apply</span> <span class="id" title="var">transfer_case</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="comment">(*&nbsp;Irrelevant&nbsp;call.&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">fold</span> (<a class="idref" href="ConCert.Execution.Blockchain.html#outgoing_txs"><span class="id" title="definition">outgoing_txs</span></a> <span class="id" title="var">trace</span> <span class="id" title="var">caddr</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;- <span class="comment">(*&nbsp;Invalid&nbsp;User&nbsp;Action&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">rewrite_environment_equiv</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">IH</span> <span class="id" title="keyword">as</span> (<span class="id" title="var">depinfo</span> &amp; <span class="id" title="var">cstate</span> &amp; <span class="id" title="var">inc_calls</span> &amp; ? &amp; ? &amp; ? &amp; <span class="id" title="var">IH</span>); <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">exists</span> <span class="id" title="var">depinfo</span>, <span class="id" title="var">cstate</span>, <span class="id" title="var">inc_calls</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">repeat</span> <span class="id" title="tactic">split</span>; <span class="id" title="var">rewrite_environment_equiv</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">outgoing_acts_eq</span> : <a class="idref" href="ConCert.Execution.Blockchain.html#outgoing_acts"><span class="id" title="definition">outgoing_acts</span></a> <span class="id" title="var">mid</span> <span class="id" title="var">caddr</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#outgoing_acts"><span class="id" title="definition">outgoing_acts</span></a> <span class="id" title="var">to</span> <span class="id" title="var">caddr</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">unfold</span> <a class="idref" href="ConCert.Execution.Blockchain.html#outgoing_acts"><span class="id" title="definition">outgoing_acts</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">setoid_rewrite</span> <span class="id" title="var">queue_new</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">setoid_rewrite</span> <span class="id" title="var">queue_prev</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="ConCert.Execution.Blockchain.html#act_is_from_account"><span class="id" title="definition">act_is_from_account</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">act_from_acc</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">destruct_address_eq</span>; <span class="id" title="var">easy</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">outgoing_acts_eq</span> <span class="id" title="tactic">in</span> <span class="id" title="var">IH</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">fold</span> (<a class="idref" href="ConCert.Execution.Blockchain.html#outgoing_txs"><span class="id" title="definition">outgoing_txs</span></a> <span class="id" title="var">trace</span> <span class="id" title="var">caddr</span>).<br/>
&nbsp;&nbsp;- <span class="comment">(*&nbsp;Permutation&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">rewrite_environment_equiv</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">specialize_hypotheses</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">IH</span> <span class="id" title="keyword">as</span> (<span class="id" title="var">depinfo</span> &amp; <span class="id" title="var">cstate</span> &amp; <span class="id" title="var">inc_calls</span> &amp; ? &amp; ? &amp; ? &amp; <span class="id" title="var">IH</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">exists</span> <span class="id" title="var">depinfo</span>, <span class="id" title="var">cstate</span>, <span class="id" title="var">inc_calls</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">rewrite_environment_equiv</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">repeat</span> <span class="id" title="tactic">split</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="ConCert.Execution.Blockchain.html#outgoing_acts"><span class="id" title="definition">outgoing_acts</span></a> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">fold</span> (<a class="idref" href="ConCert.Execution.Blockchain.html#outgoing_txs"><span class="id" title="definition">outgoing_txs</span></a> <span class="id" title="var">trace</span> <span class="id" title="var">caddr</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">permute_queue_case</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">out_queue</span> := <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#map"><span class="id" title="definition">map</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#act_body"><span class="id" title="projection">act_body</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#filter"><span class="id" title="definition">filter</span></a> (<span class="id" title="keyword">fun</span> <span class="id" title="var">a</span> =&gt; (<a class="idref" href="ConCert.Execution.Blockchain.html#act_from"><span class="id" title="projection">act_from</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#a"><span class="id" title="variable">a</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#6f617e0e5500b437e5aeb1eaa876d41f"><span class="id" title="notation">=?</span></a> <span class="id" title="var">caddr</span>)%<span class="id" title="var">address</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="ConCert.Execution.Blockchain.html#chain_state_queue"><span class="id" title="projection">chain_state_queue</span></a> <span class="id" title="var">mid</span>))); <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Sorting.Permutation.html#Permutation_map"><span class="id" title="lemma">Permutation_map</span></a>, <a class="idref" href="ConCert.Utils.Extras.html#Permutation_filter"><span class="id" title="lemma">Permutation_filter</span></a>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">End</span> <a class="idref" href="ConCert.Execution.Blockchain.html#Blockchain.Semantics.Trace.Theories"><span class="id" title="section">Theories</span></a>.<br/>
<span class="id" title="keyword">End</span> <a class="idref" href="ConCert.Execution.Blockchain.html#Blockchain.Semantics.Trace"><span class="id" title="section">Trace</span></a>.<br/>
<span class="id" title="keyword">End</span> <a class="idref" href="ConCert.Execution.Blockchain.html#Blockchain.Semantics"><span class="id" title="section">Semantics</span></a>.<br/>

<br/>
<span class="id" title="keyword">Inductive</span> <a name="ActionEvaluationError"><span class="id" title="inductive">ActionEvaluationError</span></a> :=<br/>
| <a name="amount_negative"><span class="id" title="constructor">amount_negative</span></a> <span class="comment">(*&nbsp;amount&nbsp;is&nbsp;negative&nbsp;*)</span><br/>
| <a name="amount_too_high"><span class="id" title="constructor">amount_too_high</span></a> <span class="comment">(*&nbsp;sender&nbsp;does&nbsp;not&nbsp;have&nbsp;enough&nbsp;money&nbsp;*)</span><br/>
| <a name="no_such_contract"><span class="id" title="constructor">no_such_contract</span></a> <span class="comment">(*&nbsp;there&nbsp;is&nbsp;not&nbsp;contract&nbsp;at&nbsp;that&nbsp;address&nbsp;*)</span><br/>
| <a name="too_many_contracts"><span class="id" title="constructor">too_many_contracts</span></a> <span class="comment">(*&nbsp;cannot&nbsp;generate&nbsp;fresh&nbsp;address&nbsp;for&nbsp;new&nbsp;contract&nbsp;*)</span><br/>
| <a name="init_failed"><span class="id" title="constructor">init_failed</span></a> <span class="comment">(*&nbsp;contract&nbsp;init&nbsp;function&nbsp;failed&nbsp;*)</span><br/>
| <a name="receive_failed"><span class="id" title="constructor">receive_failed</span></a> <span class="comment">(*&nbsp;contract&nbsp;receive&nbsp;function&nbsp;failed&nbsp;*)</span><br/>
| <a name="internal_error"><span class="id" title="constructor">internal_error</span></a>. <span class="comment">(*&nbsp;unexpected&nbsp;internal&nbsp;error&nbsp;*)</span><br/>

<br/>
<span class="id" title="keyword">Inductive</span> <a name="AddBlockError"><span class="id" title="inductive">AddBlockError</span></a> :=<br/>
| <a name="invalid_header"><span class="id" title="constructor">invalid_header</span></a> <span class="comment">(*&nbsp;header&nbsp;for&nbsp;next&nbsp;block&nbsp;is&nbsp;invalid&nbsp;*)</span><br/>
| <a name="invalid_root_action"><span class="id" title="constructor">invalid_root_action</span></a> (<span class="id" title="var">act</span> : <a class="idref" href="ConCert.Execution.Blockchain.html#Action"><span class="id" title="record">Action</span></a>) <span class="comment">(*&nbsp;a&nbsp;specified&nbsp;root&nbsp;action&nbsp;is&nbsp;invalid&nbsp;*)</span><br/>
| <a name="origin_from_mismatch"><span class="id" title="constructor">origin_from_mismatch</span></a> (<span class="id" title="var">act</span> : <a class="idref" href="ConCert.Execution.Blockchain.html#Action"><span class="id" title="record">Action</span></a>) <span class="comment">(*&nbsp;origin&nbsp;and&nbsp;from&nbsp;addresses&nbsp;do&nbsp;not&nbsp;match&nbsp;for&nbsp;an&nbsp;action&nbsp;in&nbsp;a&nbsp;new&nbsp;block&nbsp;*)</span><br/>
| <a name="action_evaluation_depth_exceeded"><span class="id" title="constructor">action_evaluation_depth_exceeded</span></a> <span class="comment">(*&nbsp;out&nbsp;of&nbsp;fuel&nbsp;while&nbsp;evaluating&nbsp;actions&nbsp;recursively&nbsp;*)</span><br/>
| <a name="action_evaluation_error"><span class="id" title="constructor">action_evaluation_error</span></a> <span class="comment">(*&nbsp;error&nbsp;when&nbsp;evaluating&nbsp;single&nbsp;action&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">act</span> : <a class="idref" href="ConCert.Execution.Blockchain.html#Action"><span class="id" title="record">Action</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">err</span> : <a class="idref" href="ConCert.Execution.Blockchain.html#ActionEvaluationError"><span class="id" title="inductive">ActionEvaluationError</span></a>).<br/>

<br/>
<span class="id" title="keyword">Class</span> <a name="ChainBuilderType"><span class="id" title="record">ChainBuilderType</span></a> :=<br/>
&nbsp;&nbsp;<a name="build_builder"><span class="id" title="constructor">build_builder</span></a> {<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a name="builder_type"><span class="id" title="projection">builder_type</span></a> : <span class="id" title="keyword">Type</span>;<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a name="builder_initial"><span class="id" title="projection">builder_initial</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#builder_type"><span class="id" title="method">builder_type</span></a>;<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a name="builder_env"><span class="id" title="projection">builder_env</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#builder_type"><span class="id" title="method">builder_type</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#Environment"><span class="id" title="record">Environment</span></a>;<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a name="builder_add_block"><span class="id" title="projection">builder_add_block</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">builder</span> : <a class="idref" href="ConCert.Execution.Blockchain.html#builder_type"><span class="id" title="method">builder_type</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">header</span> : <a class="idref" href="ConCert.Execution.Blockchain.html#BlockHeader"><span class="id" title="record">BlockHeader</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">actions</span> : <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#list"><span class="id" title="inductive">list</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#Action"><span class="id" title="record">Action</span></a>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.ResultMonad.html#result"><span class="id" title="inductive">result</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#builder_type"><span class="id" title="method">builder_type</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#AddBlockError"><span class="id" title="inductive">AddBlockError</span></a>;<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a name="builder_trace"><span class="id" title="projection">builder_trace</span></a> (<span class="id" title="var">builder</span> : <a class="idref" href="ConCert.Execution.Blockchain.html#builder_type"><span class="id" title="method">builder_type</span></a>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#ChainTrace"><span class="id" title="definition">ChainTrace</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#empty_state"><span class="id" title="definition">empty_state</span></a> (<a class="idref" href="ConCert.Execution.Blockchain.html#build_chain_state"><span class="id" title="constructor">build_chain_state</span></a> (<a class="idref" href="ConCert.Execution.Blockchain.html#builder_env"><span class="id" title="method">builder_env</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#builder"><span class="id" title="variable">builder</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#ae9a5e1034e143b218b09d8e454472bd"><span class="id" title="notation">[]</span></a>);<br/>
&nbsp;&nbsp;}.<br/>

<br/>
<span class="id" title="keyword">Global</span> <a class="idref" href="ConCert.Execution.Blockchain.html#builder_type"><span class="id" title="method">Coercion</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#builder_type"><span class="id" title="method">builder_type</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#builder_type"><span class="id" title="method">:</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#builder_type"><span class="id" title="method">ChainBuilderType</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#builder_type"><span class="id" title="method">&gt;-&gt;</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#builder_type"><span class="id" title="method">Sortclass</span></a>.<br/>
<span class="id" title="keyword">Global</span> <a class="idref" href="ConCert.Execution.Blockchain.html#builder_env"><span class="id" title="method">Coercion</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#builder_env"><span class="id" title="method">builder_env</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#builder_env"><span class="id" title="method">:</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#builder_env"><span class="id" title="method">builder_type</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#builder_env"><span class="id" title="method">&gt;-&gt;</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#builder_env"><span class="id" title="method">Environment</span></a>.<br/>
<span class="id" title="keyword">End</span> <a class="idref" href="ConCert.Execution.Blockchain.html#Blockchain"><span class="id" title="section">Blockchain</span></a>.<br/>

<br/>
<span class="id" title="keyword">Ltac</span> <span class="id" title="var">destruct_chain_step</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| [<span class="id" title="var">step</span>: <a class="idref" href="ConCert.Execution.Blockchain.html#ChainStep"><span class="id" title="inductive">ChainStep</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> |- <span class="id" title="var">_</span>] =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">step</span> <span class="id" title="keyword">as</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[?<span class="id" title="var">header</span> ?<span class="id" title="var">queue_prev</span> ?<span class="id" title="var">valid_header</span> ?<span class="id" title="var">acts_from_accs</span> ?<span class="id" title="var">origin_correct</span> ?<span class="id" title="var">env_eq</span>|<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;?<span class="id" title="var">act</span> ?<span class="id" title="var">acts</span> ?<span class="id" title="var">new_acts</span> ?<span class="id" title="var">queue_prev</span> ?<span class="id" title="tactic">eval</span> ?<span class="id" title="var">queue_new</span>|<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;?<span class="id" title="var">act</span> ?<span class="id" title="var">acts</span> ?<span class="id" title="var">env_eq</span> ?<span class="id" title="var">queue_prev</span> ?<span class="id" title="var">queue_new</span> ?<span class="id" title="var">act_from_acc</span> ?<span class="id" title="var">no_eval</span>|<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;?<span class="id" title="var">env_eq</span> ?<span class="id" title="var">perm</span>]<br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Ltac</span> <span class="id" title="var">destruct_action_eval</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| [<span class="id" title="tactic">eval</span>: <a class="idref" href="ConCert.Execution.Blockchain.html#ActionEvaluation"><span class="id" title="inductive">ActionEvaluation</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> |- <span class="id" title="var">_</span>] =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="tactic">eval</span> <span class="id" title="keyword">as</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[?<span class="id" title="var">origin</span> ?<span class="id" title="var">from_addr</span> ?<span class="id" title="var">to_addr</span> ?<span class="id" title="var">amount</span> ?<span class="id" title="var">amount_nonnegative</span> ?<span class="id" title="var">enough_balance</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;?<span class="id" title="var">to_addr_not_contract</span> ?<span class="id" title="var">act_eq</span> ?<span class="id" title="var">env_eq</span> ?<span class="id" title="var">new_acts_eq</span> |<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;?<span class="id" title="var">origin</span> ?<span class="id" title="var">from_addr</span> ?<span class="id" title="var">to_addr</span> ?<span class="id" title="var">amount</span> ?<span class="id" title="var">wc</span> ?<span class="id" title="var">setup</span> ?<span class="id" title="var">state</span> ?<span class="id" title="var">amount_nonnegative</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;?<span class="id" title="var">enough_balance</span> ?<span class="id" title="var">to_addr_contract</span> ?<span class="id" title="var">not_deployed</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;?<span class="id" title="var">act_eq</span> ?<span class="id" title="var">init_some</span> ?<span class="id" title="var">env_eq</span> ?<span class="id" title="var">new_acts_eq</span> |<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;?<span class="id" title="var">origin</span> ?<span class="id" title="var">from_addr</span> ?<span class="id" title="var">to_addr</span> ?<span class="id" title="var">amount</span> ?<span class="id" title="var">wc</span> ?<span class="id" title="var">msg</span> ?<span class="id" title="var">prev_state</span> ?<span class="id" title="var">new_state</span> ?<span class="id" title="var">resp_acts</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;?<span class="id" title="var">amount_nonnegative</span> ?<span class="id" title="var">enough_balance</span> ?<span class="id" title="var">deployed</span> ?<span class="id" title="var">deployed_state</span> ?<span class="id" title="var">act_eq</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;?<span class="id" title="var">receive_some</span> ?<span class="id" title="var">new_acts_eq</span> ?<span class="id" title="var">env_eq</span> ]<br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Ltac</span> <span class="id" title="var">rewrite_environment_equiv</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| [<span class="id" title="var">eq</span>: <a class="idref" href="ConCert.Execution.Blockchain.html#EnvironmentEquiv"><span class="id" title="record">EnvironmentEquiv</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> |- <span class="id" title="var">_</span>] =&gt; <span class="id" title="tactic">rewrite</span> <span class="id" title="var">eq</span> <span class="id" title="tactic">in</span> *<br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Local Ltac</span> <span class="id" title="var">generalize_contract_statement_aux</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">bstate</span> <span class="id" title="var">caddr</span> <span class="id" title="var">trace</span> <span class="id" title="var">is_deployed</span> <span class="id" title="var">Setup</span> <span class="id" title="var">Msg</span> <span class="id" title="var">State</span> <span class="id" title="var">post</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">P</span> := <span class="id" title="tactic">fresh</span> "P" <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;<span class="id" title="tactic">evar</span> (<span class="id" title="var">P</span> : <span class="id" title="keyword">forall</span> (<span class="id" title="var">chain_height</span> : <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a>) (<span class="id" title="var">current_slot</span> : <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a>) (<span class="id" title="var">finalized_height</span> : <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">caddr</span> : <a class="idref" href="ConCert.Execution.Blockchain.html#Address"><span class="id" title="method">Address</span></a>) (<span class="id" title="var">deployment_info</span> : <a class="idref" href="ConCert.Execution.Blockchain.html#DeploymentInfo"><span class="id" title="record">DeploymentInfo</span></a> <span class="id" title="var">Setup</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">cstate</span> : <span class="id" title="var">State</span>) (<span class="id" title="var">balance</span> : <a class="idref" href="ConCert.Execution.Blockchain.html#Amount"><span class="id" title="definition">Amount</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">outgoing_actions_queued</span> : <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#list"><span class="id" title="inductive">list</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#ActionBody"><span class="id" title="inductive">ActionBody</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">incoming_calls_seen</span> : <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#list"><span class="id" title="inductive">list</span></a> (<a class="idref" href="ConCert.Execution.Blockchain.html#ContractCallInfo"><span class="id" title="record">ContractCallInfo</span></a> <span class="id" title="var">Msg</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">outgoing_txs_seen</span> : <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#list"><span class="id" title="inductive">list</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#Tx"><span class="id" title="record">Tx</span></a>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Prop</span>);<br/>
&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">H</span> := <span class="id" title="tactic">fresh</span> "H" <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;<span class="id" title="var">enough</span> (<span class="id" title="var">H</span>: <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">exists</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">(</span></a><span class="id" title="var">dep</span> : <a class="idref" href="ConCert.Execution.Blockchain.html#DeploymentInfo"><span class="id" title="record">DeploymentInfo</span></a> <span class="id" title="var">Setup</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">cstate</span> : <span class="id" title="var">State</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">inc_calls</span> : <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#list"><span class="id" title="inductive">list</span></a> (<a class="idref" href="ConCert.Execution.Blockchain.html#ContractCallInfo"><span class="id" title="record">ContractCallInfo</span></a> <span class="id" title="var">Msg</span>)<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">),</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#deployment_info"><span class="id" title="definition">deployment_info</span></a> <span class="id" title="var">Setup</span> <span class="id" title="var">trace</span> <span class="id" title="var">caddr</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#dep"><span class="id" title="variable">dep</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">/\</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#contract_state"><span class="id" title="definition">contract_state</span></a> <span class="id" title="var">bstate</span> <span class="id" title="var">caddr</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#cstate"><span class="id" title="variable">cstate</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">/\</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#incoming_calls"><span class="id" title="definition">incoming_calls</span></a> <span class="id" title="var">Msg</span> <span class="id" title="var">trace</span> <span class="id" title="var">caddr</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#inc_calls"><span class="id" title="variable">inc_calls</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">/\</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">P</span> (<a class="idref" href="ConCert.Execution.Blockchain.html#chain_height"><span class="id" title="projection">chain_height</span></a> <span class="id" title="var">bstate</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="ConCert.Execution.Blockchain.html#current_slot"><span class="id" title="projection">current_slot</span></a> <span class="id" title="var">bstate</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="ConCert.Execution.Blockchain.html#finalized_height"><span class="id" title="projection">finalized_height</span></a> <span class="id" title="var">bstate</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">caddr</span> <a class="idref" href="ConCert.Execution.Blockchain.html#dep"><span class="id" title="variable">dep</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#cstate"><span class="id" title="variable">cstate</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="ConCert.Execution.Blockchain.html#env_account_balances"><span class="id" title="projection">env_account_balances</span></a> <span class="id" title="var">bstate</span> <span class="id" title="var">caddr</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="ConCert.Execution.Blockchain.html#outgoing_acts"><span class="id" title="definition">outgoing_acts</span></a> <span class="id" title="var">bstate</span> <span class="id" title="var">caddr</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#inc_calls"><span class="id" title="variable">inc_calls</span></a> (<a class="idref" href="ConCert.Execution.Blockchain.html#outgoing_txs"><span class="id" title="definition">outgoing_txs</span></a> <span class="id" title="var">trace</span> <span class="id" title="var">caddr</span>));<br/>
&nbsp;&nbsp;[<span class="id" title="keyword">let</span> <span class="id" title="var">depinfo</span> := <span class="id" title="tactic">fresh</span> "depinfo" <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">cstate</span> := <span class="id" title="tactic">fresh</span> "cstate" <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">inc_calls</span> := <span class="id" title="tactic">fresh</span> "inc_calls" <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">depinfo_strong</span> := <span class="id" title="tactic">fresh</span> "depinfo_strong" <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">cstate_strong</span> := <span class="id" title="tactic">fresh</span> "cstate_strong" <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">inc_calls_strong</span> := <span class="id" title="tactic">fresh</span> "inc_calls_strong" <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">provenP</span> := <span class="id" title="tactic">fresh</span> "provenP" <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">H</span> <span class="id" title="keyword">as</span> (<span class="id" title="var">depinfo</span> &amp; <span class="id" title="var">cstate</span> &amp; <span class="id" title="var">inc_calls</span> &amp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">depinfo_strong</span> &amp; <span class="id" title="var">cstate_strong</span> &amp; <span class="id" title="var">inc_calls_strong</span> &amp; <span class="id" title="var">provenP</span>);<br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">repeat</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| [|- <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">exists</span></a> <span class="id" title="var">_</span> : <a class="idref" href="ConCert.Execution.Blockchain.html#DeploymentInfo"><span class="id" title="record">DeploymentInfo</span></a> <span class="id" title="var">Setup</span><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">,</span></a> <span class="id" title="var">_</span>] =&gt; <span class="id" title="tactic">exists</span> <span class="id" title="var">depinfo</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| [|- <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">exists</span></a> <span class="id" title="var">_</span> : <span class="id" title="var">State</span><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">,</span></a> <span class="id" title="var">_</span>] =&gt; <span class="id" title="tactic">exists</span> <span class="id" title="var">cstate</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| [|- <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">exists</span></a> <span class="id" title="var">_</span> : <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#list"><span class="id" title="inductive">list</span></a> (<a class="idref" href="ConCert.Execution.Blockchain.html#ContractCallInfo"><span class="id" title="record">ContractCallInfo</span></a> <span class="id" title="var">Msg</span>)<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">,</span></a> <span class="id" title="var">_</span>] =&gt; <span class="id" title="tactic">exists</span> <span class="id" title="var">inc_calls</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| [|- ?<span class="id" title="var">a</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">/\</span></a> ?<span class="id" title="var">b</span>] =&gt; <span class="id" title="tactic">refine</span> (<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#conj"><span class="id" title="constructor">conj</span></a> <span class="id" title="var">depinfo_strong</span> <span class="id" title="var">_</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| [|- ?<span class="id" title="var">a</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">/\</span></a> ?<span class="id" title="var">b</span>] =&gt; <span class="id" title="tactic">refine</span> (<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#conj"><span class="id" title="constructor">conj</span></a> <span class="id" title="var">cstate_strong</span> <span class="id" title="var">_</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| [|- ?<span class="id" title="var">a</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">/\</span></a> ?<span class="id" title="var">b</span>] =&gt; <span class="id" title="tactic">refine</span> (<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#conj"><span class="id" title="constructor">conj</span></a> <span class="id" title="var">inc_calls_strong</span> <span class="id" title="var">_</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>;<br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">pattern</span> (<a class="idref" href="ConCert.Execution.Blockchain.html#chain_height"><span class="id" title="projection">chain_height</span></a> <span class="id" title="var">bstate</span>), (<a class="idref" href="ConCert.Execution.Blockchain.html#current_slot"><span class="id" title="projection">current_slot</span></a> <span class="id" title="var">bstate</span>), (<a class="idref" href="ConCert.Execution.Blockchain.html#finalized_height"><span class="id" title="projection">finalized_height</span></a> <span class="id" title="var">bstate</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">caddr</span>, <span class="id" title="var">depinfo</span>, <span class="id" title="var">cstate</span>, (<a class="idref" href="ConCert.Execution.Blockchain.html#env_account_balances"><span class="id" title="projection">env_account_balances</span></a> <span class="id" title="var">bstate</span> <span class="id" title="var">caddr</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="ConCert.Execution.Blockchain.html#outgoing_acts"><span class="id" title="definition">outgoing_acts</span></a> <span class="id" title="var">bstate</span> <span class="id" title="var">caddr</span>), <span class="id" title="var">inc_calls</span>, (<a class="idref" href="ConCert.Execution.Blockchain.html#outgoing_txs"><span class="id" title="definition">outgoing_txs</span></a> <span class="id" title="var">trace</span> <span class="id" title="var">caddr</span>);<br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;| [|- ?<span class="id" title="var">f</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>] =&gt; <span class="id" title="tactic">instantiate</span> (<span class="id" title="var">P</span> := <span class="id" title="var">f</span>); <span class="id" title="tactic">exact</span> <span class="id" title="var">provenP</span><br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span><br/>
&nbsp;&nbsp;| <span class="id" title="var">post</span> <span class="id" title="var">bstate</span> <span class="id" title="var">caddr</span> <span class="id" title="var">trace</span> <span class="id" title="var">is_deployed</span> <span class="id" title="var">Setup</span> <span class="id" title="var">Msg</span> <span class="id" title="var">State</span> <span class="id" title="var">P</span> ].<br/>

<br/>
<span class="id" title="keyword">Local Ltac</span> <span class="id" title="var">generalize_contract_statement_with_post</span> <span class="id" title="var">post</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>;<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| [<span class="id" title="var">bstate</span> : <a class="idref" href="ConCert.Execution.Blockchain.html#ChainState"><span class="id" title="record">ChainState</span></a>, <span class="id" title="var">caddr</span> : <a class="idref" href="ConCert.Execution.Blockchain.html#Address"><span class="id" title="method">Address</span></a> |- <span class="id" title="var">_</span>] =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">try</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| [<span class="id" title="var">is_reachable</span> : <a class="idref" href="ConCert.Execution.Blockchain.html#reachable"><span class="id" title="definition">reachable</span></a> <span class="id" title="var">bstate</span> |- <span class="id" title="var">_</span>] =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">trace</span> := <span class="id" title="tactic">fresh</span> "trace" <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">is_reachable</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">trace</span>]<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[<span class="id" title="var">trace</span> : <a class="idref" href="ConCert.Execution.Blockchain.html#ChainTrace"><span class="id" title="definition">ChainTrace</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#empty_state"><span class="id" title="definition">empty_state</span></a> <span class="id" title="var">bstate</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">is_deployed</span> : <a class="idref" href="ConCert.Execution.Blockchain.html#env_contracts"><span class="id" title="projection">env_contracts</span></a> (<span class="id" title="var">_</span> <span class="id" title="var">bstate</span>) <span class="id" title="var">caddr</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> (<a class="idref" href="ConCert.Execution.Blockchain.html#contract_to_weak_contract"><span class="id" title="definition">contract_to_weak_contract</span></a> ?<span class="id" title="var">c</span>) |- <span class="id" title="var">_</span>] =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="keyword">type</span> <span class="id" title="keyword">of</span> <span class="id" title="var">c</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="ConCert.Execution.Blockchain.html#Contract"><span class="id" title="record">Contract</span></a> ?<span class="id" title="var">Setup</span> ?<span class="id" title="var">Msg</span> ?<span class="id" title="var">State</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">generalize_contract_statement_aux</span> <span class="id" title="var">bstate</span> <span class="id" title="var">caddr</span> <span class="id" title="var">trace</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">is_deployed</span> <span class="id" title="var">Setup</span> <span class="id" title="var">Msg</span> <span class="id" title="var">State</span> <span class="id" title="var">post</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Ltac</span> <span class="id" title="var">generalize_contract_statement</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="var">generalize_contract_statement_with_post</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">ltac</span>:(<span class="id" title="keyword">fun</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">is_deployed</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> =&gt; <span class="id" title="var">revert</span> <span class="id" title="var">is_deployed</span>).<br/>

<br/>
<span class="id" title="keyword">Ltac</span> <span class="id" title="var">contract_induction</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="var">generalize_contract_statement_with_post</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">ltac</span>:(<span class="id" title="keyword">fun</span> <span class="id" title="var">bstate</span> <span class="id" title="var">caddr</span> <span class="id" title="var">_</span> <span class="id" title="var">is_deployed</span> <span class="id" title="var">Setup</span> <span class="id" title="var">Msg</span> <span class="id" title="var">State</span> <span class="id" title="var">P</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">revert</span> <span class="id" title="var">is_deployed</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">AddBlockFacts</span> := <span class="id" title="tactic">fresh</span> "AddBlockFacts" <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">DeployFacts</span> := <span class="id" title="tactic">fresh</span> "DeployFacts" <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">CallFacts</span> := <span class="id" title="tactic">fresh</span> "CallFacts" <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">evar</span> (<span class="id" title="var">AddBlockFacts</span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">forall</span> (<span class="id" title="var">chain_height</span> : <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a>) (<span class="id" title="var">current_slot</span> : <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">finalized_height</span> : <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a>) (<span class="id" title="var">new_height</span> : <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">new_slot</span> : <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a>) (<span class="id" title="var">new_finalized_height</span> : <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a>), <span class="id" title="keyword">Prop</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">evar</span> (<span class="id" title="var">DeployFacts</span> : <span class="id" title="keyword">forall</span> (<span class="id" title="var">chain</span> : <a class="idref" href="ConCert.Execution.Blockchain.html#Chain"><span class="id" title="record">Chain</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">ctx</span> : <a class="idref" href="ConCert.Execution.Blockchain.html#ContractCallContext"><span class="id" title="record">ContractCallContext</span></a>), <span class="id" title="keyword">Prop</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">evar</span> (<span class="id" title="var">CallFacts</span> : <span class="id" title="keyword">forall</span> (<span class="id" title="var">chain</span> : <a class="idref" href="ConCert.Execution.Blockchain.html#Chain"><span class="id" title="record">Chain</span></a>) (<span class="id" title="var">ctx</span> : <a class="idref" href="ConCert.Execution.Blockchain.html#ContractCallContext"><span class="id" title="record">ContractCallContext</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">cstate</span> : <span class="id" title="var">State</span>) (<span class="id" title="var">outgoing_actions</span> : <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#list"><span class="id" title="inductive">list</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#ActionBody"><span class="id" title="inductive">ActionBody</span></a>), <span class="id" title="keyword">Prop</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<a class="idref" href="ConCert.Execution.Blockchain.html#contract_induction"><span class="id" title="lemma">contract_induction</span></a> <span class="id" title="var">_</span> <span class="id" title="var">AddBlockFacts</span> <span class="id" title="var">DeployFacts</span> <span class="id" title="var">CallFacts</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">cbv</span> [<span class="id" title="var">P</span>]; <span class="id" title="tactic">clear</span> <span class="id" title="var">P</span>; <span class="id" title="var">cycle</span> 1; <span class="id" title="tactic">clear</span> <span class="id" title="tactic">dependent</span> <span class="id" title="var">bstate</span>; <span class="id" title="tactic">clear</span> <span class="id" title="tactic">dependent</span> <span class="id" title="var">caddr</span>).<br/>

<br/>
<span class="id" title="keyword">Global</span> <span class="id" title="keyword">Notation</span> "'Please' 'prove' 'your' 'facts'" := <a class="idref" href="ConCert.Execution.Blockchain.html#TagFacts"><span class="id" title="inductive">TagFacts</span></a> (<span class="id" title="tactic">at</span> <span class="id" title="keyword">level</span> 100, <span class="id" title="var">only</span> <span class="id" title="var">printing</span>).<br/>
<span class="id" title="keyword">Global</span> <span class="id" title="keyword">Notation</span> "'Please' 'reestablish' 'the' 'invariant' 'after' 'addition' 'of' 'a' 'block'"<br/>
&nbsp;&nbsp;:= <a class="idref" href="ConCert.Execution.Blockchain.html#TagAddBlock"><span class="id" title="inductive">TagAddBlock</span></a> (<span class="id" title="tactic">at</span> <span class="id" title="keyword">level</span> 100, <span class="id" title="var">only</span> <span class="id" title="var">printing</span>).<br/>
<span class="id" title="keyword">Global</span> <span class="id" title="keyword">Notation</span> "'Please' 'establish' 'the' 'invariant' 'after' 'deployment' 'of' 'the' 'contract'"<br/>
&nbsp;&nbsp;:= <a class="idref" href="ConCert.Execution.Blockchain.html#TagDeployment"><span class="id" title="inductive">TagDeployment</span></a> (<span class="id" title="tactic">at</span> <span class="id" title="keyword">level</span> 100, <span class="id" title="var">only</span> <span class="id" title="var">printing</span>).<br/>
<span class="id" title="keyword">Global</span> <span class="id" title="keyword">Notation</span> "'Please' 'reestablish' 'the' 'invariant' 'after' 'an' 'outgoing' 'action'"<br/>
&nbsp;&nbsp;:= <a class="idref" href="ConCert.Execution.Blockchain.html#TagOutgoingAct"><span class="id" title="inductive">TagOutgoingAct</span></a> (<span class="id" title="tactic">at</span> <span class="id" title="keyword">level</span> 100, <span class="id" title="var">only</span> <span class="id" title="var">printing</span>).<br/>
<span class="id" title="keyword">Global</span> <span class="id" title="keyword">Notation</span> "'Please' 'reestablish' 'the' 'invariant' 'after' 'a' 'nonrecursive' 'call'"<br/>
&nbsp;&nbsp;:= <a class="idref" href="ConCert.Execution.Blockchain.html#TagNonrecursiveCall"><span class="id" title="inductive">TagNonrecursiveCall</span></a> (<span class="id" title="tactic">at</span> <span class="id" title="keyword">level</span> 100, <span class="id" title="var">only</span> <span class="id" title="var">printing</span>).<br/>
<span class="id" title="keyword">Global</span> <span class="id" title="keyword">Notation</span> "'Please' 'reestablish' 'the' 'invariant' 'after' 'a' 'recursive' 'call'"<br/>
&nbsp;&nbsp;:= <a class="idref" href="ConCert.Execution.Blockchain.html#TagRecursiveCall"><span class="id" title="inductive">TagRecursiveCall</span></a> (<span class="id" title="tactic">at</span> <span class="id" title="keyword">level</span> 100, <span class="id" title="var">only</span> <span class="id" title="var">printing</span>).<br/>
<span class="id" title="keyword">Global</span> <span class="id" title="keyword">Notation</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"'Please' 'reestablish' 'the' 'invariant' 'after' 'permutation' 'of' 'the' 'action' 'queue'"<br/>
&nbsp;&nbsp;:= <a class="idref" href="ConCert.Execution.Blockchain.html#TagPermuteQueue"><span class="id" title="inductive">TagPermuteQueue</span></a> (<span class="id" title="tactic">at</span> <span class="id" title="keyword">level</span> 100, <span class="id" title="var">only</span> <span class="id" title="var">printing</span>).<br/>

<br/>
<span class="id" title="keyword">Section</span> <a name="LiftTransactionProp"><span class="id" title="section">LiftTransactionProp</span></a>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Context</span> {<span class="id" title="var">BaseTypes</span> : <a class="idref" href="ConCert.Execution.Blockchain.html#ChainBase"><span class="id" title="class">ChainBase</span></a>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<span class="id" title="var">Setup</span> : <span class="id" title="keyword">Type</span>} `{<a class="idref" href="ConCert.Execution.Serializable.html#Serializable"><span class="id" title="class">Serializable</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#Setup"><span class="id" title="variable">Setup</span></a>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<span class="id" title="var">Msg</span> : <span class="id" title="keyword">Type</span>} `{<a class="idref" href="ConCert.Execution.Serializable.html#Serializable"><span class="id" title="class">Serializable</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#Msg"><span class="id" title="variable">Msg</span></a>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<span class="id" title="var">State</span> : <span class="id" title="keyword">Type</span>} `{<a class="idref" href="ConCert.Execution.Serializable.html#Serializable"><span class="id" title="class">Serializable</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#State"><span class="id" title="variable">State</span></a>}.<br/>

<br/>
</div>

<div class="doc">
If some property <span class="inlinecode"><a class="idref" href="ConCert.Extraction.Tests.ElmExtractTests.html#type_scheme_ex.LetouzeyExample.P"><span class="id" title="definition">P</span></a></span> holds for all actions in the output of the receive function, the property can be lifted to all outgoing actions for all reachabile states. 
</div>
<div class="code">
<span class="id" title="keyword">Lemma</span> <a name="lift_outgoing_acts_prop"><span class="id" title="lemma">lift_outgoing_acts_prop</span></a> {<span class="id" title="var">P</span> : <a class="idref" href="ConCert.Execution.Blockchain.html#ActionBody"><span class="id" title="inductive">ActionBody</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a> <span class="id" title="keyword">Prop</span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">contract</span> : <a class="idref" href="ConCert.Execution.Blockchain.html#Contract"><span class="id" title="record">Contract</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#LiftTransactionProp.Setup"><span class="id" title="variable">Setup</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#LiftTransactionProp.Msg"><span class="id" title="variable">Msg</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#LiftTransactionProp.State"><span class="id" title="variable">State</span></a>) (<span class="id" title="var">bstate</span> : <a class="idref" href="ConCert.Execution.Blockchain.html#ChainState"><span class="id" title="record">ChainState</span></a>) (<span class="id" title="var">addr</span> : <a class="idref" href="ConCert.Execution.Blockchain.html#Address"><span class="id" title="method">Address</span></a>) :<br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#reachable"><span class="id" title="definition">reachable</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#bstate"><span class="id" title="variable">bstate</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">(</span></a><span class="id" title="keyword">forall</span> <span class="id" title="var">chain</span> <span class="id" title="var">ctx</span> <span class="id" title="var">cstate</span> <span class="id" title="var">msg</span> <span class="id" title="var">new_cstate</span> <span class="id" title="var">acts</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#contract"><span class="id" title="variable">contract</span></a>.(<a class="idref" href="ConCert.Execution.Blockchain.html#receive"><span class="id" title="projection">receive</span></a>) <a class="idref" href="ConCert.Execution.Blockchain.html#chain"><span class="id" title="variable">chain</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#ctx"><span class="id" title="variable">ctx</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#cstate"><span class="id" title="variable">cstate</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#msg"><span class="id" title="variable">msg</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Execution.Blockchain.html#new_cstate"><span class="id" title="variable">new_cstate</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#acts"><span class="id" title="variable">acts</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#Forall"><span class="id" title="inductive">Forall</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#P"><span class="id" title="variable">P</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#acts"><span class="id" title="variable">acts</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#env_contracts"><span class="id" title="projection">env_contracts</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#bstate"><span class="id" title="variable">bstate</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#addr"><span class="id" title="variable">addr</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> (<a class="idref" href="ConCert.Execution.Blockchain.html#contract"><span class="id" title="variable">contract</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#WeakContract"><span class="id" title="inductive">WeakContract</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#Forall"><span class="id" title="inductive">Forall</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#P"><span class="id" title="variable">P</span></a> (<a class="idref" href="ConCert.Execution.Blockchain.html#outgoing_acts"><span class="id" title="definition">outgoing_acts</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#bstate"><span class="id" title="variable">bstate</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#addr"><span class="id" title="variable">addr</span></a>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">Hr</span> <span class="id" title="var">Hc</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">contract_induction</span>; <span class="id" title="tactic">intros</span>; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">inversion_clear</span> <span class="id" title="var">IH</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <a class="idref" href="ConCert.Utils.Extras.html#Forall_app"><span class="id" title="lemma">Forall_app</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <a class="idref" href="ConCert.Utils.Extras.html#Forall_app"><span class="id" title="lemma">Forall_app</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">inversion_clear</span> <span class="id" title="var">IH</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="var">perm</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">instantiate</span> (<span class="id" title="var">AddBlockFacts</span> := <span class="id" title="keyword">fun</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> =&gt; <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#True"><span class="id" title="inductive">Logic.True</span></a>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">instantiate</span> (<span class="id" title="var">DeployFacts</span> := <span class="id" title="keyword">fun</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> =&gt; <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#True"><span class="id" title="inductive">Logic.True</span></a>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">instantiate</span> (<span class="id" title="var">CallFacts</span> := <span class="id" title="keyword">fun</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> =&gt; <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#True"><span class="id" title="inductive">Logic.True</span></a>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">unset_all</span>; <span class="id" title="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">step</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">a</span>; <span class="id" title="tactic">auto</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
If the receive function always returns an empty list of actions,
 the same holds for all reachable states 
</div>
<div class="code">
<span class="id" title="keyword">Lemma</span> <a name="lift_outgoing_acts_nil"><span class="id" title="lemma">lift_outgoing_acts_nil</span></a> (<span class="id" title="var">contract</span> : <a class="idref" href="ConCert.Execution.Blockchain.html#Contract"><span class="id" title="record">Contract</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#LiftTransactionProp.Setup"><span class="id" title="variable">Setup</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#LiftTransactionProp.Msg"><span class="id" title="variable">Msg</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#LiftTransactionProp.State"><span class="id" title="variable">State</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">bstate</span> : <a class="idref" href="ConCert.Execution.Blockchain.html#ChainState"><span class="id" title="record">ChainState</span></a>) (<span class="id" title="var">addr</span> : <a class="idref" href="ConCert.Execution.Blockchain.html#Address"><span class="id" title="method">Address</span></a>) :<br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#reachable"><span class="id" title="definition">reachable</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#bstate"><span class="id" title="variable">bstate</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">(</span></a><span class="id" title="keyword">forall</span> <span class="id" title="var">chain</span> <span class="id" title="var">ctx</span> <span class="id" title="var">cstate</span> <span class="id" title="var">msg</span> <span class="id" title="var">new_cstate</span> <span class="id" title="var">acts</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#contract"><span class="id" title="variable">contract</span></a>.(<a class="idref" href="ConCert.Execution.Blockchain.html#receive"><span class="id" title="projection">receive</span></a>) <a class="idref" href="ConCert.Execution.Blockchain.html#chain"><span class="id" title="variable">chain</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#ctx"><span class="id" title="variable">ctx</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#cstate"><span class="id" title="variable">cstate</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#msg"><span class="id" title="variable">msg</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Execution.Blockchain.html#new_cstate"><span class="id" title="variable">new_cstate</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#acts"><span class="id" title="variable">acts</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#acts"><span class="id" title="variable">acts</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#ae9a5e1034e143b218b09d8e454472bd"><span class="id" title="notation">[]</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#env_contracts"><span class="id" title="projection">env_contracts</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#bstate"><span class="id" title="variable">bstate</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#addr"><span class="id" title="variable">addr</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> (<a class="idref" href="ConCert.Execution.Blockchain.html#contract"><span class="id" title="variable">contract</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#WeakContract"><span class="id" title="inductive">WeakContract</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#outgoing_acts"><span class="id" title="definition">outgoing_acts</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#bstate"><span class="id" title="variable">bstate</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#addr"><span class="id" title="variable">addr</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#ae9a5e1034e143b218b09d8e454472bd"><span class="id" title="notation">[]</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">enough</span> (<span class="id" title="var">all_false</span>: <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#Forall"><span class="id" title="inductive">Forall</span></a> (<span class="id" title="keyword">fun</span> <span class="id" title="var">_</span> =&gt; <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#False"><span class="id" title="inductive">False</span></a>) (<a class="idref" href="ConCert.Execution.Blockchain.html#outgoing_acts"><span class="id" title="definition">outgoing_acts</span></a> <span class="id" title="var">bstate</span> <span class="id" title="var">addr</span>)) <span class="id" title="tactic">by</span> (<span class="id" title="var">now</span> <span class="id" title="tactic">destruct</span> <span class="id" title="var">all_false</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<a class="idref" href="ConCert.Execution.Blockchain.html#lift_outgoing_acts_prop"><span class="id" title="lemma">lift_outgoing_acts_prop</span></a> <span class="id" title="var">contract</span>); <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">erewrite</span> (<span class="id" title="var">H3</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">acts</span>); [<span class="id" title="tactic">constructor</span>|<span class="id" title="var">eassumption</span>].<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
If some property <span class="inlinecode"><a class="idref" href="ConCert.Extraction.Tests.ElmExtractTests.html#type_scheme_ex.LetouzeyExample.P"><span class="id" title="definition">P</span></a></span> holds for all contract states in the output of the receive function,
  the property can be lifted to all contract states for all reachabile states. 
</div>
<div class="code">
<span class="id" title="keyword">Lemma</span> <a name="lift_contract_state_prop"><span class="id" title="lemma">lift_contract_state_prop</span></a> {<span class="id" title="var">P</span> : <a class="idref" href="ConCert.Execution.Blockchain.html#LiftTransactionProp.State"><span class="id" title="variable">State</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a> <span class="id" title="keyword">Prop</span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">contract</span> : <a class="idref" href="ConCert.Execution.Blockchain.html#Contract"><span class="id" title="record">Contract</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#LiftTransactionProp.Setup"><span class="id" title="variable">Setup</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#LiftTransactionProp.Msg"><span class="id" title="variable">Msg</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#LiftTransactionProp.State"><span class="id" title="variable">State</span></a>) (<span class="id" title="var">bstate</span> : <a class="idref" href="ConCert.Execution.Blockchain.html#ChainState"><span class="id" title="record">ChainState</span></a>) (<span class="id" title="var">addr</span> : <a class="idref" href="ConCert.Execution.Blockchain.html#Address"><span class="id" title="method">Address</span></a>) :<br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">(</span></a><span class="id" title="keyword">forall</span> <span class="id" title="var">chain</span> <span class="id" title="var">ctx</span> <span class="id" title="var">setup</span> <span class="id" title="var">result</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#contract"><span class="id" title="variable">contract</span></a>.(<a class="idref" href="ConCert.Execution.Blockchain.html#init"><span class="id" title="projection">init</span></a>) <a class="idref" href="ConCert.Execution.Blockchain.html#chain"><span class="id" title="variable">chain</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#ctx"><span class="id" title="variable">ctx</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#setup"><span class="id" title="variable">setup</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#result"><span class="id" title="variable">result</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#P"><span class="id" title="variable">P</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#result"><span class="id" title="variable">result</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">(</span></a><span class="id" title="keyword">forall</span> <span class="id" title="var">chain</span> <span class="id" title="var">ctx</span> <span class="id" title="var">cstate</span> <span class="id" title="var">msg</span> <span class="id" title="var">new_cstate</span> <span class="id" title="var">acts</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#P"><span class="id" title="variable">P</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#cstate"><span class="id" title="variable">cstate</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#contract"><span class="id" title="variable">contract</span></a>.(<a class="idref" href="ConCert.Execution.Blockchain.html#receive"><span class="id" title="projection">receive</span></a>) <a class="idref" href="ConCert.Execution.Blockchain.html#chain"><span class="id" title="variable">chain</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#ctx"><span class="id" title="variable">ctx</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#cstate"><span class="id" title="variable">cstate</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#msg"><span class="id" title="variable">msg</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Execution.Blockchain.html#new_cstate"><span class="id" title="variable">new_cstate</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#acts"><span class="id" title="variable">acts</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#P"><span class="id" title="variable">P</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#new_cstate"><span class="id" title="variable">new_cstate</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#reachable"><span class="id" title="definition">reachable</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#bstate"><span class="id" title="variable">bstate</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#env_contracts"><span class="id" title="projection">env_contracts</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#bstate"><span class="id" title="variable">bstate</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#addr"><span class="id" title="variable">addr</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> (<a class="idref" href="ConCert.Execution.Blockchain.html#contract"><span class="id" title="variable">contract</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#WeakContract"><span class="id" title="inductive">WeakContract</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">exists</span></a> <span class="id" title="var">cstate</span><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">,</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#contract_state"><span class="id" title="definition">contract_state</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#bstate"><span class="id" title="variable">bstate</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#addr"><span class="id" title="variable">addr</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#cstate"><span class="id" title="variable">cstate</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">/\</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#P"><span class="id" title="variable">P</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#cstate"><span class="id" title="variable">cstate</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">Hinit</span> <span class="id" title="var">Hreceive</span> <span class="id" title="var">Hreach</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">contract_induction</span>; <span class="id" title="tactic">intros</span>; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">now</span> <span class="id" title="tactic">eapply</span> <span class="id" title="var">Hinit</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">now</span> <span class="id" title="tactic">eapply</span> <span class="id" title="var">Hreceive</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">now</span> <span class="id" title="tactic">eapply</span> <span class="id" title="var">Hreceive</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">instantiate</span> (<span class="id" title="var">AddBlockFacts</span> := <span class="id" title="keyword">fun</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> =&gt; <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#True"><span class="id" title="inductive">Logic.True</span></a>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">instantiate</span> (<span class="id" title="var">DeployFacts</span> := <span class="id" title="keyword">fun</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> =&gt; <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#True"><span class="id" title="inductive">Logic.True</span></a>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">instantiate</span> (<span class="id" title="var">CallFacts</span> := <span class="id" title="keyword">fun</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> =&gt; <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#True"><span class="id" title="inductive">Logic.True</span></a>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">unset_all</span>; <span class="id" title="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">step</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">a</span>; <span class="id" title="tactic">auto</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a name="lift_dep_info_contract_state_prop"><span class="id" title="lemma">lift_dep_info_contract_state_prop</span></a> {<span class="id" title="var">P</span> : <a class="idref" href="ConCert.Execution.Blockchain.html#DeploymentInfo"><span class="id" title="record">DeploymentInfo</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#LiftTransactionProp.Setup"><span class="id" title="variable">Setup</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#LiftTransactionProp.State"><span class="id" title="variable">State</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a> <span class="id" title="keyword">Prop</span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">contract</span> : <a class="idref" href="ConCert.Execution.Blockchain.html#Contract"><span class="id" title="record">Contract</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#LiftTransactionProp.Setup"><span class="id" title="variable">Setup</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#LiftTransactionProp.Msg"><span class="id" title="variable">Msg</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#LiftTransactionProp.State"><span class="id" title="variable">State</span></a>) (<span class="id" title="var">bstate</span> : <a class="idref" href="ConCert.Execution.Blockchain.html#ChainState"><span class="id" title="record">ChainState</span></a>) (<span class="id" title="var">addr</span> : <a class="idref" href="ConCert.Execution.Blockchain.html#Address"><span class="id" title="method">Address</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">trace</span> : <a class="idref" href="ConCert.Execution.Blockchain.html#ChainTrace"><span class="id" title="definition">ChainTrace</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#empty_state"><span class="id" title="definition">empty_state</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#bstate"><span class="id" title="variable">bstate</span></a>) :<br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">(</span></a><span class="id" title="keyword">forall</span> <span class="id" title="var">chain</span> <span class="id" title="var">ctx</span> <span class="id" title="var">setup</span> <span class="id" title="var">result</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#contract"><span class="id" title="variable">contract</span></a>.(<a class="idref" href="ConCert.Execution.Blockchain.html#init"><span class="id" title="projection">init</span></a>) <a class="idref" href="ConCert.Execution.Blockchain.html#chain"><span class="id" title="variable">chain</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#ctx"><span class="id" title="variable">ctx</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#setup"><span class="id" title="variable">setup</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#result"><span class="id" title="variable">result</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#P"><span class="id" title="variable">P</span></a> (<a class="idref" href="ConCert.Execution.Blockchain.html#build_deployment_info"><span class="id" title="constructor">build_deployment_info</span></a> (<a class="idref" href="ConCert.Execution.Blockchain.html#ctx_origin"><span class="id" title="projection">ctx_origin</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#ctx"><span class="id" title="variable">ctx</span></a>) (<a class="idref" href="ConCert.Execution.Blockchain.html#ctx_from"><span class="id" title="projection">ctx_from</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#ctx"><span class="id" title="variable">ctx</span></a>) (<a class="idref" href="ConCert.Execution.Blockchain.html#ctx_amount"><span class="id" title="projection">ctx_amount</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#ctx"><span class="id" title="variable">ctx</span></a>) <a class="idref" href="ConCert.Execution.Blockchain.html#setup"><span class="id" title="variable">setup</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#result"><span class="id" title="variable">result</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">(</span></a><span class="id" title="keyword">forall</span> <span class="id" title="var">chain</span> <span class="id" title="var">ctx</span> <span class="id" title="var">cstate</span> <span class="id" title="var">msg</span> <span class="id" title="var">new_cstate</span> <span class="id" title="var">acts</span> <span class="id" title="var">dep</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#P"><span class="id" title="variable">P</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#dep"><span class="id" title="variable">dep</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#cstate"><span class="id" title="variable">cstate</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#contract"><span class="id" title="variable">contract</span></a>.(<a class="idref" href="ConCert.Execution.Blockchain.html#receive"><span class="id" title="projection">receive</span></a>) <a class="idref" href="ConCert.Execution.Blockchain.html#chain"><span class="id" title="variable">chain</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#ctx"><span class="id" title="variable">ctx</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#cstate"><span class="id" title="variable">cstate</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#msg"><span class="id" title="variable">msg</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Execution.Blockchain.html#new_cstate"><span class="id" title="variable">new_cstate</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#acts"><span class="id" title="variable">acts</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#P"><span class="id" title="variable">P</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#dep"><span class="id" title="variable">dep</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#new_cstate"><span class="id" title="variable">new_cstate</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#env_contracts"><span class="id" title="projection">env_contracts</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#bstate"><span class="id" title="variable">bstate</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#addr"><span class="id" title="variable">addr</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> (<a class="idref" href="ConCert.Execution.Blockchain.html#contract"><span class="id" title="variable">contract</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#WeakContract"><span class="id" title="inductive">WeakContract</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">exists</span></a> <span class="id" title="var">dep</span> <span class="id" title="var">cstate</span><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">,</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#deployment_info"><span class="id" title="definition">deployment_info</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#LiftTransactionProp.Setup"><span class="id" title="variable">Setup</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#trace"><span class="id" title="variable">trace</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#addr"><span class="id" title="variable">addr</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#dep"><span class="id" title="variable">dep</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">/\</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#contract_state"><span class="id" title="definition">contract_state</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#bstate"><span class="id" title="variable">bstate</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#addr"><span class="id" title="variable">addr</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#cstate"><span class="id" title="variable">cstate</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">/\</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#P"><span class="id" title="variable">P</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#dep"><span class="id" title="variable">dep</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#cstate"><span class="id" title="variable">cstate</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">Hinit</span> <span class="id" title="var">Hreceive</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">contract_induction</span>; <span class="id" title="tactic">intros</span>; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">now</span> <span class="id" title="tactic">eapply</span> <span class="id" title="var">Hinit</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">now</span> <span class="id" title="tactic">eapply</span> <span class="id" title="var">Hreceive</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">now</span> <span class="id" title="tactic">eapply</span> <span class="id" title="var">Hreceive</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">instantiate</span> (<span class="id" title="var">AddBlockFacts</span> := <span class="id" title="keyword">fun</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> =&gt; <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#True"><span class="id" title="inductive">Logic.True</span></a>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">instantiate</span> (<span class="id" title="var">DeployFacts</span> := <span class="id" title="keyword">fun</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> =&gt; <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#True"><span class="id" title="inductive">Logic.True</span></a>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">instantiate</span> (<span class="id" title="var">CallFacts</span> := <span class="id" title="keyword">fun</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> =&gt; <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#True"><span class="id" title="inductive">Logic.True</span></a>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">unset_all</span>; <span class="id" title="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">step</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">a</span>; <span class="id" title="tactic">auto</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">End</span> <a class="idref" href="ConCert.Execution.Blockchain.html#LiftTransactionProp"><span class="id" title="section">LiftTransactionProp</span></a>.<br/>
</div>
</div>
<div id="footer">
  Generated by <a href="https://coq.inria.fr/">coqdoc</a> and improved with <a href="https://github.com/tebbi/coqdocjs">CoqdocJS</a> and <a href="https://github.com/jgallen23/toc">TOC</a>
</div>
</div>
<script>
  const elements = document.getElementsByClassName("libtitle");
  while(elements.length > 0){
        elements[0].parentNode.removeChild(elements[0]);
  }
  if (window.location.pathname.endsWith("/toc.html")) {
      const jstocDiv = document.getElementById("js-toc");
      jstocDiv.classList.remove("toc");
      jstocDiv.classList.add("jstoc-hidden");
      const jstocHeaderDiv = document.getElementById("js-toc-header");
      jstocHeaderDiv.classList.add("jstoc-hidden");
  }
  console.log(window.location.pathname);
</script>
<script type="text/javascript" src="toc.js"></script>
</body>

</html>
