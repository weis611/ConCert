<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">

<head>
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
<link href="coqdoc.css" rel="stylesheet" type="text/css" />
<link href="coqdocjs.css" rel="stylesheet" type="text/css"/>
<link href="toc.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="config.js"></script>
<script type="text/javascript" src="coqdocjs.js"></script>
</head>

<body onload="document.getElementById('content').focus()">
  <div id="header">
    <span class="left">
      <span class="modulename"> <script> document.write(document.title) </script> </span>
    </span>

    <span class="button" id="toggle-proofs"></span>

    <span class="right">
      <a href="toc.html">Table of contents</a>
      <a href="https://github.com/AU-COBRA/ConCert" target="_balnk">Project Page</a>
    </span>
</div>
  <div id="content" tabindex="-1" onblur="document.getElementById('content').focus()">
    <div id="js-toc-header" class="toc-header">Contents:</div>
    <div id="js-toc" class="toc" data-toc="h1,h2,h3,h4" data-toc-container="doc">
    </div>
    <div id="main">
<h1 class="libtitle">Library ConCert.Execution.Test.TraceGens</h1>

<div class="code">
<span class="comment">(*<br/>
&nbsp;&nbsp;The&nbsp;ChainTrace&nbsp;datatype&nbsp;is&nbsp;defined&nbsp;as&nbsp;a&nbsp;ChainedList&nbsp;of&nbsp;ChainStates&nbsp;and&nbsp;ChainSteps.<br/>
&nbsp;&nbsp;This&nbsp;file&nbsp;defines&nbsp;a&nbsp;generator&nbsp;combinator,&nbsp;gChain,&nbsp;for&nbsp;the&nbsp;ChainBuilder&nbsp;type.<br/>
&nbsp;&nbsp;From&nbsp;this,&nbsp;a&nbsp;generator/arbitrary&nbsp;instance&nbsp;for&nbsp;the&nbsp;ChainTrace&nbsp;type&nbsp;is&nbsp;derived&nbsp;automatically.<br/>
<br/>
&nbsp;&nbsp;This&nbsp;file&nbsp;also&nbsp;contains&nbsp;checker&nbsp;combinator&nbsp;&nbsp;over&nbsp;ChainBuilders/ChainTraces,<br/>
&nbsp;&nbsp;like&nbsp;forAllChainTrace,&nbsp;reachableFrom_chaintrace,&nbsp;and&nbsp;pre_post_assertion.<br/>
*)</span><br/>

<br/>
<span class="id" title="keyword">Global</span> <span class="id" title="keyword">Set</span> <span class="id" title="var">Warnings</span> "-extraction-logical-axiom".<br/>

<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">QuickChick</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="library">QuickChick</span>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">ConCert.Utils</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="ConCert.Utils.Extras.html#"><span class="id" title="library">Extras</span></a>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">ConCert.Execution</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="ConCert.Execution.Blockchain.html#"><span class="id" title="library">Blockchain</span></a>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">ConCert.Execution</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="ConCert.Execution.Serializable.html#"><span class="id" title="library">Serializable</span></a>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">ConCert.Execution</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="ConCert.Execution.BoundedN.html#"><span class="id" title="library">BoundedN</span></a>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">ConCert.Execution</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="ConCert.Execution.ResultMonad.html#"><span class="id" title="library">ResultMonad</span></a>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">ConCert.Execution</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="ConCert.Execution.ChainedList.html#"><span class="id" title="library">ChainedList</span></a>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">ConCert.Execution.Test</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="ConCert.Execution.Test.TestUtils.html#"><span class="id" title="library">TestUtils</span></a>.<br/>

<br/>
<span class="id" title="keyword">Import</span> <span class="id" title="var">MonadNotation</span>. <span class="id" title="keyword">Open</span> <span class="id" title="keyword">Scope</span> <span class="id" title="var">monad_scope</span>.<br/>

<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">Coq</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.ZArith.ZArith.html#"><span class="id" title="library">ZArith</span></a>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">Coq</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#"><span class="id" title="library">List</span></a>.<br/>

<br/>
<span class="id" title="keyword">Import</span> <span class="id" title="var">QcNotation</span>.<br/>
<span class="id" title="keyword">Import</span> <span class="id" title="var">BoundedN.Stdpp</span>.<br/>
<span class="id" title="keyword">Import</span> <span class="id" title="var">ListNotations</span>.<br/>

<br/>
<span class="id" title="keyword">Section</span> <a name="TraceGens"><span class="id" title="section">TraceGens</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Context</span> `{<span class="id" title="class">Show</span> <a class="idref" href="ConCert.Execution.Test.TestUtils.html#ChainBuilder"><span class="id" title="instance">ChainBuilder</span></a>}.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Context</span> `{<span class="id" title="class">Show</span> <a class="idref" href="ConCert.Execution.Blockchain.html#ChainState"><span class="id" title="record">ChainState</span></a>}.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Global</span> <span class="id" title="keyword">Definition</span> <a name="BlockReward"><span class="id" title="definition">BlockReward</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#Amount"><span class="id" title="definition">Amount</span></a> := 50.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Global</span> <span class="id" title="keyword">Definition</span> <a name="BlockCreator"><span class="id" title="definition">BlockCreator</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#Address"><span class="id" title="method">Address</span></a> := <a class="idref" href="ConCert.Execution.Test.TestUtils.html#creator"><span class="id" title="definition">creator</span></a>.<br/>

<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;Deconstructs&nbsp;a&nbsp;ChainTrace&nbsp;to&nbsp;a&nbsp;list&nbsp;of&nbsp;blockheaders&nbsp;list&nbsp;of&nbsp;the&nbsp;minimum&nbsp;information<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;needed&nbsp;to&nbsp;reconstruct&nbsp;a&nbsp;ChainTrace,&nbsp;that&nbsp;being&nbsp;a&nbsp;list&nbsp;of&nbsp;block&nbsp;headers&nbsp;and<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;chain_state_queues&nbsp;from&nbsp;each&nbsp;step_block&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">Fixpoint</span> <a name="trace_blocks"><span class="id" title="definition">trace_blocks</span></a> {<span class="id" title="var">from</span> <span class="id" title="var">to</span>} (<span class="id" title="var">trace</span> : <a class="idref" href="ConCert.Execution.Blockchain.html#ChainTrace"><span class="id" title="definition">ChainTrace</span></a> <a class="idref" href="ConCert.Execution.Test.TraceGens.html#from"><span class="id" title="variable">from</span></a> <a class="idref" href="ConCert.Execution.Test.TraceGens.html#to"><span class="id" title="variable">to</span></a>) : <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#list"><span class="id" title="inductive">list</span></a> (<a class="idref" href="ConCert.Execution.Blockchain.html#BlockHeader"><span class="id" title="record">BlockHeader</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#11c698c8685bb8ab1cf725545c085ac4"><span class="id" title="notation">*</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#list"><span class="id" title="inductive">list</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#Action"><span class="id" title="record">Action</span></a>) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="ConCert.Execution.Test.TraceGens.html#trace"><span class="id" title="variable">trace</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="ConCert.Execution.ChainedList.html#snoc"><span class="id" title="constructor">snoc</span></a> <span class="id" title="var">trace'</span> (<a class="idref" href="ConCert.Execution.Blockchain.html#step_block"><span class="id" title="constructor">Blockchain.step_block</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">header</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="keyword">as</span> <span class="id" title="var">step</span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Test.TraceGens.html#trace_blocks"><span class="id" title="definition">trace_blocks</span></a> <span class="id" title="var">trace'</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#bc347c51eaf667706ae54503b26d52c6"><span class="id" title="notation">++</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#ddd65c2f7ee73ecec433744948d846bb"><span class="id" title="notation">[</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><span class="id" title="var">header</span><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#chain_state_queue"><span class="id" title="projection">chain_state_queue</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#snd"><span class="id" title="definition">snd</span></a> (<a class="idref" href="ConCert.Execution.Test.TestUtils.html#chainstep_states"><span class="id" title="definition">chainstep_states</span></a> <span class="id" title="var">step</span>))<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#ddd65c2f7ee73ecec433744948d846bb"><span class="id" title="notation">]</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="ConCert.Execution.ChainedList.html#snoc"><span class="id" title="constructor">snoc</span></a> <span class="id" title="var">trace'</span> <span class="id" title="var">_</span> =&gt; <a class="idref" href="ConCert.Execution.Test.TraceGens.html#trace_blocks"><span class="id" title="definition">trace_blocks</span></a> <span class="id" title="var">trace'</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="ConCert.Execution.ChainedList.html#clnil"><span class="id" title="constructor">clnil</span></a> =&gt; <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#ae9a5e1034e143b218b09d8e454472bd"><span class="id" title="notation">[]</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;Reconstructs&nbsp;list&nbsp;of&nbsp;block&nbsp;information&nbsp;(blockheaders&nbsp;and&nbsp;queues)&nbsp;to&nbsp;a&nbsp;ChainBuilder.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;It&nbsp;trims&nbsp;any&nbsp;empty&nbsp;blocks&nbsp;that&nbsp;can&nbsp;be&nbsp;removed&nbsp;without&nbsp;invalidating&nbsp;execution&nbsp;of<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;the&nbsp;remaining&nbsp;actions.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Also&nbsp;removes&nbsp;any&nbsp;actions&nbsp;that&nbsp;cannot&nbsp;be&nbsp;executed&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">Fixpoint</span> <a name="build_chain_builder"><span class="id" title="definition">build_chain_builder</span></a> (<span class="id" title="var">init_cb</span> : <a class="idref" href="ConCert.Execution.Test.TestUtils.html#ChainBuilder"><span class="id" title="instance">ChainBuilder</span></a>) <span class="id" title="var">blocks</span> : <a class="idref" href="ConCert.Execution.ResultMonad.html#result"><span class="id" title="inductive">result</span></a> <a class="idref" href="ConCert.Execution.Test.TestUtils.html#ChainBuilder"><span class="id" title="instance">ChainBuilder</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#AddBlockError"><span class="id" title="inductive">AddBlockError</span></a> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;Instead&nbsp;of&nbsp;using&nbsp;the&nbsp;original&nbsp;header&nbsp;we&nbsp;need&nbsp;override&nbsp;height&nbsp;and&nbsp;finalized_height<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;since&nbsp;the&nbsp;blockchain&nbsp;requires&nbsp;that&nbsp;the&nbsp;height&nbsp;always&nbsp;grows&nbsp;by&nbsp;one&nbsp;and&nbsp;if&nbsp;we&nbsp;trim&nbsp;and&nbsp;keep&nbsp;the<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;height&nbsp;in&nbsp;the&nbsp;original&nbsp;header&nbsp;then&nbsp;the&nbsp;height&nbsp;would&nbsp;increase&nbsp;by&nbsp;two&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">new_header</span> <span class="id" title="var">header</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{| <a class="idref" href="ConCert.Execution.Blockchain.html#build_block_Header"><span class="id" title="constructor">block_height</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#build_block_Header"><span class="id" title="constructor">:=</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#build_block_Header"><span class="id" title="constructor">S</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#build_block_Header"><span class="id" title="constructor">(</span></a><a class="idref" href="ConCert.Execution.Blockchain.html#build_block_Header"><span class="id" title="constructor">chain_height</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#build_block_Header"><span class="id" title="constructor">init_cb</span></a><a class="idref" href="ConCert.Execution.Blockchain.html#build_block_Header"><span class="id" title="constructor">);</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#build_block_Header"><span class="id" title="constructor">block_slot</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#build_block_Header"><span class="id" title="constructor">:=</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#build_block_Header"><span class="id" title="constructor">header</span></a><a class="idref" href="ConCert.Execution.Blockchain.html#build_block_Header"><span class="id" title="constructor">.(</span></a><a class="idref" href="ConCert.Execution.Blockchain.html#build_block_Header"><span class="id" title="constructor">block_slot</span></a><a class="idref" href="ConCert.Execution.Blockchain.html#build_block_Header"><span class="id" title="constructor">);</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#build_block_Header"><span class="id" title="constructor">block_finalized_height</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#build_block_Header"><span class="id" title="constructor">:=</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#build_block_Header"><span class="id" title="constructor">finalized_height</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#build_block_Header"><span class="id" title="constructor">init_cb</span></a><a class="idref" href="ConCert.Execution.Blockchain.html#build_block_Header"><span class="id" title="constructor">;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#build_block_Header"><span class="id" title="constructor">block_creator</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#build_block_Header"><span class="id" title="constructor">:=</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#build_block_Header"><span class="id" title="constructor">header</span></a><a class="idref" href="ConCert.Execution.Blockchain.html#build_block_Header"><span class="id" title="constructor">.(</span></a><a class="idref" href="ConCert.Execution.Blockchain.html#build_block_Header"><span class="id" title="constructor">block_creator</span></a><a class="idref" href="ConCert.Execution.Blockchain.html#build_block_Header"><span class="id" title="constructor">);</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#build_block_Header"><span class="id" title="constructor">block_reward</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#build_block_Header"><span class="id" title="constructor">:=</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#build_block_Header"><span class="id" title="constructor">header</span></a><a class="idref" href="ConCert.Execution.Blockchain.html#build_block_Header"><span class="id" title="constructor">.(</span></a><a class="idref" href="ConCert.Execution.Blockchain.html#build_block_Header"><span class="id" title="constructor">block_reward</span></a><a class="idref" href="ConCert.Execution.Blockchain.html#build_block_Header"><span class="id" title="constructor">);</span></a> |} <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;Remove&nbsp;any&nbsp;actions&nbsp;that&nbsp;are&nbsp;no&nbsp;longer&nbsp;valid&nbsp;due&nbsp;to&nbsp;earlier&nbsp;actions<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;that&nbsp;could&nbsp;have&nbsp;been&nbsp;removed&nbsp;by&nbsp;the&nbsp;shrinker&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">try_remove_invalid_acts</span> <span class="id" title="var">header</span> <span class="id" title="var">acts</span> <span class="id" title="var">blocks</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">valid_acts</span> := <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#fold_left"><span class="id" title="definition">fold_left</span></a> (<span class="id" title="keyword">fun</span> <span class="id" title="var">acts</span> <span class="id" title="var">act</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="ConCert.Execution.Blockchain.html#builder_add_block"><span class="id" title="method">builder_add_block</span></a> <a class="idref" href="ConCert.Execution.Test.TraceGens.html#init_cb"><span class="id" title="variable">init_cb</span></a> (<a class="idref" href="ConCert.Execution.Test.TraceGens.html#new_header"><span class="id" title="variable">new_header</span></a> <a class="idref" href="ConCert.Execution.Test.TraceGens.html#header"><span class="id" title="variable">header</span></a>) (<a class="idref" href="ConCert.Execution.Test.TraceGens.html#acts"><span class="id" title="variable">acts</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#bc347c51eaf667706ae54503b26d52c6"><span class="id" title="notation">++</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#ddd65c2f7ee73ecec433744948d846bb"><span class="id" title="notation">[</span></a><a class="idref" href="ConCert.Execution.Test.TraceGens.html#act"><span class="id" title="variable">act</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#ddd65c2f7ee73ecec433744948d846bb"><span class="id" title="notation">]</span></a>) <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="ConCert.Execution.ResultMonad.html#Ok"><span class="id" title="constructor">Ok</span></a> <span class="id" title="var">cb</span> =&gt; <a class="idref" href="ConCert.Execution.Test.TraceGens.html#acts"><span class="id" title="variable">acts</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#bc347c51eaf667706ae54503b26d52c6"><span class="id" title="notation">++</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#ddd65c2f7ee73ecec433744948d846bb"><span class="id" title="notation">[</span></a><a class="idref" href="ConCert.Execution.Test.TraceGens.html#act"><span class="id" title="variable">act</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#ddd65c2f7ee73ecec433744948d846bb"><span class="id" title="notation">]</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="ConCert.Execution.ResultMonad.html#Err"><span class="id" title="constructor">Err</span></a> <span class="id" title="var">error</span> =&gt; <a class="idref" href="ConCert.Execution.Test.TraceGens.html#acts"><span class="id" title="variable">acts</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span> ) <a class="idref" href="ConCert.Execution.Test.TraceGens.html#acts"><span class="id" title="variable">acts</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#ae9a5e1034e143b218b09d8e454472bd"><span class="id" title="notation">[]</span></a> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="ConCert.Execution.Blockchain.html#builder_add_block"><span class="id" title="method">builder_add_block</span></a> <a class="idref" href="ConCert.Execution.Test.TraceGens.html#init_cb"><span class="id" title="variable">init_cb</span></a> (<a class="idref" href="ConCert.Execution.Test.TraceGens.html#new_header"><span class="id" title="variable">new_header</span></a> <a class="idref" href="ConCert.Execution.Test.TraceGens.html#header"><span class="id" title="variable">header</span></a>) <a class="idref" href="ConCert.Execution.Test.TraceGens.html#valid_acts"><span class="id" title="variable">valid_acts</span></a> <span class="id" title="keyword">with</span> <span class="comment">(*&nbsp;TODO:&nbsp;also&nbsp;try&nbsp;to&nbsp;trim&nbsp;block&nbsp;here&nbsp;if&nbsp;valid_acts&nbsp;is&nbsp;empty&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="ConCert.Execution.ResultMonad.html#Ok"><span class="id" title="constructor">Ok</span></a> <span class="id" title="var">cb</span> =&gt; <a class="idref" href="ConCert.Execution.Test.TraceGens.html#build_chain_builder"><span class="id" title="definition">build_chain_builder</span></a> <span class="id" title="var">cb</span> <a class="idref" href="ConCert.Execution.Test.TraceGens.html#blocks"><span class="id" title="variable">blocks</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="ConCert.Execution.ResultMonad.html#Err"><span class="id" title="constructor">Err</span></a> <span class="id" title="var">error</span> =&gt; <a class="idref" href="ConCert.Execution.ResultMonad.html#Err"><span class="id" title="constructor">Err</span></a> <span class="id" title="var">error</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">build_block</span> <span class="id" title="var">header</span> <span class="id" title="var">acts</span> <span class="id" title="var">blocks</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="ConCert.Execution.Blockchain.html#builder_add_block"><span class="id" title="method">builder_add_block</span></a> <a class="idref" href="ConCert.Execution.Test.TraceGens.html#init_cb"><span class="id" title="variable">init_cb</span></a> (<a class="idref" href="ConCert.Execution.Test.TraceGens.html#new_header"><span class="id" title="variable">new_header</span></a> <a class="idref" href="ConCert.Execution.Test.TraceGens.html#header"><span class="id" title="variable">header</span></a>) <a class="idref" href="ConCert.Execution.Test.TraceGens.html#acts"><span class="id" title="variable">acts</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="ConCert.Execution.ResultMonad.html#Ok"><span class="id" title="constructor">Ok</span></a> <span class="id" title="var">cb</span> =&gt; <a class="idref" href="ConCert.Execution.Test.TraceGens.html#build_chain_builder"><span class="id" title="definition">build_chain_builder</span></a> <span class="id" title="var">cb</span> <a class="idref" href="ConCert.Execution.Test.TraceGens.html#blocks"><span class="id" title="variable">blocks</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="ConCert.Execution.ResultMonad.html#Err"><span class="id" title="constructor">Err</span></a> <span class="id" title="var">error</span> =&gt; <a class="idref" href="ConCert.Execution.Test.TraceGens.html#try_remove_invalid_acts"><span class="id" title="variable">try_remove_invalid_acts</span></a> <a class="idref" href="ConCert.Execution.Test.TraceGens.html#header"><span class="id" title="variable">header</span></a> <a class="idref" href="ConCert.Execution.Test.TraceGens.html#acts"><span class="id" title="variable">acts</span></a> <a class="idref" href="ConCert.Execution.Test.TraceGens.html#blocks"><span class="id" title="variable">blocks</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;Attempt&nbsp;to&nbsp;trim&nbsp;block&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">try_trim</span> <span class="id" title="var">header</span> <span class="id" title="var">blocks</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">trimmed_result</span> := <a class="idref" href="ConCert.Execution.Test.TraceGens.html#build_chain_builder"><span class="id" title="definition">build_chain_builder</span></a> <a class="idref" href="ConCert.Execution.Test.TraceGens.html#init_cb"><span class="id" title="variable">init_cb</span></a> <a class="idref" href="ConCert.Execution.Test.TraceGens.html#blocks"><span class="id" title="variable">blocks</span></a> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="ConCert.Execution.Test.TraceGens.html#trimmed_result"><span class="id" title="variable">trimmed_result</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="ConCert.Execution.ResultMonad.html#Ok"><span class="id" title="constructor">Ok</span></a> <span class="id" title="var">cb</span> =&gt; <a class="idref" href="ConCert.Execution.ResultMonad.html#Ok"><span class="id" title="constructor">Ok</span></a> <span class="id" title="var">cb</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="ConCert.Execution.ResultMonad.html#Err"><span class="id" title="constructor">Err</span></a> <span class="id" title="var">error</span> =&gt; <a class="idref" href="ConCert.Execution.Test.TraceGens.html#build_block"><span class="id" title="variable">build_block</span></a> <a class="idref" href="ConCert.Execution.Test.TraceGens.html#header"><span class="id" title="variable">header</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#ae9a5e1034e143b218b09d8e454472bd"><span class="id" title="notation">[]</span></a> <a class="idref" href="ConCert.Execution.Test.TraceGens.html#blocks"><span class="id" title="variable">blocks</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="ConCert.Execution.Test.TraceGens.html#blocks"><span class="id" title="variable">blocks</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#ae9a5e1034e143b218b09d8e454472bd"><span class="id" title="notation">[]</span></a> =&gt; <a class="idref" href="ConCert.Execution.ResultMonad.html#Ok"><span class="id" title="constructor">Ok</span></a> <a class="idref" href="ConCert.Execution.Test.TraceGens.html#init_cb"><span class="id" title="variable">init_cb</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><span class="id" title="var">header</span><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#ae9a5e1034e143b218b09d8e454472bd"><span class="id" title="notation">[]</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#cbcf67aac0c2a85b8d93d37de9969adf"><span class="id" title="notation">::</span></a> <span class="id" title="var">xs</span> =&gt; <a class="idref" href="ConCert.Execution.Test.TraceGens.html#try_trim"><span class="id" title="variable">try_trim</span></a> <span class="id" title="var">header</span> <span class="id" title="var">xs</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><span class="id" title="var">header</span><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <span class="id" title="var">acts</span><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#cbcf67aac0c2a85b8d93d37de9969adf"><span class="id" title="notation">::</span></a> <span class="id" title="var">xs</span> =&gt; <a class="idref" href="ConCert.Execution.Test.TraceGens.html#build_block"><span class="id" title="variable">build_block</span></a> <span class="id" title="var">header</span> <span class="id" title="var">acts</span> <span class="id" title="var">xs</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;Reconstructs&nbsp;a&nbsp;list&nbsp;of&nbsp;ChainBuilders&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">Fixpoint</span> <a name="rebuild_chains"><span class="id" title="definition">rebuild_chains</span></a> (<span class="id" title="var">shrunk_chains</span> : <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#list"><span class="id" title="inductive">list</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#list"><span class="id" title="inductive">list</span></a> (<a class="idref" href="ConCert.Execution.Blockchain.html#BlockHeader"><span class="id" title="record">BlockHeader</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#11c698c8685bb8ab1cf725545c085ac4"><span class="id" title="notation">*</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#list"><span class="id" title="inductive">list</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#Action"><span class="id" title="record">Action</span></a>))) <span class="id" title="var">init_cb</span> : <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#list"><span class="id" title="inductive">list</span></a> <a class="idref" href="ConCert.Execution.Test.TestUtils.html#ChainBuilder"><span class="id" title="instance">ChainBuilder</span></a> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="ConCert.Execution.Test.TraceGens.html#shrunk_chains"><span class="id" title="variable">shrunk_chains</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#ae9a5e1034e143b218b09d8e454472bd"><span class="id" title="notation">[]</span></a> =&gt; <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#ae9a5e1034e143b218b09d8e454472bd"><span class="id" title="notation">[]</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">block</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#cbcf67aac0c2a85b8d93d37de9969adf"><span class="id" title="notation">::</span></a> <span class="id" title="var">blocks</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="ConCert.Execution.Test.TraceGens.html#build_chain_builder"><span class="id" title="definition">build_chain_builder</span></a> <a class="idref" href="ConCert.Execution.Test.TraceGens.html#init_cb"><span class="id" title="variable">init_cb</span></a> <span class="id" title="var">block</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="ConCert.Execution.ResultMonad.html#Ok"><span class="id" title="constructor">Ok</span></a> <span class="id" title="var">cb</span> =&gt; <span class="id" title="var">cb</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#cbcf67aac0c2a85b8d93d37de9969adf"><span class="id" title="notation">::</span></a> <a class="idref" href="ConCert.Execution.Test.TraceGens.html#rebuild_chains"><span class="id" title="definition">rebuild_chains</span></a> <span class="id" title="var">blocks</span> <a class="idref" href="ConCert.Execution.Test.TraceGens.html#init_cb"><span class="id" title="variable">init_cb</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="ConCert.Execution.ResultMonad.html#Err"><span class="id" title="constructor">Err</span></a> <span class="id" title="var">error</span> =&gt; <a class="idref" href="ConCert.Execution.Test.TraceGens.html#rebuild_chains"><span class="id" title="definition">rebuild_chains</span></a> <span class="id" title="var">blocks</span> <a class="idref" href="ConCert.Execution.Test.TraceGens.html#init_cb"><span class="id" title="variable">init_cb</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;Alternative&nbsp;version&nbsp;of&nbsp;ordinary&nbsp;list&nbsp;shrinker&nbsp;that&nbsp;does&nbsp;not&nbsp;attempt&nbsp;to&nbsp;shrink&nbsp;list&nbsp;elements&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">Fixpoint</span> <a name="shrinkListAux_"><span class="id" title="definition">shrinkListAux_</span></a> {<span class="id" title="var">A</span>} (<span class="id" title="var">l</span> : <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#list"><span class="id" title="inductive">list</span></a> <a class="idref" href="ConCert.Execution.Test.TraceGens.html#A"><span class="id" title="variable">A</span></a>) : <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#list"><span class="id" title="inductive">list</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#list"><span class="id" title="inductive">list</span></a> <a class="idref" href="ConCert.Execution.Test.TraceGens.html#A"><span class="id" title="variable">A</span></a>) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="ConCert.Execution.Test.TraceGens.html#l"><span class="id" title="variable">l</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#ae9a5e1034e143b218b09d8e454472bd"><span class="id" title="notation">[]</span></a> =&gt; <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#ae9a5e1034e143b218b09d8e454472bd"><span class="id" title="notation">[]</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">x</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#cbcf67aac0c2a85b8d93d37de9969adf"><span class="id" title="notation">::</span></a> <span class="id" title="var">xs</span> =&gt; <span class="id" title="var">xs</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#cbcf67aac0c2a85b8d93d37de9969adf"><span class="id" title="notation">::</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#map"><span class="id" title="definition">map</span></a> (<span class="id" title="keyword">fun</span> <span class="id" title="var">xs'</span> : <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#list"><span class="id" title="inductive">list</span></a> <a class="idref" href="ConCert.Execution.Test.TraceGens.html#A"><span class="id" title="variable">A</span></a> =&gt; <span class="id" title="var">x</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#cbcf67aac0c2a85b8d93d37de9969adf"><span class="id" title="notation">::</span></a> <a class="idref" href="ConCert.Execution.Test.TraceGens.html#xs'"><span class="id" title="variable">xs'</span></a>) (<a class="idref" href="ConCert.Execution.Test.TraceGens.html#shrinkListAux_"><span class="id" title="definition">shrinkListAux_</span></a> <span class="id" title="var">xs</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;Shrink&nbsp;list&nbsp;of&nbsp;blocks&nbsp;by&nbsp;trying&nbsp;all&nbsp;combinations&nbsp;of&nbsp;removing&nbsp;one&nbsp;action&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">Fixpoint</span> <a name="shrinkChainBuilderAux"><span class="id" title="definition">shrinkChainBuilderAux</span></a> (<span class="id" title="var">blocks</span> : <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#list"><span class="id" title="inductive">list</span></a> (<a class="idref" href="ConCert.Execution.Blockchain.html#BlockHeader"><span class="id" title="record">BlockHeader</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#11c698c8685bb8ab1cf725545c085ac4"><span class="id" title="notation">*</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#list"><span class="id" title="inductive">list</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#Action"><span class="id" title="record">Action</span></a>)) : <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#list"><span class="id" title="inductive">list</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#list"><span class="id" title="inductive">list</span></a> (<a class="idref" href="ConCert.Execution.Blockchain.html#BlockHeader"><span class="id" title="record">BlockHeader</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#11c698c8685bb8ab1cf725545c085ac4"><span class="id" title="notation">*</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#list"><span class="id" title="inductive">list</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#Action"><span class="id" title="record">Action</span></a>)) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="ConCert.Execution.Test.TraceGens.html#blocks"><span class="id" title="variable">blocks</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#ae9a5e1034e143b218b09d8e454472bd"><span class="id" title="notation">[]</span></a> =&gt; <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#ae9a5e1034e143b218b09d8e454472bd"><span class="id" title="notation">[]</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">block</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#cbcf67aac0c2a85b8d93d37de9969adf"><span class="id" title="notation">::</span></a> <span class="id" title="var">blocks'</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> '<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><span class="id" title="var">header</span><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <span class="id" title="var">acts</span><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> := <span class="id" title="var">block</span> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">acts_shrunk</span> := <a class="idref" href="ConCert.Execution.Test.TraceGens.html#shrinkListAux_"><span class="id" title="definition">shrinkListAux_</span></a> <span class="id" title="var">acts</span> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">block_shrunk</span> := <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#map"><span class="id" title="definition">map</span></a> (<span class="id" title="keyword">fun</span> <span class="id" title="var">acts</span> =&gt; <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><span class="id" title="var">header</span><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="ConCert.Execution.Test.TraceGens.html#acts"><span class="id" title="variable">acts</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a>) <a class="idref" href="ConCert.Execution.Test.TraceGens.html#acts_shrunk"><span class="id" title="variable">acts_shrunk</span></a> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#bc347c51eaf667706ae54503b26d52c6"><span class="id" title="notation">(</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#map"><span class="id" title="definition">map</span></a> (<span class="id" title="keyword">fun</span> <span class="id" title="var">block'</span> =&gt; <a class="idref" href="ConCert.Execution.Test.TraceGens.html#block'"><span class="id" title="variable">block'</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#cbcf67aac0c2a85b8d93d37de9969adf"><span class="id" title="notation">::</span></a> <span class="id" title="var">blocks'</span>) <a class="idref" href="ConCert.Execution.Test.TraceGens.html#block_shrunk"><span class="id" title="variable">block_shrunk</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#bc347c51eaf667706ae54503b26d52c6"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#bc347c51eaf667706ae54503b26d52c6"><span class="id" title="notation">++</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#map"><span class="id" title="definition">map</span></a> (<span class="id" title="keyword">fun</span> <span class="id" title="var">xs</span> =&gt; <span class="id" title="var">block</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#cbcf67aac0c2a85b8d93d37de9969adf"><span class="id" title="notation">::</span></a> <a class="idref" href="ConCert.Execution.Test.TraceGens.html#xs"><span class="id" title="variable">xs</span></a>) (<a class="idref" href="ConCert.Execution.Test.TraceGens.html#shrinkChainBuilderAux"><span class="id" title="definition">shrinkChainBuilderAux</span></a> <span class="id" title="var">blocks'</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;Shrinker&nbsp;for&nbsp;ChainBuilders,&nbsp;it&nbsp;will&nbsp;only&nbsp;try&nbsp;to&nbsp;shrink&nbsp;the&nbsp;blocks&nbsp;and&nbsp;their&nbsp;action&nbsp;queues,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;it&nbsp;will&nbsp;not&nbsp;attempt&nbsp;to&nbsp;shrink&nbsp;parameters&nbsp;of&nbsp;any&nbsp;actions&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">Instance</span> <a name="shrinkChainBuilder"><span class="id" title="instance">shrinkChainBuilder</span></a> : <span class="id" title="class">Shrink</span> <a class="idref" href="ConCert.Execution.Test.TestUtils.html#ChainBuilder"><span class="id" title="instance">ChainBuilder</span></a> :=<br/>
&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="method">shrink</span> <span class="id" title="var">cb</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">cb_blocks</span> := <a class="idref" href="ConCert.Execution.Test.TraceGens.html#trace_blocks"><span class="id" title="definition">trace_blocks</span></a> <a class="idref" href="ConCert.Execution.Test.TraceGens.html#cb"><span class="id" title="variable">cb</span></a>.(<a class="idref" href="ConCert.Execution.Blockchain.html#builder_trace"><span class="id" title="method">builder_trace</span></a>) <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">shrunk_blocks</span> := <a class="idref" href="ConCert.Execution.Test.TraceGens.html#shrinkChainBuilderAux"><span class="id" title="definition">shrinkChainBuilderAux</span></a> <a class="idref" href="ConCert.Execution.Test.TraceGens.html#cb_blocks"><span class="id" title="variable">cb_blocks</span></a> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Test.TraceGens.html#rebuild_chains"><span class="id" title="definition">rebuild_chains</span></a> <a class="idref" href="ConCert.Execution.Test.TraceGens.html#shrunk_blocks"><span class="id" title="variable">shrunk_blocks</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#builder_initial"><span class="id" title="method">builder_initial</span></a><br/>
&nbsp;&nbsp;}.<br/>

<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;Adds&nbsp;a&nbsp;block&nbsp;with&nbsp;miner&nbsp;reward&nbsp;of&nbsp;50.&nbsp;This&nbsp;is&nbsp;used&nbsp;for&nbsp;all&nbsp;testing&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a name="add_block"><span class="id" title="definition">add_block</span></a> (<span class="id" title="var">chain</span> : <a class="idref" href="ConCert.Execution.Test.TestUtils.html#ChainBuilder"><span class="id" title="instance">ChainBuilder</span></a>) <span class="id" title="var">acts</span> : <a class="idref" href="ConCert.Execution.ResultMonad.html#result"><span class="id" title="inductive">result</span></a> <a class="idref" href="ConCert.Execution.Test.TestUtils.html#ChainBuilder"><span class="id" title="instance">ChainBuilder</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#AddBlockError"><span class="id" title="inductive">AddBlockError</span></a> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">header</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{| <a class="idref" href="ConCert.Execution.Blockchain.html#build_block_Header"><span class="id" title="constructor">block_height</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#build_block_Header"><span class="id" title="constructor">:=</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#build_block_Header"><span class="id" title="constructor">S</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#build_block_Header"><span class="id" title="constructor">(</span></a><a class="idref" href="ConCert.Execution.Blockchain.html#build_block_Header"><span class="id" title="constructor">chain_height</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#build_block_Header"><span class="id" title="constructor">chain</span></a><a class="idref" href="ConCert.Execution.Blockchain.html#build_block_Header"><span class="id" title="constructor">);</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#build_block_Header"><span class="id" title="constructor">block_slot</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#build_block_Header"><span class="id" title="constructor">:=</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#build_block_Header"><span class="id" title="constructor">S</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#build_block_Header"><span class="id" title="constructor">(</span></a><a class="idref" href="ConCert.Execution.Blockchain.html#build_block_Header"><span class="id" title="constructor">current_slot</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#build_block_Header"><span class="id" title="constructor">chain</span></a><a class="idref" href="ConCert.Execution.Blockchain.html#build_block_Header"><span class="id" title="constructor">);</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#build_block_Header"><span class="id" title="constructor">block_finalized_height</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#build_block_Header"><span class="id" title="constructor">:=</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#build_block_Header"><span class="id" title="constructor">finalized_height</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#build_block_Header"><span class="id" title="constructor">chain</span></a><a class="idref" href="ConCert.Execution.Blockchain.html#build_block_Header"><span class="id" title="constructor">;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#build_block_Header"><span class="id" title="constructor">block_creator</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#build_block_Header"><span class="id" title="constructor">:=</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#build_block_Header"><span class="id" title="constructor">BlockCreator</span></a><a class="idref" href="ConCert.Execution.Blockchain.html#build_block_Header"><span class="id" title="constructor">;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#build_block_Header"><span class="id" title="constructor">block_reward</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#build_block_Header"><span class="id" title="constructor">:=</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#build_block_Header"><span class="id" title="constructor">BlockReward</span></a><a class="idref" href="ConCert.Execution.Blockchain.html#build_block_Header"><span class="id" title="constructor">;</span></a> |} <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#builder_add_block"><span class="id" title="method">builder_add_block</span></a> <a class="idref" href="ConCert.Execution.Test.TraceGens.html#chain"><span class="id" title="variable">chain</span></a> <a class="idref" href="ConCert.Execution.Test.TraceGens.html#header"><span class="id" title="variable">header</span></a> <a class="idref" href="ConCert.Execution.Test.TraceGens.html#acts"><span class="id" title="variable">acts</span></a>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a name="gAdd_block"><span class="id" title="definition">gAdd_block</span></a> (<span class="id" title="var">cb</span> : <a class="idref" href="ConCert.Execution.Test.TestUtils.html#ChainBuilder"><span class="id" title="instance">ChainBuilder</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">gActOptFromChainSized</span> : <a class="idref" href="ConCert.Execution.Blockchain.html#Environment"><span class="id" title="record">Environment</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a> <span class="id" title="definition">GOpt</span> <a class="idref" href="ConCert.Execution.Blockchain.html#Action"><span class="id" title="record">Action</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">act_depth</span> : <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">max_acts_per_block</span> : <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;: <span class="id" title="axiom">G</span> (<a class="idref" href="ConCert.Execution.ResultMonad.html#result"><span class="id" title="inductive">result</span></a> <a class="idref" href="ConCert.Execution.Test.TestUtils.html#ChainBuilder"><span class="id" title="instance">ChainBuilder</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#AddBlockError"><span class="id" title="inductive">AddBlockError</span></a>) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">acts</span> <span class="id" title="notation">&lt;-</span> <a class="idref" href="ConCert.Execution.Test.TestUtils.html#optToVector"><span class="id" title="definition">optToVector</span></a> <a class="idref" href="ConCert.Execution.Test.TraceGens.html#max_acts_per_block"><span class="id" title="variable">max_acts_per_block</span></a> (<a class="idref" href="ConCert.Execution.Test.TraceGens.html#gActOptFromChainSized"><span class="id" title="variable">gActOptFromChainSized</span></a> <a class="idref" href="ConCert.Execution.Test.TraceGens.html#cb"><span class="id" title="variable">cb</span></a> <a class="idref" href="ConCert.Execution.Test.TraceGens.html#act_depth"><span class="id" title="variable">act_depth</span></a>) <span class="id" title="notation">;;</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="axiom">returnGen</span> (<a class="idref" href="ConCert.Execution.Test.TraceGens.html#add_block"><span class="id" title="definition">add_block</span></a> <a class="idref" href="ConCert.Execution.Test.TraceGens.html#cb"><span class="id" title="variable">cb</span></a> <a class="idref" href="ConCert.Execution.Test.TraceGens.html#acts"><span class="id" title="variable">acts</span></a>).<br/>

<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;Given&nbsp;a&nbsp;function&nbsp;from&nbsp;nat&nbsp;to&nbsp;a&nbsp;generator,&nbsp;try&nbsp;the&nbsp;generator&nbsp;on&nbsp;decreasing&nbsp;number&nbsp;until&nbsp;one&nbsp;returns&nbsp;Ok&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">Fixpoint</span> <a name="try_decreasing"><span class="id" title="definition">try_decreasing</span></a> {<span class="id" title="var">T</span> <span class="id" title="var">E</span>} (<span class="id" title="var">default</span> : <a class="idref" href="ConCert.Execution.Test.TraceGens.html#E"><span class="id" title="variable">E</span></a>) (<span class="id" title="var">n</span> : <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a>) (<span class="id" title="var">g</span> : <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a> <span class="id" title="axiom">G</span> (<a class="idref" href="ConCert.Execution.ResultMonad.html#result"><span class="id" title="inductive">result</span></a> <a class="idref" href="ConCert.Execution.Test.TraceGens.html#T"><span class="id" title="variable">T</span></a> <a class="idref" href="ConCert.Execution.Test.TraceGens.html#E"><span class="id" title="variable">E</span></a>)) : <span class="id" title="axiom">G</span> (<a class="idref" href="ConCert.Execution.ResultMonad.html#result"><span class="id" title="inductive">result</span></a> <a class="idref" href="ConCert.Execution.Test.TraceGens.html#T"><span class="id" title="variable">T</span></a> <a class="idref" href="ConCert.Execution.Test.TraceGens.html#E"><span class="id" title="variable">E</span></a>) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="ConCert.Execution.Test.TraceGens.html#n"><span class="id" title="variable">n</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| 0 =&gt; <span class="id" title="axiom">returnGen</span> (<a class="idref" href="ConCert.Execution.ResultMonad.html#Err"><span class="id" title="constructor">Err</span></a> <a class="idref" href="ConCert.Execution.Test.TraceGens.html#default"><span class="id" title="variable">default</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#S"><span class="id" title="constructor">S</span></a> <span class="id" title="var">n'</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">ma</span> <span class="id" title="notation">&lt;-</span> <span class="id" title="notation">(</span><a class="idref" href="ConCert.Execution.Test.TraceGens.html#g"><span class="id" title="variable">g</span></a> <a class="idref" href="ConCert.Execution.Test.TraceGens.html#n"><span class="id" title="variable">n</span></a><span class="id" title="notation">)</span> <span class="id" title="notation">;;</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="ConCert.Execution.Test.TraceGens.html#ma"><span class="id" title="variable">ma</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="ConCert.Execution.ResultMonad.html#Err"><span class="id" title="constructor">Err</span></a> <span class="id" title="var">e</span> =&gt; <a class="idref" href="ConCert.Execution.Test.TraceGens.html#try_decreasing"><span class="id" title="definition">try_decreasing</span></a> <a class="idref" href="ConCert.Execution.Test.TraceGens.html#default"><span class="id" title="variable">default</span></a> <span class="id" title="var">n'</span> <a class="idref" href="ConCert.Execution.Test.TraceGens.html#g"><span class="id" title="variable">g</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="ConCert.Execution.ResultMonad.html#Ok"><span class="id" title="constructor">Ok</span></a> <span class="id" title="var">r</span> =&gt; <span class="id" title="axiom">returnGen</span> (<a class="idref" href="ConCert.Execution.ResultMonad.html#Ok"><span class="id" title="constructor">Ok</span></a> <span class="id" title="var">r</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a name="gChain"><span class="id" title="definition">gChain</span></a> (<span class="id" title="var">init_lc</span> : <a class="idref" href="ConCert.Execution.Test.TestUtils.html#ChainBuilder"><span class="id" title="instance">ChainBuilder</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">gActOptFromChainSized</span> : <a class="idref" href="ConCert.Execution.Blockchain.html#Environment"><span class="id" title="record">Environment</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a> <span class="id" title="definition">GOpt</span> <a class="idref" href="ConCert.Execution.Blockchain.html#Action"><span class="id" title="record">Action</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">max_length</span> : <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">act_depth</span> : <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">max_acts_per_block</span> : <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;: <span class="id" title="axiom">G</span> <a class="idref" href="ConCert.Execution.Test.TestUtils.html#ChainBuilder"><span class="id" title="instance">ChainBuilder</span></a> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">gAdd_block'</span> <span class="id" title="var">lc</span> <span class="id" title="var">max_acts</span> := <a class="idref" href="ConCert.Execution.Test.TraceGens.html#gAdd_block"><span class="id" title="definition">gAdd_block</span></a> <a class="idref" href="ConCert.Execution.Test.TraceGens.html#lc"><span class="id" title="variable">lc</span></a> <a class="idref" href="ConCert.Execution.Test.TraceGens.html#gActOptFromChainSized"><span class="id" title="variable">gActOptFromChainSized</span></a> <a class="idref" href="ConCert.Execution.Test.TraceGens.html#act_depth"><span class="id" title="variable">act_depth</span></a> <a class="idref" href="ConCert.Execution.Test.TraceGens.html#max_acts"><span class="id" title="variable">max_acts</span></a> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">default_error</span> := <a class="idref" href="ConCert.Execution.Blockchain.html#action_evaluation_depth_exceeded"><span class="id" title="constructor">action_evaluation_depth_exceeded</span></a> <span class="id" title="tactic">in</span> <span class="comment">(*&nbsp;Not&nbsp;ideal&nbsp;approach,&nbsp;but&nbsp;it&nbsp;suffices&nbsp;for&nbsp;now&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">try_twice</span> <span class="id" title="var">g</span> := <a class="idref" href="ConCert.Execution.Test.TestUtils.html#backtrack_result"><span class="id" title="definition">backtrack_result</span></a> <a class="idref" href="ConCert.Execution.Test.TraceGens.html#default_error"><span class="id" title="variable">default_error</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#e76c6291366b599375c28eba0aae94bb"><span class="id" title="notation">[</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a>1<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="ConCert.Execution.Test.TraceGens.html#g"><span class="id" title="variable">g</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#e76c6291366b599375c28eba0aae94bb"><span class="id" title="notation">;</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a>1<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="ConCert.Execution.Test.TraceGens.html#g"><span class="id" title="variable">g</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#e76c6291366b599375c28eba0aae94bb"><span class="id" title="notation">]</span></a> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">try_decreasing</span> <span class="id" title="var">g</span> := <a class="idref" href="ConCert.Execution.Test.TraceGens.html#try_decreasing"><span class="id" title="definition">try_decreasing</span></a> <a class="idref" href="ConCert.Execution.Test.TraceGens.html#default_error"><span class="id" title="variable">default_error</span></a> <a class="idref" href="ConCert.Execution.Test.TraceGens.html#max_acts_per_block"><span class="id" title="variable">max_acts_per_block</span></a> (<span class="id" title="keyword">fun</span> <span class="id" title="var">n</span> =&gt; <a class="idref" href="ConCert.Execution.Test.TraceGens.html#try_twice"><span class="id" title="variable">try_twice</span></a> (<a class="idref" href="ConCert.Execution.Test.TraceGens.html#g"><span class="id" title="variable">g</span></a> <a class="idref" href="ConCert.Execution.Test.TraceGens.html#n"><span class="id" title="variable">n</span></a>)) <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;Try&nbsp;decreasing&nbsp;max_acts_per_block,&nbsp;this&nbsp;is&nbsp;needed&nbsp;in&nbsp;some&nbsp;cases&nbsp;since&nbsp;there&nbsp;might&nbsp;be&nbsp;blocks<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;where&nbsp;it&nbsp;is&nbsp;not&nbsp;possible&nbsp;to&nbsp;generate&nbsp;max_acts_per_block&nbsp;number&nbsp;of&nbsp;valid&nbsp;actions&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="keyword">fix</span> <span class="id" title="keyword">rec</span> <span class="id" title="var">n</span> (<span class="id" title="var">lc</span> : <a class="idref" href="ConCert.Execution.Test.TestUtils.html#ChainBuilder"><span class="id" title="instance">ChainBuilder</span></a>) : <span class="id" title="axiom">G</span> <a class="idref" href="ConCert.Execution.Test.TestUtils.html#ChainBuilder"><span class="id" title="instance">ChainBuilder</span></a> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="ConCert.Execution.Test.TraceGens.html#n"><span class="id" title="variable">n</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| 0 =&gt; <span class="id" title="axiom">returnGen</span> <a class="idref" href="ConCert.Execution.Test.TraceGens.html#lc"><span class="id" title="variable">lc</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#S"><span class="id" title="constructor">S</span></a> <span class="id" title="var">n</span> =&gt; <span class="id" title="var">lc'</span> <span class="id" title="notation">&lt;-</span> <a class="idref" href="ConCert.Execution.Test.TraceGens.html#try_decreasing"><span class="id" title="variable">try_decreasing</span></a> (<a class="idref" href="ConCert.Execution.Test.TraceGens.html#gAdd_block'"><span class="id" title="variable">gAdd_block'</span></a> <a class="idref" href="ConCert.Execution.Test.TraceGens.html#lc"><span class="id" title="variable">lc</span></a>) <span class="id" title="notation">;;</span> <span class="comment">(*&nbsp;heuristic:&nbsp;try&nbsp;twice&nbsp;for&nbsp;more&nbsp;expected&nbsp;robustness&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="ConCert.Execution.Test.TraceGens.html#lc'"><span class="id" title="variable">lc'</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="ConCert.Execution.ResultMonad.html#Ok"><span class="id" title="constructor">Ok</span></a> <span class="id" title="var">lc'</span> =&gt; <a class="idref" href="ConCert.Execution.Test.TraceGens.html#rec"><span class="id" title="variable">rec</span></a> <a class="idref" href="ConCert.Execution.Test.TraceGens.html#n"><span class="id" title="variable">n</span></a> <a class="idref" href="ConCert.Execution.Test.TraceGens.html#lc'"><span class="id" title="variable">lc'</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;if&nbsp;no&nbsp;new&nbsp;chain&nbsp;could&nbsp;be&nbsp;generated&nbsp;without&nbsp;error,&nbsp;return&nbsp;the&nbsp;old&nbsp;chain&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">err</span> =&gt; <span class="id" title="axiom">returnGen</span> <a class="idref" href="ConCert.Execution.Test.TraceGens.html#lc"><span class="id" title="variable">lc</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Test.TraceGens.html#rec"><span class="id" title="variable">rec</span></a> <a class="idref" href="ConCert.Execution.Test.TraceGens.html#max_length"><span class="id" title="variable">max_length</span></a> <a class="idref" href="ConCert.Execution.Test.TraceGens.html#init_lc"><span class="id" title="variable">init_lc</span></a>.<br/>

<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;Generator&nbsp;that&nbsp;generates&nbsp;blocks&nbsp;of&nbsp;invalid&nbsp;actions.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;It&nbsp;will&nbsp;return&nbsp;a&nbsp;ChainBuilder&nbsp;and&nbsp;a&nbsp;list&nbsp;of&nbsp;actions&nbsp;that&nbsp;will<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cause&nbsp;an&nbsp;error&nbsp;if&nbsp;the&nbsp;actions&nbsp;are&nbsp;added&nbsp;as&nbsp;a&nbsp;new&nbsp;block&nbsp;to&nbsp;the&nbsp;ChainBuilder&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a name="gInvalidAction"><span class="id" title="definition">gInvalidAction</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">init_lc</span> : <a class="idref" href="ConCert.Execution.Test.TestUtils.html#ChainBuilder"><span class="id" title="instance">ChainBuilder</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">gActOptFromChainSized</span> : <a class="idref" href="ConCert.Execution.Blockchain.html#Environment"><span class="id" title="record">Environment</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a> <span class="id" title="definition">GOpt</span> <a class="idref" href="ConCert.Execution.Blockchain.html#Action"><span class="id" title="record">Action</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">max_length</span> : <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">act_depth</span> : <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">max_acts_per_block</span> : <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;: <span class="id" title="axiom">G</span> (<a class="idref" href="ConCert.Execution.Test.TestUtils.html#ChainBuilder"><span class="id" title="instance">ChainBuilder</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#11c698c8685bb8ab1cf725545c085ac4"><span class="id" title="notation">*</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#list"><span class="id" title="inductive">list</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#Action"><span class="id" title="record">Action</span></a>) :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="keyword">fix</span> <span class="id" title="keyword">rec</span> <span class="id" title="var">n</span> (<span class="id" title="var">lc</span> : <a class="idref" href="ConCert.Execution.Test.TestUtils.html#ChainBuilder"><span class="id" title="instance">ChainBuilder</span></a>) : <span class="id" title="axiom">G</span> (<a class="idref" href="ConCert.Execution.Test.TestUtils.html#ChainBuilder"><span class="id" title="instance">ChainBuilder</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#11c698c8685bb8ab1cf725545c085ac4"><span class="id" title="notation">*</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#list"><span class="id" title="inductive">list</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#Action"><span class="id" title="record">Action</span></a>) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="ConCert.Execution.Test.TraceGens.html#n"><span class="id" title="variable">n</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| 0 =&gt; <span class="id" title="axiom">returnGen</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Execution.Test.TraceGens.html#lc"><span class="id" title="variable">lc</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#ae9a5e1034e143b218b09d8e454472bd"><span class="id" title="notation">[]</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <span class="comment">(*&nbsp;max_length&nbsp;was&nbsp;reached&nbsp;without&nbsp;any&nbsp;errors&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#S"><span class="id" title="constructor">S</span></a> <span class="id" title="var">n</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">acts</span> <span class="id" title="notation">&lt;-</span> <a class="idref" href="ConCert.Execution.Test.TestUtils.html#optToVector"><span class="id" title="definition">optToVector</span></a> <a class="idref" href="ConCert.Execution.Test.TraceGens.html#max_acts_per_block"><span class="id" title="variable">max_acts_per_block</span></a> (<a class="idref" href="ConCert.Execution.Test.TraceGens.html#gActOptFromChainSized"><span class="id" title="variable">gActOptFromChainSized</span></a> <a class="idref" href="ConCert.Execution.Test.TraceGens.html#lc"><span class="id" title="variable">lc</span></a> <a class="idref" href="ConCert.Execution.Test.TraceGens.html#act_depth"><span class="id" title="variable">act_depth</span></a>) <span class="id" title="notation">;;</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> (<a class="idref" href="ConCert.Execution.Test.TraceGens.html#add_block"><span class="id" title="definition">TraceGens.add_block</span></a> <a class="idref" href="ConCert.Execution.Test.TraceGens.html#lc"><span class="id" title="variable">lc</span></a> <a class="idref" href="ConCert.Execution.Test.TraceGens.html#acts"><span class="id" title="variable">acts</span></a>) <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="ConCert.Execution.ResultMonad.html#Ok"><span class="id" title="constructor">Ok</span></a> <span class="id" title="var">lc'</span> =&gt; <a class="idref" href="ConCert.Execution.Test.TraceGens.html#rec"><span class="id" title="variable">rec</span></a> <a class="idref" href="ConCert.Execution.Test.TraceGens.html#n"><span class="id" title="variable">n</span></a> <span class="id" title="var">lc'</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;If&nbsp;no&nbsp;new&nbsp;chain&nbsp;could&nbsp;be&nbsp;generated&nbsp;without&nbsp;error,&nbsp;return&nbsp;the&nbsp;trace&nbsp;and&nbsp;action&nbsp;list&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">err</span> =&gt; <span class="id" title="axiom">returnGen</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Execution.Test.TraceGens.html#lc"><span class="id" title="variable">lc</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="ConCert.Execution.Test.TraceGens.html#acts"><span class="id" title="variable">acts</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Test.TraceGens.html#rec"><span class="id" title="variable">rec</span></a> <a class="idref" href="ConCert.Execution.Test.TraceGens.html#max_length"><span class="id" title="variable">max_length</span></a> <a class="idref" href="ConCert.Execution.Test.TraceGens.html#init_lc"><span class="id" title="variable">init_lc</span></a>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a name="get_reachable"><span class="id" title="definition">get_reachable</span></a> {<span class="id" title="var">to</span>} : <a class="idref" href="ConCert.Execution.Blockchain.html#ChainTrace"><span class="id" title="definition">ChainTrace</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#empty_state"><span class="id" title="definition">empty_state</span></a> <a class="idref" href="ConCert.Execution.Test.TraceGens.html#to"><span class="id" title="variable">to</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#reachable"><span class="id" title="definition">reachable</span></a> <a class="idref" href="ConCert.Execution.Test.TraceGens.html#to"><span class="id" title="variable">to</span></a> := <span class="id" title="keyword">fun</span> <span class="id" title="var">t</span> =&gt; <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#inhabits"><span class="id" title="constructor">inhabits</span></a> <a class="idref" href="ConCert.Execution.Test.TraceGens.html#t"><span class="id" title="variable">t</span></a>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a name="gReachableFromTrace"><span class="id" title="definition">gReachableFromTrace</span></a> {<span class="id" title="var">to</span>} (<span class="id" title="var">gtrace</span> : <span class="id" title="axiom">G</span> (<a class="idref" href="ConCert.Execution.Blockchain.html#ChainTrace"><span class="id" title="definition">ChainTrace</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#empty_state"><span class="id" title="definition">empty_state</span></a> <a class="idref" href="ConCert.Execution.Test.TraceGens.html#to"><span class="id" title="variable">to</span></a>)) : <span class="id" title="axiom">G</span> (<a class="idref" href="ConCert.Execution.Blockchain.html#reachable"><span class="id" title="definition">reachable</span></a> <a class="idref" href="ConCert.Execution.Test.TraceGens.html#to"><span class="id" title="variable">to</span></a>) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="axiom">bindGen</span> <a class="idref" href="ConCert.Execution.Test.TraceGens.html#gtrace"><span class="id" title="variable">gtrace</span></a> (<span class="id" title="keyword">fun</span> <span class="id" title="var">trace</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="axiom">returnGen</span> (<a class="idref" href="ConCert.Execution.Test.TraceGens.html#get_reachable"><span class="id" title="definition">get_reachable</span></a> <a class="idref" href="ConCert.Execution.Test.TraceGens.html#trace"><span class="id" title="variable">trace</span></a>)).<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Global Instance</span> <a name="shrinkReachable"><span class="id" title="instance">shrinkReachable</span></a> : <span class="id" title="class">Shrink</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Specif.html#6556914db359db999889decec6a4a562"><span class="id" title="notation">{</span></a><span class="id" title="var">to</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Specif.html#6556914db359db999889decec6a4a562"><span class="id" title="notation">:</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#ChainState"><span class="id" title="record">ChainState</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Specif.html#6556914db359db999889decec6a4a562"><span class="id" title="notation">|</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#reachable"><span class="id" title="definition">reachable</span></a> <a class="idref" href="ConCert.Execution.Test.TraceGens.html#to"><span class="id" title="variable">to</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Specif.html#6556914db359db999889decec6a4a562"><span class="id" title="notation">}</span></a> :=<br/>
&nbsp;&nbsp;{|<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="constructor">shrink</span> <span class="id" title="constructor">a</span> <span class="id" title="constructor">:=</span> <span class="id" title="constructor">[</span><span class="id" title="constructor">a</span><span class="id" title="constructor">]</span><br/>
&nbsp;&nbsp;|}.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Global Instance</span> <a name="genReachableSized"><span class="id" title="instance">genReachableSized</span></a> `{<span class="id" title="class">GenSized</span> <a class="idref" href="ConCert.Execution.Test.TestUtils.html#ChainBuilder"><span class="id" title="instance">ChainBuilder</span></a>} : <span class="id" title="class">GenSized</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Specif.html#bc4528e836ab0e91ea7e942fb09e898f"><span class="id" title="notation">{</span></a><span class="id" title="var">to</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Specif.html#bc4528e836ab0e91ea7e942fb09e898f"><span class="id" title="notation">|</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#reachable"><span class="id" title="definition">reachable</span></a> <a class="idref" href="ConCert.Execution.Test.TraceGens.html#to"><span class="id" title="variable">to</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Specif.html#bc4528e836ab0e91ea7e942fb09e898f"><span class="id" title="notation">}</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">constructor</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">H2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">H1</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<span class="id" title="axiom">bindGen</span> <span class="id" title="var">H2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">cb</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">remember</span> (<a class="idref" href="ConCert.Execution.Blockchain.html#builder_trace"><span class="id" title="method">builder_trace</span></a> <span class="id" title="var">cb</span>) <span class="id" title="keyword">as</span> <span class="id" title="var">trace</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="axiom">returnGen</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Specif.html#exist"><span class="id" title="constructor">exist</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="ConCert.Execution.Test.TraceGens.html#get_reachable"><span class="id" title="definition">get_reachable</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">trace</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Defined</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Global Instance</span> <a name="shrinkChainTraceSig"><span class="id" title="instance">shrinkChainTraceSig</span></a> : <span class="id" title="class">Shrink</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Specif.html#cc5e56ba3765e2d6b17e66d19b966f1d"><span class="id" title="notation">{</span></a><span class="id" title="var">to</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Specif.html#cc5e56ba3765e2d6b17e66d19b966f1d"><span class="id" title="notation">:</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#ChainState"><span class="id" title="record">ChainState</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Specif.html#cc5e56ba3765e2d6b17e66d19b966f1d"><span class="id" title="notation">&amp;</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#ChainTrace"><span class="id" title="definition">ChainTrace</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#empty_state"><span class="id" title="definition">empty_state</span></a> <a class="idref" href="ConCert.Execution.Test.TraceGens.html#to"><span class="id" title="variable">to</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Specif.html#cc5e56ba3765e2d6b17e66d19b966f1d"><span class="id" title="notation">}</span></a> :=<br/>
&nbsp;&nbsp;{|<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="constructor">shrink</span> <span class="id" title="constructor">a</span> <span class="id" title="constructor">:=</span> <span class="id" title="constructor">[</span><span class="id" title="constructor">a</span><span class="id" title="constructor">]</span><br/>
&nbsp;&nbsp;|}.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Global Instance</span> <a name="genChainTraceSigSized"><span class="id" title="instance">genChainTraceSigSized</span></a> `{<span class="id" title="class">GenSized</span> <a class="idref" href="ConCert.Execution.Test.TestUtils.html#ChainBuilder"><span class="id" title="instance">ChainBuilder</span></a>} : <span class="id" title="class">GenSized</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Specif.html#cc5e56ba3765e2d6b17e66d19b966f1d"><span class="id" title="notation">{</span></a><span class="id" title="var">to</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Specif.html#cc5e56ba3765e2d6b17e66d19b966f1d"><span class="id" title="notation">:</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#ChainState"><span class="id" title="record">ChainState</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Specif.html#cc5e56ba3765e2d6b17e66d19b966f1d"><span class="id" title="notation">&amp;</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#ChainTrace"><span class="id" title="definition">ChainTrace</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#empty_state"><span class="id" title="definition">empty_state</span></a> <a class="idref" href="ConCert.Execution.Test.TraceGens.html#to"><span class="id" title="variable">to</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Specif.html#cc5e56ba3765e2d6b17e66d19b966f1d"><span class="id" title="notation">}</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">constructor</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">n</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">H1</span> <span class="id" title="tactic">in</span> <span class="id" title="var">n</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<span class="id" title="axiom">bindGen</span> <span class="id" title="var">n</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">cb</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">remember</span> (<a class="idref" href="ConCert.Execution.Blockchain.html#builder_trace"><span class="id" title="method">builder_trace</span></a> <span class="id" title="var">cb</span>) <span class="id" title="keyword">as</span> <span class="id" title="var">trace</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="axiom">returnGen</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Specif.html#existT"><span class="id" title="constructor">existT</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Defined</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;Checker&nbsp;combinators&nbsp;on&nbsp;ChainBuilder&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a name="forAllChainBuilder"><span class="id" title="definition">forAllChainBuilder</span></a> {<span class="id" title="var">prop</span> : <span class="id" title="keyword">Type</span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;`{<span class="id" title="class">Checkable</span> <a class="idref" href="ConCert.Execution.Test.TraceGens.html#prop"><span class="id" title="variable">prop</span></a>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">maxLength</span> : <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">init_lc</span> : <a class="idref" href="ConCert.Execution.Test.TestUtils.html#ChainBuilder"><span class="id" title="instance">ChainBuilder</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">gTrace</span> : <a class="idref" href="ConCert.Execution.Test.TestUtils.html#ChainBuilder"><span class="id" title="instance">ChainBuilder</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a> <span class="id" title="axiom">G</span> <a class="idref" href="ConCert.Execution.Test.TestUtils.html#ChainBuilder"><span class="id" title="instance">ChainBuilder</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">pf</span> : <a class="idref" href="ConCert.Execution.Test.TestUtils.html#ChainBuilder"><span class="id" title="instance">ChainBuilder</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="ConCert.Execution.Test.TraceGens.html#prop"><span class="id" title="variable">prop</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;: <span class="id" title="definition">Checker</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="definition">forAllShrink</span> (<a class="idref" href="ConCert.Execution.Test.TraceGens.html#gTrace"><span class="id" title="variable">gTrace</span></a> <a class="idref" href="ConCert.Execution.Test.TraceGens.html#init_lc"><span class="id" title="variable">init_lc</span></a> <a class="idref" href="ConCert.Execution.Test.TraceGens.html#maxLength"><span class="id" title="variable">maxLength</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="method">shrink</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">cb</span> =&gt; <span class="id" title="method">checker</span> (<a class="idref" href="ConCert.Execution.Test.TraceGens.html#pf"><span class="id" title="variable">pf</span></a> <a class="idref" href="ConCert.Execution.Test.TraceGens.html#cb"><span class="id" title="variable">cb</span></a>)).<br/>

<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;Gathers&nbsp;all&nbsp;ChainStates&nbsp;from&nbsp;a&nbsp;ChainTrace&nbsp;in&nbsp;a&nbsp;list,&nbsp;appearing&nbsp;in&nbsp;order.&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;Currently&nbsp;not&nbsp;tail-call&nbsp;optimized.&nbsp;Can&nbsp;be&nbsp;improved&nbsp;if&nbsp;needed.&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">Fixpoint</span> <a name="trace_states"><span class="id" title="definition">trace_states</span></a> {<span class="id" title="var">from</span> <span class="id" title="var">to</span>} (<span class="id" title="var">trace</span> : <a class="idref" href="ConCert.Execution.Blockchain.html#ChainTrace"><span class="id" title="definition">ChainTrace</span></a> <a class="idref" href="ConCert.Execution.Test.TraceGens.html#from"><span class="id" title="variable">from</span></a> <a class="idref" href="ConCert.Execution.Test.TraceGens.html#to"><span class="id" title="variable">to</span></a>) : <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#list"><span class="id" title="inductive">list</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#ChainState"><span class="id" title="record">ChainState</span></a> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="ConCert.Execution.Test.TraceGens.html#trace"><span class="id" title="variable">trace</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="ConCert.Execution.ChainedList.html#snoc"><span class="id" title="constructor">snoc</span></a> <span class="id" title="var">trace'</span> <span class="id" title="var">step</span> =&gt; <a class="idref" href="ConCert.Execution.Test.TraceGens.html#trace_states"><span class="id" title="definition">trace_states</span></a> <span class="id" title="var">trace'</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#bc347c51eaf667706ae54503b26d52c6"><span class="id" title="notation">++</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#ddd65c2f7ee73ecec433744948d846bb"><span class="id" title="notation">[</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#snd"><span class="id" title="definition">snd</span></a> (<a class="idref" href="ConCert.Execution.Test.TestUtils.html#chainstep_states"><span class="id" title="definition">chainstep_states</span></a> <span class="id" title="var">step</span>)<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#ddd65c2f7ee73ecec433744948d846bb"><span class="id" title="notation">]</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="ConCert.Execution.ChainedList.html#clnil"><span class="id" title="constructor">clnil</span></a> =&gt; <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#ae9a5e1034e143b218b09d8e454472bd"><span class="id" title="notation">[]</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;Variant&nbsp;that&nbsp;only&nbsp;gathers&nbsp;ChainStates&nbsp;of&nbsp;step_block&nbsp;steps&nbsp;in&nbsp;the&nbsp;trace.&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">Fixpoint</span> <a name="trace_states_step_block"><span class="id" title="definition">trace_states_step_block</span></a> {<span class="id" title="var">from</span> <span class="id" title="var">to</span>} (<span class="id" title="var">trace</span> : <a class="idref" href="ConCert.Execution.Blockchain.html#ChainTrace"><span class="id" title="definition">ChainTrace</span></a> <a class="idref" href="ConCert.Execution.Test.TraceGens.html#from"><span class="id" title="variable">from</span></a> <a class="idref" href="ConCert.Execution.Test.TraceGens.html#to"><span class="id" title="variable">to</span></a>) : <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#list"><span class="id" title="inductive">list</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#ChainState"><span class="id" title="record">ChainState</span></a> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="ConCert.Execution.Test.TraceGens.html#trace"><span class="id" title="variable">trace</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="ConCert.Execution.ChainedList.html#snoc"><span class="id" title="constructor">snoc</span></a> <span class="id" title="var">trace'</span> (<a class="idref" href="ConCert.Execution.Blockchain.html#step_block"><span class="id" title="constructor">Blockchain.step_block</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="keyword">as</span> <span class="id" title="var">step</span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Test.TraceGens.html#trace_states_step_block"><span class="id" title="definition">trace_states_step_block</span></a> <span class="id" title="var">trace'</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#bc347c51eaf667706ae54503b26d52c6"><span class="id" title="notation">++</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#ddd65c2f7ee73ecec433744948d846bb"><span class="id" title="notation">[</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#snd"><span class="id" title="definition">snd</span></a> (<a class="idref" href="ConCert.Execution.Test.TestUtils.html#chainstep_states"><span class="id" title="definition">chainstep_states</span></a> <span class="id" title="var">step</span>)<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#ddd65c2f7ee73ecec433744948d846bb"><span class="id" title="notation">]</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="ConCert.Execution.ChainedList.html#snoc"><span class="id" title="constructor">snoc</span></a> <span class="id" title="var">trace'</span> <span class="id" title="var">_</span> =&gt; <a class="idref" href="ConCert.Execution.Test.TraceGens.html#trace_states_step_block"><span class="id" title="definition">trace_states_step_block</span></a> <span class="id" title="var">trace'</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="ConCert.Execution.ChainedList.html#clnil"><span class="id" title="constructor">clnil</span></a> =&gt; <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#ae9a5e1034e143b218b09d8e454472bd"><span class="id" title="notation">[]</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;Gather&nbsp;execution&nbsp;information&nbsp;for&nbsp;each&nbsp;step_action&nbsp;in&nbsp;a&nbsp;ChainTrace&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">Fixpoint</span> <a name="trace_states_step_action"><span class="id" title="definition">trace_states_step_action</span></a> {<span class="id" title="var">from</span> <span class="id" title="var">to</span>} (<span class="id" title="var">trace</span> : <a class="idref" href="ConCert.Execution.Blockchain.html#ChainTrace"><span class="id" title="definition">ChainTrace</span></a> <a class="idref" href="ConCert.Execution.Test.TraceGens.html#from"><span class="id" title="variable">from</span></a> <a class="idref" href="ConCert.Execution.Test.TraceGens.html#to"><span class="id" title="variable">to</span></a>) : <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#list"><span class="id" title="inductive">list</span></a> (<a class="idref" href="ConCert.Execution.Blockchain.html#Action"><span class="id" title="record">Action</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#11c698c8685bb8ab1cf725545c085ac4"><span class="id" title="notation">*</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#list"><span class="id" title="inductive">list</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#Action"><span class="id" title="record">Action</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#11c698c8685bb8ab1cf725545c085ac4"><span class="id" title="notation">*</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#ChainState"><span class="id" title="record">ChainState</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#11c698c8685bb8ab1cf725545c085ac4"><span class="id" title="notation">*</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#ChainState"><span class="id" title="record">ChainState</span></a>) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="ConCert.Execution.Test.TraceGens.html#trace"><span class="id" title="variable">trace</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="ConCert.Execution.ChainedList.html#snoc"><span class="id" title="constructor">snoc</span></a> <span class="id" title="var">trace'</span> (<a class="idref" href="ConCert.Execution.Blockchain.html#step_action"><span class="id" title="constructor">Blockchain.step_action</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">act</span> <span class="id" title="var">_</span> <span class="id" title="var">new_acts</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="keyword">as</span> <span class="id" title="var">step</span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> '<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><span class="id" title="var">from</span><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <span class="id" title="var">to</span><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> := <a class="idref" href="ConCert.Execution.Test.TestUtils.html#chainstep_states"><span class="id" title="definition">chainstep_states</span></a> <span class="id" title="var">step</span> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Test.TraceGens.html#trace_states_step_action"><span class="id" title="definition">trace_states_step_action</span></a> <span class="id" title="var">trace'</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#bc347c51eaf667706ae54503b26d52c6"><span class="id" title="notation">++</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#ddd65c2f7ee73ecec433744948d846bb"><span class="id" title="notation">[</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><span class="id" title="var">act</span><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <span class="id" title="var">new_acts</span><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="ConCert.Execution.Test.TraceGens.html#from"><span class="id" title="variable">from</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="ConCert.Execution.Test.TraceGens.html#to"><span class="id" title="variable">to</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#ddd65c2f7ee73ecec433744948d846bb"><span class="id" title="notation">]</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="ConCert.Execution.ChainedList.html#snoc"><span class="id" title="constructor">snoc</span></a> <span class="id" title="var">trace'</span> <span class="id" title="var">_</span> =&gt; <a class="idref" href="ConCert.Execution.Test.TraceGens.html#trace_states_step_action"><span class="id" title="definition">trace_states_step_action</span></a> <span class="id" title="var">trace'</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="ConCert.Execution.ChainedList.html#clnil"><span class="id" title="constructor">clnil</span></a> =&gt; <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#ae9a5e1034e143b218b09d8e454472bd"><span class="id" title="notation">[]</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;Asserts&nbsp;that&nbsp;a&nbsp;ChainState&nbsp;property&nbsp;holds&nbsp;for&nbsp;all&nbsp;step_block&nbsp;ChainStates&nbsp;in&nbsp;a&nbsp;ChainTrace&nbsp;&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a name="ChainTrace_ChainTraceProp"><span class="id" title="definition">ChainTrace_ChainTraceProp</span></a> {<span class="id" title="var">prop</span> : <span class="id" title="keyword">Type</span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<span class="id" title="var">from</span> <span class="id" title="var">to</span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;`{<span class="id" title="class">Checkable</span> <a class="idref" href="ConCert.Execution.Test.TraceGens.html#prop"><span class="id" title="variable">prop</span></a>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">trace</span> : <a class="idref" href="ConCert.Execution.Blockchain.html#ChainTrace"><span class="id" title="definition">ChainTrace</span></a> <a class="idref" href="ConCert.Execution.Test.TraceGens.html#from"><span class="id" title="variable">from</span></a> <a class="idref" href="ConCert.Execution.Test.TraceGens.html#to"><span class="id" title="variable">to</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">pf</span> : <a class="idref" href="ConCert.Execution.Blockchain.html#ChainState"><span class="id" title="record">ChainState</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="ConCert.Execution.Test.TraceGens.html#prop"><span class="id" title="variable">prop</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;: <span class="id" title="definition">Checker</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">printOnFail</span> (<span class="id" title="var">cs</span> : <a class="idref" href="ConCert.Execution.Blockchain.html#ChainState"><span class="id" title="record">ChainState</span></a>) : <span class="id" title="definition">Checker</span> := <span class="id" title="definition">whenFail</span> (<span class="id" title="method">show</span> <a class="idref" href="ConCert.Execution.Test.TraceGens.html#cs"><span class="id" title="variable">cs</span></a>) (<span class="id" title="method">checker</span> (<a class="idref" href="ConCert.Execution.Test.TraceGens.html#pf"><span class="id" title="variable">pf</span></a> <a class="idref" href="ConCert.Execution.Test.TraceGens.html#cs"><span class="id" title="variable">cs</span></a>)) <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">trace_list</span> := <a class="idref" href="ConCert.Execution.Test.TraceGens.html#trace_states_step_block"><span class="id" title="definition">trace_states_step_block</span></a> <a class="idref" href="ConCert.Execution.Test.TraceGens.html#trace"><span class="id" title="variable">trace</span></a> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Test.TestUtils.html#discard_empty"><span class="id" title="definition">discard_empty</span></a> <a class="idref" href="ConCert.Execution.Test.TraceGens.html#trace_list"><span class="id" title="variable">trace_list</span></a> (<a class="idref" href="ConCert.Execution.Test.TestUtils.html#conjoin_map"><span class="id" title="definition">conjoin_map</span></a> <a class="idref" href="ConCert.Execution.Test.TraceGens.html#printOnFail"><span class="id" title="variable">printOnFail</span></a>).<br/>

<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;--------------------&nbsp;Checker&nbsp;combinators&nbsp;on&nbsp;traces&nbsp;--------------------&nbsp;&nbsp;*)</span><br/>

<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;Asserts&nbsp;that&nbsp;a&nbsp;ChainState&nbsp;property&nbsp;holds&nbsp;on&nbsp;all&nbsp;ChainStates&nbsp;in&nbsp;a&nbsp;ChainTrace&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a name="forAllChainState"><span class="id" title="definition">forAllChainState</span></a> {<span class="id" title="var">prop</span> : <span class="id" title="keyword">Type</span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;`{<span class="id" title="class">Checkable</span> <a class="idref" href="ConCert.Execution.Test.TraceGens.html#prop"><span class="id" title="variable">prop</span></a>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">maxLength</span> : <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">init_lc</span> : <a class="idref" href="ConCert.Execution.Test.TestUtils.html#ChainBuilder"><span class="id" title="instance">ChainBuilder</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">gTrace</span> : <a class="idref" href="ConCert.Execution.Test.TestUtils.html#ChainBuilder"><span class="id" title="instance">ChainBuilder</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a> <span class="id" title="axiom">G</span> <a class="idref" href="ConCert.Execution.Test.TestUtils.html#ChainBuilder"><span class="id" title="instance">ChainBuilder</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">pf</span> : <a class="idref" href="ConCert.Execution.Blockchain.html#ChainState"><span class="id" title="record">ChainState</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="ConCert.Execution.Test.TraceGens.html#prop"><span class="id" title="variable">prop</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;: <span class="id" title="definition">Checker</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">printOnFail</span> (<span class="id" title="var">cs</span> : <a class="idref" href="ConCert.Execution.Blockchain.html#ChainState"><span class="id" title="record">ChainState</span></a>) : <span class="id" title="definition">Checker</span> := <span class="id" title="definition">whenFail</span> (<span class="id" title="method">show</span> <a class="idref" href="ConCert.Execution.Test.TraceGens.html#cs"><span class="id" title="variable">cs</span></a>) (<span class="id" title="method">checker</span> (<a class="idref" href="ConCert.Execution.Test.TraceGens.html#pf"><span class="id" title="variable">pf</span></a> <a class="idref" href="ConCert.Execution.Test.TraceGens.html#cs"><span class="id" title="variable">cs</span></a>)) <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="definition">forAllShrink</span> (<a class="idref" href="ConCert.Execution.Test.TraceGens.html#gTrace"><span class="id" title="variable">gTrace</span></a> <a class="idref" href="ConCert.Execution.Test.TraceGens.html#init_lc"><span class="id" title="variable">init_lc</span></a> <a class="idref" href="ConCert.Execution.Test.TraceGens.html#maxLength"><span class="id" title="variable">maxLength</span></a>) <span class="id" title="method">shrink</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="keyword">fun</span> <span class="id" title="var">cb</span> =&gt; <a class="idref" href="ConCert.Execution.Test.TestUtils.html#discard_empty"><span class="id" title="definition">discard_empty</span></a> (<a class="idref" href="ConCert.Execution.Test.TraceGens.html#trace_states"><span class="id" title="definition">trace_states</span></a> <a class="idref" href="ConCert.Execution.Test.TraceGens.html#cb"><span class="id" title="variable">cb</span></a>.(<a class="idref" href="ConCert.Execution.Blockchain.html#builder_trace"><span class="id" title="method">builder_trace</span></a>)) (<a class="idref" href="ConCert.Execution.Test.TestUtils.html#conjoin_map"><span class="id" title="definition">conjoin_map</span></a> <a class="idref" href="ConCert.Execution.Test.TraceGens.html#printOnFail"><span class="id" title="variable">printOnFail</span></a>)).<br/>

<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;Asserts&nbsp;that&nbsp;a&nbsp;ChainState&nbsp;property&nbsp;holds&nbsp;on&nbsp;all&nbsp;step_block&nbsp;ChainStates&nbsp;in&nbsp;a&nbsp;ChainTrace&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a name="forAllBlocks"><span class="id" title="definition">forAllBlocks</span></a> {<span class="id" title="var">prop</span> : <span class="id" title="keyword">Type</span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;`{<span class="id" title="class">Checkable</span> <a class="idref" href="ConCert.Execution.Test.TraceGens.html#prop"><span class="id" title="variable">prop</span></a>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">maxLength</span> : <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">init_lc</span> : <a class="idref" href="ConCert.Execution.Test.TestUtils.html#ChainBuilder"><span class="id" title="instance">ChainBuilder</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">gTrace</span> : <a class="idref" href="ConCert.Execution.Test.TestUtils.html#ChainBuilder"><span class="id" title="instance">ChainBuilder</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a> <span class="id" title="axiom">G</span> <a class="idref" href="ConCert.Execution.Test.TestUtils.html#ChainBuilder"><span class="id" title="instance">ChainBuilder</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">pf</span> : <a class="idref" href="ConCert.Execution.Blockchain.html#ChainState"><span class="id" title="record">ChainState</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="ConCert.Execution.Test.TraceGens.html#prop"><span class="id" title="variable">prop</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;: <span class="id" title="definition">Checker</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="definition">forAllShrink</span> (<a class="idref" href="ConCert.Execution.Test.TraceGens.html#gTrace"><span class="id" title="variable">gTrace</span></a> <a class="idref" href="ConCert.Execution.Test.TraceGens.html#init_lc"><span class="id" title="variable">init_lc</span></a> <a class="idref" href="ConCert.Execution.Test.TraceGens.html#maxLength"><span class="id" title="variable">maxLength</span></a>) <span class="id" title="method">shrink</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="keyword">fun</span> <span class="id" title="var">cb</span> =&gt; <a class="idref" href="ConCert.Execution.Test.TraceGens.html#ChainTrace_ChainTraceProp"><span class="id" title="definition">ChainTrace_ChainTraceProp</span></a> <a class="idref" href="ConCert.Execution.Test.TraceGens.html#cb"><span class="id" title="variable">cb</span></a>.(<a class="idref" href="ConCert.Execution.Blockchain.html#builder_trace"><span class="id" title="method">builder_trace</span></a>) <a class="idref" href="ConCert.Execution.Test.TraceGens.html#pf"><span class="id" title="variable">pf</span></a>).<br/>

<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;Checker&nbsp;combinators&nbsp;on&nbsp;ChainTrace,&nbsp;asserting&nbsp;holds&nbsp;a&nbsp;property&nbsp;on<br/>
&nbsp;&nbsp;&nbsp;&nbsp;each&nbsp;pair&nbsp;of&nbsp;succeeding&nbsp;ChainStates&nbsp;in&nbsp;the&nbsp;trace.&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a name="forAllChainStatePairs"><span class="id" title="definition">forAllChainStatePairs</span></a> {<span class="id" title="var">prop</span> : <span class="id" title="keyword">Type</span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;`{<span class="id" title="class">Checkable</span> <a class="idref" href="ConCert.Execution.Test.TraceGens.html#prop"><span class="id" title="variable">prop</span></a>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">maxLength</span> : <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">init_lc</span> : <a class="idref" href="ConCert.Execution.Test.TestUtils.html#ChainBuilder"><span class="id" title="instance">ChainBuilder</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">gTrace</span> : <a class="idref" href="ConCert.Execution.Test.TestUtils.html#ChainBuilder"><span class="id" title="instance">ChainBuilder</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a> <span class="id" title="axiom">G</span> <a class="idref" href="ConCert.Execution.Test.TestUtils.html#ChainBuilder"><span class="id" title="instance">ChainBuilder</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">pf</span> : <a class="idref" href="ConCert.Execution.Blockchain.html#ChainState"><span class="id" title="record">ChainState</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#ChainState"><span class="id" title="record">ChainState</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="ConCert.Execution.Test.TraceGens.html#prop"><span class="id" title="variable">prop</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;: <span class="id" title="definition">Checker</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;helper&nbsp;function&nbsp;folding&nbsp;over&nbsp;the&nbsp;trace*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">last_cstate</span> {<span class="id" title="var">from</span> <span class="id" title="var">to</span>} (<span class="id" title="var">trace</span> : <a class="idref" href="ConCert.Execution.Blockchain.html#ChainTrace"><span class="id" title="definition">ChainTrace</span></a> <a class="idref" href="ConCert.Execution.Test.TraceGens.html#from"><span class="id" title="variable">from</span></a> <a class="idref" href="ConCert.Execution.Test.TraceGens.html#to"><span class="id" title="variable">to</span></a>) := <a class="idref" href="ConCert.Execution.Test.TraceGens.html#to"><span class="id" title="variable">to</span></a> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="keyword">fix</span> <span class="id" title="var">all_statepairs</span> {<span class="id" title="var">from</span> <span class="id" title="var">to</span> : <a class="idref" href="ConCert.Execution.Blockchain.html#ChainState"><span class="id" title="record">ChainState</span></a>} (<span class="id" title="var">trace</span> : <a class="idref" href="ConCert.Execution.Blockchain.html#ChainTrace"><span class="id" title="definition">ChainTrace</span></a> <a class="idref" href="ConCert.Execution.Test.TraceGens.html#from"><span class="id" title="variable">from</span></a> <a class="idref" href="ConCert.Execution.Test.TraceGens.html#to"><span class="id" title="variable">to</span></a>) <span class="id" title="var">prev_bstate</span> : <span class="id" title="definition">Checker</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="ConCert.Execution.Test.TraceGens.html#trace"><span class="id" title="variable">trace</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="ConCert.Execution.ChainedList.html#snoc"><span class="id" title="constructor">snoc</span></a> <span class="id" title="var">trace'</span> <span class="id" title="var">step</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">step</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="ConCert.Execution.Blockchain.html#step_block"><span class="id" title="constructor">Blockchain.step_block</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;next_bstate&nbsp;has&nbsp;acts,&nbsp;bstate_before_step_block&nbsp;has&nbsp;no&nbsp;acts&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> '<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><span class="id" title="var">bstate_before_step_block</span><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <span class="id" title="var">next_bstate</span><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> := <a class="idref" href="ConCert.Execution.Test.TestUtils.html#chainstep_states"><span class="id" title="definition">chainstep_states</span></a> <span class="id" title="var">step</span> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="definition">conjoin</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#e76c6291366b599375c28eba0aae94bb"><span class="id" title="notation">[(</span></a><span class="id" title="method">checker</span> (<a class="idref" href="ConCert.Execution.Test.TraceGens.html#pf"><span class="id" title="variable">pf</span></a> <span class="id" title="var">next_bstate</span> <a class="idref" href="ConCert.Execution.Test.TraceGens.html#prev_bstate"><span class="id" title="variable">prev_bstate</span></a>)<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#e76c6291366b599375c28eba0aae94bb"><span class="id" title="notation">);</span></a> <a class="idref" href="ConCert.Execution.Test.TraceGens.html#all_statepairs"><span class="id" title="variable">all_statepairs</span></a> <span class="id" title="var">trace'</span> <span class="id" title="var">bstate_before_step_block</span><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#e76c6291366b599375c28eba0aae94bb"><span class="id" title="notation">]</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">_</span> =&gt; <a class="idref" href="ConCert.Execution.Test.TraceGens.html#all_statepairs"><span class="id" title="variable">all_statepairs</span></a> <span class="id" title="var">trace'</span> <a class="idref" href="ConCert.Execution.Test.TraceGens.html#prev_bstate"><span class="id" title="variable">prev_bstate</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="ConCert.Execution.ChainedList.html#clnil"><span class="id" title="constructor">clnil</span></a>  =&gt; <span class="id" title="method">checker</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#true"><span class="id" title="constructor">true</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="definition">forAllShrink</span> (<a class="idref" href="ConCert.Execution.Test.TraceGens.html#gTrace"><span class="id" title="variable">gTrace</span></a> <a class="idref" href="ConCert.Execution.Test.TraceGens.html#init_lc"><span class="id" title="variable">init_lc</span></a> <a class="idref" href="ConCert.Execution.Test.TraceGens.html#maxLength"><span class="id" title="variable">maxLength</span></a>) <span class="id" title="method">shrink</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="keyword">fun</span> <span class="id" title="var">cb</span> =&gt; <a class="idref" href="ConCert.Execution.Test.TraceGens.html#all_statepairs"><span class="id" title="variable">all_statepairs</span></a> <a class="idref" href="ConCert.Execution.Test.TraceGens.html#cb"><span class="id" title="variable">cb</span></a>.(<a class="idref" href="ConCert.Execution.Blockchain.html#builder_trace"><span class="id" title="method">builder_trace</span></a>) (<a class="idref" href="ConCert.Execution.Test.TraceGens.html#last_cstate"><span class="id" title="variable">last_cstate</span></a> <a class="idref" href="ConCert.Execution.Test.TraceGens.html#cb"><span class="id" title="variable">cb</span></a>.(<a class="idref" href="ConCert.Execution.Blockchain.html#builder_trace"><span class="id" title="method">builder_trace</span></a>))).<br/>

<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;Asserts&nbsp;that&nbsp;property&nbsp;holds&nbsp;on&nbsp;all&nbsp;action&nbsp;evaluations&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a name="forAllActionExecution"><span class="id" title="definition">forAllActionExecution</span></a> {<span class="id" title="var">prop</span> : <span class="id" title="keyword">Type</span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;`{<span class="id" title="class">Checkable</span> <a class="idref" href="ConCert.Execution.Test.TraceGens.html#prop"><span class="id" title="variable">prop</span></a>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">maxLength</span> : <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">init_lc</span> : <a class="idref" href="ConCert.Execution.Test.TestUtils.html#ChainBuilder"><span class="id" title="instance">ChainBuilder</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">gTrace</span> : <a class="idref" href="ConCert.Execution.Test.TestUtils.html#ChainBuilder"><span class="id" title="instance">ChainBuilder</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a> <span class="id" title="axiom">G</span> <a class="idref" href="ConCert.Execution.Test.TestUtils.html#ChainBuilder"><span class="id" title="instance">ChainBuilder</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">pf</span> : <a class="idref" href="ConCert.Execution.Blockchain.html#Action"><span class="id" title="record">Action</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#list"><span class="id" title="inductive">list</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#Action"><span class="id" title="record">Action</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#ChainState"><span class="id" title="record">ChainState</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#ChainState"><span class="id" title="record">ChainState</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="ConCert.Execution.Test.TraceGens.html#prop"><span class="id" title="variable">prop</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;: <span class="id" title="definition">Checker</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">printOnFail</span> <span class="id" title="var">x</span> : <span class="id" title="definition">Checker</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> '<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><span class="id" title="var">action</span><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <span class="id" title="var">new_acts</span><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <span class="id" title="var">cs_from</span><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <span class="id" title="var">cs_to</span><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> := <a class="idref" href="ConCert.Execution.Test.TraceGens.html#x"><span class="id" title="variable">x</span></a> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="definition">whenFail</span> (<span class="id" title="method">show</span> <span class="id" title="var">cs_from</span>) (<span class="id" title="method">checker</span> (<a class="idref" href="ConCert.Execution.Test.TraceGens.html#pf"><span class="id" title="variable">pf</span></a> <span class="id" title="var">action</span> <span class="id" title="var">new_acts</span> <span class="id" title="var">cs_from</span> <span class="id" title="var">cs_to</span>)) <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">trace_list</span> <span class="id" title="var">cb</span> := <a class="idref" href="ConCert.Execution.Test.TraceGens.html#trace_states_step_action"><span class="id" title="definition">trace_states_step_action</span></a> <a class="idref" href="ConCert.Execution.Test.TraceGens.html#cb"><span class="id" title="variable">cb</span></a>.(<a class="idref" href="ConCert.Execution.Blockchain.html#builder_trace"><span class="id" title="method">builder_trace</span></a>) <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="definition">forAllShrink</span> (<a class="idref" href="ConCert.Execution.Test.TraceGens.html#gTrace"><span class="id" title="variable">gTrace</span></a> <a class="idref" href="ConCert.Execution.Test.TraceGens.html#init_lc"><span class="id" title="variable">init_lc</span></a> <a class="idref" href="ConCert.Execution.Test.TraceGens.html#maxLength"><span class="id" title="variable">maxLength</span></a>) <span class="id" title="method">shrink</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="keyword">fun</span> <span class="id" title="var">cb</span> =&gt; <a class="idref" href="ConCert.Execution.Test.TestUtils.html#discard_empty"><span class="id" title="definition">discard_empty</span></a> (<a class="idref" href="ConCert.Execution.Test.TraceGens.html#trace_list"><span class="id" title="variable">trace_list</span></a> <a class="idref" href="ConCert.Execution.Test.TraceGens.html#cb"><span class="id" title="variable">cb</span></a>) (<a class="idref" href="ConCert.Execution.Test.TestUtils.html#conjoin_map"><span class="id" title="definition">conjoin_map</span></a> <a class="idref" href="ConCert.Execution.Test.TraceGens.html#printOnFail"><span class="id" title="variable">printOnFail</span></a>)).<br/>

<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;Asserts&nbsp;that&nbsp;a&nbsp;boolean&nbsp;predicate&nbsp;holds&nbsp;for&nbsp;at&nbsp;least&nbsp;one&nbsp;ChainState&nbsp;in&nbsp;the&nbsp;given&nbsp;ChainTrace&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a name="existsb_chaintrace"><span class="id" title="definition">existsb_chaintrace</span></a> {<span class="id" title="var">from</span> <span class="id" title="var">to</span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">pf</span> : <a class="idref" href="ConCert.Execution.Blockchain.html#ChainState"><span class="id" title="record">ChainState</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#bool"><span class="id" title="inductive">bool</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">trace</span> : <a class="idref" href="ConCert.Execution.Blockchain.html#ChainTrace"><span class="id" title="definition">ChainTrace</span></a> <a class="idref" href="ConCert.Execution.Test.TraceGens.html#from"><span class="id" title="variable">from</span></a> <a class="idref" href="ConCert.Execution.Test.TraceGens.html#to"><span class="id" title="variable">to</span></a>) : <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#bool"><span class="id" title="inductive">bool</span></a> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#existsb"><span class="id" title="definition">existsb</span></a> <a class="idref" href="ConCert.Execution.Test.TraceGens.html#pf"><span class="id" title="variable">pf</span></a> (<a class="idref" href="ConCert.Execution.Test.TraceGens.html#trace_states"><span class="id" title="definition">trace_states</span></a> <a class="idref" href="ConCert.Execution.Test.TraceGens.html#trace"><span class="id" title="variable">trace</span></a>).<br/>

<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;Asserts&nbsp;that&nbsp;a&nbsp;ChainState&nbsp;satisfying&nbsp;a&nbsp;given&nbsp;predicate&nbsp;is&nbsp;reachable&nbsp;from&nbsp;the&nbsp;given&nbsp;trace&nbsp;generator.&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a name="reachableFromSized_chaintrace"><span class="id" title="definition">reachableFromSized_chaintrace</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">maxLength</span> : <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">init_lc</span> : <a class="idref" href="ConCert.Execution.Test.TestUtils.html#ChainBuilder"><span class="id" title="instance">ChainBuilder</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">gTrace</span> : <a class="idref" href="ConCert.Execution.Test.TestUtils.html#ChainBuilder"><span class="id" title="instance">ChainBuilder</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a> <span class="id" title="axiom">G</span> <a class="idref" href="ConCert.Execution.Test.TestUtils.html#ChainBuilder"><span class="id" title="instance">ChainBuilder</span></a> )<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">pf</span> : <a class="idref" href="ConCert.Execution.Blockchain.html#ChainState"><span class="id" title="record">ChainState</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#bool"><span class="id" title="inductive">bool</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;: <span class="id" title="definition">Checker</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Test.TestUtils.html#existsP"><span class="id" title="definition">existsP</span></a> (<a class="idref" href="ConCert.Execution.Test.TraceGens.html#gTrace"><span class="id" title="variable">gTrace</span></a> <a class="idref" href="ConCert.Execution.Test.TraceGens.html#init_lc"><span class="id" title="variable">init_lc</span></a> <a class="idref" href="ConCert.Execution.Test.TraceGens.html#maxLength"><span class="id" title="variable">maxLength</span></a>) (<span class="id" title="keyword">fun</span> <span class="id" title="var">cb</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Test.TraceGens.html#existsb_chaintrace"><span class="id" title="definition">existsb_chaintrace</span></a> <a class="idref" href="ConCert.Execution.Test.TraceGens.html#pf"><span class="id" title="variable">pf</span></a> <a class="idref" href="ConCert.Execution.Test.TraceGens.html#cb"><span class="id" title="variable">cb</span></a>.(<a class="idref" href="ConCert.Execution.Blockchain.html#builder_trace"><span class="id" title="method">builder_trace</span></a>)).<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a name="reachableFrom_chaintrace"><span class="id" title="definition">reachableFrom_chaintrace</span></a> <span class="id" title="var">init_lc</span> <span class="id" title="var">gTrace</span> <span class="id" title="var">pf</span> : <span class="id" title="definition">Checker</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="axiom">sized</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">n</span> =&gt; <a class="idref" href="ConCert.Execution.Test.TraceGens.html#reachableFromSized_chaintrace"><span class="id" title="definition">reachableFromSized_chaintrace</span></a> <a class="idref" href="ConCert.Execution.Test.TraceGens.html#n"><span class="id" title="variable">n</span></a> <a class="idref" href="ConCert.Execution.Test.TraceGens.html#init_lc"><span class="id" title="variable">init_lc</span></a> <a class="idref" href="ConCert.Execution.Test.TraceGens.html#gTrace"><span class="id" title="variable">gTrace</span></a> <a class="idref" href="ConCert.Execution.Test.TraceGens.html#pf"><span class="id" title="variable">pf</span></a>).<br/>

<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;This&nbsp;property&nbsp;states&nbsp;that&nbsp;if&nbsp;there&nbsp;is&nbsp;a&nbsp;reachable&nbsp;chainstate&nbsp;satisfying&nbsp;the&nbsp;reachable_prop&nbsp;predicate,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;then&nbsp;all&nbsp;succeeding&nbsp;chainstates&nbsp;must&nbsp;satisfy&nbsp;implied_prop&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a name="reachableFrom_implies_chaintracePropSized"><span class="id" title="definition">reachableFrom_implies_chaintracePropSized</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<span class="id" title="var">A</span> <span class="id" title="var">prop</span> : <span class="id" title="keyword">Type</span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;`{<span class="id" title="class">Checkable</span> <a class="idref" href="ConCert.Execution.Test.TraceGens.html#prop"><span class="id" title="variable">prop</span></a>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">maxLength</span> : <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">init_cb</span> : <a class="idref" href="ConCert.Execution.Test.TestUtils.html#ChainBuilder"><span class="id" title="instance">ChainBuilder</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">gTrace</span> : <a class="idref" href="ConCert.Execution.Test.TestUtils.html#ChainBuilder"><span class="id" title="instance">ChainBuilder</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a> <span class="id" title="axiom">G</span> <a class="idref" href="ConCert.Execution.Test.TestUtils.html#ChainBuilder"><span class="id" title="instance">ChainBuilder</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">reachable_prop</span> : <a class="idref" href="ConCert.Execution.Blockchain.html#ChainState"><span class="id" title="record">ChainState</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#option"><span class="id" title="inductive">option</span></a> <a class="idref" href="ConCert.Execution.Test.TraceGens.html#A"><span class="id" title="variable">A</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">implied_prop</span> : <a class="idref" href="ConCert.Execution.Test.TraceGens.html#A"><span class="id" title="variable">A</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#list"><span class="id" title="inductive">list</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#ChainState"><span class="id" title="record">ChainState</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#list"><span class="id" title="inductive">list</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#ChainState"><span class="id" title="record">ChainState</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="ConCert.Execution.Test.TraceGens.html#prop"><span class="id" title="variable">prop</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;: <span class="id" title="definition">Checker</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="definition">forAllShrink</span> (<a class="idref" href="ConCert.Execution.Test.TraceGens.html#gTrace"><span class="id" title="variable">gTrace</span></a> <a class="idref" href="ConCert.Execution.Test.TraceGens.html#init_cb"><span class="id" title="variable">init_cb</span></a> <a class="idref" href="ConCert.Execution.Test.TraceGens.html#maxLength"><span class="id" title="variable">maxLength</span></a>) <span class="id" title="method">shrink</span><br/>
&nbsp;&nbsp;(<span class="id" title="keyword">fun</span> <span class="id" title="var">cb</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">trace</span> := <a class="idref" href="ConCert.Execution.Test.TraceGens.html#cb"><span class="id" title="variable">cb</span></a>.(<a class="idref" href="ConCert.Execution.Blockchain.html#builder_trace"><span class="id" title="method">builder_trace</span></a>) <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">reachable_prop_bool</span> := <a class="idref" href="ConCert.Utils.Extras.html#isSome"><span class="id" title="definition">isSome</span></a> <a class="idref" href="ConCert.Execution.Test.TestUtils.html#7b7e4684e4e94e8bc8d09d9e7f96bf6b"><span class="id" title="notation">o</span></a> <a class="idref" href="ConCert.Execution.Test.TraceGens.html#reachable_prop"><span class="id" title="variable">reachable_prop</span></a> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">tracelist</span> := <a class="idref" href="ConCert.Execution.Test.TraceGens.html#trace_states_step_block"><span class="id" title="definition">trace_states_step_block</span></a> <a class="idref" href="ConCert.Execution.Test.TraceGens.html#trace"><span class="id" title="variable">trace</span></a> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="ConCert.Execution.Test.TestUtils.html#split_at_first_satisfying"><span class="id" title="definition">split_at_first_satisfying</span></a> <a class="idref" href="ConCert.Execution.Test.TraceGens.html#reachable_prop_bool"><span class="id" title="variable">reachable_prop_bool</span></a> <a class="idref" href="ConCert.Execution.Test.TraceGens.html#tracelist"><span class="id" title="variable">tracelist</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a>(<span class="id" title="var">x</span><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#cbcf67aac0c2a85b8d93d37de9969adf"><span class="id" title="notation">::</span></a><span class="id" title="var">xs</span>) <span class="id" title="keyword">as</span> <span class="id" title="var">pre</span><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <span class="id" title="var">post</span><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;last_step&nbsp;is&nbsp;the&nbsp;element&nbsp;satisfying&nbsp;reachable_prop_bool&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">last_step</span> := (<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#last"><span class="id" title="definition">List.last</span></a> <span class="id" title="var">pre</span> <span class="id" title="var">x</span>) <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Test.TestUtils.html#isSomeCheck"><span class="id" title="definition">isSomeCheck</span></a> (<a class="idref" href="ConCert.Execution.Test.TraceGens.html#reachable_prop"><span class="id" title="variable">reachable_prop</span></a> <a class="idref" href="ConCert.Execution.Test.TraceGens.html#last_step"><span class="id" title="variable">last_step</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="keyword">fun</span> <span class="id" title="var">a</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;assert&nbsp;that&nbsp;implied_prop&nbsp;holds&nbsp;on&nbsp;the&nbsp;post&nbsp;trace&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Test.TraceGens.html#implied_prop"><span class="id" title="variable">implied_prop</span></a> <a class="idref" href="ConCert.Execution.Test.TraceGens.html#a"><span class="id" title="variable">a</span></a> <span class="id" title="var">pre</span> <span class="id" title="var">post</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">_</span> =&gt; <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#false"><span class="id" title="constructor">false</span></a> <span class="id" title="notation">==&gt;</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#true"><span class="id" title="constructor">true</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>).<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Open</span> <span class="id" title="keyword">Scope</span> <span class="id" title="var">string_scope</span>.<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;if&nbsp;pre&nbsp;tests&nbsp;true,&nbsp;then&nbsp;post&nbsp;tests&nbsp;true,&nbsp;for&nbsp;all&nbsp;tested&nbsp;execution&nbsp;traces&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a name="pre_post_assertion"><span class="id" title="definition">pre_post_assertion</span></a> {<span class="id" title="var">Msg</span> <span class="id" title="var">State</span> <span class="id" title="var">prop</span> : <span class="id" title="keyword">Type</span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;`{<span class="id" title="class">Checkable</span> <a class="idref" href="ConCert.Execution.Test.TraceGens.html#prop"><span class="id" title="variable">prop</span></a>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;`{<a class="idref" href="ConCert.Execution.Serializable.html#Serializable"><span class="id" title="class">Serializable</span></a> <a class="idref" href="ConCert.Execution.Test.TraceGens.html#Msg"><span class="id" title="variable">Msg</span></a>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;`{<a class="idref" href="ConCert.Execution.Serializable.html#Serializable"><span class="id" title="class">Serializable</span></a> <a class="idref" href="ConCert.Execution.Test.TraceGens.html#State"><span class="id" title="variable">State</span></a>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;`{<span class="id" title="class">Show</span> <a class="idref" href="ConCert.Execution.Test.TraceGens.html#Msg"><span class="id" title="variable">Msg</span></a>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">maxLength</span> : <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">init_chain</span> : <a class="idref" href="ConCert.Execution.Test.TestUtils.html#ChainBuilder"><span class="id" title="instance">ChainBuilder</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">gTrace</span> : <a class="idref" href="ConCert.Execution.Test.TestUtils.html#ChainBuilder"><span class="id" title="instance">ChainBuilder</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a> <span class="id" title="axiom">G</span> <a class="idref" href="ConCert.Execution.Test.TestUtils.html#ChainBuilder"><span class="id" title="instance">ChainBuilder</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">caddr</span> : <a class="idref" href="ConCert.Execution.Blockchain.html#Address"><span class="id" title="method">Address</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">pre</span> : <a class="idref" href="ConCert.Execution.Test.TraceGens.html#State"><span class="id" title="variable">State</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="ConCert.Execution.Test.TraceGens.html#Msg"><span class="id" title="variable">Msg</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#bool"><span class="id" title="inductive">bool</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">post</span> : <a class="idref" href="ConCert.Execution.Blockchain.html#Environment"><span class="id" title="record">Environment</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#ContractCallContext"><span class="id" title="record">ContractCallContext</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="ConCert.Execution.Test.TraceGens.html#State"><span class="id" title="variable">State</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="ConCert.Execution.Test.TraceGens.html#Msg"><span class="id" title="variable">Msg</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#option"><span class="id" title="inductive">option</span></a> (<a class="idref" href="ConCert.Execution.Test.TraceGens.html#State"><span class="id" title="variable">State</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#11c698c8685bb8ab1cf725545c085ac4"><span class="id" title="notation">*</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#list"><span class="id" title="inductive">list</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#ActionBody"><span class="id" title="inductive">ActionBody</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="ConCert.Execution.Test.TraceGens.html#prop"><span class="id" title="variable">prop</span></a>) : <span class="id" title="definition">Checker</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">action_bodies</span> <span class="id" title="var">actions</span> := <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#map"><span class="id" title="definition">map</span></a> (<span class="id" title="keyword">fun</span> <span class="id" title="var">act</span> =&gt; <a class="idref" href="ConCert.Execution.Test.TraceGens.html#act"><span class="id" title="variable">act</span></a>.(<a class="idref" href="ConCert.Execution.Blockchain.html#act_body"><span class="id" title="projection">act_body</span></a>)) <a class="idref" href="ConCert.Execution.Test.TraceGens.html#actions"><span class="id" title="variable">actions</span></a> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">post_helper</span> <span class="id" title="var">env</span> <span class="id" title="var">cctx</span> <span class="id" title="var">post_cstate</span> <span class="id" title="var">new_acts</span> <span class="id" title="var">cstate</span> <span class="id" title="var">msg</span> : <span class="id" title="definition">Checker</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="definition">whenFail</span> ("On Msg: " <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Strings.String.html#169ad156fbc6036a53a0338819a2b301"><span class="id" title="notation">++</span></a> <span class="id" title="method">show</span> <a class="idref" href="ConCert.Execution.Test.TraceGens.html#msg"><span class="id" title="variable">msg</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="method">checker</span> (<a class="idref" href="ConCert.Execution.Test.TraceGens.html#post"><span class="id" title="variable">post</span></a> <a class="idref" href="ConCert.Execution.Test.TraceGens.html#env"><span class="id" title="variable">env</span></a> <a class="idref" href="ConCert.Execution.Test.TraceGens.html#cctx"><span class="id" title="variable">cctx</span></a> <a class="idref" href="ConCert.Execution.Test.TraceGens.html#cstate"><span class="id" title="variable">cstate</span></a> <a class="idref" href="ConCert.Execution.Test.TraceGens.html#msg"><span class="id" title="variable">msg</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Execution.Test.TraceGens.html#post_cstate"><span class="id" title="variable">post_cstate</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="ConCert.Execution.Test.TraceGens.html#action_bodies"><span class="id" title="variable">action_bodies</span></a> <a class="idref" href="ConCert.Execution.Test.TraceGens.html#new_acts"><span class="id" title="variable">new_acts</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a>))) <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">stepProp</span> (<span class="id" title="var">act</span> : <a class="idref" href="ConCert.Execution.Blockchain.html#Action"><span class="id" title="record">Action</span></a>) (<span class="id" title="var">new_acts</span> : <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#list"><span class="id" title="inductive">list</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#Action"><span class="id" title="record">Action</span></a>) (<span class="id" title="var">cs_from</span> : <a class="idref" href="ConCert.Execution.Blockchain.html#ChainState"><span class="id" title="record">ChainState</span></a>) (<span class="id" title="var">cs_to</span> : <a class="idref" href="ConCert.Execution.Blockchain.html#ChainState"><span class="id" title="record">ChainState</span></a>) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">env_from</span> : <a class="idref" href="ConCert.Execution.Blockchain.html#Environment"><span class="id" title="record">Environment</span></a> := <a class="idref" href="ConCert.Execution.Test.TraceGens.html#cs_from"><span class="id" title="variable">cs_from</span></a>.(<a class="idref" href="ConCert.Execution.Blockchain.html#chain_state_env"><span class="id" title="projection">chain_state_env</span></a>) <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">env_to</span> : <a class="idref" href="ConCert.Execution.Blockchain.html#Environment"><span class="id" title="record">Environment</span></a> := <a class="idref" href="ConCert.Execution.Test.TraceGens.html#cs_to"><span class="id" title="variable">cs_to</span></a>.(<a class="idref" href="ConCert.Execution.Blockchain.html#chain_state_env"><span class="id" title="projection">chain_state_env</span></a>) <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">amount</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="ConCert.Execution.Test.TraceGens.html#act"><span class="id" title="variable">act</span></a>.(<a class="idref" href="ConCert.Execution.Blockchain.html#act_body"><span class="id" title="projection">act_body</span></a>) <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="ConCert.Execution.Blockchain.html#act_call"><span class="id" title="constructor">act_call</span></a> <span class="id" title="var">_</span> <span class="id" title="var">amount</span> <span class="id" title="var">_</span> =&gt; <span class="id" title="var">amount</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">_</span> =&gt; 0%<span class="id" title="var">Z</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">new_balance</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">if</span> (<a class="idref" href="ConCert.Execution.Test.TraceGens.html#act"><span class="id" title="variable">act</span></a>.(<a class="idref" href="ConCert.Execution.Blockchain.html#act_from"><span class="id" title="projection">act_from</span></a>) <a class="idref" href="ConCert.Execution.Blockchain.html#6f617e0e5500b437e5aeb1eaa876d41f"><span class="id" title="notation">=?</span></a> <a class="idref" href="ConCert.Execution.Test.TraceGens.html#caddr"><span class="id" title="variable">caddr</span></a>)%<span class="id" title="var">address</span> <span class="id" title="keyword">then</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Test.TraceGens.html#env_from"><span class="id" title="variable">env_from</span></a>.(<a class="idref" href="ConCert.Execution.Blockchain.html#env_account_balances"><span class="id" title="projection">env_account_balances</span></a>) <a class="idref" href="ConCert.Execution.Test.TraceGens.html#caddr"><span class="id" title="variable">caddr</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">else</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="ConCert.Execution.Test.TraceGens.html#env_from"><span class="id" title="variable">env_from</span></a>.(<a class="idref" href="ConCert.Execution.Blockchain.html#env_account_balances"><span class="id" title="projection">env_account_balances</span></a>) <a class="idref" href="ConCert.Execution.Test.TraceGens.html#caddr"><span class="id" title="variable">caddr</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.ZArith.BinInt.html#46584eddd5fdb16176a10a2843177d3a"><span class="id" title="notation">+</span></a> <a class="idref" href="ConCert.Execution.Test.TraceGens.html#amount"><span class="id" title="variable">amount</span></a>)%<span class="id" title="var">Z</span> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">cctx</span> := <a class="idref" href="ConCert.Execution.Blockchain.html#build_ctx"><span class="id" title="constructor">build_ctx</span></a> <a class="idref" href="ConCert.Execution.Test.TraceGens.html#act"><span class="id" title="variable">act</span></a>.(<a class="idref" href="ConCert.Execution.Blockchain.html#act_origin"><span class="id" title="projection">act_origin</span></a>) <a class="idref" href="ConCert.Execution.Test.TraceGens.html#act"><span class="id" title="variable">act</span></a>.(<a class="idref" href="ConCert.Execution.Blockchain.html#act_from"><span class="id" title="projection">act_from</span></a>) <a class="idref" href="ConCert.Execution.Test.TraceGens.html#caddr"><span class="id" title="variable">caddr</span></a> <a class="idref" href="ConCert.Execution.Test.TraceGens.html#new_balance"><span class="id" title="variable">new_balance</span></a> <a class="idref" href="ConCert.Execution.Test.TraceGens.html#amount"><span class="id" title="variable">amount</span></a> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="ConCert.Execution.Test.TraceGens.html#act"><span class="id" title="variable">act</span></a>.(<a class="idref" href="ConCert.Execution.Blockchain.html#act_body"><span class="id" title="projection">act_body</span></a>) <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="ConCert.Execution.Blockchain.html#act_call"><span class="id" title="constructor">act_call</span></a> <span class="id" title="var">to</span> <span class="id" title="var">_</span> <span class="id" title="var">ser_msg</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">if</span> <a class="idref" href="ConCert.Execution.Blockchain.html#address_eqb"><span class="id" title="method">address_eqb</span></a> <span class="id" title="var">to</span> <a class="idref" href="ConCert.Execution.Test.TraceGens.html#caddr"><span class="id" title="variable">caddr</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">then</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> @<a class="idref" href="ConCert.Execution.Serializable.html#deserialize"><span class="id" title="method">deserialize</span></a> <a class="idref" href="ConCert.Execution.Test.TraceGens.html#Msg"><span class="id" title="variable">Msg</span></a> <span class="id" title="var">_</span> <span class="id" title="var">ser_msg</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <span class="id" title="var">msg</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="ConCert.Execution.Test.TestUtils.html#get_contract_state"><span class="id" title="definition">get_contract_state</span></a> <a class="idref" href="ConCert.Execution.Test.TraceGens.html#State"><span class="id" title="variable">State</span></a> <a class="idref" href="ConCert.Execution.Test.TraceGens.html#env_from"><span class="id" title="variable">env_from</span></a> <a class="idref" href="ConCert.Execution.Test.TraceGens.html#caddr"><span class="id" title="variable">caddr</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <span class="id" title="var">cstate_from</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">if</span> <a class="idref" href="ConCert.Execution.Test.TraceGens.html#pre"><span class="id" title="variable">pre</span></a> <span class="id" title="var">cstate_from</span> <span class="id" title="var">msg</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">then</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="ConCert.Execution.Test.TestUtils.html#get_contract_state"><span class="id" title="definition">get_contract_state</span></a> <a class="idref" href="ConCert.Execution.Test.TraceGens.html#State"><span class="id" title="variable">State</span></a> <a class="idref" href="ConCert.Execution.Test.TraceGens.html#env_to"><span class="id" title="variable">env_to</span></a> <a class="idref" href="ConCert.Execution.Test.TraceGens.html#caddr"><span class="id" title="variable">caddr</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <span class="id" title="var">cstate_to</span> =&gt; (<a class="idref" href="ConCert.Execution.Test.TraceGens.html#post_helper"><span class="id" title="variable">post_helper</span></a> <a class="idref" href="ConCert.Execution.Test.TraceGens.html#env_from"><span class="id" title="variable">env_from</span></a> <a class="idref" href="ConCert.Execution.Test.TraceGens.html#cctx"><span class="id" title="variable">cctx</span></a> <span class="id" title="var">cstate_to</span> <a class="idref" href="ConCert.Execution.Test.TraceGens.html#new_acts"><span class="id" title="variable">new_acts</span></a> <span class="id" title="var">cstate_from</span> <span class="id" title="var">msg</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a> =&gt; <span class="id" title="method">checker</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#true"><span class="id" title="constructor">true</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">else</span> <span class="id" title="method">checker</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#true"><span class="id" title="constructor">true</span></a> <span class="comment">(*&nbsp;TODO:&nbsp;should&nbsp;be&nbsp;discarded!*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a> =&gt; <span class="id" title="method">checker</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#true"><span class="id" title="constructor">true</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a> =&gt; <span class="id" title="method">checker</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#true"><span class="id" title="constructor">true</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">else</span> <span class="id" title="method">checker</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#true"><span class="id" title="constructor">true</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">_</span> =&gt; <span class="id" title="method">checker</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#true"><span class="id" title="constructor">true</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Test.TraceGens.html#forAllActionExecution"><span class="id" title="definition">forAllActionExecution</span></a> <a class="idref" href="ConCert.Execution.Test.TraceGens.html#maxLength"><span class="id" title="variable">maxLength</span></a> <a class="idref" href="ConCert.Execution.Test.TraceGens.html#init_chain"><span class="id" title="variable">init_chain</span></a> <a class="idref" href="ConCert.Execution.Test.TraceGens.html#gTrace"><span class="id" title="variable">gTrace</span></a> <a class="idref" href="ConCert.Execution.Test.TraceGens.html#stepProp"><span class="id" title="variable">stepProp</span></a>.<br/>

<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;For&nbsp;any&nbsp;ChainState&nbsp;in&nbsp;a&nbsp;ChainTrace&nbsp;if&nbsp;pf&nbsp;tests&nbsp;true&nbsp;on&nbsp;all&nbsp;previous&nbsp;ChainStates&nbsp;in&nbsp;the<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ChainTrace&nbsp;then&nbsp;implied_prop&nbsp;tests&nbsp;true,&nbsp;for&nbsp;all&nbsp;tested&nbsp;execution&nbsp;traces*)</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a name="forAllChainState_implication"><span class="id" title="definition">forAllChainState_implication</span></a> {<span class="id" title="var">prop</span> : <span class="id" title="keyword">Type</span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;`{<span class="id" title="class">Checkable</span> <a class="idref" href="ConCert.Execution.Test.TraceGens.html#prop"><span class="id" title="variable">prop</span></a>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">maxLength</span> : <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">init_lc</span> : <a class="idref" href="ConCert.Execution.Test.TestUtils.html#ChainBuilder"><span class="id" title="instance">ChainBuilder</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">gTrace</span> : <a class="idref" href="ConCert.Execution.Test.TestUtils.html#ChainBuilder"><span class="id" title="instance">ChainBuilder</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a> <span class="id" title="axiom">G</span> <a class="idref" href="ConCert.Execution.Test.TestUtils.html#ChainBuilder"><span class="id" title="instance">ChainBuilder</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">pf</span> : <a class="idref" href="ConCert.Execution.Blockchain.html#ChainState"><span class="id" title="record">ChainState</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#bool"><span class="id" title="inductive">bool</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">implied_prop</span> : <a class="idref" href="ConCert.Execution.Blockchain.html#ChainState"><span class="id" title="record">ChainState</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="ConCert.Execution.Test.TraceGens.html#prop"><span class="id" title="variable">prop</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;: <span class="id" title="definition">Checker</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">printOnFail</span> (<span class="id" title="var">cs</span> : <a class="idref" href="ConCert.Execution.Blockchain.html#ChainState"><span class="id" title="record">ChainState</span></a>) : <span class="id" title="definition">Checker</span> := <span class="id" title="definition">whenFail</span> (<span class="id" title="method">show</span> <a class="idref" href="ConCert.Execution.Test.TraceGens.html#cs"><span class="id" title="variable">cs</span></a>) (<span class="id" title="method">checker</span> (<a class="idref" href="ConCert.Execution.Test.TraceGens.html#implied_prop"><span class="id" title="variable">implied_prop</span></a> <a class="idref" href="ConCert.Execution.Test.TraceGens.html#cs"><span class="id" title="variable">cs</span></a>)) <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">map_implication</span> (<span class="id" title="var">states</span> : <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#list"><span class="id" title="inductive">list</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#ChainState"><span class="id" title="record">ChainState</span></a>) : <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#list"><span class="id" title="inductive">list</span></a> <span class="id" title="definition">Checker</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#snd"><span class="id" title="definition">snd</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#fold_left"><span class="id" title="definition">fold_left</span></a> (<span class="id" title="keyword">fun</span> '<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><span class="id" title="var">b</span><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <span class="id" title="var">checkers</span><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <span class="id" title="var">state</span> =&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Execution.Test.TraceGens.html#b"><span class="id" title="variable">b</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#9ddeac0ab66152bd1d64bedb507a795e"><span class="id" title="notation">&amp;&amp;</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#9ddeac0ab66152bd1d64bedb507a795e"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Execution.Test.TraceGens.html#pf"><span class="id" title="variable">pf</span></a> <a class="idref" href="ConCert.Execution.Test.TraceGens.html#state"><span class="id" title="variable">state</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#9ddeac0ab66152bd1d64bedb507a795e"><span class="id" title="notation">)</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#cbcf67aac0c2a85b8d93d37de9969adf"><span class="id" title="notation">(</span></a><span class="id" title="definition">implication</span> <a class="idref" href="ConCert.Execution.Test.TraceGens.html#b"><span class="id" title="variable">b</span></a> (<a class="idref" href="ConCert.Execution.Test.TraceGens.html#printOnFail"><span class="id" title="variable">printOnFail</span></a> <a class="idref" href="ConCert.Execution.Test.TraceGens.html#state"><span class="id" title="variable">state</span></a>)<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#cbcf67aac0c2a85b8d93d37de9969adf"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#cbcf67aac0c2a85b8d93d37de9969adf"><span class="id" title="notation">::</span></a> <a class="idref" href="ConCert.Execution.Test.TraceGens.html#checkers"><span class="id" title="variable">checkers</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a>) <a class="idref" href="ConCert.Execution.Test.TraceGens.html#states"><span class="id" title="variable">states</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#true"><span class="id" title="constructor">true</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#ae9a5e1034e143b218b09d8e454472bd"><span class="id" title="notation">[]</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a>) <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="definition">forAllShrink</span> (<a class="idref" href="ConCert.Execution.Test.TraceGens.html#gTrace"><span class="id" title="variable">gTrace</span></a> <a class="idref" href="ConCert.Execution.Test.TraceGens.html#init_lc"><span class="id" title="variable">init_lc</span></a> <a class="idref" href="ConCert.Execution.Test.TraceGens.html#maxLength"><span class="id" title="variable">maxLength</span></a>) <span class="id" title="method">shrink</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="keyword">fun</span> <span class="id" title="var">cb</span> =&gt; <span class="id" title="definition">conjoin</span> (<a class="idref" href="ConCert.Execution.Test.TraceGens.html#map_implication"><span class="id" title="variable">map_implication</span></a> (<a class="idref" href="ConCert.Execution.Test.TraceGens.html#trace_states"><span class="id" title="definition">trace_states</span></a> <a class="idref" href="ConCert.Execution.Test.TraceGens.html#cb"><span class="id" title="variable">cb</span></a>.(<a class="idref" href="ConCert.Execution.Blockchain.html#builder_trace"><span class="id" title="method">builder_trace</span></a>)))).<br/>

<br/>
<span class="id" title="keyword">End</span> <a class="idref" href="ConCert.Execution.Test.TraceGens.html#TraceGens"><span class="id" title="section">TraceGens</span></a>.<br/>
</div>
</div>
<div id="footer">
  Generated by <a href="https://coq.inria.fr/">coqdoc</a> and improved with <a href="https://github.com/tebbi/coqdocjs">CoqdocJS</a> and <a href="https://github.com/jgallen23/toc">TOC</a>
</div>
</div>
<script>
  const elements = document.getElementsByClassName("libtitle");
  while(elements.length > 0){
        elements[0].parentNode.removeChild(elements[0]);
  }
  if (window.location.pathname.endsWith("/toc.html")) {
      const jstocDiv = document.getElementById("js-toc");
      jstocDiv.classList.remove("toc");
      jstocDiv.classList.add("jstoc-hidden");
      const jstocHeaderDiv = document.getElementById("js-toc-header");
      jstocHeaderDiv.classList.add("jstoc-hidden");
  }
  console.log(window.location.pathname);
</script>
<script type="text/javascript" src="toc.js"></script>
</body>

</html>
