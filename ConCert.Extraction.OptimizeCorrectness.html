<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">

<head>
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
<link href="coqdoc.css" rel="stylesheet" type="text/css" />
<link href="coqdocjs.css" rel="stylesheet" type="text/css"/>
<link href="toc.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="config.js"></script>
<script type="text/javascript" src="coqdocjs.js"></script>
</head>

<body onload="document.getElementById('content').focus()">
  <div id="header">
    <span class="left">
      <span class="modulename"> <script> document.write(document.title) </script> </span>
    </span>

    <span class="button" id="toggle-proofs"></span>

    <span class="right">
      <a href="toc.html">Table of contents</a>
      <a href="https://github.com/AU-COBRA/ConCert" target="_balnk">Project Page</a>
    </span>
</div>
  <div id="content" tabindex="-1" onblur="document.getElementById('content').focus()">
    <div id="js-toc-header" class="toc-header">Contents:</div>
    <div id="js-toc" class="toc" data-toc="h1,h2,h3,h4" data-toc-container="doc">
    </div>
    <div id="main">
<h1 class="libtitle">Library ConCert.Extraction.OptimizeCorrectness</h1>

<div class="code">
<span class="id" title="keyword">From</span> <span class="id" title="var">ConCert.Utils</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="ConCert.Utils.Automation.html#"><span class="id" title="library">Automation</span></a>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">ConCert.Extraction</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="ConCert.Extraction.Utils.html#"><span class="id" title="library">Utils</span></a>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">ConCert.Extraction</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="ConCert.Extraction.ClosedAux.html#"><span class="id" title="library">ClosedAux</span></a>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">ConCert.Extraction</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="ConCert.Extraction.ExAst.html#"><span class="id" title="library">ExAst</span></a>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">ConCert.Extraction</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="ConCert.Extraction.Optimize.html#"><span class="id" title="library">Optimize</span></a>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">ConCert.Extraction</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="ConCert.Extraction.Transform.html#"><span class="id" title="library">Transform</span></a>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">ConCert.Extraction</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="ConCert.Extraction.WcbvEvalAux.html#"><span class="id" title="library">WcbvEvalAux</span></a>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">Coq</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.btauto.Btauto.html#"><span class="id" title="library">Btauto</span></a>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="keyword">Equations</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="library">Equations</span>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">MetaCoq.Erasure</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="library">EAstUtils</span>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">MetaCoq.Erasure</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="library">ECSubst</span>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">MetaCoq.Erasure</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="library">EInduction</span>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">MetaCoq.Erasure</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="library">ELiftSubst</span>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">MetaCoq.Erasure</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="library">EWcbvEval</span>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">MetaCoq.Erasure</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="library">ETyping</span>.<br/>

<br/>
<span class="id" title="keyword">Import</span> <span class="id" title="var">ExAst</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a name="lookup_env_trans_env"><span class="id" title="lemma">lookup_env_trans_env</span></a> <span class="id" title="var">Σ</span> <span class="id" title="var">kn</span> :<br/>
&nbsp;&nbsp;<span class="id" title="definition">ETyping.lookup_env</span> (<a class="idref" href="ConCert.Extraction.ExAst.html#trans_env"><span class="id" title="definition">trans_env</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#e15c0eb40e61adefe95778c26e7840f6"><span class="id" title="variable">Σ</span></a>) <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#kn"><span class="id" title="variable">kn</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#option_map"><span class="id" title="definition">option_map</span></a> <a class="idref" href="ConCert.Extraction.ExAst.html#trans_global_decl"><span class="id" title="definition">trans_global_decl</span></a> (<a class="idref" href="ConCert.Extraction.ExAst.html#lookup_env"><span class="id" title="definition">lookup_env</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#e15c0eb40e61adefe95778c26e7840f6"><span class="id" title="variable">Σ</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#kn"><span class="id" title="variable">kn</span></a>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="ConCert.Extraction.ExAst.html#lookup_env"><span class="id" title="definition">lookup_env</span></a>, <span class="id" title="definition">eq_kername</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">Σ</span> <span class="id" title="keyword">as</span> [|((<span class="id" title="var">kn'</span> &amp; <span class="id" title="var">has_deps'</span>) &amp; <span class="id" title="var">cst'</span>) <span class="id" title="var">Σ</span> <span class="id" title="var">IH</span>]; [<span class="id" title="var">easy</span>|].<br/>
&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">destruct</span> (<span class="id" title="definition">kername_eq_dec</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>) <span class="id" title="keyword">as</span> [-&gt;|].<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a name="declared_constant_trans_env"><span class="id" title="lemma">declared_constant_trans_env</span></a> <span class="id" title="var">Σ</span> <span class="id" title="var">kn</span> <span class="id" title="var">ecst</span> :<br/>
&nbsp;&nbsp;<span class="id" title="definition">declared_constant</span> (<a class="idref" href="ConCert.Extraction.ExAst.html#trans_env"><span class="id" title="definition">trans_env</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#e15c0eb40e61adefe95778c26e7840f6"><span class="id" title="variable">Σ</span></a>) <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#kn"><span class="id" title="variable">kn</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#ecst"><span class="id" title="variable">ecst</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#f031fe1957c4a4a8e217aa46af2b4e25"><span class="id" title="notation">(</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">exists</span></a> <span class="id" title="var">cst</span><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">,</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#ecst"><span class="id" title="variable">ecst</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="ConCert.Extraction.ExAst.html#trans_cst"><span class="id" title="definition">trans_cst</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#cst"><span class="id" title="variable">cst</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">/\</span></a> <a class="idref" href="ConCert.Extraction.ExAst.html#lookup_env"><span class="id" title="definition">lookup_env</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#e15c0eb40e61adefe95778c26e7840f6"><span class="id" title="variable">Σ</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#kn"><span class="id" title="variable">kn</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> (<a class="idref" href="ConCert.Extraction.ExAst.html#ConstantDecl"><span class="id" title="constructor">ConstantDecl</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#cst"><span class="id" title="variable">cst</span></a>)<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#f031fe1957c4a4a8e217aa46af2b4e25"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#f031fe1957c4a4a8e217aa46af2b4e25"><span class="id" title="notation">\/</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#f031fe1957c4a4a8e217aa46af2b4e25"><span class="id" title="notation">(</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">exists</span></a> <span class="id" title="var">ta</span><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">,</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#ecst"><span class="id" title="variable">ecst</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">{|</span></a> <span class="id" title="constructor">EAst.cst_body</span> <span class="id" title="constructor">:=</span> <span class="id" title="constructor">option_map</span> <span class="id" title="constructor">(</span><span class="id" title="constructor">fun</span> <span class="id" title="constructor">_</span> <span class="id" title="constructor">=&gt;</span> <span class="id" title="constructor">tBox</span><span class="id" title="constructor">)</span> <span class="id" title="constructor">ta</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">|}</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">/\</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Extraction.ExAst.html#lookup_env"><span class="id" title="definition">lookup_env</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#e15c0eb40e61adefe95778c26e7840f6"><span class="id" title="variable">Σ</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#kn"><span class="id" title="variable">kn</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> (<a class="idref" href="ConCert.Extraction.ExAst.html#TypeAliasDecl"><span class="id" title="constructor">TypeAliasDecl</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#ta"><span class="id" title="variable">ta</span></a>)<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#f031fe1957c4a4a8e217aa46af2b4e25"><span class="id" title="notation">)</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="definition">declared_constant</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#lookup_env_trans_env"><span class="id" title="lemma">lookup_env_trans_env</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">decl</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<a class="idref" href="ConCert.Extraction.ExAst.html#lookup_env"><span class="id" title="definition">lookup_env</span></a> <span class="id" title="var">Σ</span> <span class="id" title="var">kn</span>) <span class="id" title="keyword">as</span> [<span class="id" title="var">cst</span>|]; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *; [|<span class="id" title="tactic">congruence</span>].<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">cst</span>; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *; [|<span class="id" title="tactic">congruence</span>|]; <span class="id" title="var">noconf</span> <span class="id" title="var">decl</span>; <span class="id" title="tactic">eauto</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a name="dearg_lambdas_nil"><span class="id" title="lemma">dearg_lambdas_nil</span></a> <span class="id" title="var">t</span> :<br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Extraction.Optimize.html#dearg_lambdas"><span class="id" title="definition">dearg_lambdas</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#ae9a5e1034e143b218b09d8e454472bd"><span class="id" title="notation">[]</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#t"><span class="id" title="variable">t</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#t"><span class="id" title="variable">t</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">t</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="var">IHt2</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="comment">(*&nbsp;We&nbsp;use&nbsp;our&nbsp;own&nbsp;"properly&nbsp;ordered"&nbsp;contexts&nbsp;to&nbsp;represent&nbsp;the&nbsp;lambdas/lets<br/>
&nbsp;&nbsp;&nbsp;that&nbsp;we&nbsp;debox&nbsp;away.&nbsp;Unlike&nbsp;the&nbsp;rest&nbsp;of&nbsp;MetaCoq,&nbsp;these&nbsp;contexts&nbsp;actually<br/>
&nbsp;&nbsp;&nbsp;have&nbsp;the&nbsp;first&nbsp;declaration&nbsp;at&nbsp;the&nbsp;beginning.&nbsp;*)</span><br/>
<span class="id" title="keyword">Fixpoint</span> <a name="subst_context"><span class="id" title="definition">subst_context</span></a> (<span class="id" title="var">t</span> : <span class="id" title="inductive">term</span>) (<span class="id" title="var">k</span> : <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a>) (<span class="id" title="var">Γ</span> : <span class="id" title="definition">context</span>) : <span class="id" title="definition">context</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#1b004e48cd1f64e22d5c000cf0d7f047"><span class="id" title="variable">Γ</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#ae9a5e1034e143b218b09d8e454472bd"><span class="id" title="notation">[]</span></a> =&gt; <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#ae9a5e1034e143b218b09d8e454472bd"><span class="id" title="notation">[]</span></a><br/>
&nbsp;&nbsp;| <span class="id" title="var">cd</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#cbcf67aac0c2a85b8d93d37de9969adf"><span class="id" title="notation">::</span></a> <span class="id" title="var">Γ</span> =&gt; <span class="id" title="definition">map_decl</span> (<span class="id" title="definition">csubst</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#t"><span class="id" title="variable">t</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#k"><span class="id" title="variable">k</span></a>) <span class="id" title="var">cd</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#cbcf67aac0c2a85b8d93d37de9969adf"><span class="id" title="notation">::</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#subst_context"><span class="id" title="definition">subst_context</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#t"><span class="id" title="variable">t</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#S"><span class="id" title="constructor">S</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#k"><span class="id" title="variable">k</span></a>) <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#1b004e48cd1f64e22d5c000cf0d7f047"><span class="id" title="variable">Γ</span></a><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a name="mkLambda_or_LetIn"><span class="id" title="definition">mkLambda_or_LetIn</span></a> (<span class="id" title="var">cd</span> : <span class="id" title="record">context_decl</span>) (<span class="id" title="var">t</span> : <span class="id" title="inductive">term</span>) : <span class="id" title="inductive">term</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="projection">decl_body</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#cd"><span class="id" title="variable">cd</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a> =&gt; <span class="id" title="constructor">tLambda</span> (<span class="id" title="projection">decl_name</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#cd"><span class="id" title="variable">cd</span></a>) <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#t"><span class="id" title="variable">t</span></a><br/>
&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <span class="id" title="var">body</span> =&gt; <span class="id" title="constructor">tLetIn</span> (<span class="id" title="projection">decl_name</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#cd"><span class="id" title="variable">cd</span></a>) <span class="id" title="var">body</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#t"><span class="id" title="variable">t</span></a><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a name="it_mkLambda_or_LetIn"><span class="id" title="definition">it_mkLambda_or_LetIn</span></a> (<span class="id" title="var">Γ</span> : <span class="id" title="definition">context</span>) (<span class="id" title="var">u</span> : <span class="id" title="inductive">term</span>) : <span class="id" title="inductive">term</span> :=<br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#fold_right"><span class="id" title="definition">fold_right</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#mkLambda_or_LetIn"><span class="id" title="definition">mkLambda_or_LetIn</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#u"><span class="id" title="variable">u</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#1b004e48cd1f64e22d5c000cf0d7f047"><span class="id" title="variable">Γ</span></a>.<br/>

<br/>
<span class="id" title="keyword">Fixpoint</span> <a name="decompose_body_masked"><span class="id" title="definition">decompose_body_masked</span></a> (<span class="id" title="var">mask</span> : <a class="idref" href="ConCert.Extraction.Optimize.html#bitmask"><span class="id" title="definition">bitmask</span></a>) (<span class="id" title="var">t</span> : <span class="id" title="inductive">term</span>) : <span class="id" title="definition">context</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#11c698c8685bb8ab1cf725545c085ac4"><span class="id" title="notation">*</span></a> <span class="id" title="inductive">term</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#mask"><span class="id" title="variable">mask</span></a>, <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#t"><span class="id" title="variable">t</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| <span class="id" title="var">_</span>, <span class="id" title="constructor">tLetIn</span> <span class="id" title="var">na</span> <span class="id" title="var">val</span> <span class="id" title="var">body</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> (<span class="id" title="var">Γ</span>, <span class="id" title="var">t</span>) := <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#decompose_body_masked"><span class="id" title="definition">decompose_body_masked</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#mask"><span class="id" title="variable">mask</span></a> <span class="id" title="var">body</span> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><span class="id" title="definition">vdef</span> <span class="id" title="var">na</span> <span class="id" title="var">val</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#cbcf67aac0c2a85b8d93d37de9969adf"><span class="id" title="notation">::</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#1b004e48cd1f64e22d5c000cf0d7f047"><span class="id" title="variable">Γ</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#t"><span class="id" title="variable">t</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a><br/>
&nbsp;&nbsp;| <span class="id" title="var">b</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#cbcf67aac0c2a85b8d93d37de9969adf"><span class="id" title="notation">::</span></a> <span class="id" title="var">mask</span>, <span class="id" title="constructor">tLambda</span> <span class="id" title="var">na</span> <span class="id" title="var">body</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> (<span class="id" title="var">Γ</span>, <span class="id" title="var">t</span>) := <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#decompose_body_masked"><span class="id" title="definition">decompose_body_masked</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#mask"><span class="id" title="variable">mask</span></a> <span class="id" title="var">body</span> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><span class="id" title="definition">vass</span> <span class="id" title="var">na</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#cbcf67aac0c2a85b8d93d37de9969adf"><span class="id" title="notation">::</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#1b004e48cd1f64e22d5c000cf0d7f047"><span class="id" title="variable">Γ</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#t"><span class="id" title="variable">t</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a><br/>
&nbsp;&nbsp;| <span class="id" title="var">_</span>, <span class="id" title="var">_</span> =&gt; <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#ae9a5e1034e143b218b09d8e454472bd"><span class="id" title="notation">[]</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#t"><span class="id" title="variable">t</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a name="vasses"><span class="id" title="definition">vasses</span></a> (<span class="id" title="var">Γ</span> : <span class="id" title="definition">context</span>) : <span class="id" title="definition">context</span> :=<br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#filter"><span class="id" title="definition">filter</span></a> (<span class="id" title="keyword">fun</span> <span class="id" title="var">cd</span> =&gt; <span class="id" title="keyword">match</span> <span class="id" title="projection">decl_body</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#cd"><span class="id" title="variable">cd</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <span class="id" title="var">_</span> =&gt; <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#false"><span class="id" title="constructor">false</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a> =&gt; <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#true"><span class="id" title="constructor">true</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>) <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#1b004e48cd1f64e22d5c000cf0d7f047"><span class="id" title="variable">Γ</span></a>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a name="vasses_app"><span class="id" title="lemma">vasses_app</span></a> <span class="id" title="var">Γ</span> <span class="id" title="var">Γ'</span> :<br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#vasses"><span class="id" title="definition">vasses</span></a> (<a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#1b004e48cd1f64e22d5c000cf0d7f047"><span class="id" title="variable">Γ</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#bc347c51eaf667706ae54503b26d52c6"><span class="id" title="notation">++</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#530641ccab6ad93b36bab5ed00cbc670"><span class="id" title="variable">Γ'</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#vasses"><span class="id" title="definition">vasses</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#1b004e48cd1f64e22d5c000cf0d7f047"><span class="id" title="variable">Γ</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#bc347c51eaf667706ae54503b26d52c6"><span class="id" title="notation">++</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#vasses"><span class="id" title="definition">vasses</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#530641ccab6ad93b36bab5ed00cbc670"><span class="id" title="variable">Γ'</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#vasses"><span class="id" title="definition">vasses</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#filter_app"><span class="id" title="lemma">filter_app</span></a>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Ltac</span> <span class="id" title="var">refold</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="tactic">repeat</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| [<span class="id" title="var">H</span>: <span class="id" title="keyword">context</span>[<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#fold_right"><span class="id" title="definition">fold_right</span></a> <span class="id" title="var">_</span> ?<span class="id" title="var">t</span> ?<span class="id" title="var">Γ</span>] |- <span class="id" title="var">_</span>] =&gt; <span class="id" title="tactic">progress</span> (<span class="id" title="tactic">fold</span> (<a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#it_mkLambda_or_LetIn"><span class="id" title="definition">it_mkLambda_or_LetIn</span></a> <span class="id" title="var">Γ</span> <span class="id" title="var">t</span>) <span class="id" title="tactic">in</span> * )<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| [|- <span class="id" title="keyword">context</span>[<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#fold_right"><span class="id" title="definition">fold_right</span></a> <span class="id" title="var">_</span> ?<span class="id" title="var">t</span> ?<span class="id" title="var">Γ</span>]] =&gt; <span class="id" title="tactic">progress</span> (<span class="id" title="tactic">fold</span> (<a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#it_mkLambda_or_LetIn"><span class="id" title="definition">it_mkLambda_or_LetIn</span></a> <span class="id" title="var">Γ</span> <span class="id" title="var">t</span>) <span class="id" title="tactic">in</span> * )<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| [<span class="id" title="var">H</span>: <span class="id" title="keyword">context</span>[<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#filter"><span class="id" title="definition">filter</span></a> <span class="id" title="var">_</span> ?<span class="id" title="var">Γ</span>] |- <span class="id" title="var">_</span>] =&gt; <span class="id" title="tactic">progress</span> (<span class="id" title="tactic">fold</span> (<a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#vasses"><span class="id" title="definition">vasses</span></a> <span class="id" title="var">Γ</span>) <span class="id" title="tactic">in</span> * )<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| [|- <span class="id" title="keyword">context</span>[<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#filter"><span class="id" title="definition">filter</span></a> <span class="id" title="var">_</span> ?<span class="id" title="var">Γ</span>]] =&gt; <span class="id" title="tactic">progress</span> (<span class="id" title="tactic">fold</span> (<a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#vasses"><span class="id" title="definition">vasses</span></a> <span class="id" title="var">Γ</span>) <span class="id" title="tactic">in</span> * )<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a name="decompose_body_masked_spec"><span class="id" title="lemma">decompose_body_masked_spec</span></a> <span class="id" title="var">mask</span> <span class="id" title="var">Γ</span> <span class="id" title="var">t</span> <span class="id" title="var">t'</span> :<br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Extraction.Optimize.html#valid_dearg_mask"><span class="id" title="definition">valid_dearg_mask</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#mask"><span class="id" title="variable">mask</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#t"><span class="id" title="variable">t</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#1b004e48cd1f64e22d5c000cf0d7f047"><span class="id" title="variable">Γ</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#t'"><span class="id" title="variable">t'</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#decompose_body_masked"><span class="id" title="definition">decompose_body_masked</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#mask"><span class="id" title="variable">mask</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#t"><span class="id" title="variable">t</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<span class="id" title="notation">#|</span><a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#vasses"><span class="id" title="definition">vasses</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#1b004e48cd1f64e22d5c000cf0d7f047"><span class="id" title="variable">Γ</span></a><span class="id" title="notation">|</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <span class="id" title="notation">#|</span><a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#mask"><span class="id" title="variable">mask</span></a><span class="id" title="notation">|</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">/\</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#it_mkLambda_or_LetIn"><span class="id" title="definition">it_mkLambda_or_LetIn</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#1b004e48cd1f64e22d5c000cf0d7f047"><span class="id" title="variable">Γ</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#t'"><span class="id" title="variable">t'</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#t"><span class="id" title="variable">t</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">revert</span> <span class="id" title="var">Γ</span> <span class="id" title="var">t'</span> <span class="id" title="var">mask</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">t</span> <span class="id" title="keyword">using</span> <span class="id" title="lemma">term_forall_list_ind</span>; <span class="id" title="tactic">intros</span> <span class="id" title="var">Γ</span> <span class="id" title="var">t'</span> <span class="id" title="var">mask</span> <span class="id" title="var">valid_mask</span> <span class="id" title="var">eq</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">all</span>: <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;<span class="id" title="var">all</span>: <span class="id" title="tactic">try</span> <span class="id" title="tactic">solve</span> [<span class="id" title="tactic">destruct</span> <span class="id" title="var">mask</span>; [|<span class="id" title="var">easy</span>]; <span class="id" title="tactic">inversion</span> <span class="id" title="var">eq</span>; <span class="id" title="var">easy</span>].<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">destruct</span> <span class="id" title="var">mask</span> <span class="id" title="keyword">as</span> [|<span class="id" title="var">b</span> <span class="id" title="var">mask</span>]; <span class="id" title="tactic">inversion</span> <span class="id" title="var">eq</span>; <span class="id" title="tactic">subst</span>; <span class="id" title="tactic">clear</span> <span class="id" title="var">eq</span>; [<span class="id" title="var">easy</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#decompose_body_masked"><span class="id" title="definition">decompose_body_masked</span></a> <span class="id" title="var">mask</span> <span class="id" title="var">t</span>) <span class="id" title="keyword">as</span> (<span class="id" title="var">Γ'</span> &amp; <span class="id" title="var">t''</span>) <span class="id" title="var">eqn</span>:<span class="id" title="var">decomp_eq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">inversion</span> <span class="id" title="var">H0</span>; <span class="id" title="tactic">subst</span>; <span class="id" title="tactic">clear</span> <span class="id" title="var">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">symmetry</span> <span class="id" title="tactic">in</span> <span class="id" title="var">decomp_eq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">refold</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">propify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">destruct</span> (<span class="id" title="var">IHt</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> (<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#proj2"><span class="id" title="lemma">proj2</span></a> <span class="id" title="var">valid_mask</span>) <span class="id" title="var">decomp_eq</span>) <span class="id" title="keyword">as</span> (-&gt; &amp; -&gt;).<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">destruct</span> (<a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#decompose_body_masked"><span class="id" title="definition">decompose_body_masked</span></a> <span class="id" title="var">mask</span> <span class="id" title="var">t2</span>) <span class="id" title="var">eqn</span>:<span class="id" title="var">decomp_eq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">symmetry</span> <span class="id" title="tactic">in</span> <span class="id" title="var">decomp_eq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<span class="id" title="var">IHt2</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">valid_mask</span> <span class="id" title="var">decomp_eq</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">destruct</span> <span class="id" title="var">mask</span>; <span class="id" title="tactic">inversion</span> <span class="id" title="var">eq</span>; <span class="id" title="tactic">subst</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a name="valid_dearg_mask_spec"><span class="id" title="lemma">valid_dearg_mask_spec</span></a> <span class="id" title="var">mask</span> <span class="id" title="var">t</span> :<br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Extraction.Optimize.html#valid_dearg_mask"><span class="id" title="definition">valid_dearg_mask</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#mask"><span class="id" title="variable">mask</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#t"><span class="id" title="variable">t</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<span class="id" title="notation">∑</span> <span class="id" title="var">Γ</span> <span class="id" title="var">inner</span><span class="id" title="notation">,</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">#|</span><a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#vasses"><span class="id" title="definition">vasses</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#1b004e48cd1f64e22d5c000cf0d7f047"><span class="id" title="variable">Γ</span></a><span class="id" title="notation">|</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <span class="id" title="notation">#|</span><a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#mask"><span class="id" title="variable">mask</span></a><span class="id" title="notation">|</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">/\</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#it_mkLambda_or_LetIn"><span class="id" title="definition">it_mkLambda_or_LetIn</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#1b004e48cd1f64e22d5c000cf0d7f047"><span class="id" title="variable">Γ</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#inner"><span class="id" title="variable">inner</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#t"><span class="id" title="variable">t</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">is_valid</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#decompose_body_masked"><span class="id" title="definition">decompose_body_masked</span></a> <span class="id" title="var">mask</span> <span class="id" title="var">t</span>) <span class="id" title="keyword">as</span> (<span class="id" title="var">Γ</span> &amp; <span class="id" title="var">inner</span>) <span class="id" title="var">eqn</span>:<span class="id" title="var">decomp</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">exists</span> <span class="id" title="var">Γ</span>, <span class="id" title="var">inner</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#decompose_body_masked_spec"><span class="id" title="lemma">decompose_body_masked_spec</span></a>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a name="subst_it_mkLambda_or_LetIn"><span class="id" title="lemma">subst_it_mkLambda_or_LetIn</span></a> <span class="id" title="var">t</span> <span class="id" title="var">k</span> <span class="id" title="var">Γ</span> <span class="id" title="var">u</span> :<br/>
&nbsp;&nbsp;<span class="id" title="definition">csubst</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#t"><span class="id" title="variable">t</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#k"><span class="id" title="variable">k</span></a> (<a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#it_mkLambda_or_LetIn"><span class="id" title="definition">it_mkLambda_or_LetIn</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#1b004e48cd1f64e22d5c000cf0d7f047"><span class="id" title="variable">Γ</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#u"><span class="id" title="variable">u</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#it_mkLambda_or_LetIn"><span class="id" title="definition">it_mkLambda_or_LetIn</span></a> (<a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#subst_context"><span class="id" title="definition">subst_context</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#t"><span class="id" title="variable">t</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#k"><span class="id" title="variable">k</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#1b004e48cd1f64e22d5c000cf0d7f047"><span class="id" title="variable">Γ</span></a>) (<span class="id" title="definition">csubst</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#t"><span class="id" title="variable">t</span></a> (<a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#k"><span class="id" title="variable">k</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Peano.html#0dacc1786c5ba797d47dd85006231633"><span class="id" title="notation">+</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#length"><span class="id" title="abbreviation">length</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#1b004e48cd1f64e22d5c000cf0d7f047"><span class="id" title="variable">Γ</span></a>) <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#u"><span class="id" title="variable">u</span></a>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">revert</span> <span class="id" title="var">t</span> <span class="id" title="var">k</span> <span class="id" title="var">u</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">Γ</span> <span class="id" title="keyword">as</span> [|<span class="id" title="var">cd</span> <span class="id" title="var">Γ</span> <span class="id" title="var">IH</span>]; <span class="id" title="tactic">intros</span> <span class="id" title="var">t</span> <span class="id" title="var">k</span> <span class="id" title="var">u</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">f_equal</span>; <span class="id" title="var">lia</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *; <span class="id" title="var">refold</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">cd</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">na</span> [<span class="id" title="var">val</span>|]];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *; <span class="id" title="var">refold</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">repeat</span> (<span class="id" title="tactic">f_equal</span>; <span class="id" title="tactic">rewrite</span> ?<span class="id" title="var">IH</span>; <span class="id" title="tactic">try</span> <span class="id" title="var">lia</span>).<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a name="length_subst_context"><span class="id" title="lemma">length_subst_context</span></a> <span class="id" title="var">t</span> <span class="id" title="var">k</span> <span class="id" title="var">Γ</span> :<br/>
&nbsp;&nbsp;<span class="id" title="notation">#|</span><a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#subst_context"><span class="id" title="definition">subst_context</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#t"><span class="id" title="variable">t</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#k"><span class="id" title="variable">k</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#1b004e48cd1f64e22d5c000cf0d7f047"><span class="id" title="variable">Γ</span></a><span class="id" title="notation">|</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <span class="id" title="notation">#|</span><a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#1b004e48cd1f64e22d5c000cf0d7f047"><span class="id" title="variable">Γ</span></a><span class="id" title="notation">|</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">revert</span> <span class="id" title="var">t</span> <span class="id" title="var">k</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">Γ</span>; [<span class="id" title="var">easy</span>|]; <span class="id" title="tactic">intros</span> <span class="id" title="var">t</span> <span class="id" title="var">k</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="var">IHΓ</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a name="is_dead_closed"><span class="id" title="lemma">is_dead_closed</span></a> <span class="id" title="var">k</span> <span class="id" title="var">t</span> <span class="id" title="var">n</span> :<br/>
&nbsp;&nbsp;<span class="id" title="definition">closedn</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#k"><span class="id" title="variable">k</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#t"><span class="id" title="variable">t</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#k"><span class="id" title="variable">k</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Peano.html#cb53cf0ee22c036a03b4a9281c68b5a3"><span class="id" title="notation">&lt;=</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#n"><span class="id" title="variable">n</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Extraction.Optimize.html#is_dead"><span class="id" title="definition">is_dead</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#n"><span class="id" title="variable">n</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#t"><span class="id" title="variable">t</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">revert</span> <span class="id" title="var">k</span> <span class="id" title="var">n</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">t</span> <span class="id" title="keyword">using</span> <span class="id" title="lemma">term_forall_list_ind</span>; <span class="id" title="tactic">intros</span> <span class="id" title="var">k</span> <span class="id" title="var">n'</span> <span class="id" title="var">clos</span> <span class="id" title="var">klen</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">propify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Arith.PeanoNat.html#Nat.eqb_spec"><span class="id" title="lemma">Nat.eqb_spec</span></a> <span class="id" title="var">n</span> <span class="id" title="var">n'</span>); <span class="id" title="var">lia</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">induction</span> <span class="id" title="var">X</span>; [<span class="id" title="var">easy</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">propify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">easy</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">easy</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">propify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">easy</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">propify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">easy</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">propify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">X</span>; [<span class="id" title="var">easy</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">x</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">propify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">easy</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">easy</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">revert</span> <span class="id" title="var">k</span> <span class="id" title="var">n'</span> <span class="id" title="var">clos</span> <span class="id" title="var">klen</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">X</span>; [<span class="id" title="var">easy</span>|]; <span class="id" title="tactic">intros</span> <span class="id" title="var">k</span> <span class="id" title="var">n'</span> <span class="id" title="var">clos</span> <span class="id" title="var">klen</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">x</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">propify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>; [<span class="id" title="var">easy</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Arith.PeanoNat.html#Nat.add_succ_r"><span class="id" title="lemma">Nat.add_succ_r</span></a> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">eapply</span> <span class="id" title="var">IHX</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">revert</span> <span class="id" title="var">k</span> <span class="id" title="var">n'</span> <span class="id" title="var">clos</span> <span class="id" title="var">klen</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">X</span>; [<span class="id" title="var">easy</span>|]; <span class="id" title="tactic">intros</span> <span class="id" title="var">k</span> <span class="id" title="var">n'</span> <span class="id" title="var">clos</span> <span class="id" title="var">klen</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">x</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">propify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>; [<span class="id" title="var">easy</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Arith.PeanoNat.html#Nat.add_succ_r"><span class="id" title="lemma">Nat.add_succ_r</span></a> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">eapply</span> <span class="id" title="var">IHX</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a name="is_dead_csubst"><span class="id" title="lemma">is_dead_csubst</span></a> <span class="id" title="var">k</span> <span class="id" title="var">t</span> <span class="id" title="var">u</span> <span class="id" title="var">k'</span> :<br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Extraction.Optimize.html#is_dead"><span class="id" title="definition">is_dead</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#k"><span class="id" title="variable">k</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#t"><span class="id" title="variable">t</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<span class="id" title="definition">closedn</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#k"><span class="id" title="variable">k</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#u"><span class="id" title="variable">u</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#k"><span class="id" title="variable">k</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Peano.html#00fe0eaf5e6949f0a31725357afa4bba"><span class="id" title="notation">&lt;</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#k'"><span class="id" title="variable">k'</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Extraction.Optimize.html#is_dead"><span class="id" title="definition">is_dead</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#k"><span class="id" title="variable">k</span></a> (<span class="id" title="definition">csubst</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#u"><span class="id" title="variable">u</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#k'"><span class="id" title="variable">k'</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#t"><span class="id" title="variable">t</span></a>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">revert</span> <span class="id" title="var">k</span> <span class="id" title="var">u</span> <span class="id" title="var">k'</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">t</span> <span class="id" title="keyword">using</span> <span class="id" title="lemma">term_forall_list_ind</span>; <span class="id" title="tactic">intros</span> <span class="id" title="var">k</span> <span class="id" title="var">u</span> <span class="id" title="var">k'</span> <span class="id" title="var">use_eq</span> <span class="id" title="var">clos</span> <span class="id" title="var">kltn</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *; <span class="id" title="var">propify</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">destruct</span> (<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Arith.PeanoNat.html#Nat.compare_spec"><span class="id" title="lemma">Nat.compare_spec</span></a> <span class="id" title="var">k'</span> <span class="id" title="var">n</span>) <span class="id" title="keyword">as</span> [-&gt;| |].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#is_dead_closed"><span class="id" title="lemma">is_dead_closed</span></a> <span class="id" title="keyword">with</span> <span class="id" title="var">k</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">propify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">propify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">lia</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">induction</span> <span class="id" title="var">X</span>; [<span class="id" title="var">easy</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">propify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">easy</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <span class="id" title="var">IHt</span>; [<span class="id" title="var">easy</span>| |<span class="id" title="var">easy</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">eapply</span> <span class="id" title="lemma">closed_upwards</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">split</span>; [<span class="id" title="var">easy</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">IHt2</span>; [<span class="id" title="var">easy</span>| |<span class="id" title="var">easy</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">eapply</span> <span class="id" title="lemma">closed_upwards</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">split</span>; [<span class="id" title="var">easy</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">IHt2</span>; [<span class="id" title="var">easy</span>| |<span class="id" title="var">easy</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">eapply</span> <span class="id" title="lemma">closed_upwards</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">induction</span> <span class="id" title="var">X</span>; [<span class="id" title="var">easy</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">x</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">propify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">easy</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#map_length"><span class="id" title="lemma">map_length</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">revert</span> <span class="id" title="var">k</span> <span class="id" title="var">k'</span> <span class="id" title="var">kltn</span> <span class="id" title="var">use_eq</span> <span class="id" title="var">clos</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">X</span>; [<span class="id" title="var">easy</span>|]; <span class="id" title="tactic">intros</span> <span class="id" title="var">k</span> <span class="id" title="var">k'</span> <span class="id" title="var">kltn</span> <span class="id" title="var">use_eq</span> <span class="id" title="var">clos</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">x</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">propify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">apply</span> <span class="id" title="var">p</span>; [<span class="id" title="var">easy</span>| |<span class="id" title="var">easy</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">eapply</span> <span class="id" title="lemma">closed_upwards</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">rewrite</span> &lt;- !<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Arith.PeanoNat.html#Nat.add_succ_r"><span class="id" title="lemma">Nat.add_succ_r</span></a> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">IHX</span>; [<span class="id" title="var">easy</span>|<span class="id" title="var">easy</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">eapply</span> <span class="id" title="lemma">closed_upwards</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#map_length"><span class="id" title="lemma">map_length</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">revert</span> <span class="id" title="var">k</span> <span class="id" title="var">k'</span> <span class="id" title="var">kltn</span> <span class="id" title="var">use_eq</span> <span class="id" title="var">clos</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">X</span>; [<span class="id" title="var">easy</span>|]; <span class="id" title="tactic">intros</span> <span class="id" title="var">k</span> <span class="id" title="var">k'</span> <span class="id" title="var">kltn</span> <span class="id" title="var">use_eq</span> <span class="id" title="var">clos</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">x</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">propify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">apply</span> <span class="id" title="var">p</span>; [<span class="id" title="var">easy</span>| |<span class="id" title="var">easy</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">eapply</span> <span class="id" title="lemma">closed_upwards</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">rewrite</span> &lt;- !<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Arith.PeanoNat.html#Nat.add_succ_r"><span class="id" title="lemma">Nat.add_succ_r</span></a> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">IHX</span>; [<span class="id" title="var">easy</span>|<span class="id" title="var">easy</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">eapply</span> <span class="id" title="lemma">closed_upwards</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a name="valid_dearg_mask_nil"><span class="id" title="lemma">valid_dearg_mask_nil</span></a> <span class="id" title="var">t</span> : <a class="idref" href="ConCert.Extraction.Optimize.html#valid_dearg_mask"><span class="id" title="definition">valid_dearg_mask</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#ae9a5e1034e143b218b09d8e454472bd"><span class="id" title="notation">[]</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#t"><span class="id" title="variable">t</span></a>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">induction</span> <span class="id" title="var">t</span>; <span class="id" title="var">easy</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a name="valid_dearg_mask_csubst"><span class="id" title="lemma">valid_dearg_mask_csubst</span></a> <span class="id" title="var">mask</span> <span class="id" title="var">t</span> <span class="id" title="var">u</span> <span class="id" title="var">k</span> :<br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Extraction.Optimize.html#valid_dearg_mask"><span class="id" title="definition">valid_dearg_mask</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#mask"><span class="id" title="variable">mask</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#t"><span class="id" title="variable">t</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<span class="id" title="abbreviation">closed</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#u"><span class="id" title="variable">u</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Extraction.Optimize.html#valid_dearg_mask"><span class="id" title="definition">valid_dearg_mask</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#mask"><span class="id" title="variable">mask</span></a> (<span class="id" title="definition">csubst</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#u"><span class="id" title="variable">u</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#k"><span class="id" title="variable">k</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#t"><span class="id" title="variable">t</span></a>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">revert</span> <span class="id" title="var">mask</span> <span class="id" title="var">u</span> <span class="id" title="var">k</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">t</span> <span class="id" title="keyword">using</span> <span class="id" title="lemma">term_forall_list_ind</span>; <span class="id" title="tactic">intros</span> <span class="id" title="var">mask</span> <span class="id" title="var">u</span> <span class="id" title="var">k</span> <span class="id" title="var">valid_mask</span> <span class="id" title="var">clos</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">try</span> <span class="id" title="tactic">solve</span> [<span class="id" title="var">now</span> <span class="id" title="tactic">destruct</span> <span class="id" title="var">mask</span>].<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">destruct</span> <span class="id" title="var">mask</span>; [|<span class="id" title="var">easy</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#valid_dearg_mask_nil"><span class="id" title="lemma">valid_dearg_mask_nil</span></a>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">destruct</span> <span class="id" title="var">mask</span>; [<span class="id" title="var">easy</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">propify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">destruct</span> <span class="id" title="var">b</span>; [|<span class="id" title="var">easy</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">propify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> (<a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#is_dead_csubst"><span class="id" title="lemma">is_dead_csubst</span></a> 0).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <span class="id" title="var">IHt</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a name="vasses_subst_context"><span class="id" title="lemma">vasses_subst_context</span></a> <span class="id" title="var">t</span> <span class="id" title="var">k</span> <span class="id" title="var">Γ</span> :<br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#vasses"><span class="id" title="definition">vasses</span></a> (<a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#subst_context"><span class="id" title="definition">subst_context</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#t"><span class="id" title="variable">t</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#k"><span class="id" title="variable">k</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#1b004e48cd1f64e22d5c000cf0d7f047"><span class="id" title="variable">Γ</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#vasses"><span class="id" title="definition">vasses</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#1b004e48cd1f64e22d5c000cf0d7f047"><span class="id" title="variable">Γ</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">revert</span> <span class="id" title="var">t</span> <span class="id" title="var">k</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">Γ</span> <span class="id" title="keyword">as</span> [|<span class="id" title="var">cd</span> <span class="id" title="var">Γ</span> <span class="id" title="var">IH</span>]; [<span class="id" title="var">easy</span>|]; <span class="id" title="tactic">intros</span> <span class="id" title="var">t</span> <span class="id" title="var">k</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="definition">map_decl</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">cd</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">decl_body</span>; <span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">easy</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">easy</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a name="dearg_lambdas_subst"><span class="id" title="lemma">dearg_lambdas_subst</span></a> <span class="id" title="var">mask</span> <span class="id" title="var">s</span> <span class="id" title="var">k</span> <span class="id" title="var">Γ</span> <span class="id" title="var">inner</span> :<br/>
&nbsp;&nbsp;<span class="id" title="notation">#|</span><a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#vasses"><span class="id" title="definition">vasses</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#1b004e48cd1f64e22d5c000cf0d7f047"><span class="id" title="variable">Γ</span></a><span class="id" title="notation">|</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <span class="id" title="notation">#|</span><a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#mask"><span class="id" title="variable">mask</span></a><span class="id" title="notation">|</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Extraction.Optimize.html#dearg_lambdas"><span class="id" title="definition">dearg_lambdas</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#mask"><span class="id" title="variable">mask</span></a> (<span class="id" title="definition">subst</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#ddd65c2f7ee73ecec433744948d846bb"><span class="id" title="notation">[</span></a><a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#s"><span class="id" title="variable">s</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#ddd65c2f7ee73ecec433744948d846bb"><span class="id" title="notation">]</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#k"><span class="id" title="variable">k</span></a> (<a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#it_mkLambda_or_LetIn"><span class="id" title="definition">it_mkLambda_or_LetIn</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#1b004e48cd1f64e22d5c000cf0d7f047"><span class="id" title="variable">Γ</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#inner"><span class="id" title="variable">inner</span></a>)) <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a><br/>
&nbsp;&nbsp;<span class="id" title="definition">subst</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#ddd65c2f7ee73ecec433744948d846bb"><span class="id" title="notation">[</span></a><a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#s"><span class="id" title="variable">s</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#ddd65c2f7ee73ecec433744948d846bb"><span class="id" title="notation">]</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#k"><span class="id" title="variable">k</span></a> (<a class="idref" href="ConCert.Extraction.Optimize.html#dearg_lambdas"><span class="id" title="definition">dearg_lambdas</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#mask"><span class="id" title="variable">mask</span></a> (<a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#it_mkLambda_or_LetIn"><span class="id" title="definition">it_mkLambda_or_LetIn</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#1b004e48cd1f64e22d5c000cf0d7f047"><span class="id" title="variable">Γ</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#inner"><span class="id" title="variable">inner</span></a>)).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">revert</span> <span class="id" title="var">mask</span> <span class="id" title="var">s</span> <span class="id" title="var">k</span> <span class="id" title="var">inner</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">Γ</span> <span class="id" title="keyword">as</span> [|<span class="id" title="var">cd</span> <span class="id" title="var">Γ</span> <span class="id" title="var">IH</span>]; <span class="id" title="tactic">intros</span> <span class="id" title="var">mask</span> <span class="id" title="var">s</span> <span class="id" title="var">k</span> <span class="id" title="var">inner</span> <span class="id" title="var">len_eq</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">destruct</span> <span class="id" title="var">mask</span>; [|<span class="id" title="var">easy</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> !<a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#dearg_lambdas_nil"><span class="id" title="lemma">dearg_lambdas_nil</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">destruct</span> <span class="id" title="var">cd</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">na</span> [<span class="id" title="var">body</span>|]];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *; <span class="id" title="var">refold</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="var">IH</span> <span class="id" title="tactic">by</span> <span class="id" title="var">easy</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">destruct</span> <span class="id" title="var">mask</span> <span class="id" title="keyword">as</span> [|[] <span class="id" title="var">mask</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="var">easy</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="tactic">rewrite</span> <span class="id" title="var">IH</span> <span class="id" title="tactic">by</span> <span class="id" title="var">easy</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="definition">subst1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> !<span class="id" title="lemma">distr_subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="var">IH</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a name="dearg_single_masked"><span class="id" title="lemma">dearg_single_masked</span></a> <span class="id" title="var">mask</span> <span class="id" title="var">t</span> <span class="id" title="var">args</span> :<br/>
&nbsp;&nbsp;<span class="id" title="notation">#|</span><a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#mask"><span class="id" title="variable">mask</span></a><span class="id" title="notation">|</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Peano.html#cb53cf0ee22c036a03b4a9281c68b5a3"><span class="id" title="notation">&lt;=</span></a> <span class="id" title="notation">#|</span><a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#args"><span class="id" title="variable">args</span></a><span class="id" title="notation">|</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Extraction.Optimize.html#dearg_single"><span class="id" title="definition">dearg_single</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#mask"><span class="id" title="variable">mask</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#t"><span class="id" title="variable">t</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#args"><span class="id" title="variable">args</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <span class="id" title="definition">mkApps</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#t"><span class="id" title="variable">t</span></a> (<a class="idref" href="ConCert.Extraction.Optimize.html#masked"><span class="id" title="definition">masked</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#mask"><span class="id" title="variable">mask</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#args"><span class="id" title="variable">args</span></a>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">le</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">mask</span> <span class="id" title="tactic">in</span> <span class="id" title="var">mask</span>, <span class="id" title="var">t</span>, <span class="id" title="var">args</span>, <span class="id" title="var">le</span> |- *.<br/>
&nbsp;&nbsp;- <span class="id" title="var">now</span> <span class="id" title="tactic">destruct</span> <span class="id" title="var">args</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">destruct</span> <span class="id" title="var">args</span>; [<span class="id" title="var">easy</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">destruct</span> <span class="id" title="var">a</span>; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *; <span class="id" title="tactic">apply</span> <span class="id" title="var">IHmask</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a name="eval_dearg_lambdas_inv"><span class="id" title="lemma">eval_dearg_lambdas_inv</span></a> {<span class="id" title="var">wfl</span>:<span class="id" title="class">WcbvFlags</span>} <span class="id" title="var">Σ</span> <span class="id" title="var">mask</span> <span class="id" title="var">Γ</span> <span class="id" title="var">inner</span> <span class="id" title="var">v</span> :<br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Extraction.ClosedAux.html#env_closed"><span class="id" title="definition">env_closed</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#e15c0eb40e61adefe95778c26e7840f6"><span class="id" title="variable">Σ</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<span class="id" title="abbreviation">closed</span> (<a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#it_mkLambda_or_LetIn"><span class="id" title="definition">it_mkLambda_or_LetIn</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#1b004e48cd1f64e22d5c000cf0d7f047"><span class="id" title="variable">Γ</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#inner"><span class="id" title="variable">inner</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<span class="id" title="notation">#|</span><a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#mask"><span class="id" title="variable">mask</span></a><span class="id" title="notation">|</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <span class="id" title="notation">#|</span><a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#vasses"><span class="id" title="definition">vasses</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#1b004e48cd1f64e22d5c000cf0d7f047"><span class="id" title="variable">Γ</span></a><span class="id" title="notation">|</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#e15c0eb40e61adefe95778c26e7840f6"><span class="id" title="variable">Σ</span></a> <a class="idref" href="ConCert.Extraction.WcbvEvalAux.html#e49f44d96100960446bedaca1e4a4428"><span class="id" title="notation">e</span></a><a class="idref" href="ConCert.Extraction.WcbvEvalAux.html#e49f44d96100960446bedaca1e4a4428"><span class="id" title="notation">⊢</span></a> <a class="idref" href="ConCert.Extraction.Optimize.html#dearg_lambdas"><span class="id" title="definition">dearg_lambdas</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#mask"><span class="id" title="variable">mask</span></a> (<a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#it_mkLambda_or_LetIn"><span class="id" title="definition">it_mkLambda_or_LetIn</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#1b004e48cd1f64e22d5c000cf0d7f047"><span class="id" title="variable">Γ</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#inner"><span class="id" title="variable">inner</span></a>) <a class="idref" href="ConCert.Extraction.WcbvEvalAux.html#e49f44d96100960446bedaca1e4a4428"><span class="id" title="notation">▷</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#v"><span class="id" title="variable">v</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<span class="id" title="notation">∑</span> <span class="id" title="var">tv</span><span class="id" title="notation">,</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#e15c0eb40e61adefe95778c26e7840f6"><span class="id" title="variable">Σ</span></a> <a class="idref" href="ConCert.Extraction.WcbvEvalAux.html#e49f44d96100960446bedaca1e4a4428"><span class="id" title="notation">e</span></a><a class="idref" href="ConCert.Extraction.WcbvEvalAux.html#e49f44d96100960446bedaca1e4a4428"><span class="id" title="notation">⊢</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#it_mkLambda_or_LetIn"><span class="id" title="definition">it_mkLambda_or_LetIn</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#1b004e48cd1f64e22d5c000cf0d7f047"><span class="id" title="variable">Γ</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#inner"><span class="id" title="variable">inner</span></a> <a class="idref" href="ConCert.Extraction.WcbvEvalAux.html#e49f44d96100960446bedaca1e4a4428"><span class="id" title="notation">▷</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#tv"><span class="id" title="variable">tv</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">env_clos</span> <span class="id" title="var">clos</span> <span class="id" title="var">len_eq</span> <span class="id" title="var">ev</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="notation">#|</span><span class="id" title="var">Γ</span><span class="id" title="notation">|</span> <span class="id" title="keyword">as</span> [|<span class="id" title="var">Γlen</span> <span class="id" title="var">IH</span>] <span class="id" title="var">eqn</span>:<span class="id" title="var">Γlen_eq</span> <span class="id" title="tactic">in</span> <span class="id" title="var">Γ</span>, <span class="id" title="var">mask</span>, <span class="id" title="var">inner</span>, <span class="id" title="var">v</span>, <span class="id" title="var">clos</span>, <span class="id" title="var">len_eq</span>, <span class="id" title="var">ev</span> |- *.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">destruct</span> <span class="id" title="var">Γ</span>, <span class="id" title="var">mask</span>; <span class="id" title="tactic">try</span> <span class="id" title="var">easy</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#dearg_lambdas_nil"><span class="id" title="lemma">dearg_lambdas_nil</span></a> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">destruct</span> <span class="id" title="var">Γ</span> <span class="id" title="keyword">as</span> [|[<span class="id" title="var">na</span> [<span class="id" title="var">body</span>|]] <span class="id" title="var">Γ</span>];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *; <span class="id" title="var">refold</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">easy</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">apply</span> <a class="idref" href="ConCert.Extraction.WcbvEvalAux.html#eval_tLetIn_inv"><span class="id" title="lemma">eval_tLetIn_inv</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">ev</span> <span class="id" title="keyword">as</span> (<span class="id" title="var">bodyv</span> &amp; <span class="id" title="var">ev_body</span> &amp; <span class="id" title="var">ev_let</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">propify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="abbreviation">closed</span> <span class="id" title="var">bodyv</span>) <span class="id" title="tactic">by</span> (<span class="id" title="var">now</span> <span class="id" title="tactic">eapply</span> <a class="idref" href="ConCert.Extraction.WcbvEvalAux.html#eval_closed"><span class="id" title="lemma">eval_closed</span></a>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">closed_subst</span> <span class="id" title="tactic">in</span> <span class="id" title="var">ev_let</span> <span class="id" title="tactic">by</span> <span class="id" title="var">easy</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#dearg_lambdas_subst"><span class="id" title="lemma">dearg_lambdas_subst</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">ev_let</span> <span class="id" title="tactic">by</span> <span class="id" title="var">easy</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="lemma">closed_subst</span> <span class="id" title="tactic">in</span> <span class="id" title="var">ev_let</span> <span class="id" title="tactic">by</span> <span class="id" title="var">easy</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#subst_it_mkLambda_or_LetIn"><span class="id" title="lemma">subst_it_mkLambda_or_LetIn</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">ev_let</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">IH</span> <span class="id" title="tactic">in</span> <span class="id" title="var">ev_let</span> <span class="id" title="keyword">as</span> (<span class="id" title="var">tv</span> &amp; <span class="id" title="var">ev_tv</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="tactic">exists</span> <span class="id" title="var">tv</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#subst_it_mkLambda_or_LetIn"><span class="id" title="lemma">subst_it_mkLambda_or_LetIn</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">ev_tv</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">econstructor</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="tactic">rewrite</span> &lt;- <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#subst_it_mkLambda_or_LetIn"><span class="id" title="lemma">subst_it_mkLambda_or_LetIn</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <a class="idref" href="ConCert.Extraction.ClosedAux.html#closed_csubst"><span class="id" title="lemma">closed_csubst</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#vasses_subst_context"><span class="id" title="lemma">vasses_subst_context</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#length_subst_context"><span class="id" title="lemma">length_subst_context</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">destruct</span> <span class="id" title="var">mask</span> <span class="id" title="keyword">as</span> [|[] <span class="id" title="var">mask</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="var">easy</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="tactic">eexists</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">eapply</span> <span class="id" title="constructor">eval_atom</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="tactic">eexists</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">eapply</span> <span class="id" title="constructor">eval_atom</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a name="no_use_subst"><span class="id" title="lemma">no_use_subst</span></a> <span class="id" title="var">k</span> <span class="id" title="var">t</span> <span class="id" title="var">s</span> <span class="id" title="var">s'</span> :<br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Extraction.Optimize.html#is_dead"><span class="id" title="definition">is_dead</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#k"><span class="id" title="variable">k</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#t"><span class="id" title="variable">t</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<span class="id" title="definition">subst</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#ddd65c2f7ee73ecec433744948d846bb"><span class="id" title="notation">[</span></a><a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#s"><span class="id" title="variable">s</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#ddd65c2f7ee73ecec433744948d846bb"><span class="id" title="notation">]</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#k"><span class="id" title="variable">k</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#t"><span class="id" title="variable">t</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <span class="id" title="definition">subst</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#ddd65c2f7ee73ecec433744948d846bb"><span class="id" title="notation">[</span></a><a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#s'"><span class="id" title="variable">s'</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#ddd65c2f7ee73ecec433744948d846bb"><span class="id" title="notation">]</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#k"><span class="id" title="variable">k</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#t"><span class="id" title="variable">t</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">revert</span> <span class="id" title="var">k</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">t</span> <span class="id" title="keyword">using</span> <span class="id" title="lemma">term_forall_list_ind</span>; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *; <span class="id" title="tactic">intros</span> <span class="id" title="var">k</span> <span class="id" title="var">no_use</span>; <span class="id" title="var">propify</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">easy</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">destruct</span> (<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Arith.PeanoNat.html#Nat.leb_spec"><span class="id" title="lemma">Nat.leb_spec</span></a> <span class="id" title="var">k</span> <span class="id" title="var">n</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> !(<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#proj2"><span class="id" title="lemma">proj2</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#nth_error_None"><span class="id" title="lemma">nth_error_None</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span>)) <span class="id" title="tactic">by</span> (<span class="id" title="var">cbn</span>; <span class="id" title="var">lia</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">easy</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">easy</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">X</span>; [<span class="id" title="var">easy</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">propify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">now</span> <span class="id" title="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">now</span> <span class="id" title="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">now</span> <span class="id" title="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">easy</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">easy</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">f_equal</span>; [<span class="id" title="var">easy</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">no_use</span> <span class="id" title="keyword">as</span> (<span class="id" title="var">_</span> &amp; <span class="id" title="var">no_use</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">X</span>; [<span class="id" title="var">easy</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">propify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">f_equal</span>; [|<span class="id" title="var">easy</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">now</span> <span class="id" title="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">revert</span> <span class="id" title="var">k</span> <span class="id" title="var">no_use</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">X</span>; [<span class="id" title="var">easy</span>|]; <span class="id" title="tactic">intros</span> <span class="id" title="var">k</span> <span class="id" title="var">no_use</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="definition">map_def</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">x</span>; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *; <span class="id" title="var">propify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">p</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- (<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#proj1"><span class="id" title="lemma">proj1</span></a> <span class="id" title="var">no_use</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">rewrite</span> &lt;- <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Arith.PeanoNat.html#Nat.add_succ_r"><span class="id" title="lemma">Nat.add_succ_r</span></a> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <span class="id" title="var">IHX</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">revert</span> <span class="id" title="var">k</span> <span class="id" title="var">no_use</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">X</span>; [<span class="id" title="var">easy</span>|]; <span class="id" title="tactic">intros</span> <span class="id" title="var">k</span> <span class="id" title="var">no_use</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="definition">map_def</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">x</span>; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *; <span class="id" title="var">propify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">p</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- (<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#proj1"><span class="id" title="lemma">proj1</span></a> <span class="id" title="var">no_use</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">rewrite</span> &lt;- !<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Arith.PeanoNat.html#Nat.add_succ_r"><span class="id" title="lemma">Nat.add_succ_r</span></a> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <span class="id" title="var">IHX</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">reflexivity</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a name="masked_nil"><span class="id" title="lemma">masked_nil</span></a> {<span class="id" title="var">X</span>} <span class="id" title="var">mask</span> :<br/>
&nbsp;&nbsp;@<a class="idref" href="ConCert.Extraction.Optimize.html#masked"><span class="id" title="definition">masked</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#X"><span class="id" title="variable">X</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#mask"><span class="id" title="variable">mask</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#ae9a5e1034e143b218b09d8e454472bd"><span class="id" title="notation">[]</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#ae9a5e1034e143b218b09d8e454472bd"><span class="id" title="notation">[]</span></a>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="var">now</span> <span class="id" title="tactic">destruct</span> <span class="id" title="var">mask</span> <span class="id" title="keyword">as</span> [|[] ?]. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a name="All2_masked"><span class="id" title="lemma">All2_masked</span></a> {<span class="id" title="var">X</span> <span class="id" title="var">Y</span>} {<span class="id" title="var">T</span> : <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#X"><span class="id" title="variable">X</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#Y"><span class="id" title="variable">Y</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a> <span class="id" title="keyword">Type</span>} <span class="id" title="var">xs</span> <span class="id" title="var">ys</span> <span class="id" title="var">mask</span> :<br/>
&nbsp;&nbsp;<span class="id" title="inductive">All2</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#T"><span class="id" title="variable">T</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#xs"><span class="id" title="variable">xs</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#ys"><span class="id" title="variable">ys</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<span class="id" title="inductive">All2</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#T"><span class="id" title="variable">T</span></a> (<a class="idref" href="ConCert.Extraction.Optimize.html#masked"><span class="id" title="definition">masked</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#mask"><span class="id" title="variable">mask</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#xs"><span class="id" title="variable">xs</span></a>) (<a class="idref" href="ConCert.Extraction.Optimize.html#masked"><span class="id" title="definition">masked</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#mask"><span class="id" title="variable">mask</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#ys"><span class="id" title="variable">ys</span></a>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">all</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">all</span> <span class="id" title="tactic">in</span> <span class="id" title="var">mask</span> |- *.<br/>
&nbsp;&nbsp;- <span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> !<a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#masked_nil"><span class="id" title="lemma">masked_nil</span></a>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">destruct</span> <span class="id" title="var">mask</span> <span class="id" title="keyword">as</span> [|[] <span class="id" title="var">mask</span>]; [<span class="id" title="var">now</span> <span class="id" title="tactic">constructor</span>| |]; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <span class="id" title="var">IHall</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">now</span> <span class="id" title="tactic">constructor</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a name="dearg_lambdas_correct"><span class="id" title="lemma">dearg_lambdas_correct</span></a> {<span class="id" title="var">wfl</span>:<span class="id" title="class">WcbvFlags</span>} <span class="id" title="var">Σ</span> <span class="id" title="var">body</span> <span class="id" title="var">args</span> <span class="id" title="var">mask</span> <span class="id" title="var">v</span> :<br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Extraction.ClosedAux.html#env_closed"><span class="id" title="definition">env_closed</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#e15c0eb40e61adefe95778c26e7840f6"><span class="id" title="variable">Σ</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<span class="id" title="abbreviation">closed</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#body"><span class="id" title="variable">body</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#Forall"><span class="id" title="inductive">Forall</span></a> (<span class="id" title="definition">closedn</span> 0) <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#args"><span class="id" title="variable">args</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Extraction.Optimize.html#valid_dearg_mask"><span class="id" title="definition">valid_dearg_mask</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#mask"><span class="id" title="variable">mask</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#body"><span class="id" title="variable">body</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<span class="id" title="notation">#|</span><a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#mask"><span class="id" title="variable">mask</span></a><span class="id" title="notation">|</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Peano.html#cb53cf0ee22c036a03b4a9281c68b5a3"><span class="id" title="notation">&lt;=</span></a> <span class="id" title="notation">#|</span><a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#args"><span class="id" title="variable">args</span></a><span class="id" title="notation">|</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#e15c0eb40e61adefe95778c26e7840f6"><span class="id" title="variable">Σ</span></a> <a class="idref" href="ConCert.Extraction.WcbvEvalAux.html#e49f44d96100960446bedaca1e4a4428"><span class="id" title="notation">e</span></a><a class="idref" href="ConCert.Extraction.WcbvEvalAux.html#e49f44d96100960446bedaca1e4a4428"><span class="id" title="notation">⊢</span></a> <span class="id" title="definition">mkApps</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#body"><span class="id" title="variable">body</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#args"><span class="id" title="variable">args</span></a> <a class="idref" href="ConCert.Extraction.WcbvEvalAux.html#e49f44d96100960446bedaca1e4a4428"><span class="id" title="notation">▷</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#v"><span class="id" title="variable">v</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#e15c0eb40e61adefe95778c26e7840f6"><span class="id" title="variable">Σ</span></a> <a class="idref" href="ConCert.Extraction.WcbvEvalAux.html#e49f44d96100960446bedaca1e4a4428"><span class="id" title="notation">e</span></a><a class="idref" href="ConCert.Extraction.WcbvEvalAux.html#e49f44d96100960446bedaca1e4a4428"><span class="id" title="notation">⊢</span></a> <span class="id" title="definition">mkApps</span> (<a class="idref" href="ConCert.Extraction.Optimize.html#dearg_lambdas"><span class="id" title="definition">dearg_lambdas</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#mask"><span class="id" title="variable">mask</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#body"><span class="id" title="variable">body</span></a>) (<a class="idref" href="ConCert.Extraction.Optimize.html#masked"><span class="id" title="definition">masked</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#mask"><span class="id" title="variable">mask</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#args"><span class="id" title="variable">args</span></a>) <a class="idref" href="ConCert.Extraction.WcbvEvalAux.html#e49f44d96100960446bedaca1e4a4428"><span class="id" title="notation">▷</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#v"><span class="id" title="variable">v</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">env_clos</span> <span class="id" title="var">body_clos</span> <span class="id" title="var">args_clos</span> <span class="id" title="var">valid_mask</span> <span class="id" title="var">l</span> <span class="id" title="var">ev</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#valid_dearg_mask_spec"><span class="id" title="lemma">valid_dearg_mask_spec</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">valid_mask</span>) <span class="id" title="keyword">as</span> (<span class="id" title="var">Γ</span> &amp; <span class="id" title="var">inner</span> &amp; <span class="id" title="var">vasses_len</span> &amp; &lt;-).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="notation">#|</span><span class="id" title="var">Γ</span><span class="id" title="notation">|</span> <span class="id" title="keyword">as</span> [|<span class="id" title="var">Γlen</span> <span class="id" title="var">IH</span>] <span class="id" title="var">eqn</span>:<span class="id" title="var">eq</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">in</span> <span class="id" title="var">Γ</span>, <span class="id" title="var">mask</span>, <span class="id" title="var">valid_mask</span>, <span class="id" title="var">args</span>, <span class="id" title="var">body_clos</span>, <span class="id" title="var">args_clos</span>, <span class="id" title="var">inner</span>, <span class="id" title="var">ev</span>, <span class="id" title="var">l</span>, <span class="id" title="var">vasses_len</span> |- *.<br/>
&nbsp;&nbsp;1: { <span class="id" title="tactic">destruct</span> <span class="id" title="var">Γ</span>, <span class="id" title="var">mask</span>, <span class="id" title="var">args</span>; <span class="id" title="tactic">try</span> <span class="id" title="var">easy</span>; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#dearg_lambdas_nil"><span class="id" title="lemma">dearg_lambdas_nil</span></a>. }<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">Γ</span> <span class="id" title="keyword">as</span> [|[<span class="id" title="var">na</span> [<span class="id" title="var">body</span>|]] <span class="id" title="var">Γ</span>];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *; <span class="id" title="var">refold</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">easy</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <a class="idref" href="ConCert.Extraction.WcbvEvalAux.html#eval_mkApps_head"><span class="id" title="lemma">eval_mkApps_head</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">ev</span> <span class="id" title="keyword">as</span> <span class="id" title="var">ev_let</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">ev_let</span> <span class="id" title="keyword">as</span> (<span class="id" title="var">letv</span> &amp; <span class="id" title="var">ev_let</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="ConCert.Extraction.WcbvEvalAux.html#eval_tLetIn_inv"><span class="id" title="lemma">eval_tLetIn_inv</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">ev_let</span> <span class="id" title="keyword">as</span> <span class="id" title="var">ev_subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">ev_subst</span> <span class="id" title="keyword">as</span> (<span class="id" title="var">bodyv</span> &amp; <span class="id" title="var">ev_body</span> &amp; <span class="id" title="var">ev_subst</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">propify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="abbreviation">closed</span> <span class="id" title="var">bodyv</span>) <span class="id" title="tactic">by</span> (<span class="id" title="var">now</span> <span class="id" title="tactic">eapply</span> <a class="idref" href="ConCert.Extraction.WcbvEvalAux.html#eval_closed"><span class="id" title="lemma">eval_closed</span></a>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">unshelve</span> <span class="id" title="var">epose</span> <span class="id" title="var">proof</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">IH</span> <span class="id" title="var">args</span> <span class="id" title="var">mask</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#subst_context"><span class="id" title="definition">subst_context</span></a> <span class="id" title="var">bodyv</span> 0 <span class="id" title="var">Γ</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="definition">csubst</span> <span class="id" title="var">bodyv</span> <span class="id" title="notation">#|</span><span class="id" title="var">Γ</span><span class="id" title="notation">|</span> <span class="id" title="var">inner</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>) <span class="id" title="keyword">as</span> <span class="id" title="var">IH</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">rewrite</span> &lt;- <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#subst_it_mkLambda_or_LetIn"><span class="id" title="lemma">subst_it_mkLambda_or_LetIn</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <a class="idref" href="ConCert.Extraction.ClosedAux.html#closed_csubst"><span class="id" title="lemma">closed_csubst</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">easy</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">rewrite</span> &lt;- <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#subst_it_mkLambda_or_LetIn"><span class="id" title="lemma">subst_it_mkLambda_or_LetIn</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#valid_dearg_mask_csubst"><span class="id" title="lemma">valid_dearg_mask_csubst</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">easy</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">rewrite</span> &lt;- <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#subst_it_mkLambda_or_LetIn"><span class="id" title="lemma">subst_it_mkLambda_or_LetIn</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> (<a class="idref" href="ConCert.Extraction.WcbvEvalAux.html#eval_mkApps_heads"><span class="id" title="lemma">eval_mkApps_heads</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">letv</span>); [<span class="id" title="var">easy</span>|<span class="id" title="var">easy</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">eapply</span> <a class="idref" href="ConCert.Extraction.WcbvEvalAux.html#eval_mkApps_heads"><span class="id" title="lemma">eval_mkApps_heads</span></a>; [<span class="id" title="tactic">exact</span> <span class="id" title="var">ev_let</span>| |]; <span class="id" title="var">easy</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#vasses_subst_context"><span class="id" title="lemma">vasses_subst_context</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#length_subst_context"><span class="id" title="lemma">length_subst_context</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">rewrite</span> &lt;- <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#subst_it_mkLambda_or_LetIn"><span class="id" title="lemma">subst_it_mkLambda_or_LetIn</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">IH</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="ConCert.Extraction.WcbvEvalAux.html#eval_mkApps_head"><span class="id" title="lemma">eval_mkApps_head</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">IH</span> <span class="id" title="keyword">as</span> <span class="id" title="var">ev_top</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">ev_top</span> <span class="id" title="keyword">as</span> (<span class="id" title="var">topv</span> &amp; <span class="id" title="var">ev_top</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#subst_it_mkLambda_or_LetIn"><span class="id" title="lemma">subst_it_mkLambda_or_LetIn</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">ev_top</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#eval_dearg_lambdas_inv"><span class="id" title="lemma">eval_dearg_lambdas_inv</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">ev_top</span> <span class="id" title="keyword">as</span> <span class="id" title="var">ev_sub_top</span>; <span class="id" title="var">cycle</span> 1.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="var">easy</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="tactic">rewrite</span> &lt;- <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#subst_it_mkLambda_or_LetIn"><span class="id" title="lemma">subst_it_mkLambda_or_LetIn</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <a class="idref" href="ConCert.Extraction.ClosedAux.html#closed_csubst"><span class="id" title="lemma">closed_csubst</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#vasses_subst_context"><span class="id" title="lemma">vasses_subst_context</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="tactic">destruct</span> <span class="id" title="var">ev_sub_top</span> <span class="id" title="keyword">as</span> (<span class="id" title="var">sub_top</span> &amp; <span class="id" title="var">ev_sub_top</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#subst_it_mkLambda_or_LetIn"><span class="id" title="lemma">subst_it_mkLambda_or_LetIn</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">ev_top</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="ConCert.Extraction.WcbvEvalAux.html#eval_mkApps_heads"><span class="id" title="lemma">eval_mkApps_heads</span></a>; [| |<span class="id" title="var">now</span> <span class="id" title="tactic">eauto</span>]; [<span class="id" title="var">now</span> <span class="id" title="tactic">eauto</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">econstructor</span>; [<span class="id" title="var">easy</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> !<span class="id" title="lemma">closed_subst</span> <span class="id" title="tactic">in</span> * <span class="id" title="tactic">by</span> <span class="id" title="var">easy</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> &lt;- <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#dearg_lambdas_subst"><span class="id" title="lemma">dearg_lambdas_subst</span></a>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">destruct</span> <span class="id" title="var">mask</span> <span class="id" title="keyword">as</span> [|<span class="id" title="var">b</span> <span class="id" title="var">mask</span>]; [<span class="id" title="var">easy</span>|];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *; <span class="id" title="var">refold</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">args</span> <span class="id" title="keyword">as</span> [|<span class="id" title="var">a</span> <span class="id" title="var">args</span>]; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *; [<span class="id" title="var">easy</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="ConCert.Extraction.WcbvEvalAux.html#eval_mkApps_head"><span class="id" title="lemma">eval_mkApps_head</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">ev</span> <span class="id" title="keyword">as</span> <span class="id" title="var">ev_app</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">ev_app</span> <span class="id" title="keyword">as</span> (<span class="id" title="var">appv</span> &amp; <span class="id" title="var">ev_app</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="ConCert.Extraction.WcbvEvalAux.html#eval_tApp_tLambda_inv"><span class="id" title="lemma">eval_tApp_tLambda_inv</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">ev_app</span> <span class="id" title="keyword">as</span> <span class="id" title="var">ev_subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">ev_subst</span> <span class="id" title="keyword">as</span> (<span class="id" title="var">av</span> &amp; <span class="id" title="var">ev_a</span> &amp; <span class="id" title="var">ev_subst</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="abbreviation">closed</span> <span class="id" title="var">av</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#Forall_inv"><span class="id" title="lemma">Forall_inv</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">args_clos</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">eapply</span> <a class="idref" href="ConCert.Extraction.WcbvEvalAux.html#eval_closed"><span class="id" title="lemma">eval_closed</span></a>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">unshelve</span> <span class="id" title="var">epose</span> <span class="id" title="var">proof</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">IH</span> <span class="id" title="var">args</span> <span class="id" title="var">mask</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#subst_context"><span class="id" title="definition">subst_context</span></a> <span class="id" title="var">av</span> 0 <span class="id" title="var">Γ</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="definition">csubst</span> <span class="id" title="var">av</span> <span class="id" title="notation">#|</span><span class="id" title="var">Γ</span><span class="id" title="notation">|</span> <span class="id" title="var">inner</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>) <span class="id" title="keyword">as</span> <span class="id" title="var">IH</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">rewrite</span> &lt;- <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#subst_it_mkLambda_or_LetIn"><span class="id" title="lemma">subst_it_mkLambda_or_LetIn</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <a class="idref" href="ConCert.Extraction.ClosedAux.html#closed_csubst"><span class="id" title="lemma">closed_csubst</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#Forall_inv_tail"><span class="id" title="lemma">Forall_inv_tail</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">args_clos</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">rewrite</span> &lt;- <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#subst_it_mkLambda_or_LetIn"><span class="id" title="lemma">subst_it_mkLambda_or_LetIn</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">propify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#valid_dearg_mask_csubst"><span class="id" title="lemma">valid_dearg_mask_csubst</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">easy</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">rewrite</span> &lt;- <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#subst_it_mkLambda_or_LetIn"><span class="id" title="lemma">subst_it_mkLambda_or_LetIn</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">eapply</span> <a class="idref" href="ConCert.Extraction.WcbvEvalAux.html#eval_mkApps_heads"><span class="id" title="lemma">eval_mkApps_heads</span></a>; [<span class="id" title="tactic">exact</span> <span class="id" title="var">ev_app</span>| |]; <span class="id" title="var">easy</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#vasses_subst_context"><span class="id" title="lemma">vasses_subst_context</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#length_subst_context"><span class="id" title="lemma">length_subst_context</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">apply</span> <a class="idref" href="ConCert.Extraction.WcbvEvalAux.html#eval_mkApps_head"><span class="id" title="lemma">eval_mkApps_head</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">IH</span> <span class="id" title="keyword">as</span> <span class="id" title="var">ev_top</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">ev_top</span> <span class="id" title="keyword">as</span> (<span class="id" title="var">topv</span> &amp; <span class="id" title="var">ev_top</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#eval_dearg_lambdas_inv"><span class="id" title="lemma">eval_dearg_lambdas_inv</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">ev_top</span> <span class="id" title="keyword">as</span> <span class="id" title="var">ev_sub_top</span>; <span class="id" title="var">cycle</span> 1.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="var">easy</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="tactic">rewrite</span> &lt;- <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#subst_it_mkLambda_or_LetIn"><span class="id" title="lemma">subst_it_mkLambda_or_LetIn</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <a class="idref" href="ConCert.Extraction.ClosedAux.html#closed_csubst"><span class="id" title="lemma">closed_csubst</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#vasses_subst_context"><span class="id" title="lemma">vasses_subst_context</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="tactic">rewrite</span> &lt;- !<a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#subst_it_mkLambda_or_LetIn"><span class="id" title="lemma">subst_it_mkLambda_or_LetIn</span></a> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">ev_sub_top</span> <span class="id" title="keyword">as</span> (<span class="id" title="var">sub_top</span> &amp; <span class="id" title="var">ev_sub_top</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> !<span class="id" title="lemma">closed_subst</span> <span class="id" title="tactic">in</span> * <span class="id" title="tactic">by</span> <span class="id" title="var">easy</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">b</span>; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- <span class="id" title="tactic">eapply</span> <a class="idref" href="ConCert.Extraction.WcbvEvalAux.html#eval_mkApps_heads"><span class="id" title="lemma">eval_mkApps_heads</span></a>; [| |<span class="id" title="var">now</span> <span class="id" title="tactic">eauto</span>]; [<span class="id" title="var">now</span> <span class="id" title="tactic">eauto</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="definition">subst1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#dearg_lambdas_subst"><span class="id" title="lemma">dearg_lambdas_subst</span></a> <span class="id" title="tactic">by</span> <span class="id" title="var">easy</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">propify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="var">erewrite</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#no_use_subst"><span class="id" title="lemma">no_use_subst</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- <span class="id" title="tactic">eapply</span> <a class="idref" href="ConCert.Extraction.WcbvEvalAux.html#eval_mkApps_heads"><span class="id" title="lemma">eval_mkApps_heads</span></a>; [| |<span class="id" title="var">now</span> <span class="id" title="tactic">eauto</span>]; [<span class="id" title="var">now</span> <span class="id" title="tactic">eauto</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#dearg_lambdas_subst"><span class="id" title="lemma">dearg_lambdas_subst</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">ev_top</span> <span class="id" title="tactic">by</span> <span class="id" title="var">easy</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="lemma">closed_subst</span> <span class="id" title="tactic">in</span> <span class="id" title="var">ev_top</span> <span class="id" title="tactic">by</span> <span class="id" title="var">easy</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <span class="id" title="constructor">eval_beta</span>; [|<span class="id" title="var">easy</span>|<span class="id" title="var">easy</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">eapply</span> <span class="id" title="constructor">eval_atom</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Section</span> <a name="dearg_correct"><span class="id" title="section">dearg_correct</span></a>.<br/>
<span class="id" title="keyword">Context</span> (<span class="id" title="var">ind_masks</span> : <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#list"><span class="id" title="inductive">list</span></a> (<span class="id" title="definition">kername</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#11c698c8685bb8ab1cf725545c085ac4"><span class="id" title="notation">*</span></a> <a class="idref" href="ConCert.Extraction.Optimize.html#mib_masks"><span class="id" title="record">mib_masks</span></a>)).<br/>
<span class="id" title="keyword">Context</span> (<span class="id" title="var">const_masks</span> : <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#list"><span class="id" title="inductive">list</span></a> (<span class="id" title="definition">kername</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#11c698c8685bb8ab1cf725545c085ac4"><span class="id" title="notation">*</span></a> <a class="idref" href="ConCert.Extraction.Optimize.html#bitmask"><span class="id" title="definition">bitmask</span></a>)).<br/>
<span class="id" title="keyword">Notation</span> <a name="get_ctor_mask"><span class="id" title="abbreviation">get_ctor_mask</span></a> := (<a class="idref" href="ConCert.Extraction.Optimize.html#get_ctor_mask"><span class="id" title="definition">get_ctor_mask</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#dearg_correct.ind_masks"><span class="id" title="variable">ind_masks</span></a>).<br/>
<span class="id" title="keyword">Notation</span> <a name="get_mib_masks"><span class="id" title="abbreviation">get_mib_masks</span></a> := (<a class="idref" href="ConCert.Extraction.Optimize.html#get_mib_masks"><span class="id" title="definition">get_mib_masks</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#dearg_correct.ind_masks"><span class="id" title="variable">ind_masks</span></a>).<br/>
<span class="id" title="keyword">Notation</span> <a name="get_const_mask"><span class="id" title="abbreviation">get_const_mask</span></a> := (<a class="idref" href="ConCert.Extraction.Optimize.html#get_const_mask"><span class="id" title="definition">get_const_mask</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#dearg_correct.const_masks"><span class="id" title="variable">const_masks</span></a>).<br/>
<span class="id" title="keyword">Notation</span> <a name="dearg"><span class="id" title="abbreviation">dearg</span></a> := (<a class="idref" href="ConCert.Extraction.Optimize.html#dearg"><span class="id" title="definition">dearg</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#dearg_correct.ind_masks"><span class="id" title="variable">ind_masks</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#dearg_correct.const_masks"><span class="id" title="variable">const_masks</span></a>).<br/>
<span class="id" title="keyword">Notation</span> <a name="dearg_aux"><span class="id" title="abbreviation">dearg_aux</span></a> := (<a class="idref" href="ConCert.Extraction.Optimize.html#dearg_aux"><span class="id" title="definition">dearg_aux</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#dearg_correct.ind_masks"><span class="id" title="variable">ind_masks</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#dearg_correct.const_masks"><span class="id" title="variable">const_masks</span></a>).<br/>
<span class="id" title="keyword">Notation</span> <a name="dearg_env"><span class="id" title="abbreviation">dearg_env</span></a> := (<a class="idref" href="ConCert.Extraction.Optimize.html#dearg_env"><span class="id" title="definition">dearg_env</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#dearg_correct.ind_masks"><span class="id" title="variable">ind_masks</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#dearg_correct.const_masks"><span class="id" title="variable">const_masks</span></a>).<br/>
<span class="id" title="keyword">Notation</span> <a name="dearg_decl"><span class="id" title="abbreviation">dearg_decl</span></a> := (<a class="idref" href="ConCert.Extraction.Optimize.html#dearg_decl"><span class="id" title="definition">dearg_decl</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#dearg_correct.ind_masks"><span class="id" title="variable">ind_masks</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#dearg_correct.const_masks"><span class="id" title="variable">const_masks</span></a>).<br/>
<span class="id" title="keyword">Notation</span> <a name="dearg_cst"><span class="id" title="abbreviation">dearg_cst</span></a> := (<a class="idref" href="ConCert.Extraction.Optimize.html#dearg_cst"><span class="id" title="definition">dearg_cst</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#dearg_correct.ind_masks"><span class="id" title="variable">ind_masks</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#dearg_correct.const_masks"><span class="id" title="variable">const_masks</span></a>).<br/>
<span class="id" title="keyword">Notation</span> <a name="dearg_case"><span class="id" title="abbreviation">dearg_case</span></a> := (<a class="idref" href="ConCert.Extraction.Optimize.html#dearg_case"><span class="id" title="definition">dearg_case</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#dearg_correct.ind_masks"><span class="id" title="variable">ind_masks</span></a>).<br/>
<span class="id" title="keyword">Notation</span> <a name="dearg_proj"><span class="id" title="abbreviation">dearg_proj</span></a> := (<a class="idref" href="ConCert.Extraction.Optimize.html#dearg_proj"><span class="id" title="definition">dearg_proj</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#dearg_correct.ind_masks"><span class="id" title="variable">ind_masks</span></a>).<br/>
<span class="id" title="keyword">Notation</span> <a name="valid_case_masks"><span class="id" title="abbreviation">valid_case_masks</span></a> := (<a class="idref" href="ConCert.Extraction.Optimize.html#valid_case_masks"><span class="id" title="definition">valid_case_masks</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#dearg_correct.ind_masks"><span class="id" title="variable">ind_masks</span></a>).<br/>
<span class="id" title="keyword">Notation</span> <a name="valid_proj"><span class="id" title="abbreviation">valid_proj</span></a> := (<a class="idref" href="ConCert.Extraction.Optimize.html#valid_proj"><span class="id" title="definition">valid_proj</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#dearg_correct.ind_masks"><span class="id" title="variable">ind_masks</span></a>).<br/>
<span class="id" title="keyword">Notation</span> <a name="valid_cases"><span class="id" title="abbreviation">valid_cases</span></a> := (<a class="idref" href="ConCert.Extraction.Optimize.html#valid_cases"><span class="id" title="definition">valid_cases</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#dearg_correct.ind_masks"><span class="id" title="variable">ind_masks</span></a>).<br/>
<span class="id" title="keyword">Notation</span> <a name="valid_masks_decl"><span class="id" title="abbreviation">valid_masks_decl</span></a> := (<a class="idref" href="ConCert.Extraction.Optimize.html#valid_masks_decl"><span class="id" title="definition">valid_masks_decl</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#dearg_correct.ind_masks"><span class="id" title="variable">ind_masks</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#dearg_correct.const_masks"><span class="id" title="variable">const_masks</span></a>).<br/>
<span class="id" title="keyword">Notation</span> <a name="valid_masks_env"><span class="id" title="abbreviation">valid_masks_env</span></a> := (<a class="idref" href="ConCert.Extraction.Optimize.html#valid_masks_env"><span class="id" title="definition">valid_masks_env</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#dearg_correct.ind_masks"><span class="id" title="variable">ind_masks</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#dearg_correct.const_masks"><span class="id" title="variable">const_masks</span></a>).<br/>
<span class="id" title="keyword">Notation</span> <a name="is_expanded_aux"><span class="id" title="abbreviation">is_expanded_aux</span></a> := (<a class="idref" href="ConCert.Extraction.Optimize.html#is_expanded_aux"><span class="id" title="definition">is_expanded_aux</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#dearg_correct.ind_masks"><span class="id" title="variable">ind_masks</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#dearg_correct.const_masks"><span class="id" title="variable">const_masks</span></a>).<br/>
<span class="id" title="keyword">Notation</span> <a name="is_expanded"><span class="id" title="abbreviation">is_expanded</span></a> := (<a class="idref" href="ConCert.Extraction.Optimize.html#is_expanded"><span class="id" title="definition">is_expanded</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#dearg_correct.ind_masks"><span class="id" title="variable">ind_masks</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#dearg_correct.const_masks"><span class="id" title="variable">const_masks</span></a>).<br/>
<span class="id" title="keyword">Notation</span> <a name="is_expanded_env"><span class="id" title="abbreviation">is_expanded_env</span></a> := (<a class="idref" href="ConCert.Extraction.Optimize.html#is_expanded_env"><span class="id" title="definition">is_expanded_env</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#dearg_correct.ind_masks"><span class="id" title="variable">ind_masks</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#dearg_correct.const_masks"><span class="id" title="variable">const_masks</span></a>).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a name="dearg_aux_mkApps"><span class="id" title="lemma">dearg_aux_mkApps</span></a> <span class="id" title="var">args</span> <span class="id" title="var">args'</span> <span class="id" title="var">hd</span> :<br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#dearg_aux"><span class="id" title="abbreviation">dearg_aux</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#args"><span class="id" title="variable">args</span></a> (<span class="id" title="definition">mkApps</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#hd"><span class="id" title="variable">hd</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#args'"><span class="id" title="variable">args'</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#dearg_aux"><span class="id" title="abbreviation">dearg_aux</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#map"><span class="id" title="definition">map</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#dearg"><span class="id" title="abbreviation">dearg</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#args'"><span class="id" title="variable">args'</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#bc347c51eaf667706ae54503b26d52c6"><span class="id" title="notation">++</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#args"><span class="id" title="variable">args</span></a>) <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#hd"><span class="id" title="variable">hd</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">revert</span> <span class="id" title="var">args</span> <span class="id" title="var">hd</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">args'</span> <span class="id" title="keyword">as</span> [|<span class="id" title="var">a</span> <span class="id" title="var">args'</span> <span class="id" title="var">IH</span>]; <span class="id" title="tactic">intros</span> <span class="id" title="var">args</span> <span class="id" title="var">hd</span>; [<span class="id" title="var">easy</span>|].<br/>
&nbsp;&nbsp;<span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="var">IH</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a name="dearg_mkApps"><span class="id" title="lemma">dearg_mkApps</span></a> <span class="id" title="var">hd</span> <span class="id" title="var">args</span> :<br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#dearg"><span class="id" title="abbreviation">dearg</span></a> (<span class="id" title="definition">mkApps</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#hd"><span class="id" title="variable">hd</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#args"><span class="id" title="variable">args</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#dearg_aux"><span class="id" title="abbreviation">dearg_aux</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#map"><span class="id" title="definition">map</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#dearg"><span class="id" title="abbreviation">dearg</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#args"><span class="id" title="variable">args</span></a>) <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#hd"><span class="id" title="variable">hd</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">dearg</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#dearg_aux_mkApps"><span class="id" title="lemma">dearg_aux_mkApps</span></a>, <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#app_nil_r"><span class="id" title="lemma">app_nil_r</span></a>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Ltac</span> <span class="id" title="var">refold'</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="var">refold</span>;<br/>
&nbsp;&nbsp;<span class="id" title="tactic">change</span> (<a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#dearg_aux"><span class="id" title="abbreviation">dearg_aux</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#ae9a5e1034e143b218b09d8e454472bd"><span class="id" title="notation">[]</span></a>) <span class="id" title="keyword">with</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#dearg"><span class="id" title="abbreviation">dearg</span></a> <span class="id" title="tactic">in</span> *.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a name="subst_dearg_single"><span class="id" title="lemma">subst_dearg_single</span></a> <span class="id" title="var">s</span> <span class="id" title="var">k</span> <span class="id" title="var">mask</span> <span class="id" title="var">t</span>  <span class="id" title="var">args</span> :<br/>
&nbsp;&nbsp;<span class="id" title="definition">subst</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#s"><span class="id" title="variable">s</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#k"><span class="id" title="variable">k</span></a> (<a class="idref" href="ConCert.Extraction.Optimize.html#dearg_single"><span class="id" title="definition">dearg_single</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#mask"><span class="id" title="variable">mask</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#t"><span class="id" title="variable">t</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#args"><span class="id" title="variable">args</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Extraction.Optimize.html#dearg_single"><span class="id" title="definition">dearg_single</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#mask"><span class="id" title="variable">mask</span></a> (<span class="id" title="definition">subst</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#s"><span class="id" title="variable">s</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#k"><span class="id" title="variable">k</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#t"><span class="id" title="variable">t</span></a>) (<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#map"><span class="id" title="definition">map</span></a> (<span class="id" title="definition">subst</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#s"><span class="id" title="variable">s</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#k"><span class="id" title="variable">k</span></a>) <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#args"><span class="id" title="variable">args</span></a>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">mask</span> <span class="id" title="keyword">as</span> [|[] <span class="id" title="var">mask</span> <span class="id" title="var">IH</span>] <span class="id" title="tactic">in</span> <span class="id" title="var">mask</span>, <span class="id" title="var">args</span>, <span class="id" title="var">k</span>, <span class="id" title="var">t</span> |- *; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;- <span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">subst_mkApps</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">destruct</span> <span class="id" title="var">args</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">IH</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="lemma">commut_lift_subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">apply</span> <span class="id" title="var">IH</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">destruct</span> <span class="id" title="var">args</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">IH</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">commut_lift_subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">apply</span> <span class="id" title="var">IH</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a name="lift_dearg_single"><span class="id" title="lemma">lift_dearg_single</span></a> <span class="id" title="var">n</span> <span class="id" title="var">k</span> <span class="id" title="var">mask</span> <span class="id" title="var">t</span> <span class="id" title="var">args</span> :<br/>
&nbsp;&nbsp;<span class="id" title="definition">lift</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#n"><span class="id" title="variable">n</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#k"><span class="id" title="variable">k</span></a> (<a class="idref" href="ConCert.Extraction.Optimize.html#dearg_single"><span class="id" title="definition">dearg_single</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#mask"><span class="id" title="variable">mask</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#t"><span class="id" title="variable">t</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#args"><span class="id" title="variable">args</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="ConCert.Extraction.Optimize.html#dearg_single"><span class="id" title="definition">dearg_single</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#mask"><span class="id" title="variable">mask</span></a> (<span class="id" title="definition">lift</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#n"><span class="id" title="variable">n</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#k"><span class="id" title="variable">k</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#t"><span class="id" title="variable">t</span></a>) (<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#map"><span class="id" title="definition">map</span></a> (<span class="id" title="definition">lift</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#n"><span class="id" title="variable">n</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#k"><span class="id" title="variable">k</span></a>) <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#args"><span class="id" title="variable">args</span></a>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">mask</span> <span class="id" title="keyword">as</span> [|[] <span class="id" title="var">mask</span> <span class="id" title="var">IH</span>] <span class="id" title="tactic">in</span> <span class="id" title="var">mask</span>, <span class="id" title="var">t</span>, <span class="id" title="var">args</span>, <span class="id" title="var">k</span> |- *; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;- <span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">lift_mkApps</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">destruct</span> <span class="id" title="var">args</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">IH</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">symmetry</span>; <span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">permute_lift</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">apply</span> <span class="id" title="var">IH</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">destruct</span> <span class="id" title="var">args</span>; <span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">rewrite</span> <span class="id" title="var">IH</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">symmetry</span>; <span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">permute_lift</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">apply</span> <span class="id" title="var">IH</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a name="dearg_lambdas_lift"><span class="id" title="lemma">dearg_lambdas_lift</span></a> <span class="id" title="var">mask</span> <span class="id" title="var">n</span> <span class="id" title="var">k</span> <span class="id" title="var">t</span> :<br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Extraction.Optimize.html#dearg_lambdas"><span class="id" title="definition">dearg_lambdas</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#mask"><span class="id" title="variable">mask</span></a> (<span class="id" title="definition">lift</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#n"><span class="id" title="variable">n</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#k"><span class="id" title="variable">k</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#t"><span class="id" title="variable">t</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <span class="id" title="definition">lift</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#n"><span class="id" title="variable">n</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#k"><span class="id" title="variable">k</span></a> (<a class="idref" href="ConCert.Extraction.Optimize.html#dearg_lambdas"><span class="id" title="definition">dearg_lambdas</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#mask"><span class="id" title="variable">mask</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#t"><span class="id" title="variable">t</span></a>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">t</span> <span class="id" title="tactic">in</span> <span class="id" title="var">mask</span>, <span class="id" title="var">n</span>, <span class="id" title="var">k</span>, <span class="id" title="var">t</span> |- *; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *; <span class="id" title="tactic">try</span> <span class="id" title="var">easy</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">now</span> <span class="id" title="tactic">destruct</span> (<span class="id" title="var">_</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Arith.PeanoNat.html#0f31f5c1c6b6a21a3a187247222bc9e4"><span class="id" title="notation">&lt;=?</span></a> <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">destruct</span> <span class="id" title="var">mask</span> <span class="id" title="keyword">as</span> [|[] <span class="id" title="var">mask</span>]; [<span class="id" title="var">easy</span>| |].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">rewrite</span> <span class="id" title="var">IHt</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">change</span> <span class="id" title="constructor">tBox</span> <span class="id" title="keyword">with</span> (<span class="id" title="definition">lift</span> <span class="id" title="var">n</span> <span class="id" title="var">k</span> <span class="id" title="constructor">tBox</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="lemma">distr_lift_subst10</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="var">IHt</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a name="lift_dearg_aux"><span class="id" title="lemma">lift_dearg_aux</span></a> <span class="id" title="var">n</span> <span class="id" title="var">k</span> <span class="id" title="var">args</span> <span class="id" title="var">t</span> :<br/>
&nbsp;&nbsp;<span class="id" title="definition">lift</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#n"><span class="id" title="variable">n</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#k"><span class="id" title="variable">k</span></a> (<a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#dearg_aux"><span class="id" title="abbreviation">dearg_aux</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#args"><span class="id" title="variable">args</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#t"><span class="id" title="variable">t</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#dearg_aux"><span class="id" title="abbreviation">dearg_aux</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#map"><span class="id" title="definition">map</span></a> (<span class="id" title="definition">lift</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#n"><span class="id" title="variable">n</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#k"><span class="id" title="variable">k</span></a>) <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#args"><span class="id" title="variable">args</span></a>) (<span class="id" title="definition">lift</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#n"><span class="id" title="variable">n</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#k"><span class="id" title="variable">k</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#t"><span class="id" title="variable">t</span></a>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">t</span> <span class="id" title="tactic">in</span> <span class="id" title="var">k</span>, <span class="id" title="var">args</span>, <span class="id" title="var">t</span> |- * <span class="id" title="keyword">using</span> <span class="id" title="lemma">term_forall_list_ind</span>; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;- <span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">lift_mkApps</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">lift_mkApps</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">destruct</span> (<span class="id" title="var">_</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Arith.PeanoNat.html#0f31f5c1c6b6a21a3a187247222bc9e4"><span class="id" title="notation">&lt;=?</span></a> <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;- <span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">lift_mkApps</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">lift_mkApps</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">X</span>; [<span class="id" title="var">easy</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="var">p</span>, <span class="id" title="var">IHX</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">lift_mkApps</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="var">IHt</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">lift_mkApps</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="var">IHt1</span>, <span class="id" title="var">IHt2</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">rewrite</span> <span class="id" title="var">IHt1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="var">IHt2</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#lift_dearg_single"><span class="id" title="lemma">lift_dearg_single</span></a>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#lift_dearg_single"><span class="id" title="lemma">lift_dearg_single</span></a>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">destruct</span> <span class="id" title="var">p</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">lift_mkApps</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">dearg_case</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#get_mib_masks"><span class="id" title="abbreviation">get_mib_masks</span></a> <span class="id" title="var">_</span>); <span class="id" title="var">last</span> <span class="id" title="tactic">first</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">IHt</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">X</span>; [<span class="id" title="var">easy</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="var">p</span>, <span class="id" title="var">IHX</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">IHt</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="definition">mapi</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">generalize</span> 0.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">X</span>; [<span class="id" title="var">easy</span>|]; <span class="id" title="tactic">intros</span> ?.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">IHX</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> &lt;- <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#dearg_lambdas_lift"><span class="id" title="lemma">dearg_lambdas_lift</span></a>, <span class="id" title="var">p</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">destruct</span> <span class="id" title="var">s</span> <span class="id" title="keyword">as</span> ((<span class="id" title="var">ind</span> &amp; <span class="id" title="var">c</span>) &amp; <span class="id" title="var">npars</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">lift_mkApps</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">dearg_proj</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#get_mib_masks"><span class="id" title="abbreviation">get_mib_masks</span></a> <span class="id" title="var">_</span>); <span class="id" title="var">cbn</span>; <span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="var">IHt</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">lift_mkApps</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#map_length"><span class="id" title="lemma">map_length</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">X</span> <span class="id" title="tactic">in</span> <span class="id" title="var">k</span> |- *; [<span class="id" title="var">easy</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Arith.PeanoNat.html#Nat.add_succ_r"><span class="id" title="lemma">Nat.add_succ_r</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">IHX</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="definition">map_def</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="var">p</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">lift_mkApps</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#map_length"><span class="id" title="lemma">map_length</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">X</span> <span class="id" title="tactic">in</span> <span class="id" title="var">k</span> |- *; [<span class="id" title="var">easy</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Arith.PeanoNat.html#Nat.add_succ_r"><span class="id" title="lemma">Nat.add_succ_r</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">IHX</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="definition">map_def</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="var">p</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <span class="id" title="lemma">lift_mkApps</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a name="lift_dearg"><span class="id" title="lemma">lift_dearg</span></a> <span class="id" title="var">n</span> <span class="id" title="var">k</span> <span class="id" title="var">t</span> :<br/>
&nbsp;&nbsp;<span class="id" title="definition">lift</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#n"><span class="id" title="variable">n</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#k"><span class="id" title="variable">k</span></a> (<a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#dearg"><span class="id" title="abbreviation">dearg</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#t"><span class="id" title="variable">t</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#dearg"><span class="id" title="abbreviation">dearg</span></a> (<span class="id" title="definition">lift</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#n"><span class="id" title="variable">n</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#k"><span class="id" title="variable">k</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#t"><span class="id" title="variable">t</span></a>).<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">apply</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#lift_dearg_aux"><span class="id" title="lemma">lift_dearg_aux</span></a>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a name="is_dead_lift_other"><span class="id" title="lemma">is_dead_lift_other</span></a> <span class="id" title="var">k</span> <span class="id" title="var">k'</span> <span class="id" title="var">n</span> <span class="id" title="var">t</span> :<br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#k"><span class="id" title="variable">k</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Peano.html#00fe0eaf5e6949f0a31725357afa4bba"><span class="id" title="notation">&lt;</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#k'"><span class="id" title="variable">k'</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Extraction.Optimize.html#is_dead"><span class="id" title="definition">is_dead</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#k"><span class="id" title="variable">k</span></a> (<span class="id" title="definition">lift</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#n"><span class="id" title="variable">n</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#k'"><span class="id" title="variable">k'</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#t"><span class="id" title="variable">t</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="ConCert.Extraction.Optimize.html#is_dead"><span class="id" title="definition">is_dead</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#k"><span class="id" title="variable">k</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#t"><span class="id" title="variable">t</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">lt</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">t</span> <span class="id" title="keyword">using</span> <span class="id" title="lemma">term_forall_list_ind</span> <span class="id" title="tactic">in</span> <span class="id" title="var">t</span>, <span class="id" title="var">k</span>, <span class="id" title="var">k'</span>, <span class="id" title="var">lt</span> |- *; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;- <span class="id" title="var">easy</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">repeat</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="tactic">try</span> <span class="id" title="tactic">destruct</span> (<span class="id" title="var">_</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Arith.PeanoNat.html#0f31f5c1c6b6a21a3a187247222bc9e4"><span class="id" title="notation">&lt;=?</span></a> <span class="id" title="var">_</span>) <span class="id" title="var">eqn</span>:?; <span class="id" title="var">propify</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">try</span> <span class="id" title="tactic">destruct</span> (<span class="id" title="var">_</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Arith.PeanoNat.html#ad2ec4e405f68c46c0a176e3e94ae2e3"><span class="id" title="notation">=?</span></a> <span class="id" title="var">_</span>) <span class="id" title="var">eqn</span>:?; <span class="id" title="var">propify</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">lia</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">easy</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">induction</span> <span class="id" title="var">X</span>; [<span class="id" title="var">easy</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="var">p</span>, <span class="id" title="var">IHX</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="var">IHt</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="var">IHt1</span>, <span class="id" title="var">IHt2</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="var">IHt1</span>, <span class="id" title="var">IHt2</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">easy</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">easy</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">rewrite</span> <span class="id" title="var">IHt</span> <span class="id" title="tactic">by</span> <span class="id" title="var">easy</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">X</span>; [<span class="id" title="var">easy</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="var">p0</span>, <span class="id" title="var">IHX</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="var">IHt</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#map_length"><span class="id" title="lemma">map_length</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">X</span> <span class="id" title="tactic">in</span> <span class="id" title="var">X</span>, <span class="id" title="var">m</span>, <span class="id" title="var">k</span>, <span class="id" title="var">k'</span>, <span class="id" title="var">lt</span> |- *; [<span class="id" title="var">easy</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">p</span> <span class="id" title="tactic">by</span> <span class="id" title="var">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- !<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Arith.PeanoNat.html#Nat.add_succ_r"><span class="id" title="lemma">Nat.add_succ_r</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <span class="id" title="var">IHX</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#map_length"><span class="id" title="lemma">map_length</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">X</span> <span class="id" title="tactic">in</span> <span class="id" title="var">X</span>, <span class="id" title="var">m</span>, <span class="id" title="var">k</span>, <span class="id" title="var">k'</span>, <span class="id" title="var">lt</span> |- *; [<span class="id" title="var">easy</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">p</span> <span class="id" title="tactic">by</span> <span class="id" title="var">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- !<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Arith.PeanoNat.html#Nat.add_succ_r"><span class="id" title="lemma">Nat.add_succ_r</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <span class="id" title="var">IHX</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">reflexivity</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a name="is_dead_lift_all"><span class="id" title="lemma">is_dead_lift_all</span></a> <span class="id" title="var">k</span> <span class="id" title="var">k'</span> <span class="id" title="var">n</span> <span class="id" title="var">t</span> :<br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#k"><span class="id" title="variable">k</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Peano.html#cb53cf0ee22c036a03b4a9281c68b5a3"><span class="id" title="notation">&lt;=</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#k'"><span class="id" title="variable">k'</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#k'"><span class="id" title="variable">k'</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Peano.html#00fe0eaf5e6949f0a31725357afa4bba"><span class="id" title="notation">&lt;</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#n"><span class="id" title="variable">n</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Peano.html#0dacc1786c5ba797d47dd85006231633"><span class="id" title="notation">+</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#k"><span class="id" title="variable">k</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Extraction.Optimize.html#is_dead"><span class="id" title="definition">is_dead</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#k'"><span class="id" title="variable">k'</span></a> (<span class="id" title="definition">lift</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#n"><span class="id" title="variable">n</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#k"><span class="id" title="variable">k</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#t"><span class="id" title="variable">t</span></a>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">l1</span> <span class="id" title="var">l2</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">t</span> <span class="id" title="keyword">using</span> <span class="id" title="lemma">term_forall_list_ind</span> <span class="id" title="tactic">in</span> <span class="id" title="var">t</span>, <span class="id" title="var">n</span>, <span class="id" title="var">k</span>, <span class="id" title="var">k'</span>, <span class="id" title="var">l1</span>, <span class="id" title="var">l2</span> |- *; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">destruct</span> (<span class="id" title="var">_</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Arith.PeanoNat.html#0f31f5c1c6b6a21a3a187247222bc9e4"><span class="id" title="notation">&lt;=?</span></a> <span class="id" title="var">_</span>) <span class="id" title="var">eqn</span>:?; <span class="id" title="var">cbn</span>; <span class="id" title="var">propify</span>; <span class="id" title="var">lia</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">induction</span> <span class="id" title="var">X</span>; [<span class="id" title="var">easy</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="var">p</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="var">IHt</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="var">IHt1</span>, <span class="id" title="var">IHt2</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="var">IHt1</span>, <span class="id" title="var">IHt2</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">rewrite</span> <span class="id" title="var">IHt</span> <span class="id" title="tactic">by</span> <span class="id" title="var">easy</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">clear</span> <span class="id" title="var">IHt</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">X</span>; [<span class="id" title="var">easy</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="var">p0</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#map_length"><span class="id" title="lemma">map_length</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">X</span> <span class="id" title="tactic">in</span> <span class="id" title="var">X</span>, <span class="id" title="var">m</span>, <span class="id" title="var">k</span>, <span class="id" title="var">k'</span>, <span class="id" title="var">n</span>, <span class="id" title="var">l1</span>, <span class="id" title="var">l2</span> |- *; [<span class="id" title="var">easy</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">p</span> <span class="id" title="tactic">by</span> <span class="id" title="var">easy</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- !<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Arith.PeanoNat.html#Nat.add_succ_r"><span class="id" title="lemma">Nat.add_succ_r</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <span class="id" title="var">IHX</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#map_length"><span class="id" title="lemma">map_length</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">X</span> <span class="id" title="tactic">in</span> <span class="id" title="var">X</span>, <span class="id" title="var">m</span>, <span class="id" title="var">k</span>, <span class="id" title="var">k'</span>, <span class="id" title="var">n</span>, <span class="id" title="var">l1</span>, <span class="id" title="var">l2</span> |- *; [<span class="id" title="var">easy</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">p</span> <span class="id" title="tactic">by</span> <span class="id" title="var">easy</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- !<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Arith.PeanoNat.html#Nat.add_succ_r"><span class="id" title="lemma">Nat.add_succ_r</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <span class="id" title="var">IHX</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a name="is_dead_subst_other"><span class="id" title="lemma">is_dead_subst_other</span></a> <span class="id" title="var">k</span> <span class="id" title="var">k'</span> <span class="id" title="var">s</span> <span class="id" title="var">t</span> :<br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#k"><span class="id" title="variable">k</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Peano.html#00fe0eaf5e6949f0a31725357afa4bba"><span class="id" title="notation">&lt;</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#k'"><span class="id" title="variable">k'</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Extraction.Optimize.html#is_dead"><span class="id" title="definition">is_dead</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#k"><span class="id" title="variable">k</span></a> (<span class="id" title="definition">subst</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#s"><span class="id" title="variable">s</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#k'"><span class="id" title="variable">k'</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#t"><span class="id" title="variable">t</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="ConCert.Extraction.Optimize.html#is_dead"><span class="id" title="definition">is_dead</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#k"><span class="id" title="variable">k</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#t"><span class="id" title="variable">t</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">lt</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">t</span> <span class="id" title="tactic">in</span> <span class="id" title="var">t</span>, <span class="id" title="var">k</span>, <span class="id" title="var">k'</span>, <span class="id" title="var">lt</span> |- * <span class="id" title="keyword">using</span> <span class="id" title="lemma">term_forall_list_ind</span>; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">destruct</span> (<span class="id" title="var">_</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Arith.PeanoNat.html#0f31f5c1c6b6a21a3a187247222bc9e4"><span class="id" title="notation">&lt;=?</span></a> <span class="id" title="var">_</span>) <span class="id" title="var">eqn</span>:?, (<span class="id" title="var">_</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Arith.PeanoNat.html#ad2ec4e405f68c46c0a176e3e94ae2e3"><span class="id" title="notation">=?</span></a> <span class="id" title="var">_</span>) <span class="id" title="var">eqn</span>:?; <span class="id" title="var">propify</span>; <span class="id" title="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">destruct</span> (<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#nth_error"><span class="id" title="definition">nth_error</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span>) <span class="id" title="var">eqn</span>:<span class="id" title="var">nth</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#is_dead_lift_all"><span class="id" title="lemma">is_dead_lift_all</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<span class="id" title="var">_</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Arith.PeanoNat.html#ad2ec4e405f68c46c0a176e3e94ae2e3"><span class="id" title="notation">=?</span></a> <span class="id" title="var">_</span>) <span class="id" title="var">eqn</span>:?; <span class="id" title="var">propify</span>; [|<span class="id" title="var">easy</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#nth_error_None"><span class="id" title="lemma">nth_error_None</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">nth</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Arith.PeanoNat.html#Nat.eqb_refl"><span class="id" title="lemma">Nat.eqb_refl</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">propify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">lia</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">induction</span> <span class="id" title="var">X</span>; [<span class="id" title="var">easy</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="var">p</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="var">IHt</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="var">IHt1</span>, <span class="id" title="var">IHt2</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="var">IHt1</span>, <span class="id" title="var">IHt2</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">rewrite</span> <span class="id" title="var">IHt</span> <span class="id" title="tactic">by</span> <span class="id" title="var">easy</span>; <span class="id" title="var">cbn</span>; <span class="id" title="tactic">clear</span> <span class="id" title="var">IHt</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">X</span>; [<span class="id" title="var">easy</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="var">p0</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#map_length"><span class="id" title="lemma">map_length</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">X</span> <span class="id" title="tactic">in</span> <span class="id" title="var">X</span>, <span class="id" title="var">m</span>, <span class="id" title="var">k</span>, <span class="id" title="var">k'</span>, <span class="id" title="var">lt</span> |- *; [<span class="id" title="var">easy</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">p</span> <span class="id" title="tactic">by</span> <span class="id" title="var">easy</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- !<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Arith.PeanoNat.html#Nat.add_succ_r"><span class="id" title="lemma">Nat.add_succ_r</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <span class="id" title="var">IHX</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#map_length"><span class="id" title="lemma">map_length</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">X</span> <span class="id" title="tactic">in</span> <span class="id" title="var">X</span>, <span class="id" title="var">m</span>, <span class="id" title="var">k</span>, <span class="id" title="var">k'</span>, <span class="id" title="var">lt</span> |- *; [<span class="id" title="var">easy</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">p</span> <span class="id" title="tactic">by</span> <span class="id" title="var">easy</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- !<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Arith.PeanoNat.html#Nat.add_succ_r"><span class="id" title="lemma">Nat.add_succ_r</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <span class="id" title="var">IHX</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a name="valid_dearg_mask_lift"><span class="id" title="lemma">valid_dearg_mask_lift</span></a> <span class="id" title="var">mask</span> <span class="id" title="var">n</span> <span class="id" title="var">k</span> <span class="id" title="var">t</span> :<br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Extraction.Optimize.html#valid_dearg_mask"><span class="id" title="definition">valid_dearg_mask</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#mask"><span class="id" title="variable">mask</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#t"><span class="id" title="variable">t</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Extraction.Optimize.html#valid_dearg_mask"><span class="id" title="definition">valid_dearg_mask</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#mask"><span class="id" title="variable">mask</span></a> (<span class="id" title="definition">lift</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#n"><span class="id" title="variable">n</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#k"><span class="id" title="variable">k</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#t"><span class="id" title="variable">t</span></a>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">valid</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">t</span> <span class="id" title="tactic">in</span> <span class="id" title="var">mask</span>, <span class="id" title="var">n</span>, <span class="id" title="var">k</span>, <span class="id" title="var">t</span>, <span class="id" title="var">valid</span> |- *; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *; <span class="id" title="tactic">try</span> <span class="id" title="var">easy</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">destruct</span> <span class="id" title="var">mask</span>; [|<span class="id" title="var">easy</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#valid_dearg_mask_nil"><span class="id" title="lemma">valid_dearg_mask_nil</span></a>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">destruct</span> <span class="id" title="var">mask</span>; [<span class="id" title="var">easy</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">b</span>; [|<span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <span class="id" title="var">IHt</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">propify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#is_dead_lift_other"><span class="id" title="lemma">is_dead_lift_other</span></a> <span class="id" title="tactic">by</span> <span class="id" title="var">easy</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a name="valid_dearg_mask_subst"><span class="id" title="lemma">valid_dearg_mask_subst</span></a> <span class="id" title="var">mask</span> <span class="id" title="var">s</span> <span class="id" title="var">k</span> <span class="id" title="var">t</span> :<br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Extraction.Optimize.html#valid_dearg_mask"><span class="id" title="definition">valid_dearg_mask</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#mask"><span class="id" title="variable">mask</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#t"><span class="id" title="variable">t</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Extraction.Optimize.html#valid_dearg_mask"><span class="id" title="definition">valid_dearg_mask</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#mask"><span class="id" title="variable">mask</span></a> (<span class="id" title="definition">subst</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#s"><span class="id" title="variable">s</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#k"><span class="id" title="variable">k</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#t"><span class="id" title="variable">t</span></a>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">valid</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">t</span> <span class="id" title="tactic">in</span> <span class="id" title="var">mask</span>, <span class="id" title="var">k</span>, <span class="id" title="var">t</span>, <span class="id" title="var">valid</span> |- *; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *; <span class="id" title="tactic">try</span> <span class="id" title="var">easy</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">destruct</span> <span class="id" title="var">mask</span>; [|<span class="id" title="var">easy</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#valid_dearg_mask_nil"><span class="id" title="lemma">valid_dearg_mask_nil</span></a>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">destruct</span> <span class="id" title="var">mask</span>; [<span class="id" title="var">easy</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">b</span>; [|<span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <span class="id" title="var">IHt</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">propify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#is_dead_subst_other"><span class="id" title="lemma">is_dead_subst_other</span></a> <span class="id" title="tactic">by</span> <span class="id" title="var">easy</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a name="subst_dearg_lambdas"><span class="id" title="lemma">subst_dearg_lambdas</span></a> <span class="id" title="var">s</span> <span class="id" title="var">k</span> <span class="id" title="var">mask</span> <span class="id" title="var">t</span> :<br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Extraction.Optimize.html#valid_dearg_mask"><span class="id" title="definition">valid_dearg_mask</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#mask"><span class="id" title="variable">mask</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#t"><span class="id" title="variable">t</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<span class="id" title="definition">subst</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#s"><span class="id" title="variable">s</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#k"><span class="id" title="variable">k</span></a> (<a class="idref" href="ConCert.Extraction.Optimize.html#dearg_lambdas"><span class="id" title="definition">dearg_lambdas</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#mask"><span class="id" title="variable">mask</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#t"><span class="id" title="variable">t</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="ConCert.Extraction.Optimize.html#dearg_lambdas"><span class="id" title="definition">dearg_lambdas</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#mask"><span class="id" title="variable">mask</span></a> (<span class="id" title="definition">subst</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#s"><span class="id" title="variable">s</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#k"><span class="id" title="variable">k</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#t"><span class="id" title="variable">t</span></a>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">valid</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">t</span> <span class="id" title="tactic">in</span> <span class="id" title="var">k</span>, <span class="id" title="var">mask</span>, <span class="id" title="var">t</span>, <span class="id" title="var">valid</span> |- *; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *; <span class="id" title="tactic">try</span> <span class="id" title="var">easy</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">destruct</span> <span class="id" title="var">mask</span>; [|<span class="id" title="var">easy</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#dearg_lambdas_nil"><span class="id" title="lemma">dearg_lambdas_nil</span></a>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">destruct</span> <span class="id" title="var">mask</span> <span class="id" title="keyword">as</span> [|[] <span class="id" title="var">mask</span>]; [<span class="id" title="var">easy</span>| |]; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *; <span class="id" title="var">propify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">unfold</span> <span class="id" title="definition">subst1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">distr_subst</span>, <span class="id" title="var">IHt</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="var">IHt</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="var">IHt2</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a name="subst_dearg_case"><span class="id" title="lemma">subst_dearg_case</span></a> <span class="id" title="var">s</span> <span class="id" title="var">k</span> <span class="id" title="var">ind</span> <span class="id" title="var">c</span> <span class="id" title="var">discr</span> <span class="id" title="var">brs</span> :<br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#valid_case_masks"><span class="id" title="abbreviation">valid_case_masks</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#ind"><span class="id" title="variable">ind</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#c"><span class="id" title="variable">c</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#brs"><span class="id" title="variable">brs</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<span class="id" title="definition">subst</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#s"><span class="id" title="variable">s</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#k"><span class="id" title="variable">k</span></a> (<a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#dearg_case"><span class="id" title="abbreviation">dearg_case</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#ind"><span class="id" title="variable">ind</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#c"><span class="id" title="variable">c</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#discr"><span class="id" title="variable">discr</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#brs"><span class="id" title="variable">brs</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#dearg_case"><span class="id" title="abbreviation">dearg_case</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#ind"><span class="id" title="variable">ind</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#c"><span class="id" title="variable">c</span></a> (<span class="id" title="definition">subst</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#s"><span class="id" title="variable">s</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#k"><span class="id" title="variable">k</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#discr"><span class="id" title="variable">discr</span></a>) (<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#map"><span class="id" title="definition">map</span></a> (<span class="id" title="definition">on_snd</span> (<span class="id" title="definition">subst</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#s"><span class="id" title="variable">s</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#k"><span class="id" title="variable">k</span></a>)) <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#brs"><span class="id" title="variable">brs</span></a>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">valid</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">dearg_case</span>, <span class="id" title="var">valid_case_masks</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#get_mib_masks"><span class="id" title="abbreviation">get_mib_masks</span></a> <span class="id" title="var">_</span>) <span class="id" title="keyword">as</span> [<span class="id" title="var">masks</span>|]; [|<span class="id" title="var">easy</span>].<br/>
&nbsp;&nbsp;<span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">map_mapi</span>, <span class="id" title="lemma">mapi_map</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">propify</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">valid</span> <span class="id" title="keyword">as</span> (? &amp; <span class="id" title="var">valid</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <span class="id" title="lemma">Alli_mapi_spec</span>; [<span class="id" title="tactic">apply</span> <a class="idref" href="ConCert.Extraction.Utils.html#alli_Alli"><span class="id" title="lemma">alli_Alli</span></a>; <span class="id" title="var">eassumption</span>|].<br/>
&nbsp;&nbsp;<span class="id" title="tactic">clear</span> <span class="id" title="var">valid</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> ? [] <span class="id" title="var">valid</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="ConCert.Extraction.Optimize.html#dearg_case_branch"><span class="id" title="definition">dearg_case_branch</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">propify</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#subst_dearg_lambdas"><span class="id" title="lemma">subst_dearg_lambdas</span></a>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a name="dearg_single_enough_args"><span class="id" title="lemma">dearg_single_enough_args</span></a> <span class="id" title="var">mask</span> <span class="id" title="var">t</span> <span class="id" title="var">args</span> :<br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Extraction.Optimize.html#dearg_single"><span class="id" title="definition">dearg_single</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#mask"><span class="id" title="variable">mask</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#t"><span class="id" title="variable">t</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#args"><span class="id" title="variable">args</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a><br/>
&nbsp;&nbsp;<span class="id" title="definition">mkApps</span> (<a class="idref" href="ConCert.Extraction.Optimize.html#dearg_single"><span class="id" title="definition">dearg_single</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#mask"><span class="id" title="variable">mask</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#t"><span class="id" title="variable">t</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#firstn"><span class="id" title="definition">firstn</span></a> <span class="id" title="notation">#|</span><a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#mask"><span class="id" title="variable">mask</span></a><span class="id" title="notation">|</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#args"><span class="id" title="variable">args</span></a>)) (<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#skipn"><span class="id" title="definition">skipn</span></a> <span class="id" title="notation">#|</span><a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#mask"><span class="id" title="variable">mask</span></a><span class="id" title="notation">|</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#args"><span class="id" title="variable">args</span></a>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">mask</span> <span class="id" title="keyword">as</span> [|<span class="id" title="var">b</span> <span class="id" title="var">mask</span> <span class="id" title="var">IH</span>] <span class="id" title="tactic">in</span> <span class="id" title="var">mask</span>, <span class="id" title="var">t</span>, <span class="id" title="var">args</span> |- *; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;- <span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">skipn_0</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">destruct</span> <span class="id" title="var">args</span> <span class="id" title="keyword">as</span> [|<span class="id" title="var">a</span> <span class="id" title="var">args</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">skipn_nil</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#skipn_cons"><span class="id" title="lemma">skipn_cons</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">b</span>; <span class="id" title="tactic">apply</span> <span class="id" title="var">IH</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a name="dearg_expanded_aux"><span class="id" title="lemma">dearg_expanded_aux</span></a> <span class="id" title="var">k</span> <span class="id" title="var">t</span> <span class="id" title="var">args</span> :<br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#is_expanded_aux"><span class="id" title="abbreviation">is_expanded_aux</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#k"><span class="id" title="variable">k</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#t"><span class="id" title="variable">t</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#dearg_aux"><span class="id" title="abbreviation">dearg_aux</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#args"><span class="id" title="variable">args</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#t"><span class="id" title="variable">t</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <span class="id" title="definition">mkApps</span> (<a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#dearg_aux"><span class="id" title="abbreviation">dearg_aux</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#firstn"><span class="id" title="definition">firstn</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#k"><span class="id" title="variable">k</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#args"><span class="id" title="variable">args</span></a>) <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#t"><span class="id" title="variable">t</span></a>) (<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#skipn"><span class="id" title="definition">skipn</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#k"><span class="id" title="variable">k</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#args"><span class="id" title="variable">args</span></a>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">expanded</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">t</span> <span class="id" title="tactic">in</span> <span class="id" title="var">k</span>, <span class="id" title="var">t</span>, <span class="id" title="var">args</span>, <span class="id" title="var">expanded</span> |- * <span class="id" title="keyword">using</span> <span class="id" title="lemma">term_forall_list_ind</span>; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">refold'</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">try</span> <span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">mkApps_nested</span>, <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#firstn_skipn"><span class="id" title="lemma">firstn_skipn</span></a>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">propify</span>; <span class="id" title="tactic">intuition</span> <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="var">erewrite</span> <span class="id" title="var">IHt1</span> <span class="id" title="tactic">by</span> <span class="id" title="var">eassumption</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">propify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">symmetry</span>; <span class="id" title="tactic">rewrite</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#dearg_single_enough_args"><span class="id" title="lemma">dearg_single_enough_args</span></a>; <span class="id" title="tactic">symmetry</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">mkApps_nested</span>, <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#firstn_firstn"><span class="id" title="lemma">firstn_firstn</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">replace</span> (<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Nat.html#min"><span class="id" title="definition">Init.Nat.min</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span>) <span class="id" title="keyword">with</span> <span class="id" title="notation">#|</span><a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#get_const_mask"><span class="id" title="abbreviation">get_const_mask</span></a> <span class="id" title="var">s</span><span class="id" title="notation">|</span> <span class="id" title="tactic">by</span> <span class="id" title="var">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#dearg_single_enough_args"><span class="id" title="lemma">dearg_single_enough_args</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <a class="idref" href="ConCert.Extraction.Utils.html#skipn_firstn_slice"><span class="id" title="lemma">skipn_firstn_slice</span></a> <span class="id" title="tactic">by</span> <span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">propify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">symmetry</span>; <span class="id" title="tactic">rewrite</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#dearg_single_enough_args"><span class="id" title="lemma">dearg_single_enough_args</span></a>; <span class="id" title="tactic">symmetry</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">mkApps_nested</span>, <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#firstn_firstn"><span class="id" title="lemma">firstn_firstn</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">replace</span> (<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Nat.html#min"><span class="id" title="definition">Init.Nat.min</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span>) <span class="id" title="keyword">with</span> <span class="id" title="notation">#|</span><a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#get_ctor_mask"><span class="id" title="abbreviation">get_ctor_mask</span></a> <span class="id" title="var">i</span> <span class="id" title="var">n</span><span class="id" title="notation">|</span> <span class="id" title="tactic">by</span> <span class="id" title="var">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#dearg_single_enough_args"><span class="id" title="lemma">dearg_single_enough_args</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <a class="idref" href="ConCert.Extraction.Utils.html#skipn_firstn_slice"><span class="id" title="lemma">skipn_firstn_slice</span></a> <span class="id" title="tactic">by</span> <span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">destruct</span> <span class="id" title="var">p</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">mkApps_nested</span>, <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#firstn_skipn"><span class="id" title="lemma">firstn_skipn</span></a>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">destruct</span> <span class="id" title="var">s</span> <span class="id" title="keyword">as</span> ((<span class="id" title="var">ind</span> &amp; <span class="id" title="var">c</span>) &amp; <span class="id" title="var">npars</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">mkApps_nested</span>, <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#firstn_skipn"><span class="id" title="lemma">firstn_skipn</span></a>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a name="dearg_expanded"><span class="id" title="lemma">dearg_expanded</span></a> <span class="id" title="var">t</span> <span class="id" title="var">args</span> :<br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#is_expanded"><span class="id" title="abbreviation">is_expanded</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#t"><span class="id" title="variable">t</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#dearg_aux"><span class="id" title="abbreviation">dearg_aux</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#args"><span class="id" title="variable">args</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#t"><span class="id" title="variable">t</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <span class="id" title="definition">mkApps</span> (<a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#dearg"><span class="id" title="abbreviation">dearg</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#t"><span class="id" title="variable">t</span></a>) <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#args"><span class="id" title="variable">args</span></a>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">apply</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#dearg_expanded_aux"><span class="id" title="lemma">dearg_expanded_aux</span></a>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a name="is_expanded_aux_lift"><span class="id" title="lemma">is_expanded_aux_lift</span></a> <span class="id" title="var">k</span> <span class="id" title="var">n</span> <span class="id" title="var">k'</span> <span class="id" title="var">t</span> :<br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#is_expanded_aux"><span class="id" title="abbreviation">is_expanded_aux</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#k"><span class="id" title="variable">k</span></a> (<span class="id" title="definition">lift</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#n"><span class="id" title="variable">n</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#k'"><span class="id" title="variable">k'</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#t"><span class="id" title="variable">t</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#is_expanded_aux"><span class="id" title="abbreviation">is_expanded_aux</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#k"><span class="id" title="variable">k</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#t"><span class="id" title="variable">t</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">t</span> <span class="id" title="tactic">in</span> <span class="id" title="var">n</span>, <span class="id" title="var">k</span>, <span class="id" title="var">k'</span>, <span class="id" title="var">t</span> |- * <span class="id" title="keyword">using</span> <span class="id" title="lemma">term_forall_list_ind</span>; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">now</span> <span class="id" title="tactic">destruct</span> (<span class="id" title="var">_</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Arith.PeanoNat.html#0f31f5c1c6b6a21a3a187247222bc9e4"><span class="id" title="notation">&lt;=?</span></a> <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">induction</span> <span class="id" title="var">X</span>; [<span class="id" title="var">easy</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="var">p</span>, <span class="id" title="var">IHX</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="var">IHt1</span>, <span class="id" title="var">IHt2</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="var">IHt1</span>, <span class="id" title="var">IHt2</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">rewrite</span> <span class="id" title="var">IHt</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">X</span>; [<span class="id" title="var">easy</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="var">p0</span>, <span class="id" title="var">IHX</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">induction</span> <span class="id" title="var">X</span> <span class="id" title="tactic">in</span> <span class="id" title="var">k'</span> |- *; [<span class="id" title="var">easy</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Arith.PeanoNat.html#Nat.add_succ_r"><span class="id" title="lemma">Nat.add_succ_r</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="var">p</span>, <span class="id" title="var">IHX</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">induction</span> <span class="id" title="var">X</span> <span class="id" title="tactic">in</span> <span class="id" title="var">k'</span> |- *; [<span class="id" title="var">easy</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Arith.PeanoNat.html#Nat.add_succ_r"><span class="id" title="lemma">Nat.add_succ_r</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="var">p</span>, <span class="id" title="var">IHX</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a name="is_expanded_lift"><span class="id" title="lemma">is_expanded_lift</span></a> <span class="id" title="var">n</span> <span class="id" title="var">k</span> <span class="id" title="var">t</span> :<br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#is_expanded"><span class="id" title="abbreviation">is_expanded</span></a> (<span class="id" title="definition">lift</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#n"><span class="id" title="variable">n</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#k"><span class="id" title="variable">k</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#t"><span class="id" title="variable">t</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#is_expanded"><span class="id" title="abbreviation">is_expanded</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#t"><span class="id" title="variable">t</span></a>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">apply</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#is_expanded_aux_lift"><span class="id" title="lemma">is_expanded_aux_lift</span></a>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a name="is_dead_mkApps"><span class="id" title="lemma">is_dead_mkApps</span></a> <span class="id" title="var">k</span> <span class="id" title="var">t</span> <span class="id" title="var">args</span> :<br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Extraction.Optimize.html#is_dead"><span class="id" title="definition">is_dead</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#k"><span class="id" title="variable">k</span></a> (<span class="id" title="definition">mkApps</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#t"><span class="id" title="variable">t</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#args"><span class="id" title="variable">args</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="ConCert.Extraction.Optimize.html#is_dead"><span class="id" title="definition">is_dead</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#k"><span class="id" title="variable">k</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#t"><span class="id" title="variable">t</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#9ddeac0ab66152bd1d64bedb507a795e"><span class="id" title="notation">&amp;&amp;</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#forallb"><span class="id" title="definition">forallb</span></a> (<a class="idref" href="ConCert.Extraction.Optimize.html#is_dead"><span class="id" title="definition">is_dead</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#k"><span class="id" title="variable">k</span></a>) <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#args"><span class="id" title="variable">args</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">args</span> <span class="id" title="keyword">using</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#rev_ind"><span class="id" title="lemma">List.rev_ind</span></a>; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;- <span class="id" title="var">now</span> <span class="id" title="var">btauto</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">mkApps_app</span>, <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#forallb_app"><span class="id" title="lemma">forallb_app</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">IHargs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="var">btauto</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a name="is_dead_lift"><span class="id" title="lemma">is_dead_lift</span></a> <span class="id" title="var">k</span> <span class="id" title="var">k'</span> <span class="id" title="var">n</span> <span class="id" title="var">t</span> :<br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#k'"><span class="id" title="variable">k'</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Peano.html#cb53cf0ee22c036a03b4a9281c68b5a3"><span class="id" title="notation">&lt;=</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#k"><span class="id" title="variable">k</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#n"><span class="id" title="variable">n</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Peano.html#0dacc1786c5ba797d47dd85006231633"><span class="id" title="notation">+</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#k'"><span class="id" title="variable">k'</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Peano.html#cb53cf0ee22c036a03b4a9281c68b5a3"><span class="id" title="notation">&lt;=</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#k"><span class="id" title="variable">k</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Extraction.Optimize.html#is_dead"><span class="id" title="definition">is_dead</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#k"><span class="id" title="variable">k</span></a> (<span class="id" title="definition">lift</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#n"><span class="id" title="variable">n</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#k'"><span class="id" title="variable">k'</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#t"><span class="id" title="variable">t</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="ConCert.Extraction.Optimize.html#is_dead"><span class="id" title="definition">is_dead</span></a> (<a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#k"><span class="id" title="variable">k</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Peano.html#7825ccc99f23b0d30c9d40c317ba7af0"><span class="id" title="notation">-</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#n"><span class="id" title="variable">n</span></a>) <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#t"><span class="id" title="variable">t</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">l1</span> <span class="id" title="var">l2</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">t</span> <span class="id" title="tactic">in</span> <span class="id" title="var">k</span>, <span class="id" title="var">k'</span>, <span class="id" title="var">n</span>, <span class="id" title="var">t</span>, <span class="id" title="var">l1</span>, <span class="id" title="var">l2</span> |- * <span class="id" title="keyword">using</span> <span class="id" title="lemma">term_forall_list_ind</span>; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">repeat</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="tactic">try</span> <span class="id" title="tactic">destruct</span> (<span class="id" title="var">_</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Arith.PeanoNat.html#0f31f5c1c6b6a21a3a187247222bc9e4"><span class="id" title="notation">&lt;=?</span></a> <span class="id" title="var">_</span>) <span class="id" title="var">eqn</span>:?; <span class="id" title="var">propify</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">try</span> <span class="id" title="tactic">destruct</span> (<span class="id" title="var">_</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Arith.PeanoNat.html#ad2ec4e405f68c46c0a176e3e94ae2e3"><span class="id" title="notation">=?</span></a> <span class="id" title="var">_</span>) <span class="id" title="var">eqn</span>:?; <span class="id" title="var">propify</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">lia</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">induction</span> <span class="id" title="var">X</span>; [<span class="id" title="var">easy</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="var">p</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="var">IHt</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="var">IHt1</span>, <span class="id" title="var">IHt2</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="var">IHt1</span>, <span class="id" title="var">IHt2</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">rewrite</span> <span class="id" title="var">IHt</span> <span class="id" title="tactic">by</span> <span class="id" title="var">easy</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">X</span>; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *; [<span class="id" title="var">easy</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="var">p0</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#map_length"><span class="id" title="lemma">map_length</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">X</span> <span class="id" title="tactic">in</span> <span class="id" title="var">X</span>, <span class="id" title="var">m</span>, <span class="id" title="var">k</span>, <span class="id" title="var">k'</span>, <span class="id" title="var">n</span>, <span class="id" title="var">l1</span>, <span class="id" title="var">l2</span> |- *; [<span class="id" title="var">easy</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">p</span> <span class="id" title="tactic">by</span> <span class="id" title="var">easy</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- !<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Arith.PeanoNat.html#Nat.add_succ_r"><span class="id" title="lemma">Nat.add_succ_r</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">IHX</span> <span class="id" title="tactic">by</span> <span class="id" title="var">easy</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">replace</span> (<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#S"><span class="id" title="constructor">S</span></a> (<span class="id" title="var">k</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Peano.html#7825ccc99f23b0d30c9d40c317ba7af0"><span class="id" title="notation">-</span></a> <span class="id" title="var">n</span>)) <span class="id" title="keyword">with</span> (<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#S"><span class="id" title="constructor">S</span></a> <span class="id" title="var">k</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Peano.html#7825ccc99f23b0d30c9d40c317ba7af0"><span class="id" title="notation">-</span></a> <span class="id" title="var">n</span>) <span class="id" title="tactic">by</span> <span class="id" title="var">lia</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#map_length"><span class="id" title="lemma">map_length</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">X</span> <span class="id" title="tactic">in</span> <span class="id" title="var">X</span>, <span class="id" title="var">m</span>, <span class="id" title="var">k</span>, <span class="id" title="var">k'</span>, <span class="id" title="var">n</span>, <span class="id" title="var">l1</span>, <span class="id" title="var">l2</span> |- *; [<span class="id" title="var">easy</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">p</span> <span class="id" title="tactic">by</span> <span class="id" title="var">easy</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- !<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Arith.PeanoNat.html#Nat.add_succ_r"><span class="id" title="lemma">Nat.add_succ_r</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">IHX</span> <span class="id" title="tactic">by</span> <span class="id" title="var">easy</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">replace</span> (<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#S"><span class="id" title="constructor">S</span></a> (<span class="id" title="var">k</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Peano.html#7825ccc99f23b0d30c9d40c317ba7af0"><span class="id" title="notation">-</span></a> <span class="id" title="var">n</span>)) <span class="id" title="keyword">with</span> (<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#S"><span class="id" title="constructor">S</span></a> <span class="id" title="var">k</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Peano.html#7825ccc99f23b0d30c9d40c317ba7af0"><span class="id" title="notation">-</span></a> <span class="id" title="var">n</span>) <span class="id" title="tactic">by</span> <span class="id" title="var">lia</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a name="is_dead_dearg_single"><span class="id" title="lemma">is_dead_dearg_single</span></a> <span class="id" title="var">k</span> <span class="id" title="var">mask</span> <span class="id" title="var">t</span> <span class="id" title="var">args</span> :<br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Extraction.Optimize.html#is_dead"><span class="id" title="definition">is_dead</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#k"><span class="id" title="variable">k</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#t"><span class="id" title="variable">t</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#Forall"><span class="id" title="inductive">Forall</span></a> (<a class="idref" href="ConCert.Extraction.Optimize.html#is_dead"><span class="id" title="definition">is_dead</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#k"><span class="id" title="variable">k</span></a>) <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#args"><span class="id" title="variable">args</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Extraction.Optimize.html#is_dead"><span class="id" title="definition">is_dead</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#k"><span class="id" title="variable">k</span></a> (<a class="idref" href="ConCert.Extraction.Optimize.html#dearg_single"><span class="id" title="definition">dearg_single</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#mask"><span class="id" title="variable">mask</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#t"><span class="id" title="variable">t</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#args"><span class="id" title="variable">args</span></a>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">no_use</span> <span class="id" title="var">args_no_use</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">mask</span> <span class="id" title="keyword">as</span> [|[] <span class="id" title="var">mask</span> <span class="id" title="var">IH</span>] <span class="id" title="tactic">in</span> <span class="id" title="var">k</span>, <span class="id" title="var">mask</span>, <span class="id" title="var">t</span>, <span class="id" title="var">args</span>, <span class="id" title="var">no_use</span>, <span class="id" title="var">args_no_use</span> |- *; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">rewrite</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#is_dead_mkApps"><span class="id" title="lemma">is_dead_mkApps</span></a>, <span class="id" title="var">no_use</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <span class="id" title="lemma">forallb_Forall</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">destruct</span> <span class="id" title="var">args</span>; <span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">apply</span> <span class="id" title="var">IH</span>; [|<span class="id" title="var">easy</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#is_dead_lift"><span class="id" title="lemma">is_dead_lift</span></a> <span class="id" title="tactic">by</span> <span class="id" title="var">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Arith.PeanoNat.html#Nat.sub_0_r"><span class="id" title="lemma">Nat.sub_0_r</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">apply</span> <span class="id" title="var">IH</span>; [<span class="id" title="var">easy</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">inversion</span> <span class="id" title="var">args_no_use</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">destruct</span> <span class="id" title="var">args</span>; <span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">apply</span> <span class="id" title="var">IH</span>; [|<span class="id" title="var">easy</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Bool.Bool.html#andb_true_r"><span class="id" title="lemma">Bool.andb_true_r</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#is_dead_lift"><span class="id" title="lemma">is_dead_lift</span></a> <span class="id" title="tactic">by</span> <span class="id" title="var">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Arith.PeanoNat.html#Nat.sub_0_r"><span class="id" title="lemma">Nat.sub_0_r</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">inversion</span> <span class="id" title="var">args_no_use</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">IH</span>; [|<span class="id" title="var">easy</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="var">propify</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Ltac</span> <span class="id" title="var">bia</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="tactic">repeat</span> (<span class="id" title="tactic">destruct</span> (<a class="idref" href="ConCert.Extraction.Optimize.html#is_dead"><span class="id" title="definition">is_dead</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span>); <span class="id" title="var">cbn</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> ?<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Bool.Bool.html#orb_true_r"><span class="id" title="lemma">Bool.orb_true_r</span></a>, ?<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Bool.Bool.html#orb_false_r"><span class="id" title="lemma">Bool.orb_false_r</span></a>, ?<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Bool.Bool.html#andb_false_r"><span class="id" title="lemma">Bool.andb_false_r</span></a>; <span class="id" title="tactic">auto</span>).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a name="is_dead_subst"><span class="id" title="lemma">is_dead_subst</span></a> <span class="id" title="var">s</span> <span class="id" title="var">k</span> <span class="id" title="var">k'</span> <span class="id" title="var">t</span> :<br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#k'"><span class="id" title="variable">k'</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Peano.html#cb53cf0ee22c036a03b4a9281c68b5a3"><span class="id" title="notation">&lt;=</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#k"><span class="id" title="variable">k</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Extraction.Optimize.html#is_dead"><span class="id" title="definition">is_dead</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#k"><span class="id" title="variable">k</span></a> (<span class="id" title="definition">subst</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#ddd65c2f7ee73ecec433744948d846bb"><span class="id" title="notation">[</span></a><a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#s"><span class="id" title="variable">s</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#ddd65c2f7ee73ecec433744948d846bb"><span class="id" title="notation">]</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#k'"><span class="id" title="variable">k'</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#t"><span class="id" title="variable">t</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Extraction.Optimize.html#is_dead"><span class="id" title="definition">is_dead</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#S"><span class="id" title="constructor">S</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#k"><span class="id" title="variable">k</span></a>) <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#t"><span class="id" title="variable">t</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#9ddeac0ab66152bd1d64bedb507a795e"><span class="id" title="notation">&amp;&amp;</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#9ddeac0ab66152bd1d64bedb507a795e"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Extraction.Optimize.html#is_dead"><span class="id" title="definition">is_dead</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#k'"><span class="id" title="variable">k'</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#t"><span class="id" title="variable">t</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#081ff67d3116402bb680e8692aa39185"><span class="id" title="notation">||</span></a> <a class="idref" href="ConCert.Extraction.Optimize.html#is_dead"><span class="id" title="definition">is_dead</span></a> (<a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#k"><span class="id" title="variable">k</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Peano.html#7825ccc99f23b0d30c9d40c317ba7af0"><span class="id" title="notation">-</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#k'"><span class="id" title="variable">k'</span></a>) <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#s"><span class="id" title="variable">s</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#9ddeac0ab66152bd1d64bedb507a795e"><span class="id" title="notation">)</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">le</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">t</span> <span class="id" title="tactic">in</span> <span class="id" title="var">t</span>, <span class="id" title="var">k</span>, <span class="id" title="var">k'</span>, <span class="id" title="var">le</span> |- * <span class="id" title="keyword">using</span> <span class="id" title="lemma">term_forall_list_ind</span>; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">destruct</span> (<span class="id" title="var">_</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Arith.PeanoNat.html#0f31f5c1c6b6a21a3a187247222bc9e4"><span class="id" title="notation">&lt;=?</span></a> <span class="id" title="var">_</span>) <span class="id" title="var">eqn</span>:?; <span class="id" title="var">propify</span>; <span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">destruct</span> (<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#nth_error"><span class="id" title="definition">nth_error</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span>) <span class="id" title="var">eqn</span>:<span class="id" title="var">nth</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="tactic">replace</span> <span class="id" title="var">n</span> <span class="id" title="keyword">with</span> <span class="id" title="var">k'</span> <span class="id" title="tactic">in</span> * <span class="id" title="tactic">by</span> (<span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <span class="id" title="lemma">nth_error_Some_length</span> <span class="id" title="tactic">in</span> <span class="id" title="var">nth</span>; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> * ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Arith.PeanoNat.html#Nat.sub_diag"><span class="id" title="lemma">Nat.sub_diag</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">nth</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">noconf</span> <span class="id" title="var">nth</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Arith.PeanoNat.html#Nat.eqb_refl"><span class="id" title="lemma">Nat.eqb_refl</span></a>, (<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#proj2"><span class="id" title="lemma">proj2</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Arith.PeanoNat.html#Nat.eqb_neq"><span class="id" title="lemma">Nat.eqb_neq</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span>)) <span class="id" title="tactic">by</span> <span class="id" title="var">easy</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#is_dead_lift"><span class="id" title="lemma">is_dead_lift</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#nth_error_None"><span class="id" title="lemma">nth_error_None</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">nth</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">repeat</span> (<span class="id" title="tactic">destruct</span> (<span class="id" title="var">_</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Arith.PeanoNat.html#ad2ec4e405f68c46c0a176e3e94ae2e3"><span class="id" title="notation">=?</span></a> <span class="id" title="var">_</span>) <span class="id" title="var">eqn</span>:?; <span class="id" title="var">propify</span>); <span class="id" title="tactic">auto</span>; <span class="id" title="tactic">try</span> <span class="id" title="var">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">destruct</span> (<span class="id" title="var">n</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Arith.PeanoNat.html#ad2ec4e405f68c46c0a176e3e94ae2e3"><span class="id" title="notation">=?</span></a> <span class="id" title="var">k</span>) <span class="id" title="var">eqn</span>:?, (<span class="id" title="var">n</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Arith.PeanoNat.html#ad2ec4e405f68c46c0a176e3e94ae2e3"><span class="id" title="notation">=?</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#S"><span class="id" title="constructor">S</span></a> <span class="id" title="var">k</span>) <span class="id" title="var">eqn</span>:?, (<span class="id" title="var">n</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Arith.PeanoNat.html#ad2ec4e405f68c46c0a176e3e94ae2e3"><span class="id" title="notation">=?</span></a> <span class="id" title="var">k'</span>) <span class="id" title="var">eqn</span>:?; <span class="id" title="var">propify</span>; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *; <span class="id" title="tactic">auto</span>; <span class="id" title="var">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">induction</span> <span class="id" title="var">X</span>; [<span class="id" title="var">easy</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> !<span class="id" title="var">p</span>, !<span class="id" title="var">IHX</span> <span class="id" title="tactic">by</span> <span class="id" title="var">easy</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">bia</span>.<br/>
&nbsp;&nbsp;&nbsp;- <span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="var">IHt</span>.<br/>
&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">rewrite</span> <span class="id" title="var">IHt1</span>, <span class="id" title="var">IHt2</span> <span class="id" title="tactic">by</span> <span class="id" title="var">easy</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">replace</span> (<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#S"><span class="id" title="constructor">S</span></a> <span class="id" title="var">k</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Peano.html#7825ccc99f23b0d30c9d40c317ba7af0"><span class="id" title="notation">-</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#S"><span class="id" title="constructor">S</span></a> <span class="id" title="var">k'</span>) <span class="id" title="keyword">with</span> (<span class="id" title="var">k</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Peano.html#7825ccc99f23b0d30c9d40c317ba7af0"><span class="id" title="notation">-</span></a> <span class="id" title="var">k'</span>) <span class="id" title="tactic">by</span> <span class="id" title="var">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">bia</span>.<br/>
&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">rewrite</span> <span class="id" title="var">IHt1</span>, <span class="id" title="var">IHt2</span> <span class="id" title="tactic">by</span> <span class="id" title="var">easy</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">bia</span>.<br/>
&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">rewrite</span> <span class="id" title="var">IHt</span> <span class="id" title="tactic">by</span> <span class="id" title="var">easy</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">clear</span> <span class="id" title="var">IHt</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">X</span>; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *; [<span class="id" title="var">bia</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">p0</span> <span class="id" title="tactic">by</span> <span class="id" title="var">easy</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">bia</span>; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Bool.Bool.html#orb_true_r"><span class="id" title="lemma">Bool.orb_true_r</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">IHX</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Bool.Bool.html#orb_false_r"><span class="id" title="lemma">Bool.orb_false_r</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">IHX</span>.<br/>
&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#map_length"><span class="id" title="lemma">map_length</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">X</span> <span class="id" title="tactic">in</span> <span class="id" title="var">X</span>, <span class="id" title="var">m</span>, <span class="id" title="var">k</span>, <span class="id" title="var">k'</span>, <span class="id" title="var">le</span> |- *; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *; [<span class="id" title="var">easy</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">p</span> <span class="id" title="tactic">by</span> <span class="id" title="var">easy</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">specialize</span> (<span class="id" title="var">IHX</span> (<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#S"><span class="id" title="constructor">S</span></a> <span class="id" title="var">k</span>) (<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#S"><span class="id" title="constructor">S</span></a> <span class="id" title="var">k'</span>) <span class="id" title="keyword">ltac</span>:(<span class="id" title="var">lia</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> !<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Arith.PeanoNat.html#Nat.sub_succ"><span class="id" title="lemma">Nat.sub_succ</span></a> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">replace</span> (<span class="id" title="notation">#|</span><span class="id" title="var">l</span><span class="id" title="notation">|</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Peano.html#0dacc1786c5ba797d47dd85006231633"><span class="id" title="notation">+</span></a> <span class="id" title="var">k</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Peano.html#7825ccc99f23b0d30c9d40c317ba7af0"><span class="id" title="notation">-</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Peano.html#7825ccc99f23b0d30c9d40c317ba7af0"><span class="id" title="notation">(</span></a><span class="id" title="notation">#|</span><span class="id" title="var">l</span><span class="id" title="notation">|</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Peano.html#0dacc1786c5ba797d47dd85006231633"><span class="id" title="notation">+</span></a> <span class="id" title="var">k'</span><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Peano.html#7825ccc99f23b0d30c9d40c317ba7af0"><span class="id" title="notation">)</span></a>) <span class="id" title="keyword">with</span> (<span class="id" title="var">k</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Peano.html#7825ccc99f23b0d30c9d40c317ba7af0"><span class="id" title="notation">-</span></a> <span class="id" title="var">k'</span>) <span class="id" title="tactic">by</span> <span class="id" title="var">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- !<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Arith.PeanoNat.html#Nat.add_succ_r"><span class="id" title="lemma">Nat.add_succ_r</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">IHX</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">bia</span>.<br/>
&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#map_length"><span class="id" title="lemma">map_length</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">X</span> <span class="id" title="tactic">in</span> <span class="id" title="var">X</span>, <span class="id" title="var">m</span>, <span class="id" title="var">k</span>, <span class="id" title="var">k'</span>, <span class="id" title="var">le</span> |- *; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *; [<span class="id" title="var">easy</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">p</span> <span class="id" title="tactic">by</span> <span class="id" title="var">easy</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">specialize</span> (<span class="id" title="var">IHX</span> (<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#S"><span class="id" title="constructor">S</span></a> <span class="id" title="var">k</span>) (<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#S"><span class="id" title="constructor">S</span></a> <span class="id" title="var">k'</span>) <span class="id" title="keyword">ltac</span>:(<span class="id" title="var">lia</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> !<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Arith.PeanoNat.html#Nat.sub_succ"><span class="id" title="lemma">Nat.sub_succ</span></a> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">replace</span> (<span class="id" title="notation">#|</span><span class="id" title="var">l</span><span class="id" title="notation">|</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Peano.html#0dacc1786c5ba797d47dd85006231633"><span class="id" title="notation">+</span></a> <span class="id" title="var">k</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Peano.html#7825ccc99f23b0d30c9d40c317ba7af0"><span class="id" title="notation">-</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Peano.html#7825ccc99f23b0d30c9d40c317ba7af0"><span class="id" title="notation">(</span></a><span class="id" title="notation">#|</span><span class="id" title="var">l</span><span class="id" title="notation">|</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Peano.html#0dacc1786c5ba797d47dd85006231633"><span class="id" title="notation">+</span></a> <span class="id" title="var">k'</span><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Peano.html#7825ccc99f23b0d30c9d40c317ba7af0"><span class="id" title="notation">)</span></a>) <span class="id" title="keyword">with</span> (<span class="id" title="var">k</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Peano.html#7825ccc99f23b0d30c9d40c317ba7af0"><span class="id" title="notation">-</span></a> <span class="id" title="var">k'</span>) <span class="id" title="tactic">by</span> <span class="id" title="var">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- !<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Arith.PeanoNat.html#Nat.add_succ_r"><span class="id" title="lemma">Nat.add_succ_r</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">IHX</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">bia</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a name="is_dead_dearg_lambdas"><span class="id" title="lemma">is_dead_dearg_lambdas</span></a> <span class="id" title="var">k</span> <span class="id" title="var">mask</span> <span class="id" title="var">t</span> :<br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Extraction.Optimize.html#is_dead"><span class="id" title="definition">is_dead</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#k"><span class="id" title="variable">k</span></a> (<a class="idref" href="ConCert.Extraction.Optimize.html#dearg_lambdas"><span class="id" title="definition">dearg_lambdas</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#mask"><span class="id" title="variable">mask</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#t"><span class="id" title="variable">t</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="ConCert.Extraction.Optimize.html#is_dead"><span class="id" title="definition">is_dead</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#k"><span class="id" title="variable">k</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#t"><span class="id" title="variable">t</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">t</span> <span class="id" title="tactic">in</span> <span class="id" title="var">k</span>, <span class="id" title="var">mask</span>, <span class="id" title="var">t</span> |- *; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *; <span class="id" title="tactic">try</span> <span class="id" title="var">easy</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">mask</span> <span class="id" title="keyword">as</span> [|[] <span class="id" title="var">mask</span>]; [<span class="id" title="var">easy</span>| |]; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">unfold</span> <span class="id" title="definition">subst1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#is_dead_subst"><span class="id" title="lemma">is_dead_subst</span></a>, <span class="id" title="var">IHt</span>, <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Arith.PeanoNat.html#Nat.sub_0_r"><span class="id" title="lemma">Nat.sub_0_r</span></a> <span class="id" title="tactic">by</span> <span class="id" title="var">easy</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="var">btauto</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="var">IHt</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a name="is_dead_dearg_case"><span class="id" title="lemma">is_dead_dearg_case</span></a> <span class="id" title="var">k</span> <span class="id" title="var">ind</span> <span class="id" title="var">npars</span> <span class="id" title="var">discr</span> <span class="id" title="var">brs</span> :<br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Extraction.Optimize.html#is_dead"><span class="id" title="definition">is_dead</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#k"><span class="id" title="variable">k</span></a> (<a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#dearg_case"><span class="id" title="abbreviation">dearg_case</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#ind"><span class="id" title="variable">ind</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#npars"><span class="id" title="variable">npars</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#discr"><span class="id" title="variable">discr</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#brs"><span class="id" title="variable">brs</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Extraction.Optimize.html#is_dead"><span class="id" title="definition">is_dead</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#k"><span class="id" title="variable">k</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#discr"><span class="id" title="variable">discr</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#9ddeac0ab66152bd1d64bedb507a795e"><span class="id" title="notation">&amp;&amp;</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#forallb"><span class="id" title="definition">forallb</span></a> (<a class="idref" href="ConCert.Extraction.Optimize.html#is_dead"><span class="id" title="definition">is_dead</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#k"><span class="id" title="variable">k</span></a>) (<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#map"><span class="id" title="definition">map</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#snd"><span class="id" title="definition">snd</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#brs"><span class="id" title="variable">brs</span></a>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">dearg_case</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#get_mib_masks"><span class="id" title="abbreviation">get_mib_masks</span></a> <span class="id" title="var">_</span>); <span class="id" title="var">cbn</span>; [|<span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">forallb_map</span>].<br/>
&nbsp;&nbsp;<span class="id" title="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="definition">mapi</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">generalize</span> 0.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">brs</span>; <span class="id" title="tactic">intros</span>; [<span class="id" title="var">easy</span>|].<br/>
&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">IHbrs</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#is_dead_dearg_lambdas"><span class="id" title="lemma">is_dead_dearg_lambdas</span></a>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a name="is_dead_dearg_aux"><span class="id" title="lemma">is_dead_dearg_aux</span></a> <span class="id" title="var">k</span> <span class="id" title="var">t</span> <span class="id" title="var">args</span> :<br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Extraction.Optimize.html#is_dead"><span class="id" title="definition">is_dead</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#k"><span class="id" title="variable">k</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#t"><span class="id" title="variable">t</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#Forall"><span class="id" title="inductive">Forall</span></a> (<a class="idref" href="ConCert.Extraction.Optimize.html#is_dead"><span class="id" title="definition">is_dead</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#k"><span class="id" title="variable">k</span></a>) <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#args"><span class="id" title="variable">args</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Extraction.Optimize.html#is_dead"><span class="id" title="definition">is_dead</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#k"><span class="id" title="variable">k</span></a> (<a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#dearg_aux"><span class="id" title="abbreviation">dearg_aux</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#args"><span class="id" title="variable">args</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#t"><span class="id" title="variable">t</span></a>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">no_use</span> <span class="id" title="var">args_no_use</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">t</span> <span class="id" title="keyword">using</span> <span class="id" title="lemma">term_forall_list_ind</span> <span class="id" title="tactic">in</span> <span class="id" title="var">k</span>, <span class="id" title="var">t</span>, <span class="id" title="var">args</span>, <span class="id" title="var">no_use</span>, <span class="id" title="var">args_no_use</span> |- *;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *; <span class="id" title="tactic">rewrite</span> ?<a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#is_dead_mkApps"><span class="id" title="lemma">is_dead_mkApps</span></a>; <span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <span class="id" title="lemma">forallb_Forall</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="var">no_use</span>; <span class="id" title="tactic">apply</span> <span class="id" title="lemma">forallb_Forall</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <span class="id" title="lemma">forallb_Forall</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">propify</span>; <span class="id" title="tactic">split</span>; [|<span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <span class="id" title="lemma">forallb_Forall</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">X</span>; [<span class="id" title="var">easy</span>|]; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *; <span class="id" title="var">propify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="var">p</span>, <span class="id" title="var">IHX</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">rewrite</span> <span class="id" title="var">IHt</span> <span class="id" title="tactic">by</span> <span class="id" title="var">easy</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <span class="id" title="lemma">forallb_Forall</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">propify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">IHt1</span>, <span class="id" title="var">IHt2</span> <span class="id" title="tactic">by</span> <span class="id" title="var">easy</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>; [<span class="id" title="var">easy</span>|<span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <span class="id" title="lemma">forallb_Forall</span>].<br/>
&nbsp;&nbsp;- <span class="id" title="var">propify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="var">IHt1</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#is_dead_dearg_single"><span class="id" title="lemma">is_dead_dearg_single</span></a>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#is_dead_dearg_single"><span class="id" title="lemma">is_dead_dearg_single</span></a>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">destruct</span> <span class="id" title="var">p</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#is_dead_mkApps"><span class="id" title="lemma">is_dead_mkApps</span></a>, <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#is_dead_dearg_case"><span class="id" title="lemma">is_dead_dearg_case</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">propify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>; [|<span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <span class="id" title="lemma">forallb_Forall</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>; [<span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <span class="id" title="var">IHt</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">X</span>; [<span class="id" title="var">easy</span>|]; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *; <span class="id" title="var">propify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">p</span> <span class="id" title="tactic">by</span> <span class="id" title="var">easy</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>; [<span class="id" title="var">easy</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <span class="id" title="var">IHX</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">destruct</span> <span class="id" title="var">s</span> <span class="id" title="keyword">as</span> ((<span class="id" title="var">ind</span> &amp; <span class="id" title="var">c</span>) &amp; <span class="id" title="var">npars</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#is_dead_mkApps"><span class="id" title="lemma">is_dead_mkApps</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">propify</span>; <span class="id" title="tactic">split</span>; [|<span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <span class="id" title="lemma">forallb_Forall</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">dearg_proj</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">destruct</span> (<a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#get_mib_masks"><span class="id" title="abbreviation">get_mib_masks</span></a> <span class="id" title="var">_</span>); <span class="id" title="tactic">apply</span> <span class="id" title="var">IHt</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#map_length"><span class="id" title="lemma">map_length</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">propify</span>; <span class="id" title="tactic">split</span>; [|<span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <span class="id" title="lemma">forallb_Forall</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">X</span> <span class="id" title="tactic">in</span> <span class="id" title="var">k</span>, <span class="id" title="var">m</span>, <span class="id" title="var">X</span>, <span class="id" title="var">no_use</span> |- *; [<span class="id" title="var">easy</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *; <span class="id" title="var">propify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- !<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Arith.PeanoNat.html#Nat.add_succ_r"><span class="id" title="lemma">Nat.add_succ_r</span></a> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">p</span> <span class="id" title="tactic">by</span> <span class="id" title="var">easy</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>; [<span class="id" title="var">easy</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <span class="id" title="var">IHX</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#map_length"><span class="id" title="lemma">map_length</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">propify</span>; <span class="id" title="tactic">split</span>; [|<span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <span class="id" title="lemma">forallb_Forall</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">X</span> <span class="id" title="tactic">in</span> <span class="id" title="var">k</span>, <span class="id" title="var">m</span>, <span class="id" title="var">X</span>, <span class="id" title="var">no_use</span> |- *; [<span class="id" title="var">easy</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *; <span class="id" title="var">propify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- !<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Arith.PeanoNat.html#Nat.add_succ_r"><span class="id" title="lemma">Nat.add_succ_r</span></a> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">p</span> <span class="id" title="tactic">by</span> <span class="id" title="var">easy</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>; [<span class="id" title="var">easy</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <span class="id" title="var">IHX</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">eapply</span> <span class="id" title="lemma">Forall_forallb</span>;<span class="id" title="tactic">eauto</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a name="valid_dearg_mask_dearg"><span class="id" title="lemma">valid_dearg_mask_dearg</span></a> <span class="id" title="var">mask</span> <span class="id" title="var">t</span> :<br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Extraction.Optimize.html#valid_dearg_mask"><span class="id" title="definition">valid_dearg_mask</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#mask"><span class="id" title="variable">mask</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#t"><span class="id" title="variable">t</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Extraction.Optimize.html#valid_dearg_mask"><span class="id" title="definition">valid_dearg_mask</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#mask"><span class="id" title="variable">mask</span></a> (<a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#dearg"><span class="id" title="abbreviation">dearg</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#t"><span class="id" title="variable">t</span></a>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">valid</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">t</span> <span class="id" title="tactic">in</span> <span class="id" title="var">mask</span>, <span class="id" title="var">t</span>, <span class="id" title="var">valid</span> |- *; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *; <span class="id" title="tactic">try</span> <span class="id" title="var">easy</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">try</span> <span class="id" title="tactic">solve</span> [<span class="id" title="tactic">destruct</span> <span class="id" title="var">mask</span>; [|<span class="id" title="var">easy</span>]; <span class="id" title="tactic">apply</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#valid_dearg_mask_nil"><span class="id" title="lemma">valid_dearg_mask_nil</span></a>].<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">mask</span> <span class="id" title="keyword">as</span> [|[] <span class="id" title="var">mask</span>]; <span class="id" title="tactic">try</span> <span class="id" title="var">easy</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;<span class="id" title="var">propify</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#is_dead_dearg_aux"><span class="id" title="lemma">is_dead_dearg_aux</span></a>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a name="valid_case_masks_dearg_branches"><span class="id" title="lemma">valid_case_masks_dearg_branches</span></a> <span class="id" title="var">ind</span> <span class="id" title="var">npars</span> <span class="id" title="var">brs</span> :<br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#valid_case_masks"><span class="id" title="abbreviation">valid_case_masks</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#ind"><span class="id" title="variable">ind</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#npars"><span class="id" title="variable">npars</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#brs"><span class="id" title="variable">brs</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#valid_case_masks"><span class="id" title="abbreviation">valid_case_masks</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#ind"><span class="id" title="variable">ind</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#npars"><span class="id" title="variable">npars</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#map"><span class="id" title="definition">map</span></a> (<span class="id" title="definition">on_snd</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#dearg"><span class="id" title="abbreviation">dearg</span></a>) <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#brs"><span class="id" title="variable">brs</span></a>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">valid</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">valid_case_masks</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#get_mib_masks"><span class="id" title="abbreviation">get_mib_masks</span></a> <span class="id" title="var">_</span>); [|<span class="id" title="var">easy</span>].<br/>
&nbsp;&nbsp;<span class="id" title="var">propify</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">valid</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">split</span>; [<span class="id" title="var">easy</span>|].<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="ConCert.Extraction.Utils.html#Alli_alli"><span class="id" title="lemma">Alli_alli</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="ConCert.Extraction.Utils.html#alli_Alli"><span class="id" title="lemma">alli_Alli</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">H0</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="ConCert.Extraction.Utils.html#Alli_map"><span class="id" title="lemma">Alli_map</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <span class="id" title="lemma">Alli_impl</span>; [<span class="id" title="var">eassumption</span>|].<br/>
&nbsp;&nbsp;<span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">n</span> [] <span class="id" title="var">valid</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">propify</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">split</span>; [<span class="id" title="var">easy</span>|].<br/>
&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#valid_dearg_mask_dearg"><span class="id" title="lemma">valid_dearg_mask_dearg</span></a>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a name="dearg_aux_subst"><span class="id" title="lemma">dearg_aux_subst</span></a> <span class="id" title="var">s</span> <span class="id" title="var">k</span> <span class="id" title="var">t</span> <span class="id" title="var">args</span> :<br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#valid_cases"><span class="id" title="abbreviation">valid_cases</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#t"><span class="id" title="variable">t</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#Forall"><span class="id" title="inductive">Forall</span></a> (<span class="id" title="keyword">fun</span> <span class="id" title="var">s</span> =&gt; <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#is_expanded"><span class="id" title="abbreviation">is_expanded</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#s"><span class="id" title="variable">s</span></a>) <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#s"><span class="id" title="variable">s</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#dearg_aux"><span class="id" title="abbreviation">dearg_aux</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#map"><span class="id" title="definition">map</span></a> (<span class="id" title="definition">subst</span> (<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#map"><span class="id" title="definition">map</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#dearg"><span class="id" title="abbreviation">dearg</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#s"><span class="id" title="variable">s</span></a>) <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#k"><span class="id" title="variable">k</span></a> <span class="id" title="notation">∘</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#dearg"><span class="id" title="abbreviation">dearg</span></a>) <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#args"><span class="id" title="variable">args</span></a>) (<span class="id" title="definition">subst</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#s"><span class="id" title="variable">s</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#k"><span class="id" title="variable">k</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#t"><span class="id" title="variable">t</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a><br/>
&nbsp;&nbsp;<span class="id" title="definition">subst</span> (<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#map"><span class="id" title="definition">map</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#dearg"><span class="id" title="abbreviation">dearg</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#s"><span class="id" title="variable">s</span></a>) <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#k"><span class="id" title="variable">k</span></a> (<a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#dearg_aux"><span class="id" title="abbreviation">dearg_aux</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#map"><span class="id" title="definition">map</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#dearg"><span class="id" title="abbreviation">dearg</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#args"><span class="id" title="variable">args</span></a>) <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#t"><span class="id" title="variable">t</span></a>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">vcases</span> <span class="id" title="var">es</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">t</span> <span class="id" title="keyword">using</span> <span class="id" title="lemma">term_forall_list_ind</span> <span class="id" title="tactic">in</span> <span class="id" title="var">s</span>, <span class="id" title="var">k</span>, <span class="id" title="var">t</span>, <span class="id" title="var">args</span>, <span class="id" title="var">vcases</span>, <span class="id" title="var">es</span> |- *; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *; <span class="id" title="var">refold'</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">subst_mkApps</span>, <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#map_map"><span class="id" title="lemma">map_map</span></a>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">subst_mkApps</span>, <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#map_map"><span class="id" title="lemma">map_map</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<span class="id" title="var">_</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Arith.PeanoNat.html#0f31f5c1c6b6a21a3a187247222bc9e4"><span class="id" title="notation">&lt;=?</span></a> <span class="id" title="var">_</span>) <span class="id" title="var">eqn</span>:?; <span class="id" title="var">propify</span>; [|<span class="id" title="var">easy</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">nth_error_map</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#nth_error"><span class="id" title="definition">nth_error</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span>) <span class="id" title="var">eqn</span>:<span class="id" title="var">nth</span>; <span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">rewrite</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#dearg_expanded"><span class="id" title="lemma">dearg_expanded</span></a>, <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#lift_dearg"><span class="id" title="lemma">lift_dearg</span></a>; [<span class="id" title="var">easy</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#is_expanded_lift"><span class="id" title="lemma">is_expanded_lift</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">eapply</span> <span class="id" title="lemma">nth_error_forall</span> <span class="id" title="tactic">in</span> <span class="id" title="var">nth</span>; [|<span class="id" title="var">eassumption</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#map_length"><span class="id" title="lemma">map_length</span></a>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">subst_mkApps</span>, <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#map_map"><span class="id" title="lemma">map_map</span></a>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">subst_mkApps</span>, <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#map_map"><span class="id" title="lemma">map_map</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> !<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#map_map"><span class="id" title="lemma">map_map</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">X</span>; [<span class="id" title="var">easy</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">propify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> (<span class="id" title="var">p</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#ae9a5e1034e143b218b09d8e454472bd"><span class="id" title="notation">[]</span></a>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <span class="id" title="var">IHX</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">subst_mkApps</span>, <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#map_map"><span class="id" title="lemma">map_map</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> (<span class="id" title="var">IHt</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#ae9a5e1034e143b218b09d8e454472bd"><span class="id" title="notation">[]</span></a>).<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">subst_mkApps</span>, <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#map_map"><span class="id" title="lemma">map_map</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">propify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> (<span class="id" title="var">IHt1</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#ae9a5e1034e143b218b09d8e454472bd"><span class="id" title="notation">[]</span></a>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> (<span class="id" title="var">IHt2</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#ae9a5e1034e143b218b09d8e454472bd"><span class="id" title="notation">[]</span></a>).<br/>
&nbsp;&nbsp;- <span class="id" title="var">propify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">specialize</span> (<span class="id" title="var">IHt1</span> <span class="id" title="var">s</span> <span class="id" title="var">k</span> (<span class="id" title="var">t2</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#cbcf67aac0c2a85b8d93d37de9969adf"><span class="id" title="notation">::</span></a> <span class="id" title="var">args</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="var">IHt1</span> <span class="id" title="tactic">by</span> <span class="id" title="var">easy</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> (<span class="id" title="var">IHt2</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#ae9a5e1034e143b218b09d8e454472bd"><span class="id" title="notation">[]</span></a>).<br/>
&nbsp;&nbsp;- <span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#subst_dearg_single"><span class="id" title="lemma">subst_dearg_single</span></a>, <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#map_map"><span class="id" title="lemma">map_map</span></a>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#subst_dearg_single"><span class="id" title="lemma">subst_dearg_single</span></a>, <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#map_map"><span class="id" title="lemma">map_map</span></a>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">destruct</span> <span class="id" title="var">p</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">propify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">subst_mkApps</span>, !<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#map_map"><span class="id" title="lemma">map_map</span></a>, <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#subst_dearg_case"><span class="id" title="lemma">subst_dearg_case</span></a> <span class="id" title="tactic">by</span> (<span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#valid_case_masks_dearg_branches"><span class="id" title="lemma">valid_case_masks_dearg_branches</span></a>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">f_equal</span>; [<span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> (<span class="id" title="var">IHt</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#ae9a5e1034e143b218b09d8e454472bd"><span class="id" title="notation">[]</span></a>)|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">vcases</span> <span class="id" title="keyword">as</span> ((<span class="id" title="var">_</span> &amp; <span class="id" title="var">vcases</span>) &amp; <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">clear</span> -<span class="id" title="var">X</span> <span class="id" title="var">vcases</span> <span class="id" title="var">es</span> <span class="id" title="var">X</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">X</span>; [<span class="id" title="var">easy</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">propify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">f_equal</span>; [<span class="id" title="tactic">f_equal</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> (<span class="id" title="var">p</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#ae9a5e1034e143b218b09d8e454472bd"><span class="id" title="notation">[]</span></a>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <span class="id" title="var">IHX</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">destruct</span> <span class="id" title="var">s0</span> <span class="id" title="keyword">as</span> ((<span class="id" title="var">ind</span> &amp; <span class="id" title="var">c</span>) &amp; <span class="id" title="var">npars</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">subst_mkApps</span>, <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#map_map"><span class="id" title="lemma">map_map</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">dearg_proj</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *; <span class="id" title="var">propify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> (<span class="id" title="var">IHt</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#ae9a5e1034e143b218b09d8e454472bd"><span class="id" title="notation">[]</span></a>).<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">subst_mkApps</span>, <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#map_map"><span class="id" title="lemma">map_map</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> !<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#map_map"><span class="id" title="lemma">map_map</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#map_length"><span class="id" title="lemma">map_length</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">revert</span> <span class="id" title="var">k</span>; <span class="id" title="tactic">induction</span> <span class="id" title="var">X</span>; <span class="id" title="tactic">intros</span> <span class="id" title="var">k</span>; [<span class="id" title="var">easy</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">propify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- !<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Arith.PeanoNat.html#Nat.add_succ_r"><span class="id" title="lemma">Nat.add_succ_r</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">f_equal</span>; [|<span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <span class="id" title="var">IHX</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="definition">map_def</span>; <span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> (<span class="id" title="var">p</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#ae9a5e1034e143b218b09d8e454472bd"><span class="id" title="notation">[]</span></a>).<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">subst_mkApps</span>, <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#map_map"><span class="id" title="lemma">map_map</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> !<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#map_map"><span class="id" title="lemma">map_map</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#map_length"><span class="id" title="lemma">map_length</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">revert</span> <span class="id" title="var">k</span>; <span class="id" title="tactic">induction</span> <span class="id" title="var">X</span>; <span class="id" title="tactic">intros</span> <span class="id" title="var">k</span>; [<span class="id" title="var">easy</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">propify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- !<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Arith.PeanoNat.html#Nat.add_succ_r"><span class="id" title="lemma">Nat.add_succ_r</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">f_equal</span>; [|<span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <span class="id" title="var">IHX</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="definition">map_def</span>; <span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> (<span class="id" title="var">p</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#ae9a5e1034e143b218b09d8e454472bd"><span class="id" title="notation">[]</span></a>).<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">subst_mkApps</span>. <span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#map_map"><span class="id" title="lemma">map_map</span></a>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a name="dearg_subst"><span class="id" title="lemma">dearg_subst</span></a> <span class="id" title="var">s</span> <span class="id" title="var">k</span> <span class="id" title="var">t</span> :<br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#valid_cases"><span class="id" title="abbreviation">valid_cases</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#t"><span class="id" title="variable">t</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#Forall"><span class="id" title="inductive">Forall</span></a> (<span class="id" title="keyword">fun</span> <span class="id" title="var">s</span> =&gt; <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#is_expanded"><span class="id" title="abbreviation">is_expanded</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#s"><span class="id" title="variable">s</span></a>) <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#s"><span class="id" title="variable">s</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#dearg"><span class="id" title="abbreviation">dearg</span></a> (<span class="id" title="definition">subst</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#s"><span class="id" title="variable">s</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#k"><span class="id" title="variable">k</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#t"><span class="id" title="variable">t</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <span class="id" title="definition">subst</span> (<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#map"><span class="id" title="definition">map</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#dearg"><span class="id" title="abbreviation">dearg</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#s"><span class="id" title="variable">s</span></a>) <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#k"><span class="id" title="variable">k</span></a> (<a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#dearg"><span class="id" title="abbreviation">dearg</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#t"><span class="id" title="variable">t</span></a>).<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="var">now</span> <span class="id" title="tactic">intros</span>; <span class="id" title="tactic">apply</span> (<a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#dearg_aux_subst"><span class="id" title="lemma">dearg_aux_subst</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#ae9a5e1034e143b218b09d8e454472bd"><span class="id" title="notation">[]</span></a>). <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a name="valid_cases_mkApps_inv"><span class="id" title="lemma">valid_cases_mkApps_inv</span></a> <span class="id" title="var">hd</span> <span class="id" title="var">args</span> :<br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#valid_cases"><span class="id" title="abbreviation">valid_cases</span></a> (<span class="id" title="definition">mkApps</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#hd"><span class="id" title="variable">hd</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#args"><span class="id" title="variable">args</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#valid_cases"><span class="id" title="abbreviation">valid_cases</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#hd"><span class="id" title="variable">hd</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">/\</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#Forall"><span class="id" title="inductive">Forall</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#valid_cases"><span class="id" title="abbreviation">valid_cases</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#args"><span class="id" title="variable">args</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">valid</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">args</span> <span class="id" title="keyword">using</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#rev_ind"><span class="id" title="lemma">List.rev_ind</span></a>; [<span class="id" title="var">easy</span>|].<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">mkApps_app</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;<span class="id" title="var">propify</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intuition</span> <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="lemma">app_Forall</span>; <span class="id" title="tactic">intuition</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a name="is_expanded_aux_mkApps_eq"><span class="id" title="lemma">is_expanded_aux_mkApps_eq</span></a> <span class="id" title="var">n</span> <span class="id" title="var">hd</span> <span class="id" title="var">args</span> :<br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#is_expanded_aux"><span class="id" title="abbreviation">is_expanded_aux</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#n"><span class="id" title="variable">n</span></a> (<span class="id" title="definition">mkApps</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#hd"><span class="id" title="variable">hd</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#args"><span class="id" title="variable">args</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#is_expanded_aux"><span class="id" title="abbreviation">is_expanded_aux</span></a> (<a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#n"><span class="id" title="variable">n</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Peano.html#0dacc1786c5ba797d47dd85006231633"><span class="id" title="notation">+</span></a> <span class="id" title="notation">#|</span><a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#args"><span class="id" title="variable">args</span></a><span class="id" title="notation">|</span>) <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#hd"><span class="id" title="variable">hd</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#9ddeac0ab66152bd1d64bedb507a795e"><span class="id" title="notation">&amp;&amp;</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#forallb"><span class="id" title="definition">forallb</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#is_expanded"><span class="id" title="abbreviation">is_expanded</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#args"><span class="id" title="variable">args</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">args</span> <span class="id" title="tactic">in</span> <span class="id" title="var">args</span>, <span class="id" title="var">n</span> |- * <span class="id" title="keyword">using</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#rev_ind"><span class="id" title="lemma">List.rev_ind</span></a>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Bool.Bool.html#andb_true_r"><span class="id" title="lemma">Bool.andb_true_r</span></a>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">mkApps_app</span>, <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#forallb_app"><span class="id" title="lemma">forallb_app</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">IHargs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#app_length"><span class="id" title="lemma">app_length</span></a>, <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Bool.Bool.html#andb_true_r"><span class="id" title="lemma">Bool.andb_true_r</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> !<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Bool.Bool.html#andb_assoc"><span class="id" title="lemma">Bool.andb_assoc</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">symmetry</span>; <span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Bool.Bool.html#andb_comm"><span class="id" title="lemma">Bool.andb_comm</span></a>; <span class="id" title="tactic">symmetry</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- !<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Bool.Bool.html#andb_assoc"><span class="id" title="lemma">Bool.andb_assoc</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">lia</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a name="is_expanded_mkApps_eq"><span class="id" title="lemma">is_expanded_mkApps_eq</span></a> <span class="id" title="var">hd</span> <span class="id" title="var">args</span> :<br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#is_expanded"><span class="id" title="abbreviation">is_expanded</span></a> (<span class="id" title="definition">mkApps</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#hd"><span class="id" title="variable">hd</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#args"><span class="id" title="variable">args</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#is_expanded_aux"><span class="id" title="abbreviation">is_expanded_aux</span></a> <span class="id" title="notation">#|</span><a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#args"><span class="id" title="variable">args</span></a><span class="id" title="notation">|</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#hd"><span class="id" title="variable">hd</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#9ddeac0ab66152bd1d64bedb507a795e"><span class="id" title="notation">&amp;&amp;</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#forallb"><span class="id" title="definition">forallb</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#is_expanded"><span class="id" title="abbreviation">is_expanded</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#args"><span class="id" title="variable">args</span></a>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#is_expanded_aux_mkApps_eq"><span class="id" title="lemma">is_expanded_aux_mkApps_eq</span></a>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a name="is_expanded_aux_mkApps_inv"><span class="id" title="lemma">is_expanded_aux_mkApps_inv</span></a> <span class="id" title="var">n</span> <span class="id" title="var">hd</span> <span class="id" title="var">args</span> :<br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#is_expanded_aux"><span class="id" title="abbreviation">is_expanded_aux</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#n"><span class="id" title="variable">n</span></a> (<span class="id" title="definition">mkApps</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#hd"><span class="id" title="variable">hd</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#args"><span class="id" title="variable">args</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#is_expanded_aux"><span class="id" title="abbreviation">is_expanded_aux</span></a> (<a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#n"><span class="id" title="variable">n</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Peano.html#0dacc1786c5ba797d47dd85006231633"><span class="id" title="notation">+</span></a> <span class="id" title="notation">#|</span><a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#args"><span class="id" title="variable">args</span></a><span class="id" title="notation">|</span>) <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#hd"><span class="id" title="variable">hd</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">/\</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#Forall"><span class="id" title="inductive">Forall</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#is_expanded"><span class="id" title="abbreviation">is_expanded</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#args"><span class="id" title="variable">args</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">exp</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#is_expanded_aux_mkApps_eq"><span class="id" title="lemma">is_expanded_aux_mkApps_eq</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">exp</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">propify</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">split</span>; [<span class="id" title="var">easy</span>|].<br/>
&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <span class="id" title="lemma">forallb_Forall</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a name="is_expanded_aux_mkApps"><span class="id" title="lemma">is_expanded_aux_mkApps</span></a> <span class="id" title="var">n</span> <span class="id" title="var">hd</span> <span class="id" title="var">args</span> :<br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#is_expanded_aux"><span class="id" title="abbreviation">is_expanded_aux</span></a> (<a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#n"><span class="id" title="variable">n</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Peano.html#0dacc1786c5ba797d47dd85006231633"><span class="id" title="notation">+</span></a> <span class="id" title="notation">#|</span><a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#args"><span class="id" title="variable">args</span></a><span class="id" title="notation">|</span>) <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#hd"><span class="id" title="variable">hd</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#Forall"><span class="id" title="inductive">Forall</span></a> (<span class="id" title="keyword">fun</span> <span class="id" title="var">a</span> =&gt; <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#is_expanded"><span class="id" title="abbreviation">is_expanded</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#a"><span class="id" title="variable">a</span></a>) <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#args"><span class="id" title="variable">args</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#is_expanded_aux"><span class="id" title="abbreviation">is_expanded_aux</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#n"><span class="id" title="variable">n</span></a> (<span class="id" title="definition">mkApps</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#hd"><span class="id" title="variable">hd</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#args"><span class="id" title="variable">args</span></a>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">exp_hd</span> <span class="id" title="var">exp_args</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#is_expanded_aux_mkApps_eq"><span class="id" title="lemma">is_expanded_aux_mkApps_eq</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">exp_hd</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <span class="id" title="lemma">forallb_Forall</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a name="is_expanded_aux_upwards"><span class="id" title="lemma">is_expanded_aux_upwards</span></a> <span class="id" title="var">n</span> <span class="id" title="var">t</span> <span class="id" title="var">n'</span> :<br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#is_expanded_aux"><span class="id" title="abbreviation">is_expanded_aux</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#n"><span class="id" title="variable">n</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#t"><span class="id" title="variable">t</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#n"><span class="id" title="variable">n</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Peano.html#cb53cf0ee22c036a03b4a9281c68b5a3"><span class="id" title="notation">&lt;=</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#n'"><span class="id" title="variable">n'</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#is_expanded_aux"><span class="id" title="abbreviation">is_expanded_aux</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#n'"><span class="id" title="variable">n'</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#t"><span class="id" title="variable">t</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">exp</span> <span class="id" title="var">l</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">t</span> <span class="id" title="tactic">in</span> <span class="id" title="var">n</span>, <span class="id" title="var">t</span>, <span class="id" title="var">n'</span>, <span class="id" title="var">l</span>, <span class="id" title="var">exp</span> |- * <span class="id" title="keyword">using</span> <span class="id" title="lemma">term_forall_list_ind</span>; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *; <span class="id" title="var">propify</span>; <span class="id" title="var">easy</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a name="is_expanded_csubst"><span class="id" title="lemma">is_expanded_csubst</span></a> <span class="id" title="var">s</span> <span class="id" title="var">n</span> <span class="id" title="var">t</span> <span class="id" title="var">k</span> :<br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#is_expanded_aux"><span class="id" title="abbreviation">is_expanded_aux</span></a> 0 <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#s"><span class="id" title="variable">s</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#is_expanded_aux"><span class="id" title="abbreviation">is_expanded_aux</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#n"><span class="id" title="variable">n</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#t"><span class="id" title="variable">t</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#is_expanded_aux"><span class="id" title="abbreviation">is_expanded_aux</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#n"><span class="id" title="variable">n</span></a> (<span class="id" title="definition">csubst</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#s"><span class="id" title="variable">s</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#k"><span class="id" title="variable">k</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#t"><span class="id" title="variable">t</span></a>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">exps</span> <span class="id" title="var">expt</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">t</span> <span class="id" title="tactic">in</span> <span class="id" title="var">s</span>, <span class="id" title="var">n</span>, <span class="id" title="var">t</span>, <span class="id" title="var">k</span>, <span class="id" title="var">exps</span>, <span class="id" title="var">expt</span> |- * <span class="id" title="keyword">using</span> <span class="id" title="lemma">term_forall_list_ind</span>; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;- <span class="id" title="var">easy</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">destruct</span> (<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Arith.PeanoNat.html#Nat.compare_spec"><span class="id" title="lemma">Nat.compare_spec</span></a> <span class="id" title="var">k</span> <span class="id" title="var">n0</span>) <span class="id" title="keyword">as</span> [&lt;-| |].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">now</span> <span class="id" title="tactic">eapply</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#is_expanded_aux_upwards"><span class="id" title="lemma">is_expanded_aux_upwards</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">easy</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">easy</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">easy</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">induction</span> <span class="id" title="var">X</span>; [<span class="id" title="var">easy</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *; <span class="id" title="var">propify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="var">p</span>, <span class="id" title="var">IHX</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <span class="id" title="var">IHt</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">now</span> <span class="id" title="var">propify</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">now</span> <span class="id" title="var">propify</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">easy</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">easy</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">propify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">IHt</span> <span class="id" title="tactic">by</span> <span class="id" title="var">easy</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>; [<span class="id" title="var">easy</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">X</span>; [<span class="id" title="var">easy</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">propify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="var">p0</span>, <span class="id" title="var">IHX</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">easy</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">induction</span> <span class="id" title="var">X</span> <span class="id" title="tactic">in</span> <span class="id" title="var">m</span>, <span class="id" title="var">X</span>, <span class="id" title="var">k</span>, <span class="id" title="var">expt</span> |- *; [<span class="id" title="var">easy</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">propify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- !<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Arith.PeanoNat.html#Nat.add_succ_r"><span class="id" title="lemma">Nat.add_succ_r</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="var">p</span>, <span class="id" title="var">IHX</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">induction</span> <span class="id" title="var">X</span> <span class="id" title="tactic">in</span> <span class="id" title="var">m</span>, <span class="id" title="var">X</span>, <span class="id" title="var">k</span>, <span class="id" title="var">expt</span> |- *; [<span class="id" title="var">easy</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">propify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- !<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Arith.PeanoNat.html#Nat.add_succ_r"><span class="id" title="lemma">Nat.add_succ_r</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="var">p</span>, <span class="id" title="var">IHX</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">reflexivity</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a name="is_expanded_aux_subst"><span class="id" title="lemma">is_expanded_aux_subst</span></a> <span class="id" title="var">s</span> <span class="id" title="var">n</span> <span class="id" title="var">t</span> <span class="id" title="var">k</span> :<br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#is_expanded_aux"><span class="id" title="abbreviation">is_expanded_aux</span></a> 0 <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#s"><span class="id" title="variable">s</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#is_expanded_aux"><span class="id" title="abbreviation">is_expanded_aux</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#n"><span class="id" title="variable">n</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#t"><span class="id" title="variable">t</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#is_expanded_aux"><span class="id" title="abbreviation">is_expanded_aux</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#n"><span class="id" title="variable">n</span></a> (<span class="id" title="definition">subst</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#ddd65c2f7ee73ecec433744948d846bb"><span class="id" title="notation">[</span></a><a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#s"><span class="id" title="variable">s</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#ddd65c2f7ee73ecec433744948d846bb"><span class="id" title="notation">]</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#k"><span class="id" title="variable">k</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#t"><span class="id" title="variable">t</span></a>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">exps</span> <span class="id" title="var">expt</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">t</span> <span class="id" title="tactic">in</span> <span class="id" title="var">s</span>, <span class="id" title="var">n</span>, <span class="id" title="var">t</span>, <span class="id" title="var">k</span>, <span class="id" title="var">exps</span>, <span class="id" title="var">expt</span> |- * <span class="id" title="keyword">using</span> <span class="id" title="lemma">term_forall_list_ind</span>; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;- <span class="id" title="var">easy</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">destruct</span> (<span class="id" title="var">_</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Arith.PeanoNat.html#0f31f5c1c6b6a21a3a187247222bc9e4"><span class="id" title="notation">&lt;=?</span></a> <span class="id" title="var">_</span>); [|<span class="id" title="var">easy</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#nth_error"><span class="id" title="definition">nth_error</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span>) <span class="id" title="var">eqn</span>:<span class="id" title="var">nth</span>; [|<span class="id" title="var">easy</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<span class="id" title="var">_</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Peano.html#7825ccc99f23b0d30c9d40c317ba7af0"><span class="id" title="notation">-</span></a> <span class="id" title="var">_</span>); <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">noconf</span> <span class="id" title="var">nth</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#is_expanded_aux_lift"><span class="id" title="lemma">is_expanded_aux_lift</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">eapply</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#is_expanded_aux_upwards"><span class="id" title="lemma">is_expanded_aux_upwards</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">nth_error_nil</span> <span class="id" title="tactic">in</span> <span class="id" title="var">nth</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">easy</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">induction</span> <span class="id" title="var">X</span>; [<span class="id" title="var">easy</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *; <span class="id" title="var">propify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="var">p</span>, <span class="id" title="var">IHX</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <span class="id" title="var">IHt</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">now</span> <span class="id" title="var">propify</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">now</span> <span class="id" title="var">propify</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">easy</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">easy</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">propify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">IHt</span> <span class="id" title="tactic">by</span> <span class="id" title="var">easy</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>; [<span class="id" title="var">easy</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">X</span>; [<span class="id" title="var">easy</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">propify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="var">p0</span>, <span class="id" title="var">IHX</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">easy</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">induction</span> <span class="id" title="var">X</span> <span class="id" title="tactic">in</span> <span class="id" title="var">m</span>, <span class="id" title="var">X</span>, <span class="id" title="var">k</span>, <span class="id" title="var">expt</span> |- *; [<span class="id" title="var">easy</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">propify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- !<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Arith.PeanoNat.html#Nat.add_succ_r"><span class="id" title="lemma">Nat.add_succ_r</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="var">p</span>, <span class="id" title="var">IHX</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">induction</span> <span class="id" title="var">X</span> <span class="id" title="tactic">in</span> <span class="id" title="var">m</span>, <span class="id" title="var">X</span>, <span class="id" title="var">k</span>, <span class="id" title="var">expt</span> |- *; [<span class="id" title="var">easy</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">propify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- !<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Arith.PeanoNat.html#Nat.add_succ_r"><span class="id" title="lemma">Nat.add_succ_r</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="var">p</span>, <span class="id" title="var">IHX</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">reflexivity</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a name="is_expanded_substl"><span class="id" title="lemma">is_expanded_substl</span></a> <span class="id" title="var">s</span> <span class="id" title="var">n</span> <span class="id" title="var">t</span> :<br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#Forall"><span class="id" title="inductive">Forall</span></a> (<span class="id" title="keyword">fun</span> <span class="id" title="var">s</span> =&gt; <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#is_expanded"><span class="id" title="abbreviation">is_expanded</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#s"><span class="id" title="variable">s</span></a>) <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#s"><span class="id" title="variable">s</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#is_expanded_aux"><span class="id" title="abbreviation">is_expanded_aux</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#n"><span class="id" title="variable">n</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#t"><span class="id" title="variable">t</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#is_expanded_aux"><span class="id" title="abbreviation">is_expanded_aux</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#n"><span class="id" title="variable">n</span></a> (<span class="id" title="definition">substl</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#s"><span class="id" title="variable">s</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#t"><span class="id" title="variable">t</span></a>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">all</span> <span class="id" title="var">exp</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="definition">substl</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">s</span> <span class="id" title="keyword">using</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#rev_ind"><span class="id" title="lemma">List.rev_ind</span></a>; [<span class="id" title="var">easy</span>|].<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#fold_left_app"><span class="id" title="lemma">fold_left_app</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="ConCert.Extraction.Utils.html#Forall_snoc"><span class="id" title="lemma">Forall_snoc</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">all</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#is_expanded_csubst"><span class="id" title="lemma">is_expanded_csubst</span></a>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a name="Forall_is_expanded_fix_subst"><span class="id" title="lemma">Forall_is_expanded_fix_subst</span></a> <span class="id" title="var">defs</span> :<br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#Forall"><span class="id" title="inductive">Forall</span></a> (<a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#is_expanded"><span class="id" title="abbreviation">is_expanded</span></a> <span class="id" title="notation">∘</span> <span class="id" title="projection">dbody</span>) <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#defs"><span class="id" title="variable">defs</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#Forall"><span class="id" title="inductive">Forall</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#is_expanded"><span class="id" title="abbreviation">is_expanded</span></a> (<span class="id" title="definition">fix_subst</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#defs"><span class="id" title="variable">defs</span></a>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">all</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="definition">fix_subst</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">defs</span> <span class="id" title="tactic">at</span> 2; <span class="id" title="tactic">constructor</span>; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;- <span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <span class="id" title="lemma">forallb_Forall</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <span class="id" title="var">IHl</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a name="Forall_is_expanded_cofix_subst"><span class="id" title="lemma">Forall_is_expanded_cofix_subst</span></a> <span class="id" title="var">defs</span> :<br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#Forall"><span class="id" title="inductive">Forall</span></a> (<a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#is_expanded"><span class="id" title="abbreviation">is_expanded</span></a> <span class="id" title="notation">∘</span> <span class="id" title="projection">dbody</span>) <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#defs"><span class="id" title="variable">defs</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#Forall"><span class="id" title="inductive">Forall</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#is_expanded"><span class="id" title="abbreviation">is_expanded</span></a> (<span class="id" title="definition">cofix_subst</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#defs"><span class="id" title="variable">defs</span></a>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">all</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="definition">cofix_subst</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">defs</span> <span class="id" title="tactic">at</span> 2; <span class="id" title="tactic">constructor</span>; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;- <span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <span class="id" title="lemma">forallb_Forall</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <span class="id" title="var">IHl</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a name="is_expanded_cunfold_fix"><span class="id" title="lemma">is_expanded_cunfold_fix</span></a> <span class="id" title="var">defs</span> <span class="id" title="var">i</span> <span class="id" title="var">narg</span> <span class="id" title="var">f</span> :<br/>
&nbsp;&nbsp;<span class="id" title="definition">cunfold_fix</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#defs"><span class="id" title="variable">defs</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#i"><span class="id" title="variable">i</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#narg"><span class="id" title="variable">narg</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#f"><span class="id" title="variable">f</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#Forall"><span class="id" title="inductive">Forall</span></a> (<span class="id" title="keyword">fun</span> <span class="id" title="var">d</span> =&gt; <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#is_expanded"><span class="id" title="abbreviation">is_expanded</span></a> (<span class="id" title="projection">dbody</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#d"><span class="id" title="variable">d</span></a>)) <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#defs"><span class="id" title="variable">defs</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#is_expanded"><span class="id" title="abbreviation">is_expanded</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#f"><span class="id" title="variable">f</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">cuf</span> <span class="id" title="var">all</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="definition">cunfold_fix</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#nth_error"><span class="id" title="definition">nth_error</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span>) <span class="id" title="var">eqn</span>:<span class="id" title="var">nth</span>; [|<span class="id" title="tactic">congruence</span>].<br/>
&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <span class="id" title="lemma">nth_error_forall</span> <span class="id" title="tactic">in</span> <span class="id" title="var">nth</span>; [|<span class="id" title="var">eassumption</span>].<br/>
&nbsp;&nbsp;<span class="id" title="var">noconf</span> <span class="id" title="var">cuf</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#is_expanded_substl"><span class="id" title="lemma">is_expanded_substl</span></a>; [|<span class="id" title="var">easy</span>].<br/>
&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#Forall_is_expanded_fix_subst"><span class="id" title="lemma">Forall_is_expanded_fix_subst</span></a>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a name="is_expanded_cunfold_cofix"><span class="id" title="lemma">is_expanded_cunfold_cofix</span></a> <span class="id" title="var">defs</span> <span class="id" title="var">i</span> <span class="id" title="var">narg</span> <span class="id" title="var">f</span> :<br/>
&nbsp;&nbsp;<span class="id" title="definition">cunfold_cofix</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#defs"><span class="id" title="variable">defs</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#i"><span class="id" title="variable">i</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#narg"><span class="id" title="variable">narg</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#f"><span class="id" title="variable">f</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#Forall"><span class="id" title="inductive">Forall</span></a> (<span class="id" title="keyword">fun</span> <span class="id" title="var">d</span> =&gt; <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#is_expanded"><span class="id" title="abbreviation">is_expanded</span></a> (<span class="id" title="projection">dbody</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#d"><span class="id" title="variable">d</span></a>)) <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#defs"><span class="id" title="variable">defs</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#is_expanded"><span class="id" title="abbreviation">is_expanded</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#f"><span class="id" title="variable">f</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">cuf</span> <span class="id" title="var">all</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="definition">cunfold_cofix</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#nth_error"><span class="id" title="definition">nth_error</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span>) <span class="id" title="var">eqn</span>:<span class="id" title="var">nth</span>; [|<span class="id" title="tactic">congruence</span>].<br/>
&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <span class="id" title="lemma">nth_error_forall</span> <span class="id" title="tactic">in</span> <span class="id" title="var">nth</span>; [|<span class="id" title="var">eassumption</span>].<br/>
&nbsp;&nbsp;<span class="id" title="var">noconf</span> <span class="id" title="var">cuf</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#is_expanded_substl"><span class="id" title="lemma">is_expanded_substl</span></a>; [|<span class="id" title="var">easy</span>].<br/>
&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#Forall_is_expanded_cofix_subst"><span class="id" title="lemma">Forall_is_expanded_cofix_subst</span></a>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a name="lookup_env_Forall"><span class="id" title="lemma">lookup_env_Forall</span></a> {<span class="id" title="var">P</span>} <span class="id" title="var">Σ</span> <span class="id" title="var">kn</span> <span class="id" title="var">decl</span> :<br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Extraction.ExAst.html#lookup_env"><span class="id" title="definition">lookup_env</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#e15c0eb40e61adefe95778c26e7840f6"><span class="id" title="variable">Σ</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#kn"><span class="id" title="variable">kn</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#decl"><span class="id" title="variable">decl</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#Forall"><span class="id" title="inductive">Forall</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#P"><span class="id" title="variable">P</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#e15c0eb40e61adefe95778c26e7840f6"><span class="id" title="variable">Σ</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">exists</span></a> <span class="id" title="var">b</span><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">,</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#P"><span class="id" title="variable">P</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#kn"><span class="id" title="variable">kn</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#b"><span class="id" title="variable">b</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#decl"><span class="id" title="variable">decl</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">look</span> <span class="id" title="var">all</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="ConCert.Extraction.ExAst.html#lookup_env"><span class="id" title="definition">lookup_env</span></a> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#find"><span class="id" title="definition">find</span></a> <span class="id" title="keyword">as</span> [((<span class="id" title="var">kn'</span> &amp; <span class="id" title="var">b</span>) &amp; <span class="id" title="var">decl'</span>)|] <span class="id" title="var">eqn</span>:<span class="id" title="var">find</span>; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *; [|<span class="id" title="tactic">congruence</span>].<br/>
&nbsp;&nbsp;<span class="id" title="var">noconf</span> <span class="id" title="var">look</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#find_some"><span class="id" title="lemma">find_some</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">find</span> <span class="id" title="keyword">as</span> (<span class="id" title="var">isin</span> &amp; <span class="id" title="var">name_eq</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="definition">eq_kername</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="definition">kername_eq_dec</span> <span class="id" title="keyword">as</span> [-&gt;|]; [|<span class="id" title="tactic">congruence</span>].<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#Forall_forall"><span class="id" title="lemma">Forall_forall</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">all</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">eexists</span>; <span class="id" title="tactic">apply</span> <span class="id" title="var">all</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a name="is_expanded_constant"><span class="id" title="lemma">is_expanded_constant</span></a> <span class="id" title="var">Σ</span> <span class="id" title="var">kn</span> <span class="id" title="var">cst</span> <span class="id" title="var">body</span> :<br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#is_expanded_env"><span class="id" title="abbreviation">is_expanded_env</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#e15c0eb40e61adefe95778c26e7840f6"><span class="id" title="variable">Σ</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<span class="id" title="definition">ETyping.declared_constant</span> (<a class="idref" href="ConCert.Extraction.ExAst.html#trans_env"><span class="id" title="definition">trans_env</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#e15c0eb40e61adefe95778c26e7840f6"><span class="id" title="variable">Σ</span></a>) <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#kn"><span class="id" title="variable">kn</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#cst"><span class="id" title="variable">cst</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<span class="id" title="projection">EAst.cst_body</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#cst"><span class="id" title="variable">cst</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#body"><span class="id" title="variable">body</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#is_expanded"><span class="id" title="abbreviation">is_expanded</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#body"><span class="id" title="variable">body</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">exp_env</span> <span class="id" title="var">decl</span> <span class="id" title="var">body_eq</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">is_expanded_env</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="lemma">forallb_Forall</span> <span class="id" title="tactic">in</span> <span class="id" title="var">exp_env</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#declared_constant_trans_env"><span class="id" title="lemma">declared_constant_trans_env</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">decl</span> <span class="id" title="keyword">as</span> [(? &amp; -&gt; &amp; <span class="id" title="var">look</span>)|(? &amp; -&gt; &amp; <span class="id" title="var">look</span>)]; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">eapply</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#lookup_env_Forall"><span class="id" title="lemma">lookup_env_Forall</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">look</span> <span class="id" title="keyword">as</span> (? &amp; <span class="id" title="var">P</span>); <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">x</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="var">body_eq</span> <span class="id" title="tactic">in</span> <span class="id" title="var">P</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">destruct</span> <span class="id" title="var">x</span>; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *; [|<span class="id" title="tactic">congruence</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">replace</span> <span class="id" title="var">body</span> <span class="id" title="keyword">with</span> <span class="id" title="constructor">tBox</span> <span class="id" title="tactic">by</span> <span class="id" title="tactic">congruence</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a name="eval_is_expanded_aux"><span class="id" title="lemma">eval_is_expanded_aux</span></a> {<span class="id" title="var">wfl</span>:<span class="id" title="class">WcbvFlags</span>} <span class="id" title="var">Σ</span> <span class="id" title="var">t</span> <span class="id" title="var">v</span> <span class="id" title="var">k</span> :<br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Extraction.ExAst.html#trans_env"><span class="id" title="definition">trans_env</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#e15c0eb40e61adefe95778c26e7840f6"><span class="id" title="variable">Σ</span></a> <a class="idref" href="ConCert.Extraction.WcbvEvalAux.html#e49f44d96100960446bedaca1e4a4428"><span class="id" title="notation">e</span></a><a class="idref" href="ConCert.Extraction.WcbvEvalAux.html#e49f44d96100960446bedaca1e4a4428"><span class="id" title="notation">⊢</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#t"><span class="id" title="variable">t</span></a> <a class="idref" href="ConCert.Extraction.WcbvEvalAux.html#e49f44d96100960446bedaca1e4a4428"><span class="id" title="notation">▷</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#v"><span class="id" title="variable">v</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#is_expanded_env"><span class="id" title="abbreviation">is_expanded_env</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#e15c0eb40e61adefe95778c26e7840f6"><span class="id" title="variable">Σ</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#is_expanded_aux"><span class="id" title="abbreviation">is_expanded_aux</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#k"><span class="id" title="variable">k</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#t"><span class="id" title="variable">t</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#is_expanded_aux"><span class="id" title="abbreviation">is_expanded_aux</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#k"><span class="id" title="variable">k</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#v"><span class="id" title="variable">v</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">ev</span> <span class="id" title="var">exp_env</span> <span class="id" title="var">exp_t</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">ev</span> <span class="id" title="tactic">in</span> <span class="id" title="var">t</span>, <span class="id" title="var">v</span>, <span class="id" title="var">k</span>, <span class="id" title="var">ev</span>, <span class="id" title="var">exp_t</span> |- *; <span class="id" title="tactic">auto</span>; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *; <span class="id" title="var">propify</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <span class="id" title="var">IHev3</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#is_expanded_csubst"><span class="id" title="lemma">is_expanded_csubst</span></a>; <span class="id" title="tactic">intuition</span> <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">eapply</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#is_expanded_aux_upwards"><span class="id" title="lemma">is_expanded_aux_upwards</span></a>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <span class="id" title="var">IHev2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#is_expanded_csubst"><span class="id" title="lemma">is_expanded_csubst</span></a>; <span class="id" title="tactic">intuition</span> <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">eapply</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#is_expanded_aux_upwards"><span class="id" title="lemma">is_expanded_aux_upwards</span></a>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <span class="id" title="var">IHev2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="definition">ETyping.iota_red</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">specialize</span> (<span class="id" title="var">IHev1</span> 0 <span class="id" title="keyword">ltac</span>:(<span class="id" title="var">easy</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#is_expanded_aux_mkApps_inv"><span class="id" title="lemma">is_expanded_aux_mkApps_inv</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">IHev1</span> <span class="id" title="keyword">as</span> (<span class="id" title="var">exp_hd</span> &amp; <span class="id" title="var">exp_args</span>); <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#is_expanded_aux_mkApps"><span class="id" title="lemma">is_expanded_aux_mkApps</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">nth_nth_error</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#nth_error"><span class="id" title="definition">nth_error</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span>) <span class="id" title="var">eqn</span>:<span class="id" title="var">nth</span>; [|<span class="id" title="var">easy</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <span class="id" title="lemma">nth_error_forall</span> <span class="id" title="tactic">in</span> <span class="id" title="var">nth</span>; [|<span class="id" title="var">now</span> <span class="id" title="tactic">eapply</span> <span class="id" title="lemma">forallb_Forall</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">eapply</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#is_expanded_aux_upwards"><span class="id" title="lemma">is_expanded_aux_upwards</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <span class="id" title="lemma">Forall_skipn</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <span class="id" title="var">IHev2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#is_expanded_aux_mkApps"><span class="id" title="lemma">is_expanded_aux_mkApps</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">subst</span> <span class="id" title="var">brs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="var">propify</span>; <span class="id" title="tactic">eapply</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#is_expanded_aux_upwards"><span class="id" title="lemma">is_expanded_aux_upwards</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <a class="idref" href="ConCert.Extraction.Utils.html#Forall_repeat"><span class="id" title="lemma">Forall_repeat</span></a>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <span class="id" title="var">IHev3</span>; <span class="id" title="tactic">clear</span> <span class="id" title="var">IHev3</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">specialize</span> (<span class="id" title="var">IHev1</span> (<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#S"><span class="id" title="constructor">S</span></a> <span class="id" title="var">k</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">specialize</span> (<span class="id" title="var">IHev2</span> 0).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">propify</span>; <span class="id" title="tactic">split</span>; [<span class="id" title="var">easy</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intuition</span> <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#is_expanded_aux_mkApps_inv"><span class="id" title="lemma">is_expanded_aux_mkApps_inv</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">H2</span> <span class="id" title="keyword">as</span> (? &amp; ?).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#is_expanded_aux_mkApps"><span class="id" title="lemma">is_expanded_aux_mkApps</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">apply</span> (<a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#is_expanded_aux_upwards"><span class="id" title="lemma">is_expanded_aux_upwards</span></a> 0); [|<span class="id" title="var">lia</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#is_expanded_cunfold_fix"><span class="id" title="lemma">is_expanded_cunfold_fix</span></a>; [<span class="id" title="var">eassumption</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <span class="id" title="lemma">forallb_Forall</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">easy</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">easy</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <span class="id" title="var">IHev</span>; <span class="id" title="tactic">clear</span> <span class="id" title="var">IHev</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">propify</span>; <span class="id" title="tactic">split</span>; [|<span class="id" title="var">easy</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">exp_t</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#is_expanded_aux_mkApps_inv"><span class="id" title="lemma">is_expanded_aux_mkApps_inv</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">H</span> <span class="id" title="keyword">as</span> (<span class="id" title="var">exp_cofix</span> &amp; <span class="id" title="var">exp_args</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#is_expanded_aux_mkApps"><span class="id" title="lemma">is_expanded_aux_mkApps</span></a>; [|<span class="id" title="var">easy</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#is_expanded_aux_upwards"><span class="id" title="lemma">is_expanded_aux_upwards</span></a> 0); [|<span class="id" title="var">easy</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#is_expanded_cunfold_cofix"><span class="id" title="lemma">is_expanded_cunfold_cofix</span></a>; [<span class="id" title="var">eassumption</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <span class="id" title="lemma">forallb_Forall</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <span class="id" title="var">IHev</span>; <span class="id" title="tactic">clear</span> <span class="id" title="var">IHev</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#is_expanded_aux_mkApps_inv"><span class="id" title="lemma">is_expanded_aux_mkApps_inv</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">exp_t</span> <span class="id" title="keyword">as</span> (<span class="id" title="var">exp_cofix</span> &amp; <span class="id" title="var">exp_args</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#is_expanded_aux_mkApps"><span class="id" title="lemma">is_expanded_aux_mkApps</span></a>; [|<span class="id" title="var">easy</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#is_expanded_aux_upwards"><span class="id" title="lemma">is_expanded_aux_upwards</span></a> 0); [|<span class="id" title="var">easy</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#is_expanded_cunfold_cofix"><span class="id" title="lemma">is_expanded_cunfold_cofix</span></a>; [<span class="id" title="var">eassumption</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <span class="id" title="lemma">forallb_Forall</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <span class="id" title="var">IHev</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#is_expanded_aux_upwards"><span class="id" title="lemma">is_expanded_aux_upwards</span></a> 0); [|<span class="id" title="var">easy</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">eapply</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#is_expanded_constant"><span class="id" title="lemma">is_expanded_constant</span></a>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <span class="id" title="var">IHev2</span>; <span class="id" title="tactic">clear</span> <span class="id" title="var">IHev2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">specialize</span> (<span class="id" title="var">IHev1</span> <span class="id" title="var">_</span> <span class="id" title="var">exp_t</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#is_expanded_aux_mkApps_inv"><span class="id" title="lemma">is_expanded_aux_mkApps_inv</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">IHev1</span> <span class="id" title="keyword">as</span> (<span class="id" title="var">exp_hd</span> &amp; <span class="id" title="var">exp_args</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">nth_nth_error</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#nth_error"><span class="id" title="definition">nth_error</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span>) <span class="id" title="var">eqn</span>:<span class="id" title="var">nth</span>; [|<span class="id" title="var">easy</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <span class="id" title="lemma">nth_error_forall</span> <span class="id" title="tactic">in</span> <span class="id" title="var">nth</span>; [|<span class="id" title="var">eassumption</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> (<a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#is_expanded_aux_upwards"><span class="id" title="lemma">is_expanded_aux_upwards</span></a> 0).<br/>
&nbsp;&nbsp;- <span class="id" title="var">easy</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a name="valid_case_masks_lift"><span class="id" title="lemma">valid_case_masks_lift</span></a> <span class="id" title="var">ind</span> <span class="id" title="var">c</span> <span class="id" title="var">brs</span> <span class="id" title="var">n</span> <span class="id" title="var">k</span> :<br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#valid_case_masks"><span class="id" title="abbreviation">valid_case_masks</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#ind"><span class="id" title="variable">ind</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#c"><span class="id" title="variable">c</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#brs"><span class="id" title="variable">brs</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#valid_case_masks"><span class="id" title="abbreviation">valid_case_masks</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#ind"><span class="id" title="variable">ind</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#c"><span class="id" title="variable">c</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#map"><span class="id" title="definition">map</span></a> (<span class="id" title="definition">on_snd</span> (<span class="id" title="definition">lift</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#n"><span class="id" title="variable">n</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#k"><span class="id" title="variable">k</span></a>)) <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#brs"><span class="id" title="variable">brs</span></a>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">valid</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">valid_case_masks</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#get_mib_masks"><span class="id" title="abbreviation">get_mib_masks</span></a> <span class="id" title="var">_</span>); [|<span class="id" title="var">easy</span>].<br/>
&nbsp;&nbsp;<span class="id" title="var">propify</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">split</span>; [<span class="id" title="var">easy</span>|].<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">valid</span> <span class="id" title="keyword">as</span> (<span class="id" title="var">_</span> &amp; <span class="id" title="var">valid</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="ConCert.Extraction.Utils.html#Alli_alli"><span class="id" title="lemma">Alli_alli</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="ConCert.Extraction.Utils.html#alli_Alli"><span class="id" title="lemma">alli_Alli</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">valid</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="ConCert.Extraction.Utils.html#Alli_map"><span class="id" title="lemma">Alli_map</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <span class="id" title="lemma">Alli_impl</span>; [<span class="id" title="var">eassumption</span>|].<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> ? [] <span class="id" title="var">val_branch</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *; <span class="id" title="var">propify</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">split</span>; [<span class="id" title="var">easy</span>|].<br/>
&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#valid_dearg_mask_lift"><span class="id" title="lemma">valid_dearg_mask_lift</span></a>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a name="valid_case_masks_subst"><span class="id" title="lemma">valid_case_masks_subst</span></a> <span class="id" title="var">ind</span> <span class="id" title="var">c</span> <span class="id" title="var">brs</span> <span class="id" title="var">s</span> <span class="id" title="var">k</span> :<br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#valid_case_masks"><span class="id" title="abbreviation">valid_case_masks</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#ind"><span class="id" title="variable">ind</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#c"><span class="id" title="variable">c</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#brs"><span class="id" title="variable">brs</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#valid_case_masks"><span class="id" title="abbreviation">valid_case_masks</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#ind"><span class="id" title="variable">ind</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#c"><span class="id" title="variable">c</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#map"><span class="id" title="definition">map</span></a> (<span class="id" title="definition">on_snd</span> (<span class="id" title="definition">subst</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#s"><span class="id" title="variable">s</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#k"><span class="id" title="variable">k</span></a>)) <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#brs"><span class="id" title="variable">brs</span></a>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">valid</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">valid_case_masks</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#get_mib_masks"><span class="id" title="abbreviation">get_mib_masks</span></a> <span class="id" title="var">_</span>); [|<span class="id" title="var">easy</span>].<br/>
&nbsp;&nbsp;<span class="id" title="var">propify</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">split</span>; [<span class="id" title="var">easy</span>|].<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">valid</span> <span class="id" title="keyword">as</span> (<span class="id" title="var">_</span> &amp; <span class="id" title="var">valid</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="ConCert.Extraction.Utils.html#Alli_alli"><span class="id" title="lemma">Alli_alli</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="ConCert.Extraction.Utils.html#alli_Alli"><span class="id" title="lemma">alli_Alli</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">valid</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="ConCert.Extraction.Utils.html#Alli_map"><span class="id" title="lemma">Alli_map</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <span class="id" title="lemma">Alli_impl</span>; [<span class="id" title="var">eassumption</span>|].<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> ? [] <span class="id" title="var">val_branch</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *; <span class="id" title="var">propify</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">split</span>; [<span class="id" title="var">easy</span>|].<br/>
&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#valid_dearg_mask_subst"><span class="id" title="lemma">valid_dearg_mask_subst</span></a>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a name="valid_cases_lift"><span class="id" title="lemma">valid_cases_lift</span></a> <span class="id" title="var">t</span> <span class="id" title="var">n</span> <span class="id" title="var">k</span> :<br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#valid_cases"><span class="id" title="abbreviation">valid_cases</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#t"><span class="id" title="variable">t</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#valid_cases"><span class="id" title="abbreviation">valid_cases</span></a> (<span class="id" title="definition">lift</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#n"><span class="id" title="variable">n</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#k"><span class="id" title="variable">k</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#t"><span class="id" title="variable">t</span></a>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">valid_t</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">t</span> <span class="id" title="tactic">in</span> <span class="id" title="var">t</span>, <span class="id" title="var">k</span>, <span class="id" title="var">valid_t</span> |- * <span class="id" title="keyword">using</span> <span class="id" title="lemma">term_forall_list_ind</span>; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *; <span class="id" title="var">propify</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">now</span> <span class="id" title="tactic">destruct</span> (<span class="id" title="var">_</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Arith.PeanoNat.html#0f31f5c1c6b6a21a3a187247222bc9e4"><span class="id" title="notation">&lt;=?</span></a> <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">induction</span> <span class="id" title="var">X</span>; [<span class="id" title="var">easy</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="var">propify</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">easy</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">easy</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">destruct</span> <span class="id" title="var">p</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">propify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>; [|<span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#valid_case_masks_lift"><span class="id" title="lemma">valid_case_masks_lift</span></a>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>; [<span class="id" title="var">easy</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">valid_t</span> <span class="id" title="keyword">as</span> ((<span class="id" title="var">_</span> &amp; <span class="id" title="var">valid</span>) &amp; <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">X</span>; [<span class="id" title="var">easy</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="var">propify</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">destruct</span> <span class="id" title="var">s</span> <span class="id" title="keyword">as</span> ((<span class="id" title="var">ind</span> &amp; <span class="id" title="var">npars</span>) &amp; <span class="id" title="var">arg</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="var">propify</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">induction</span> <span class="id" title="var">X</span> <span class="id" title="tactic">in</span> <span class="id" title="var">X</span>, <span class="id" title="var">k</span>, <span class="id" title="var">valid_t</span> |- *; [<span class="id" title="var">easy</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">propify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> &lt;- !<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Arith.PeanoNat.html#Nat.add_succ_r"><span class="id" title="lemma">Nat.add_succ_r</span></a>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">induction</span> <span class="id" title="var">X</span> <span class="id" title="tactic">in</span> <span class="id" title="var">X</span>, <span class="id" title="var">k</span>, <span class="id" title="var">valid_t</span> |- *; [<span class="id" title="var">easy</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">propify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> &lt;- !<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Arith.PeanoNat.html#Nat.add_succ_r"><span class="id" title="lemma">Nat.add_succ_r</span></a>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a name="valid_cases_subst"><span class="id" title="lemma">valid_cases_subst</span></a> <span class="id" title="var">s</span> <span class="id" title="var">k</span> <span class="id" title="var">t</span> :<br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#valid_cases"><span class="id" title="abbreviation">valid_cases</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#s"><span class="id" title="variable">s</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#valid_cases"><span class="id" title="abbreviation">valid_cases</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#t"><span class="id" title="variable">t</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#valid_cases"><span class="id" title="abbreviation">valid_cases</span></a> (<span class="id" title="definition">subst</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#ddd65c2f7ee73ecec433744948d846bb"><span class="id" title="notation">[</span></a><a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#s"><span class="id" title="variable">s</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#ddd65c2f7ee73ecec433744948d846bb"><span class="id" title="notation">]</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#k"><span class="id" title="variable">k</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#t"><span class="id" title="variable">t</span></a>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">valid_s</span> <span class="id" title="var">valid_t</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">t</span> <span class="id" title="tactic">in</span> <span class="id" title="var">k</span>, <span class="id" title="var">t</span>, <span class="id" title="var">valid_t</span> |- * <span class="id" title="keyword">using</span> <span class="id" title="lemma">term_forall_list_ind</span>; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *; <span class="id" title="var">propify</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">destruct</span> (<span class="id" title="var">_</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Arith.PeanoNat.html#0f31f5c1c6b6a21a3a187247222bc9e4"><span class="id" title="notation">&lt;=?</span></a> <span class="id" title="var">_</span>); [|<span class="id" title="var">easy</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#nth_error"><span class="id" title="definition">nth_error</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span>) <span class="id" title="var">eqn</span>:<span class="id" title="var">nth</span>; [|<span class="id" title="var">easy</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<span class="id" title="var">_</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Peano.html#7825ccc99f23b0d30c9d40c317ba7af0"><span class="id" title="notation">-</span></a> <span class="id" title="var">_</span>); <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">noconf</span> <span class="id" title="var">nth</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#valid_cases_lift"><span class="id" title="lemma">valid_cases_lift</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">nth_error_nil</span> <span class="id" title="tactic">in</span> <span class="id" title="var">nth</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">induction</span> <span class="id" title="var">X</span>; [<span class="id" title="var">easy</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *; <span class="id" title="var">propify</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">easy</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">easy</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">destruct</span> <span class="id" title="var">p</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *; <span class="id" title="var">propify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>; [|<span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#valid_case_masks_subst"><span class="id" title="lemma">valid_case_masks_subst</span></a>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>; [<span class="id" title="var">easy</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">valid_t</span> <span class="id" title="keyword">as</span> ((<span class="id" title="var">_</span> &amp; <span class="id" title="var">valid</span>) &amp; <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">X</span>; [<span class="id" title="var">easy</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *; <span class="id" title="var">propify</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">destruct</span> <span class="id" title="var">s0</span> <span class="id" title="keyword">as</span> ((<span class="id" title="var">ind</span> &amp; <span class="id" title="var">npars</span>) &amp; <span class="id" title="var">arg</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="var">propify</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">induction</span> <span class="id" title="var">X</span> <span class="id" title="tactic">in</span> <span class="id" title="var">X</span>, <span class="id" title="var">k</span>, <span class="id" title="var">valid_t</span> |- *; [<span class="id" title="var">easy</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *; <span class="id" title="var">propify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> &lt;- !<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Arith.PeanoNat.html#Nat.add_succ_r"><span class="id" title="lemma">Nat.add_succ_r</span></a>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">induction</span> <span class="id" title="var">X</span> <span class="id" title="tactic">in</span> <span class="id" title="var">X</span>, <span class="id" title="var">k</span>, <span class="id" title="var">valid_t</span> |- *; [<span class="id" title="var">easy</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *; <span class="id" title="var">propify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> &lt;- !<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Arith.PeanoNat.html#Nat.add_succ_r"><span class="id" title="lemma">Nat.add_succ_r</span></a>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a name="closedn_dearg_single"><span class="id" title="lemma">closedn_dearg_single</span></a> <span class="id" title="var">k</span> <span class="id" title="var">t</span> <span class="id" title="var">args</span> <span class="id" title="var">mask</span> :<br/>
&nbsp;&nbsp;<span class="id" title="definition">closedn</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#k"><span class="id" title="variable">k</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#t"><span class="id" title="variable">t</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#Forall"><span class="id" title="inductive">Forall</span></a> (<span class="id" title="definition">closedn</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#k"><span class="id" title="variable">k</span></a>) <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#args"><span class="id" title="variable">args</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<span class="id" title="definition">closedn</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#k"><span class="id" title="variable">k</span></a> (<a class="idref" href="ConCert.Extraction.Optimize.html#dearg_single"><span class="id" title="definition">dearg_single</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#mask"><span class="id" title="variable">mask</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#t"><span class="id" title="variable">t</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#args"><span class="id" title="variable">args</span></a>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">clos_t</span> <span class="id" title="var">clos_args</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">mask</span> <span class="id" title="keyword">as</span> [|[] <span class="id" title="var">mask</span> <span class="id" title="var">IH</span>] <span class="id" title="tactic">in</span> <span class="id" title="var">k</span>, <span class="id" title="var">t</span>, <span class="id" title="var">args</span>, <span class="id" title="var">mask</span>, <span class="id" title="var">clos_t</span>, <span class="id" title="var">clos_args</span> |- *; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;- <span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <a class="idref" href="ConCert.Extraction.ClosedAux.html#closedn_mkApps"><span class="id" title="lemma">closedn_mkApps</span></a>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">depelim</span> <span class="id" title="var">clos_args</span>; [|<span class="id" title="var">easy</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">IH</span>; [|<span class="id" title="var">easy</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">pose</span> <span class="id" title="var">proof</span> (<a class="idref" href="ConCert.Extraction.ClosedAux.html#closedn_lift"><span class="id" title="lemma">closedn_lift</span></a> 1 <span class="id" title="var">k</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Arith.PeanoNat.html#Nat.add_1_r"><span class="id" title="lemma">Nat.add_1_r</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">H</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">depelim</span> <span class="id" title="var">clos_args</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">IH</span>; [|<span class="id" title="var">easy</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Bool.Bool.html#andb_true_r"><span class="id" title="lemma">Bool.andb_true_r</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">pose</span> <span class="id" title="var">proof</span> (<a class="idref" href="ConCert.Extraction.ClosedAux.html#closedn_lift"><span class="id" title="lemma">closedn_lift</span></a> 1 <span class="id" title="var">k</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Arith.PeanoNat.html#Nat.add_1_r"><span class="id" title="lemma">Nat.add_1_r</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">apply</span> <span class="id" title="var">IH</span>; [|<span class="id" title="var">easy</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="var">propify</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a name="closedn_dearg_lambdas"><span class="id" title="lemma">closedn_dearg_lambdas</span></a> <span class="id" title="var">k</span> <span class="id" title="var">mask</span> <span class="id" title="var">t</span> :<br/>
&nbsp;&nbsp;<span class="id" title="definition">closedn</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#k"><span class="id" title="variable">k</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#t"><span class="id" title="variable">t</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<span class="id" title="definition">closedn</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#k"><span class="id" title="variable">k</span></a> (<a class="idref" href="ConCert.Extraction.Optimize.html#dearg_lambdas"><span class="id" title="definition">dearg_lambdas</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#mask"><span class="id" title="variable">mask</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#t"><span class="id" title="variable">t</span></a>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">clos</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">t</span> <span class="id" title="tactic">in</span> <span class="id" title="var">k</span>, <span class="id" title="var">mask</span>, <span class="id" title="var">t</span>, <span class="id" title="var">clos</span> |- *; <span class="id" title="tactic">auto</span>; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">destruct</span> <span class="id" title="var">mask</span>; [<span class="id" title="var">easy</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">b</span>; [|<span class="id" title="var">easy</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="ConCert.Extraction.ClosedAux.html#closedn_subst0"><span class="id" title="lemma">closedn_subst0</span></a>; [<span class="id" title="var">easy</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="var">cbn</span>; <span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Arith.PeanoNat.html#Nat.add_1_r"><span class="id" title="lemma">Nat.add_1_r</span></a>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">now</span> <span class="id" title="var">propify</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a name="closedn_dearg_aux"><span class="id" title="lemma">closedn_dearg_aux</span></a> <span class="id" title="var">k</span> <span class="id" title="var">args</span> <span class="id" title="var">t</span> :<br/>
&nbsp;&nbsp;<span class="id" title="definition">closedn</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#k"><span class="id" title="variable">k</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#t"><span class="id" title="variable">t</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#Forall"><span class="id" title="inductive">Forall</span></a> (<span class="id" title="definition">closedn</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#k"><span class="id" title="variable">k</span></a>) <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#args"><span class="id" title="variable">args</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<span class="id" title="definition">closedn</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#k"><span class="id" title="variable">k</span></a> (<a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#dearg_aux"><span class="id" title="abbreviation">dearg_aux</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#args"><span class="id" title="variable">args</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#t"><span class="id" title="variable">t</span></a>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">clos_t</span> <span class="id" title="var">clos_args</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">t</span> <span class="id" title="tactic">in</span> <span class="id" title="var">k</span>, <span class="id" title="var">args</span>, <span class="id" title="var">clos_t</span>, <span class="id" title="var">clos_args</span> |- * <span class="id" title="keyword">using</span> <span class="id" title="lemma">term_forall_list_ind</span>; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">try</span> <span class="id" title="tactic">solve</span> [<span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <a class="idref" href="ConCert.Extraction.ClosedAux.html#closedn_mkApps"><span class="id" title="lemma">closedn_mkApps</span></a>].<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <a class="idref" href="ConCert.Extraction.ClosedAux.html#closedn_mkApps"><span class="id" title="lemma">closedn_mkApps</span></a>; [|<span class="id" title="var">easy</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">X</span>; [<span class="id" title="var">easy</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="var">propify</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <a class="idref" href="ConCert.Extraction.ClosedAux.html#closedn_mkApps"><span class="id" title="lemma">closedn_mkApps</span></a>; [|<span class="id" title="var">easy</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="var">propify</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">propify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">IHt1</span>; [<span class="id" title="var">easy</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">constructor</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#closedn_dearg_single"><span class="id" title="lemma">closedn_dearg_single</span></a>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#closedn_dearg_single"><span class="id" title="lemma">closedn_dearg_single</span></a>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">destruct</span> <span class="id" title="var">p</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="ConCert.Extraction.ClosedAux.html#closedn_mkApps"><span class="id" title="lemma">closedn_mkApps</span></a>; [|<span class="id" title="var">easy</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">dearg_case</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#get_mib_masks"><span class="id" title="abbreviation">get_mib_masks</span></a> <span class="id" title="var">_</span>); <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *; <span class="id" title="var">propify</span>; <span class="id" title="var">cycle</span> 1.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">split</span>; [<span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <span class="id" title="var">IHt</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">clos_t</span> <span class="id" title="keyword">as</span> (<span class="id" title="var">_</span> &amp; <span class="id" title="var">clos_brs</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">X</span>; [<span class="id" title="var">easy</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *; <span class="id" title="var">propify</span>. }<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>; [<span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <span class="id" title="var">IHt</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">clos_t</span> <span class="id" title="keyword">as</span> (<span class="id" title="var">_</span> &amp; <span class="id" title="var">clos_brs</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="definition">mapi</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">generalize</span> 0.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">X</span>; [<span class="id" title="var">easy</span>|]; <span class="id" title="tactic">intros</span> <span class="id" title="var">n'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *; <span class="id" title="var">propify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">split</span>; [<span class="id" title="tactic">apply</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#closedn_dearg_lambdas"><span class="id" title="lemma">closedn_dearg_lambdas</span></a>|].<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">destruct</span> <span class="id" title="var">s</span> <span class="id" title="keyword">as</span> ((<span class="id" title="var">ind</span> &amp; <span class="id" title="var">c</span>) &amp; <span class="id" title="var">npars</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="ConCert.Extraction.ClosedAux.html#closedn_mkApps"><span class="id" title="lemma">closedn_mkApps</span></a>; [|<span class="id" title="var">easy</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">dearg_proj</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">destruct</span> (<a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#get_mib_masks"><span class="id" title="abbreviation">get_mib_masks</span></a> <span class="id" title="var">_</span>); <span class="id" title="tactic">apply</span> <span class="id" title="var">IHt</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <a class="idref" href="ConCert.Extraction.ClosedAux.html#closedn_mkApps"><span class="id" title="lemma">closedn_mkApps</span></a>; [|<span class="id" title="var">easy</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#map_length"><span class="id" title="lemma">map_length</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">X</span> <span class="id" title="tactic">in</span> <span class="id" title="var">k</span>, <span class="id" title="var">args</span>, <span class="id" title="var">X</span>, <span class="id" title="var">clos_t</span> |- *; [<span class="id" title="var">easy</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *; <span class="id" title="var">propify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>; [<span class="id" title="var">easy</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- !<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Arith.PeanoNat.html#Nat.add_succ_r"><span class="id" title="lemma">Nat.add_succ_r</span></a> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <span class="id" title="var">IHX</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <a class="idref" href="ConCert.Extraction.ClosedAux.html#closedn_mkApps"><span class="id" title="lemma">closedn_mkApps</span></a>; [|<span class="id" title="var">easy</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#map_length"><span class="id" title="lemma">map_length</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">X</span> <span class="id" title="tactic">in</span> <span class="id" title="var">k</span>, <span class="id" title="var">args</span>, <span class="id" title="var">X</span>, <span class="id" title="var">clos_t</span> |- *; [<span class="id" title="var">easy</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *; <span class="id" title="var">propify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>; [<span class="id" title="var">easy</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- !<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Arith.PeanoNat.html#Nat.add_succ_r"><span class="id" title="lemma">Nat.add_succ_r</span></a> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <span class="id" title="var">IHX</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Hint Resolve</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">closedn_subst0</span> <span class="id" title="var">closed_mkApps</span> <span class="id" title="var">closedn_dearg_aux</span> <span class="id" title="var">closed_iota_red</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">is_expanded_aux_subst</span> <span class="id" title="var">is_expanded_aux_mkApps</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">valid_cases_subst</span> : <span class="id" title="var">dearg</span>.<br/>
<span class="id" title="keyword">Hint Constructors</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#Forall"><span class="id" title="inductive">Forall</span></a> : <span class="id" title="var">dearg</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a name="valid_cases_mkApps"><span class="id" title="lemma">valid_cases_mkApps</span></a> <span class="id" title="var">hd</span> <span class="id" title="var">args</span> :<br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#valid_cases"><span class="id" title="abbreviation">valid_cases</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#hd"><span class="id" title="variable">hd</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#Forall"><span class="id" title="inductive">Forall</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#valid_cases"><span class="id" title="abbreviation">valid_cases</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#args"><span class="id" title="variable">args</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#valid_cases"><span class="id" title="abbreviation">valid_cases</span></a> (<span class="id" title="definition">mkApps</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#hd"><span class="id" title="variable">hd</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#args"><span class="id" title="variable">args</span></a>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">valid_hd</span> <span class="id" title="var">valid_args</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">args</span> <span class="id" title="keyword">as</span> [|<span class="id" title="var">a</span> <span class="id" title="var">args</span> <span class="id" title="var">IH</span>] <span class="id" title="keyword">using</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#rev_ind"><span class="id" title="lemma">List.rev_ind</span></a>; [<span class="id" title="var">easy</span>|].<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">mkApps_app</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">cbn</span>; <span class="id" title="var">propify</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <a class="idref" href="ConCert.Extraction.Utils.html#Forall_snoc"><span class="id" title="lemma">Forall_snoc</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">valid_args</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a name="valid_cases_iota_red"><span class="id" title="lemma">valid_cases_iota_red</span></a> <span class="id" title="var">pars</span> <span class="id" title="var">c</span> <span class="id" title="var">args</span> <span class="id" title="var">brs</span> :<br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#Forall"><span class="id" title="inductive">Forall</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#valid_cases"><span class="id" title="abbreviation">valid_cases</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#args"><span class="id" title="variable">args</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#Forall"><span class="id" title="inductive">Forall</span></a> (<span class="id" title="keyword">fun</span> <span class="id" title="var">t</span> =&gt; <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#valid_cases"><span class="id" title="abbreviation">valid_cases</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#t"><span class="id" title="variable">t</span></a><span class="id" title="notation">.2</span>) <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#brs"><span class="id" title="variable">brs</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#valid_cases"><span class="id" title="abbreviation">valid_cases</span></a> (<span class="id" title="definition">iota_red</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#pars"><span class="id" title="variable">pars</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#c"><span class="id" title="variable">c</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#args"><span class="id" title="variable">args</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#brs"><span class="id" title="variable">brs</span></a>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">valid_args</span> <span class="id" title="var">valid_brs</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="definition">iota_red</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#valid_cases_mkApps"><span class="id" title="lemma">valid_cases_mkApps</span></a>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">nth_nth_error</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#nth_error"><span class="id" title="definition">nth_error</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span>) <span class="id" title="var">eqn</span>:<span class="id" title="var">nth</span>; [|<span class="id" title="var">easy</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">eapply</span> <span class="id" title="lemma">nth_error_forall</span> <span class="id" title="tactic">in</span> <span class="id" title="var">nth</span>; [|<span class="id" title="var">eassumption</span>].<br/>
&nbsp;&nbsp;- <span class="id" title="var">now</span> <span class="id" title="tactic">eapply</span> <span class="id" title="lemma">Forall_skipn</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a name="valid_cases_substl"><span class="id" title="lemma">valid_cases_substl</span></a> <span class="id" title="var">s</span> <span class="id" title="var">t</span> :<br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#Forall"><span class="id" title="inductive">Forall</span></a> (<span class="id" title="keyword">fun</span> <span class="id" title="var">s</span> =&gt; <span class="id" title="abbreviation">closed</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#s"><span class="id" title="variable">s</span></a>) <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#s"><span class="id" title="variable">s</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#Forall"><span class="id" title="inductive">Forall</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#valid_cases"><span class="id" title="abbreviation">valid_cases</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#s"><span class="id" title="variable">s</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#valid_cases"><span class="id" title="abbreviation">valid_cases</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#t"><span class="id" title="variable">t</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#valid_cases"><span class="id" title="abbreviation">valid_cases</span></a> (<span class="id" title="definition">substl</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#s"><span class="id" title="variable">s</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#t"><span class="id" title="variable">t</span></a>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">clos_s</span> <span class="id" title="var">valid_s</span> <span class="id" title="var">valid_t</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="definition">substl</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">s</span> <span class="id" title="keyword">using</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#rev_ind"><span class="id" title="lemma">List.rev_ind</span></a>; [<span class="id" title="var">easy</span>|].<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#fold_left_app"><span class="id" title="lemma">fold_left_app</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="ConCert.Extraction.Utils.html#Forall_snoc"><span class="id" title="lemma">Forall_snoc</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">clos_s</span> <span class="id" title="keyword">as</span> (? &amp; ?).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="ConCert.Extraction.Utils.html#Forall_snoc"><span class="id" title="lemma">Forall_snoc</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">valid_s</span> <span class="id" title="keyword">as</span> (? &amp; ?).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">closed_subst</span> <span class="id" title="tactic">by</span> <span class="id" title="var">easy</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#valid_cases_subst"><span class="id" title="lemma">valid_cases_subst</span></a>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a name="Forall_closed_fix_subst"><span class="id" title="lemma">Forall_closed_fix_subst</span></a> <span class="id" title="var">defs</span> :<br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#Forall"><span class="id" title="inductive">Forall</span></a> (<span class="id" title="definition">closedn</span> <span class="id" title="notation">#|</span><a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#defs"><span class="id" title="variable">defs</span></a><span class="id" title="notation">|</span> <span class="id" title="notation">∘</span> <span class="id" title="projection">dbody</span>) <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#defs"><span class="id" title="variable">defs</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#Forall"><span class="id" title="inductive">Forall</span></a> (<span class="id" title="definition">closedn</span> 0) (<span class="id" title="definition">fix_subst</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#defs"><span class="id" title="variable">defs</span></a>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">all</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="definition">fix_subst</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">defs</span> <span class="id" title="tactic">at</span> 2; <span class="id" title="tactic">constructor</span>; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <span class="id" title="lemma">forallb_Forall</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <span class="id" title="lemma">Forall_impl</span>; [<span class="id" title="var">eassumption</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Arith.PeanoNat.html#Nat.add_0_r"><span class="id" title="lemma">Nat.add_0_r</span></a>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <span class="id" title="var">IHl</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a name="Forall_closed_cofix_subst"><span class="id" title="lemma">Forall_closed_cofix_subst</span></a> <span class="id" title="var">defs</span> :<br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#Forall"><span class="id" title="inductive">Forall</span></a> (<span class="id" title="definition">closedn</span> <span class="id" title="notation">#|</span><a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#defs"><span class="id" title="variable">defs</span></a><span class="id" title="notation">|</span> <span class="id" title="notation">∘</span> <span class="id" title="projection">dbody</span>) <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#defs"><span class="id" title="variable">defs</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#Forall"><span class="id" title="inductive">Forall</span></a> (<span class="id" title="definition">closedn</span> 0) (<span class="id" title="definition">cofix_subst</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#defs"><span class="id" title="variable">defs</span></a>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">all</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="definition">cofix_subst</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">defs</span> <span class="id" title="tactic">at</span> 2; <span class="id" title="tactic">constructor</span>; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <span class="id" title="lemma">forallb_Forall</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <span class="id" title="lemma">Forall_impl</span>; [<span class="id" title="var">eassumption</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Arith.PeanoNat.html#Nat.add_0_r"><span class="id" title="lemma">Nat.add_0_r</span></a>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <span class="id" title="var">IHl</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a name="Forall_valid_cases_fix_subst"><span class="id" title="lemma">Forall_valid_cases_fix_subst</span></a> <span class="id" title="var">defs</span> :<br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#Forall"><span class="id" title="inductive">Forall</span></a> (<a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#valid_cases"><span class="id" title="abbreviation">valid_cases</span></a> <span class="id" title="notation">∘</span> <span class="id" title="projection">dbody</span>) <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#defs"><span class="id" title="variable">defs</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#Forall"><span class="id" title="inductive">Forall</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#valid_cases"><span class="id" title="abbreviation">valid_cases</span></a> (<span class="id" title="definition">fix_subst</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#defs"><span class="id" title="variable">defs</span></a>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">all</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="definition">fix_subst</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">defs</span> <span class="id" title="tactic">at</span> 2; <span class="id" title="tactic">constructor</span>; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;- <span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <span class="id" title="lemma">forallb_Forall</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <span class="id" title="var">IHl</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a name="Forall_valid_cases_cofix_subst"><span class="id" title="lemma">Forall_valid_cases_cofix_subst</span></a> <span class="id" title="var">defs</span> :<br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#Forall"><span class="id" title="inductive">Forall</span></a> (<a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#valid_cases"><span class="id" title="abbreviation">valid_cases</span></a> <span class="id" title="notation">∘</span> <span class="id" title="projection">dbody</span>) <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#defs"><span class="id" title="variable">defs</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#Forall"><span class="id" title="inductive">Forall</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#valid_cases"><span class="id" title="abbreviation">valid_cases</span></a> (<span class="id" title="definition">cofix_subst</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#defs"><span class="id" title="variable">defs</span></a>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">all</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="definition">cofix_subst</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">defs</span> <span class="id" title="tactic">at</span> 2; <span class="id" title="tactic">constructor</span>; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;- <span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <span class="id" title="lemma">forallb_Forall</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <span class="id" title="var">IHl</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a name="valid_cases_cunfold_fix"><span class="id" title="lemma">valid_cases_cunfold_fix</span></a> <span class="id" title="var">defs</span> <span class="id" title="var">i</span> <span class="id" title="var">narg</span> <span class="id" title="var">f</span> :<br/>
&nbsp;&nbsp;<span class="id" title="definition">cunfold_fix</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#defs"><span class="id" title="variable">defs</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#i"><span class="id" title="variable">i</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#narg"><span class="id" title="variable">narg</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#f"><span class="id" title="variable">f</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<span class="id" title="abbreviation">closed</span> (<span class="id" title="constructor">tFix</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#defs"><span class="id" title="variable">defs</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#i"><span class="id" title="variable">i</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#valid_cases"><span class="id" title="abbreviation">valid_cases</span></a> (<span class="id" title="constructor">tFix</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#defs"><span class="id" title="variable">defs</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#i"><span class="id" title="variable">i</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#valid_cases"><span class="id" title="abbreviation">valid_cases</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#f"><span class="id" title="variable">f</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">cuf</span> <span class="id" title="var">clos_defs</span> <span class="id" title="var">valid_defs</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="definition">cunfold_fix</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#nth_error"><span class="id" title="definition">nth_error</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span>) <span class="id" title="var">eqn</span>:<span class="id" title="var">nth</span>; [|<span class="id" title="tactic">congruence</span>].<br/>
&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <span class="id" title="lemma">nth_error_forallb</span> <span class="id" title="tactic">in</span> <span class="id" title="var">clos_defs</span> <span class="id" title="keyword">as</span> ?.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <span class="id" title="lemma">nth_error_forallb</span> <span class="id" title="tactic">in</span> <span class="id" title="var">valid_defs</span> <span class="id" title="keyword">as</span> ?.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">nth</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;<span class="id" title="var">noconf</span> <span class="id" title="var">cuf</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#valid_cases_substl"><span class="id" title="lemma">valid_cases_substl</span></a>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#Forall_closed_fix_subst"><span class="id" title="lemma">Forall_closed_fix_subst</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="lemma">forallb_Forall</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <span class="id" title="lemma">forallb_impl</span>; [|<span class="id" title="tactic">exact</span> <span class="id" title="var">clos_defs</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Arith.PeanoNat.html#Nat.add_0_r"><span class="id" title="lemma">Nat.add_0_r</span></a> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#Forall_valid_cases_fix_subst"><span class="id" title="lemma">Forall_valid_cases_fix_subst</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <span class="id" title="lemma">forallb_Forall</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">easy</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a name="valid_cases_cunfold_cofix"><span class="id" title="lemma">valid_cases_cunfold_cofix</span></a> <span class="id" title="var">defs</span> <span class="id" title="var">i</span> <span class="id" title="var">narg</span> <span class="id" title="var">f</span> :<br/>
&nbsp;&nbsp;<span class="id" title="definition">cunfold_cofix</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#defs"><span class="id" title="variable">defs</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#i"><span class="id" title="variable">i</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#narg"><span class="id" title="variable">narg</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#f"><span class="id" title="variable">f</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<span class="id" title="abbreviation">closed</span> (<span class="id" title="constructor">tCoFix</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#defs"><span class="id" title="variable">defs</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#i"><span class="id" title="variable">i</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#valid_cases"><span class="id" title="abbreviation">valid_cases</span></a> (<span class="id" title="constructor">tCoFix</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#defs"><span class="id" title="variable">defs</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#i"><span class="id" title="variable">i</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#valid_cases"><span class="id" title="abbreviation">valid_cases</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#f"><span class="id" title="variable">f</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">cuf</span> <span class="id" title="var">clos_defs</span> <span class="id" title="var">valid_defs</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="definition">cunfold_cofix</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <span class="id" title="lemma">nth_error_forallb</span> <span class="id" title="tactic">in</span> <span class="id" title="var">clos_defs</span> <span class="id" title="keyword">as</span> ?.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <span class="id" title="lemma">nth_error_forallb</span> <span class="id" title="tactic">in</span> <span class="id" title="var">valid_defs</span> <span class="id" title="keyword">as</span> ?.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#nth_error"><span class="id" title="definition">nth_error</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span>) <span class="id" title="var">eqn</span>:<span class="id" title="var">nth</span>; [|<span class="id" title="tactic">congruence</span>].<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">nth</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;<span class="id" title="var">noconf</span> <span class="id" title="var">cuf</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#valid_cases_substl"><span class="id" title="lemma">valid_cases_substl</span></a>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#Forall_closed_cofix_subst"><span class="id" title="lemma">Forall_closed_cofix_subst</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="lemma">forallb_Forall</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <span class="id" title="lemma">forallb_impl</span>; [|<span class="id" title="tactic">exact</span> <span class="id" title="var">clos_defs</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Arith.PeanoNat.html#Nat.add_0_r"><span class="id" title="lemma">Nat.add_0_r</span></a> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#Forall_valid_cases_cofix_subst"><span class="id" title="lemma">Forall_valid_cases_cofix_subst</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <span class="id" title="lemma">forallb_Forall</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">easy</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a name="valid_cases_constant"><span class="id" title="lemma">valid_cases_constant</span></a> <span class="id" title="var">Σ</span> <span class="id" title="var">kn</span> <span class="id" title="var">cst</span> <span class="id" title="var">body</span> :<br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#valid_masks_env"><span class="id" title="abbreviation">valid_masks_env</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#e15c0eb40e61adefe95778c26e7840f6"><span class="id" title="variable">Σ</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<span class="id" title="definition">ETyping.declared_constant</span> (<a class="idref" href="ConCert.Extraction.ExAst.html#trans_env"><span class="id" title="definition">trans_env</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#e15c0eb40e61adefe95778c26e7840f6"><span class="id" title="variable">Σ</span></a>) <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#kn"><span class="id" title="variable">kn</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#cst"><span class="id" title="variable">cst</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<span class="id" title="projection">EAst.cst_body</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#cst"><span class="id" title="variable">cst</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#body"><span class="id" title="variable">body</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#valid_cases"><span class="id" title="abbreviation">valid_cases</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#body"><span class="id" title="variable">body</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">valid_env</span> <span class="id" title="var">decl_const</span> <span class="id" title="var">body_eq</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#declared_constant_trans_env"><span class="id" title="lemma">declared_constant_trans_env</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">decl_const</span> <span class="id" title="keyword">as</span> [(? &amp; -&gt; &amp; <span class="id" title="var">look</span>)|(? &amp; -&gt; &amp; <span class="id" title="var">look</span>)].<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <span class="id" title="lemma">forallb_Forall</span> <span class="id" title="tactic">in</span> <span class="id" title="var">valid_env</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#lookup_env_Forall"><span class="id" title="lemma">lookup_env_Forall</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">valid_env</span> <span class="id" title="keyword">as</span> (? &amp; <span class="id" title="var">valid</span>); <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">x</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="var">body_eq</span> <span class="id" title="tactic">in</span> <span class="id" title="var">valid</span>; <span class="id" title="var">propify</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">destruct</span> <span class="id" title="var">x</span>; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *; [|<span class="id" title="tactic">congruence</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">replace</span> <span class="id" title="var">body</span> <span class="id" title="keyword">with</span> <span class="id" title="constructor">tBox</span> <span class="id" title="tactic">by</span> <span class="id" title="tactic">congruence</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a name="valid_dearg_mask_constant"><span class="id" title="lemma">valid_dearg_mask_constant</span></a> <span class="id" title="var">Σ</span> <span class="id" title="var">kn</span> <span class="id" title="var">cst</span> <span class="id" title="var">body</span> :<br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#valid_masks_env"><span class="id" title="abbreviation">valid_masks_env</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#e15c0eb40e61adefe95778c26e7840f6"><span class="id" title="variable">Σ</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<span class="id" title="definition">ETyping.declared_constant</span> (<a class="idref" href="ConCert.Extraction.ExAst.html#trans_env"><span class="id" title="definition">trans_env</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#e15c0eb40e61adefe95778c26e7840f6"><span class="id" title="variable">Σ</span></a>) <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#kn"><span class="id" title="variable">kn</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#cst"><span class="id" title="variable">cst</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<span class="id" title="projection">EAst.cst_body</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#cst"><span class="id" title="variable">cst</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#body"><span class="id" title="variable">body</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Extraction.Optimize.html#valid_dearg_mask"><span class="id" title="definition">valid_dearg_mask</span></a> (<a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#get_const_mask"><span class="id" title="abbreviation">get_const_mask</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#kn"><span class="id" title="variable">kn</span></a>) <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#body"><span class="id" title="variable">body</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">valid_env</span> <span class="id" title="var">decl_const</span> <span class="id" title="var">body_eq</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="lemma">forallb_Forall</span> <span class="id" title="tactic">in</span> <span class="id" title="var">valid_env</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#declared_constant_trans_env"><span class="id" title="lemma">declared_constant_trans_env</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">decl_const</span> <span class="id" title="keyword">as</span> [(? &amp; -&gt; &amp; <span class="id" title="var">look</span>)|(? &amp; -&gt; &amp; <span class="id" title="var">look</span>)].<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">eapply</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#lookup_env_Forall"><span class="id" title="lemma">lookup_env_Forall</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">valid_env</span> <span class="id" title="keyword">as</span> (? &amp; <span class="id" title="var">valid</span>); <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">x</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="var">body_eq</span> <span class="id" title="tactic">in</span> <span class="id" title="var">valid</span>; <span class="id" title="var">propify</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">eapply</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#lookup_env_Forall"><span class="id" title="lemma">lookup_env_Forall</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">valid_env</span> <span class="id" title="keyword">as</span> (? &amp; <span class="id" title="var">valid</span>); <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">x</span>; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *; [|<span class="id" title="tactic">congruence</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">replace</span> <span class="id" title="var">body</span> <span class="id" title="keyword">with</span> <span class="id" title="constructor">tBox</span> <span class="id" title="tactic">by</span> <span class="id" title="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">destruct</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#get_const_mask"><span class="id" title="abbreviation">get_const_mask</span></a>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a name="eval_valid_cases"><span class="id" title="lemma">eval_valid_cases</span></a> {<span class="id" title="var">wfl</span>:<span class="id" title="class">WcbvFlags</span>} <span class="id" title="var">Σ</span> <span class="id" title="var">t</span> <span class="id" title="var">v</span> :<br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Extraction.ExAst.html#trans_env"><span class="id" title="definition">trans_env</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#e15c0eb40e61adefe95778c26e7840f6"><span class="id" title="variable">Σ</span></a> <a class="idref" href="ConCert.Extraction.WcbvEvalAux.html#e49f44d96100960446bedaca1e4a4428"><span class="id" title="notation">e</span></a><a class="idref" href="ConCert.Extraction.WcbvEvalAux.html#e49f44d96100960446bedaca1e4a4428"><span class="id" title="notation">⊢</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#t"><span class="id" title="variable">t</span></a> <a class="idref" href="ConCert.Extraction.WcbvEvalAux.html#e49f44d96100960446bedaca1e4a4428"><span class="id" title="notation">▷</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#v"><span class="id" title="variable">v</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
<br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Extraction.ClosedAux.html#env_closed"><span class="id" title="definition">env_closed</span></a> (<a class="idref" href="ConCert.Extraction.ExAst.html#trans_env"><span class="id" title="definition">trans_env</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#e15c0eb40e61adefe95778c26e7840f6"><span class="id" title="variable">Σ</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<span class="id" title="abbreviation">closed</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#t"><span class="id" title="variable">t</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
<br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#valid_masks_env"><span class="id" title="abbreviation">valid_masks_env</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#e15c0eb40e61adefe95778c26e7840f6"><span class="id" title="variable">Σ</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#valid_cases"><span class="id" title="abbreviation">valid_cases</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#t"><span class="id" title="variable">t</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
<br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#valid_cases"><span class="id" title="abbreviation">valid_cases</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#v"><span class="id" title="variable">v</span></a>.<br/>
<span class="id" title="keyword">Proof</span> <span class="id" title="keyword">with</span> <span class="id" title="tactic">auto</span> <span class="id" title="keyword">with</span> <span class="id" title="var">dearg</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">ev</span> <span class="id" title="var">clos_env</span> <span class="id" title="var">clos_t</span> <span class="id" title="var">valid_env</span> <span class="id" title="var">valid_t</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">ev</span> <span class="id" title="tactic">in</span> <span class="id" title="var">t</span>, <span class="id" title="var">v</span>, <span class="id" title="var">ev</span>, <span class="id" title="var">clos_t</span>, <span class="id" title="var">valid_t</span> |- *; <span class="id" title="tactic">auto</span>; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *; <span class="id" title="var">propify</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">intuition</span> <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="ConCert.Extraction.WcbvEvalAux.html#eval_closed"><span class="id" title="lemma">eval_closed</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">ev1</span> <span class="id" title="keyword">as</span> ?...<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="ConCert.Extraction.WcbvEvalAux.html#eval_closed"><span class="id" title="lemma">eval_closed</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">ev2</span> <span class="id" title="keyword">as</span> ?...<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">closed_subst</span> <span class="id" title="tactic">in</span> * <span class="id" title="tactic">by</span> <span class="id" title="var">easy</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">IHev3</span>; [<span class="id" title="tactic">apply</span> <a class="idref" href="ConCert.Extraction.ClosedAux.html#closedn_subst0"><span class="id" title="lemma">closedn_subst0</span></a>|<span class="id" title="tactic">apply</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#valid_cases_subst"><span class="id" title="lemma">valid_cases_subst</span></a>]...<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">intuition</span> <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="ConCert.Extraction.WcbvEvalAux.html#eval_closed"><span class="id" title="lemma">eval_closed</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">ev1</span> <span class="id" title="keyword">as</span> ?...<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">closed_subst</span> <span class="id" title="tactic">in</span> * <span class="id" title="tactic">by</span> <span class="id" title="var">easy</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">IHev2</span>; [<span class="id" title="tactic">apply</span> <a class="idref" href="ConCert.Extraction.ClosedAux.html#closedn_subst0"><span class="id" title="lemma">closedn_subst0</span></a>|<span class="id" title="tactic">apply</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#valid_cases_subst"><span class="id" title="lemma">valid_cases_subst</span></a>]...<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">intuition</span> <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="ConCert.Extraction.WcbvEvalAux.html#eval_closed"><span class="id" title="lemma">eval_closed</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">ev1</span> <span class="id" title="keyword">as</span> ?...<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="ConCert.Extraction.ClosedAux.html#closed_mkApps_inv"><span class="id" title="lemma">closed_mkApps_inv</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">H1</span> <span class="id" title="keyword">as</span> (? &amp; ?).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="abbreviation">closed</span> (<span class="id" title="definition">iota_red</span> <span class="id" title="var">pars</span> <span class="id" title="var">c</span> <span class="id" title="var">args</span> <span class="id" title="var">brs</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">apply</span> <a class="idref" href="ConCert.Extraction.WcbvEvalAux.html#closed_iota_red"><span class="id" title="lemma">closed_iota_red</span></a>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <span class="id" title="lemma">forallb_Forall</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="ConCert.Extraction.WcbvEvalAux.html#eval_closed"><span class="id" title="lemma">eval_closed</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">ev2</span> <span class="id" title="keyword">as</span> ?...<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#valid_cases_mkApps_inv"><span class="id" title="lemma">valid_cases_mkApps_inv</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">H5</span> <span class="id" title="keyword">as</span> (? &amp; ?).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">IHev2</span>...<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#valid_cases_iota_red"><span class="id" title="lemma">valid_cases_iota_red</span></a>...<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="lemma">forallb_Forall</span>...<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">subst</span> <span class="id" title="var">brs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">propify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intuition</span> <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">IHev2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">apply</span> <a class="idref" href="ConCert.Extraction.ClosedAux.html#closed_mkApps"><span class="id" title="lemma">closed_mkApps</span></a>...<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <a class="idref" href="ConCert.Extraction.Utils.html#Forall_repeat"><span class="id" title="lemma">Forall_repeat</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">apply</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#valid_cases_mkApps"><span class="id" title="lemma">valid_cases_mkApps</span></a>...<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <a class="idref" href="ConCert.Extraction.Utils.html#Forall_repeat"><span class="id" title="lemma">Forall_repeat</span></a>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">intuition</span> <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="ConCert.Extraction.WcbvEvalAux.html#eval_closed"><span class="id" title="lemma">eval_closed</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">ev1</span> <span class="id" title="keyword">as</span> ?...<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="ConCert.Extraction.WcbvEvalAux.html#eval_closed"><span class="id" title="lemma">eval_closed</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">ev2</span> <span class="id" title="keyword">as</span> ?...<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="ConCert.Extraction.ClosedAux.html#closed_mkApps_inv"><span class="id" title="lemma">closed_mkApps_inv</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">H6</span> <span class="id" title="keyword">as</span> (? &amp; ?).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#valid_cases_mkApps_inv"><span class="id" title="lemma">valid_cases_mkApps_inv</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">H5</span> <span class="id" title="keyword">as</span> (? &amp; ?).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">H4</span>...<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">apply</span> <a class="idref" href="ConCert.Extraction.ClosedAux.html#closed_mkApps"><span class="id" title="lemma">closed_mkApps</span></a>...<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">eapply</span> <a class="idref" href="ConCert.Extraction.WcbvEvalAux.html#closed_cunfold_fix"><span class="id" title="lemma">closed_cunfold_fix</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">split</span>; [|<span class="id" title="var">easy</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#valid_cases_mkApps"><span class="id" title="lemma">valid_cases_mkApps</span></a>...<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#valid_cases_cunfold_fix"><span class="id" title="lemma">valid_cases_cunfold_fix</span></a>; [<span class="id" title="var">eassumption</span>| |]...<br/>
&nbsp;&nbsp;- <span class="id" title="var">easy</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">destruct</span> <span class="id" title="var">ip</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">propify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intuition</span> <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="ConCert.Extraction.ClosedAux.html#closed_mkApps_inv"><span class="id" title="lemma">closed_mkApps_inv</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">H</span> <span class="id" title="keyword">as</span> (? &amp; ?).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#valid_cases_mkApps_inv"><span class="id" title="lemma">valid_cases_mkApps_inv</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">H3</span> <span class="id" title="keyword">as</span> (? &amp; ?).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="abbreviation">closed</span> <span class="id" title="var">fn</span>) <span class="id" title="tactic">by</span> (<span class="id" title="var">now</span> <span class="id" title="tactic">eapply</span> <a class="idref" href="ConCert.Extraction.WcbvEvalAux.html#closed_cunfold_cofix"><span class="id" title="lemma">closed_cunfold_cofix</span></a>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="abbreviation">closed</span> (<span class="id" title="definition">mkApps</span> <span class="id" title="var">fn</span> <span class="id" title="var">args</span>)) <span class="id" title="tactic">by</span> (<span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <a class="idref" href="ConCert.Extraction.ClosedAux.html#closed_mkApps"><span class="id" title="lemma">closed_mkApps</span></a>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="ConCert.Extraction.WcbvEvalAux.html#eval_closed"><span class="id" title="lemma">eval_closed</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">ev</span> <span class="id" title="keyword">as</span> ?...<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">apply</span> <span class="id" title="var">H1</span>...<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intuition</span> <span class="id" title="tactic">auto</span>...<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#valid_cases_mkApps"><span class="id" title="lemma">valid_cases_mkApps</span></a>...<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">eapply</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#valid_cases_cunfold_cofix"><span class="id" title="lemma">valid_cases_cunfold_cofix</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">now</span> <span class="id" title="var">cbn</span>; <span class="id" title="var">propify</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">destruct</span> <span class="id" title="var">p</span> <span class="id" title="keyword">as</span> ((<span class="id" title="var">ind</span> &amp; <span class="id" title="var">npars</span>) &amp; <span class="id" title="var">arg</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="ConCert.Extraction.ClosedAux.html#closed_mkApps_inv"><span class="id" title="lemma">closed_mkApps_inv</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">clos_t</span> <span class="id" title="keyword">as</span> (? &amp; ?).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">propify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">valid_t</span> <span class="id" title="keyword">as</span> (<span class="id" title="var">valid_t</span> &amp; <span class="id" title="var">valid_proj</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#valid_cases_mkApps_inv"><span class="id" title="lemma">valid_cases_mkApps_inv</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">valid_t</span> <span class="id" title="keyword">as</span> (? &amp; ?).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="abbreviation">closed</span> <span class="id" title="var">fn</span>) <span class="id" title="tactic">by</span> (<span class="id" title="var">now</span> <span class="id" title="tactic">eapply</span> <a class="idref" href="ConCert.Extraction.WcbvEvalAux.html#closed_cunfold_cofix"><span class="id" title="lemma">closed_cunfold_cofix</span></a>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">IHev</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <a class="idref" href="ConCert.Extraction.ClosedAux.html#closed_mkApps"><span class="id" title="lemma">closed_mkApps</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">split</span>; [|<span class="id" title="var">easy</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#valid_cases_mkApps"><span class="id" title="lemma">valid_cases_mkApps</span></a>...<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">eapply</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#valid_cases_cunfold_cofix"><span class="id" title="lemma">valid_cases_cunfold_cofix</span></a>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <span class="id" title="var">IHev</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">now</span> <span class="id" title="tactic">eapply</span> <a class="idref" href="ConCert.Extraction.WcbvEvalAux.html#closed_constant"><span class="id" title="lemma">closed_constant</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">now</span> <span class="id" title="tactic">eapply</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#valid_cases_constant"><span class="id" title="lemma">valid_cases_constant</span></a>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">intuition</span> <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="ConCert.Extraction.WcbvEvalAux.html#eval_closed"><span class="id" title="lemma">eval_closed</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">ev1</span> <span class="id" title="keyword">as</span> ?...<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="ConCert.Extraction.ClosedAux.html#closed_mkApps_inv"><span class="id" title="lemma">closed_mkApps_inv</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">H1</span> <span class="id" title="keyword">as</span> (? &amp; ?).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#valid_cases_mkApps_inv"><span class="id" title="lemma">valid_cases_mkApps_inv</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">H2</span> <span class="id" title="keyword">as</span> (? &amp; ?).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> (<span class="id" title="lemma">nth_nth_error</span> (<span class="id" title="var">pars</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Peano.html#0dacc1786c5ba797d47dd85006231633"><span class="id" title="notation">+</span></a> <span class="id" title="var">arg</span>) <span class="id" title="var">args</span> <span class="id" title="definition">tDummy</span>) <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#nth_error"><span class="id" title="definition">nth_error</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span>) <span class="id" title="var">eqn</span>:<span class="id" title="var">nth</span>; [|<span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <span class="id" title="var">IHev2</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <span class="id" title="lemma">nth_error_forall</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H4</span>; [|<span class="id" title="var">eassumption</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <span class="id" title="lemma">nth_error_forall</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H3</span>; [|<span class="id" title="var">eassumption</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <span class="id" title="var">IHev2</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">easy</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a name="lookup_env_dearg_env"><span class="id" title="lemma">lookup_env_dearg_env</span></a> <span class="id" title="var">Σ</span> <span class="id" title="var">kn</span> :<br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Extraction.ExAst.html#lookup_env"><span class="id" title="definition">lookup_env</span></a> (<a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#dearg_env"><span class="id" title="abbreviation">dearg_env</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#e15c0eb40e61adefe95778c26e7840f6"><span class="id" title="variable">Σ</span></a>) <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#kn"><span class="id" title="variable">kn</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#option_map"><span class="id" title="definition">option_map</span></a> (<a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#dearg_decl"><span class="id" title="abbreviation">dearg_decl</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#kn"><span class="id" title="variable">kn</span></a>) (<a class="idref" href="ConCert.Extraction.ExAst.html#lookup_env"><span class="id" title="definition">lookup_env</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#e15c0eb40e61adefe95778c26e7840f6"><span class="id" title="variable">Σ</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#kn"><span class="id" title="variable">kn</span></a>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="ConCert.Extraction.ExAst.html#lookup_env"><span class="id" title="definition">lookup_env</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">Σ</span> <span class="id" title="keyword">as</span> [|((<span class="id" title="var">kn'</span>, <span class="id" title="var">has_deps</span>), <span class="id" title="var">decl</span>) <span class="id" title="var">Σ</span> <span class="id" title="var">IH</span>]; [<span class="id" title="var">easy</span>|].<br/>
&nbsp;&nbsp;<span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="definition">eq_kername</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="definition">kername_eq_dec</span> <span class="id" title="keyword">as</span> [-&gt;|]; [<span class="id" title="var">easy</span>|].<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">IH</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a name="declared_constant_dearg"><span class="id" title="lemma">declared_constant_dearg</span></a> <span class="id" title="var">Σ</span> <span class="id" title="var">k</span> <span class="id" title="var">cst</span> :<br/>
&nbsp;&nbsp;<span class="id" title="definition">declared_constant</span> (<a class="idref" href="ConCert.Extraction.ExAst.html#trans_env"><span class="id" title="definition">trans_env</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#e15c0eb40e61adefe95778c26e7840f6"><span class="id" title="variable">Σ</span></a>) <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#k"><span class="id" title="variable">k</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#cst"><span class="id" title="variable">cst</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<span class="id" title="notation">∑</span> <span class="id" title="var">cst'</span><span class="id" title="notation">,</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="definition">declared_constant</span> (<a class="idref" href="ConCert.Extraction.ExAst.html#trans_env"><span class="id" title="definition">trans_env</span></a> (<a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#dearg_env"><span class="id" title="abbreviation">dearg_env</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#e15c0eb40e61adefe95778c26e7840f6"><span class="id" title="variable">Σ</span></a>)) <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#k"><span class="id" title="variable">k</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#cst'"><span class="id" title="variable">cst'</span></a> <span class="id" title="notation">×</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="projection">EAst.cst_body</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#cst'"><span class="id" title="variable">cst'</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#option_map"><span class="id" title="definition">option_map</span></a> (<a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#dearg"><span class="id" title="abbreviation">dearg</span></a> <span class="id" title="notation">∘</span> <a class="idref" href="ConCert.Extraction.Optimize.html#dearg_lambdas"><span class="id" title="definition">dearg_lambdas</span></a> (<a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#get_const_mask"><span class="id" title="abbreviation">get_const_mask</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#k"><span class="id" title="variable">k</span></a>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="projection">EAst.cst_body</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#cst"><span class="id" title="variable">cst</span></a>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="definition">declared_constant</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> !<a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#lookup_env_trans_env"><span class="id" title="lemma">lookup_env_trans_env</span></a>, <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#lookup_env_dearg_env"><span class="id" title="lemma">lookup_env_dearg_env</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">typ</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <a class="idref" href="ConCert.Extraction.ExAst.html#lookup_env"><span class="id" title="definition">lookup_env</span></a> <span class="id" title="keyword">as</span> [<span class="id" title="var">decl</span>|]; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *; [|<span class="id" title="tactic">congruence</span>].<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">decl</span>; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *; [|<span class="id" title="tactic">congruence</span>|]; <span class="id" title="var">noconf</span> <span class="id" title="var">typ</span>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">eexists</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">split</span>; [<span class="id" title="tactic">reflexivity</span>|].<br/>
&nbsp;&nbsp;<span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">destruct</span> <span class="id" title="var">o</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Inductive</span> <a name="dearg_spec"><span class="id" title="inductive">dearg_spec</span></a> : <span class="id" title="inductive">term</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a> <span class="id" title="inductive">term</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a> <span class="id" title="keyword">Type</span> :=<br/>
| <a name="dearg_spec_const"><span class="id" title="constructor">dearg_spec_const</span></a> <span class="id" title="var">kn</span> <span class="id" title="var">args</span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#dearg_spec"><span class="id" title="inductive">dearg_spec</span></a> (<span class="id" title="definition">mkApps</span> (<span class="id" title="constructor">tConst</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#kn"><span class="id" title="variable">kn</span></a>) <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#args"><span class="id" title="variable">args</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="ConCert.Extraction.Optimize.html#dearg_single"><span class="id" title="definition">dearg_single</span></a> (<a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#get_const_mask"><span class="id" title="abbreviation">get_const_mask</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#kn"><span class="id" title="variable">kn</span></a>) (<span class="id" title="constructor">tConst</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#kn"><span class="id" title="variable">kn</span></a>) (<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#map"><span class="id" title="definition">map</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#dearg"><span class="id" title="abbreviation">dearg</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#args"><span class="id" title="variable">args</span></a>))<br/>
| <a name="dearg_spec_ctor"><span class="id" title="constructor">dearg_spec_ctor</span></a> <span class="id" title="var">ind</span> <span class="id" title="var">c</span> <span class="id" title="var">args</span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#dearg_spec"><span class="id" title="inductive">dearg_spec</span></a> (<span class="id" title="definition">mkApps</span> (<span class="id" title="constructor">tConstruct</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#ind"><span class="id" title="variable">ind</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#c"><span class="id" title="variable">c</span></a>) <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#args"><span class="id" title="variable">args</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="ConCert.Extraction.Optimize.html#dearg_single"><span class="id" title="definition">dearg_single</span></a> (<a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#get_ctor_mask"><span class="id" title="abbreviation">get_ctor_mask</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#ind"><span class="id" title="variable">ind</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#c"><span class="id" title="variable">c</span></a>) (<span class="id" title="constructor">tConstruct</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#ind"><span class="id" title="variable">ind</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#c"><span class="id" title="variable">c</span></a>) (<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#map"><span class="id" title="definition">map</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#dearg"><span class="id" title="abbreviation">dearg</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#args"><span class="id" title="variable">args</span></a>))<br/>
| <a name="dearg_spec_case"><span class="id" title="constructor">dearg_spec_case</span></a> <span class="id" title="var">ind</span> <span class="id" title="var">npars</span> <span class="id" title="var">discr</span> <span class="id" title="var">brs</span> <span class="id" title="var">args</span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#dearg_spec"><span class="id" title="inductive">dearg_spec</span></a> (<span class="id" title="definition">mkApps</span> (<span class="id" title="constructor">tCase</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#ind"><span class="id" title="variable">ind</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#npars"><span class="id" title="variable">npars</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#discr"><span class="id" title="variable">discr</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#brs"><span class="id" title="variable">brs</span></a>) <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#args"><span class="id" title="variable">args</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="definition">mkApps</span> (<a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#dearg"><span class="id" title="abbreviation">dearg</span></a> (<span class="id" title="constructor">tCase</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#ind"><span class="id" title="variable">ind</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#npars"><span class="id" title="variable">npars</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#discr"><span class="id" title="variable">discr</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#brs"><span class="id" title="variable">brs</span></a>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#map"><span class="id" title="definition">map</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#dearg"><span class="id" title="abbreviation">dearg</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#args"><span class="id" title="variable">args</span></a>))<br/>
| <a name="dearg_spec_proj"><span class="id" title="constructor">dearg_spec_proj</span></a> <span class="id" title="var">ind</span> <span class="id" title="var">c</span> <span class="id" title="var">npars</span> <span class="id" title="var">t</span> <span class="id" title="var">args</span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#dearg_spec"><span class="id" title="inductive">dearg_spec</span></a> (<span class="id" title="definition">mkApps</span> (<span class="id" title="constructor">tProj</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#ind"><span class="id" title="variable">ind</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#c"><span class="id" title="variable">c</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#npars"><span class="id" title="variable">npars</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#t"><span class="id" title="variable">t</span></a>) <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#args"><span class="id" title="variable">args</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="definition">mkApps</span> (<a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#dearg"><span class="id" title="abbreviation">dearg</span></a> (<span class="id" title="constructor">tProj</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#ind"><span class="id" title="variable">ind</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#c"><span class="id" title="variable">c</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#npars"><span class="id" title="variable">npars</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#t"><span class="id" title="variable">t</span></a>)) (<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#map"><span class="id" title="definition">map</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#dearg"><span class="id" title="abbreviation">dearg</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#args"><span class="id" title="variable">args</span></a>))<br/>
| <a name="dearg_spec_other"><span class="id" title="constructor">dearg_spec_other</span></a> <span class="id" title="var">hd</span> <span class="id" title="var">args</span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#hd"><span class="id" title="variable">hd</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="constructor">tConst</span> <span class="id" title="var">_</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="constructor">tConstruct</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="constructor">tCase</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="constructor">tProj</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="constructor">tApp</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> =&gt; <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#False"><span class="id" title="inductive">False</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">_</span> =&gt; <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#True"><span class="id" title="inductive">True</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#dearg_spec"><span class="id" title="inductive">dearg_spec</span></a> (<span class="id" title="definition">mkApps</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#hd"><span class="id" title="variable">hd</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#args"><span class="id" title="variable">args</span></a>) (<span class="id" title="definition">mkApps</span> (<a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#dearg"><span class="id" title="abbreviation">dearg</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#hd"><span class="id" title="variable">hd</span></a>) (<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#map"><span class="id" title="definition">map</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#dearg"><span class="id" title="abbreviation">dearg</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#args"><span class="id" title="variable">args</span></a>)).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a name="dearg_elim"><span class="id" title="lemma">dearg_elim</span></a> <span class="id" title="var">t</span> :<br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#dearg_spec"><span class="id" title="inductive">dearg_spec</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#t"><span class="id" title="variable">t</span></a> (<a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#dearg"><span class="id" title="abbreviation">dearg</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#t"><span class="id" title="variable">t</span></a>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<span class="id" title="lemma">mkApps_elim</span> <span class="id" title="var">t</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#ae9a5e1034e143b218b09d8e454472bd"><span class="id" title="notation">[]</span></a>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">generalize</span> (<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#firstn"><span class="id" title="definition">firstn</span></a> <span class="id" title="var">n</span> <span class="id" title="var">l</span>) <span class="id" title="keyword">as</span> <span class="id" title="var">args</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">clear</span> <span class="id" title="var">n</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">args</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#dearg_mkApps"><span class="id" title="lemma">dearg_mkApps</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">f</span>; <span class="id" title="tactic">try</span> <span class="id" title="tactic">solve</span> [<span class="id" title="var">now</span> <span class="id" title="tactic">econstructor</span>].<br/>
&nbsp;&nbsp;- <span class="id" title="var">easy</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">p</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#dearg_spec_case"><span class="id" title="constructor">dearg_spec_case</span></a>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">p</span> <span class="id" title="keyword">as</span> ((? &amp; ?) &amp; ?).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#dearg_spec_proj"><span class="id" title="constructor">dearg_spec_proj</span></a>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a name="valid_cases_dearg_lambdas"><span class="id" title="lemma">valid_cases_dearg_lambdas</span></a> <span class="id" title="var">mask</span> <span class="id" title="var">t</span> :<br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#valid_cases"><span class="id" title="abbreviation">valid_cases</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#t"><span class="id" title="variable">t</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#valid_cases"><span class="id" title="abbreviation">valid_cases</span></a> (<a class="idref" href="ConCert.Extraction.Optimize.html#dearg_lambdas"><span class="id" title="definition">dearg_lambdas</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#mask"><span class="id" title="variable">mask</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#t"><span class="id" title="variable">t</span></a>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">valid</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">t</span> <span class="id" title="tactic">in</span> <span class="id" title="var">mask</span>, <span class="id" title="var">valid</span> |- * <span class="id" title="keyword">using</span> <span class="id" title="lemma">term_forall_list_ind</span>; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *; <span class="id" title="var">propify</span>; <span class="id" title="tactic">try</span> <span class="id" title="var">easy</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">mask</span> <span class="id" title="keyword">as</span> [|[] <span class="id" title="var">mask</span>]; <span class="id" title="tactic">try</span> <span class="id" title="var">easy</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#valid_cases_subst"><span class="id" title="lemma">valid_cases_subst</span></a>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a name="dearg_dearg_lambdas"><span class="id" title="lemma">dearg_dearg_lambdas</span></a> <span class="id" title="var">mask</span> <span class="id" title="var">t</span> :<br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Extraction.Optimize.html#valid_dearg_mask"><span class="id" title="definition">valid_dearg_mask</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#mask"><span class="id" title="variable">mask</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#t"><span class="id" title="variable">t</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#valid_cases"><span class="id" title="abbreviation">valid_cases</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#t"><span class="id" title="variable">t</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#dearg"><span class="id" title="abbreviation">dearg</span></a> (<a class="idref" href="ConCert.Extraction.Optimize.html#dearg_lambdas"><span class="id" title="definition">dearg_lambdas</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#mask"><span class="id" title="variable">mask</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#t"><span class="id" title="variable">t</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="ConCert.Extraction.Optimize.html#dearg_lambdas"><span class="id" title="definition">dearg_lambdas</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#mask"><span class="id" title="variable">mask</span></a> (<a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#dearg"><span class="id" title="abbreviation">dearg</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#t"><span class="id" title="variable">t</span></a>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">vm</span> <span class="id" title="var">vc</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">t</span> <span class="id" title="tactic">in</span> <span class="id" title="var">mask</span>, <span class="id" title="var">vm</span>, <span class="id" title="var">vc</span> |- * <span class="id" title="keyword">using</span> <span class="id" title="lemma">term_forall_list_ind</span>; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *; <span class="id" title="var">propify</span>; <span class="id" title="tactic">try</span> <span class="id" title="var">easy</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">try</span> <span class="id" title="tactic">solve</span> [<span class="id" title="tactic">destruct</span> <span class="id" title="var">mask</span>; [|<span class="id" title="var">easy</span>]; <span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#dearg_lambdas_nil"><span class="id" title="lemma">dearg_lambdas_nil</span></a>].<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">destruct</span> <span class="id" title="var">mask</span> <span class="id" title="keyword">as</span> [|[] <span class="id" title="var">mask</span>]; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *; <span class="id" title="var">propify</span>; <span class="id" title="tactic">try</span> <span class="id" title="var">easy</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">refold'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="definition">subst1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#dearg_subst"><span class="id" title="lemma">dearg_subst</span></a>; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="var">IHt</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#valid_cases_dearg_lambdas"><span class="id" title="lemma">valid_cases_dearg_lambdas</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="var">easy</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">refold'</span>; <span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="var">IHt</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">now</span> <span class="id" title="var">refold'</span>; <span class="id" title="tactic">rewrite</span> <span class="id" title="var">IHt2</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a name="dearg_substl"><span class="id" title="lemma">dearg_substl</span></a> <span class="id" title="var">s</span> <span class="id" title="var">t</span> :<br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#Forall"><span class="id" title="inductive">Forall</span></a> (<span class="id" title="definition">closedn</span> 0) <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#s"><span class="id" title="variable">s</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#Forall"><span class="id" title="inductive">Forall</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#valid_cases"><span class="id" title="abbreviation">valid_cases</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#s"><span class="id" title="variable">s</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#Forall"><span class="id" title="inductive">Forall</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#is_expanded"><span class="id" title="abbreviation">is_expanded</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#s"><span class="id" title="variable">s</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#valid_cases"><span class="id" title="abbreviation">valid_cases</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#t"><span class="id" title="variable">t</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#dearg"><span class="id" title="abbreviation">dearg</span></a> (<span class="id" title="definition">substl</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#s"><span class="id" title="variable">s</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#t"><span class="id" title="variable">t</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <span class="id" title="definition">substl</span> (<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#map"><span class="id" title="definition">map</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#dearg"><span class="id" title="abbreviation">dearg</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#s"><span class="id" title="variable">s</span></a>) (<a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#dearg"><span class="id" title="abbreviation">dearg</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#t"><span class="id" title="variable">t</span></a>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">clos</span> <span class="id" title="var">valid</span> <span class="id" title="var">exp</span> <span class="id" title="var">valid_t</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">s</span> <span class="id" title="keyword">using</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#rev_ind"><span class="id" title="lemma">List.rev_ind</span></a>; [<span class="id" title="var">easy</span>|].<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="definition">substl</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#map_app"><span class="id" title="lemma">map_app</span></a>, !<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#fold_left_app"><span class="id" title="lemma">fold_left_app</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="ConCert.Extraction.Utils.html#Forall_snoc"><span class="id" title="lemma">Forall_snoc</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">clos</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="ConCert.Extraction.Utils.html#Forall_snoc"><span class="id" title="lemma">Forall_snoc</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">valid</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="ConCert.Extraction.Utils.html#Forall_snoc"><span class="id" title="lemma">Forall_snoc</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">exp</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">closed_subst</span> <span class="id" title="tactic">by</span> <span class="id" title="var">easy</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">refold'</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#dearg_subst"><span class="id" title="lemma">dearg_subst</span></a>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="lemma">closed_subst</span> <span class="id" title="tactic">by</span> (<span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#closedn_dearg_aux"><span class="id" title="lemma">closedn_dearg_aux</span></a>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <span class="id" title="var">IHs</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#valid_cases_substl"><span class="id" title="lemma">valid_cases_substl</span></a>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">easy</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a name="fix_subst_dearg"><span class="id" title="lemma">fix_subst_dearg</span></a> <span class="id" title="var">defs</span> :<br/>
&nbsp;&nbsp;<span class="id" title="definition">fix_subst</span> (<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#map"><span class="id" title="definition">map</span></a> (<span class="id" title="definition">map_def</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#dearg"><span class="id" title="abbreviation">dearg</span></a>) <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#defs"><span class="id" title="variable">defs</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#map"><span class="id" title="definition">map</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#dearg"><span class="id" title="abbreviation">dearg</span></a> (<span class="id" title="definition">fix_subst</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#defs"><span class="id" title="variable">defs</span></a>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="definition">fix_subst</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#map_length"><span class="id" title="lemma">map_length</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="notation">#|</span><span class="id" title="var">defs</span><span class="id" title="notation">|</span>; [<span class="id" title="var">easy</span>|].<br/>
&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">IHn</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a name="cofix_subst_dearg"><span class="id" title="lemma">cofix_subst_dearg</span></a> <span class="id" title="var">defs</span> :<br/>
&nbsp;&nbsp;<span class="id" title="definition">cofix_subst</span> (<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#map"><span class="id" title="definition">map</span></a> (<span class="id" title="definition">map_def</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#dearg"><span class="id" title="abbreviation">dearg</span></a>) <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#defs"><span class="id" title="variable">defs</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#map"><span class="id" title="definition">map</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#dearg"><span class="id" title="abbreviation">dearg</span></a> (<span class="id" title="definition">cofix_subst</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#defs"><span class="id" title="variable">defs</span></a>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="definition">cofix_subst</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#map_length"><span class="id" title="lemma">map_length</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="notation">#|</span><span class="id" title="var">defs</span><span class="id" title="notation">|</span>; [<span class="id" title="var">easy</span>|].<br/>
&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">IHn</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a name="dearg_cunfold_fix"><span class="id" title="lemma">dearg_cunfold_fix</span></a> <span class="id" title="var">defs</span> <span class="id" title="var">i</span> <span class="id" title="var">narg</span> <span class="id" title="var">fn</span> :<br/>
&nbsp;&nbsp;<span class="id" title="definition">cunfold_fix</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#defs"><span class="id" title="variable">defs</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#i"><span class="id" title="variable">i</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#narg"><span class="id" title="variable">narg</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#fn"><span class="id" title="variable">fn</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<span class="id" title="abbreviation">closed</span> (<span class="id" title="constructor">tFix</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#defs"><span class="id" title="variable">defs</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#i"><span class="id" title="variable">i</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#valid_cases"><span class="id" title="abbreviation">valid_cases</span></a> (<span class="id" title="constructor">tFix</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#defs"><span class="id" title="variable">defs</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#i"><span class="id" title="variable">i</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#is_expanded"><span class="id" title="abbreviation">is_expanded</span></a> (<span class="id" title="constructor">tFix</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#defs"><span class="id" title="variable">defs</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#i"><span class="id" title="variable">i</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<span class="id" title="definition">cunfold_fix</span> (<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#map"><span class="id" title="definition">map</span></a> (<span class="id" title="definition">map_def</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#dearg"><span class="id" title="abbreviation">dearg</span></a>) <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#defs"><span class="id" title="variable">defs</span></a>) <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#i"><span class="id" title="variable">i</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#narg"><span class="id" title="variable">narg</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#dearg"><span class="id" title="abbreviation">dearg</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#fn"><span class="id" title="variable">fn</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">cuf</span> <span class="id" title="var">clos_fix</span> <span class="id" title="var">valid_fix</span> <span class="id" title="var">exp_fix</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="definition">cunfold_fix</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">nth_error_map</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#nth_error"><span class="id" title="definition">nth_error</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span>) <span class="id" title="var">eqn</span>:<span class="id" title="var">nth</span>; [|<span class="id" title="var">easy</span>].<br/>
&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;<span class="id" title="var">noconf</span> <span class="id" title="var">cuf</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#dearg_substl"><span class="id" title="lemma">dearg_substl</span></a>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">f_equal</span>; <span class="id" title="tactic">apply</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#fix_subst_dearg"><span class="id" title="lemma">fix_subst_dearg</span></a>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#Forall_closed_fix_subst"><span class="id" title="lemma">Forall_closed_fix_subst</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">setoid_rewrite</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Arith.PeanoNat.html#Nat.add_0_r"><span class="id" title="lemma">Nat.add_0_r</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">clos_fix</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <span class="id" title="lemma">forallb_Forall</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#Forall_valid_cases_fix_subst"><span class="id" title="lemma">Forall_valid_cases_fix_subst</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <span class="id" title="lemma">forallb_Forall</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#Forall_is_expanded_fix_subst"><span class="id" title="lemma">Forall_is_expanded_fix_subst</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <span class="id" title="lemma">forallb_Forall</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">eapply</span> <span class="id" title="lemma">nth_error_forallb</span> <span class="id" title="tactic">in</span> <span class="id" title="var">valid_fix</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="var">nth</span> <span class="id" title="tactic">in</span> <span class="id" title="var">valid_fix</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a name="dearg_cunfold_cofix"><span class="id" title="lemma">dearg_cunfold_cofix</span></a> <span class="id" title="var">defs</span> <span class="id" title="var">i</span> <span class="id" title="var">narg</span> <span class="id" title="var">fn</span> :<br/>
&nbsp;&nbsp;<span class="id" title="definition">cunfold_cofix</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#defs"><span class="id" title="variable">defs</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#i"><span class="id" title="variable">i</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#narg"><span class="id" title="variable">narg</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#fn"><span class="id" title="variable">fn</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<span class="id" title="abbreviation">closed</span> (<span class="id" title="constructor">tCoFix</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#defs"><span class="id" title="variable">defs</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#i"><span class="id" title="variable">i</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#valid_cases"><span class="id" title="abbreviation">valid_cases</span></a> (<span class="id" title="constructor">tCoFix</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#defs"><span class="id" title="variable">defs</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#i"><span class="id" title="variable">i</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#is_expanded"><span class="id" title="abbreviation">is_expanded</span></a> (<span class="id" title="constructor">tCoFix</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#defs"><span class="id" title="variable">defs</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#i"><span class="id" title="variable">i</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<span class="id" title="definition">cunfold_cofix</span> (<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#map"><span class="id" title="definition">map</span></a> (<span class="id" title="definition">map_def</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#dearg"><span class="id" title="abbreviation">dearg</span></a>) <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#defs"><span class="id" title="variable">defs</span></a>) <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#i"><span class="id" title="variable">i</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#narg"><span class="id" title="variable">narg</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#dearg"><span class="id" title="abbreviation">dearg</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#fn"><span class="id" title="variable">fn</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">cuf</span> <span class="id" title="var">clos_fix</span> <span class="id" title="var">valid_fix</span> <span class="id" title="var">exp_fix</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="definition">cunfold_cofix</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">nth_error_map</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#nth_error"><span class="id" title="definition">nth_error</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span>) <span class="id" title="var">eqn</span>:<span class="id" title="var">nth</span>; [|<span class="id" title="var">easy</span>].<br/>
&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;<span class="id" title="var">noconf</span> <span class="id" title="var">cuf</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#dearg_substl"><span class="id" title="lemma">dearg_substl</span></a>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">f_equal</span>; <span class="id" title="tactic">apply</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#cofix_subst_dearg"><span class="id" title="lemma">cofix_subst_dearg</span></a>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#Forall_closed_cofix_subst"><span class="id" title="lemma">Forall_closed_cofix_subst</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">setoid_rewrite</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Arith.PeanoNat.html#Nat.add_0_r"><span class="id" title="lemma">Nat.add_0_r</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">clos_fix</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <span class="id" title="lemma">forallb_Forall</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#Forall_valid_cases_cofix_subst"><span class="id" title="lemma">Forall_valid_cases_cofix_subst</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <span class="id" title="lemma">forallb_Forall</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#Forall_is_expanded_cofix_subst"><span class="id" title="lemma">Forall_is_expanded_cofix_subst</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <span class="id" title="lemma">forallb_Forall</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">eapply</span> <span class="id" title="lemma">nth_error_forallb</span> <span class="id" title="tactic">in</span> <span class="id" title="var">valid_fix</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="var">nth</span> <span class="id" title="tactic">in</span> <span class="id" title="var">valid_fix</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a name="isBox_mkApps"><span class="id" title="lemma">isBox_mkApps</span></a> <span class="id" title="var">hd</span> <span class="id" title="var">args</span> :<br/>
&nbsp;&nbsp;<span class="id" title="definition">isBox</span> (<span class="id" title="definition">mkApps</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#hd"><span class="id" title="variable">hd</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#args"><span class="id" title="variable">args</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <span class="id" title="definition">isBox</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#hd"><span class="id" title="variable">hd</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#9ddeac0ab66152bd1d64bedb507a795e"><span class="id" title="notation">&amp;&amp;</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#9ddeac0ab66152bd1d64bedb507a795e"><span class="id" title="notation">(</span></a><span class="id" title="notation">#|</span><a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#args"><span class="id" title="variable">args</span></a><span class="id" title="notation">|</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Arith.PeanoNat.html#ad2ec4e405f68c46c0a176e3e94ae2e3"><span class="id" title="notation">=?</span></a> 0<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#9ddeac0ab66152bd1d64bedb507a795e"><span class="id" title="notation">)</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">args</span> <span class="id" title="keyword">using</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#rev_ind"><span class="id" title="lemma">List.rev_ind</span></a>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Bool.Bool.html#andb_true_r"><span class="id" title="lemma">Bool.andb_true_r</span></a>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">mkApps_app</span>, <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#app_length"><span class="id" title="lemma">app_length</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Arith.PeanoNat.html#Nat.add_comm"><span class="id" title="lemma">Nat.add_comm</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Bool.Bool.html#andb_false_r"><span class="id" title="lemma">Bool.andb_false_r</span></a>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a name="isLambda_mkApps"><span class="id" title="lemma">isLambda_mkApps</span></a> <span class="id" title="var">hd</span> <span class="id" title="var">args</span> :<br/>
&nbsp;&nbsp;<span class="id" title="definition">isLambda</span> (<span class="id" title="definition">mkApps</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#hd"><span class="id" title="variable">hd</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#args"><span class="id" title="variable">args</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <span class="id" title="definition">isLambda</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#hd"><span class="id" title="variable">hd</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#9ddeac0ab66152bd1d64bedb507a795e"><span class="id" title="notation">&amp;&amp;</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#9ddeac0ab66152bd1d64bedb507a795e"><span class="id" title="notation">(</span></a><span class="id" title="notation">#|</span><a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#args"><span class="id" title="variable">args</span></a><span class="id" title="notation">|</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Arith.PeanoNat.html#ad2ec4e405f68c46c0a176e3e94ae2e3"><span class="id" title="notation">=?</span></a> 0<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#9ddeac0ab66152bd1d64bedb507a795e"><span class="id" title="notation">)</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">args</span> <span class="id" title="keyword">using</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#rev_ind"><span class="id" title="lemma">List.rev_ind</span></a>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Bool.Bool.html#andb_true_r"><span class="id" title="lemma">Bool.andb_true_r</span></a>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">mkApps_app</span>, <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#app_length"><span class="id" title="lemma">app_length</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">symmetry</span>; <span class="id" title="var">propify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">right</span>; <span class="id" title="var">easy</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a name="eval_mkApps_tConstruct"><span class="id" title="lemma">eval_mkApps_tConstruct</span></a> {<span class="id" title="var">wfl</span>:<span class="id" title="class">WcbvFlags</span>} <span class="id" title="var">Σ</span> <span class="id" title="var">ind</span> <span class="id" title="var">c</span> <span class="id" title="var">args</span> <span class="id" title="var">argsv</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">a</span> : <span class="id" title="inductive">All2</span> (<span class="id" title="inductive">eval</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#e15c0eb40e61adefe95778c26e7840f6"><span class="id" title="variable">Σ</span></a>) <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#args"><span class="id" title="variable">args</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#argsv"><span class="id" title="variable">argsv</span></a>) :<br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#e15c0eb40e61adefe95778c26e7840f6"><span class="id" title="variable">Σ</span></a> <a class="idref" href="ConCert.Extraction.WcbvEvalAux.html#e49f44d96100960446bedaca1e4a4428"><span class="id" title="notation">e</span></a><a class="idref" href="ConCert.Extraction.WcbvEvalAux.html#e49f44d96100960446bedaca1e4a4428"><span class="id" title="notation">⊢</span></a> <span class="id" title="definition">mkApps</span> (<span class="id" title="constructor">tConstruct</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#ind"><span class="id" title="variable">ind</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#c"><span class="id" title="variable">c</span></a>) <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#args"><span class="id" title="variable">args</span></a> <a class="idref" href="ConCert.Extraction.WcbvEvalAux.html#e49f44d96100960446bedaca1e4a4428"><span class="id" title="notation">▷</span></a> <span class="id" title="definition">mkApps</span> (<span class="id" title="constructor">tConstruct</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#ind"><span class="id" title="variable">ind</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#c"><span class="id" title="variable">c</span></a>) <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#argsv"><span class="id" title="variable">argsv</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">revert</span> <span class="id" title="var">argsv</span> <span class="id" title="var">a</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">args</span> <span class="id" title="keyword">using</span> <span class="id" title="lemma">MCList.rev_ind</span>; <span class="id" title="tactic">intros</span> <span class="id" title="var">argsv</span> <span class="id" title="var">all</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">depelim</span> <span class="id" title="var">all</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">constructor</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">destruct</span> <span class="id" title="var">argsv</span> <span class="id" title="keyword">as</span> [|? ? <span class="id" title="var">_</span>] <span class="id" title="keyword">using</span> <span class="id" title="lemma">MCList.rev_ind</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">apply</span> <span class="id" title="lemma">All2_length</span> <span class="id" title="tactic">in</span> <span class="id" title="var">all</span> <span class="id" title="keyword">as</span> <span class="id" title="var">len</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#app_length"><span class="id" title="lemma">app_length</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">len</span>; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *; <span class="id" title="var">lia</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<a class="idref" href="ConCert.Extraction.WcbvEvalAux.html#All2_eval_snoc_elim"><span class="id" title="lemma">All2_eval_snoc_elim</span></a> <span class="id" title="var">all</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> !<span class="id" title="lemma">mkApps_app</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <span class="id" title="constructor">eval_app_cong</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">easy</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#isLambda_mkApps"><span class="id" title="lemma">isLambda_mkApps</span></a>, <span class="id" title="lemma">isFixApp_mkApps</span>, <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#isBox_mkApps"><span class="id" title="lemma">isBox_mkApps</span></a> <span class="id" title="tactic">by</span> <span class="id" title="var">easy</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">assumption</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Ltac</span> <span class="id" title="var">facts</span> :=<br/>
&nbsp;&nbsp;(<span class="id" title="tactic">repeat</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| [<span class="id" title="var">H</span>: ?<span class="id" title="var">Σ</span> <a class="idref" href="ConCert.Extraction.WcbvEvalAux.html#e49f44d96100960446bedaca1e4a4428"><span class="id" title="notation">e</span></a><a class="idref" href="ConCert.Extraction.WcbvEvalAux.html#e49f44d96100960446bedaca1e4a4428"><span class="id" title="notation">⊢</span></a> ?<span class="id" title="var">t</span> <a class="idref" href="ConCert.Extraction.WcbvEvalAux.html#e49f44d96100960446bedaca1e4a4428"><span class="id" title="notation">▷</span></a> ?<span class="id" title="var">v</span> |- <span class="id" title="var">_</span>] =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| [<span class="id" title="var">H'</span>: <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#is_true"><span class="id" title="definition">is_true</span></a> (<span class="id" title="abbreviation">closed</span> <span class="id" title="var">v</span>) |- <span class="id" title="var">_</span>] =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">fail</span> 1<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">_</span> =&gt; <span class="id" title="tactic">idtac</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="abbreviation">closed</span> <span class="id" title="var">v</span>) <span class="id" title="tactic">by</span> (<span class="id" title="tactic">apply</span> (<a class="idref" href="ConCert.Extraction.WcbvEvalAux.html#eval_closed"><span class="id" title="lemma">eval_closed</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">H</span>); <span class="id" title="tactic">trivial</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>);<br/>
&nbsp;&nbsp;(<span class="id" title="tactic">repeat</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| [<span class="id" title="var">H</span>: ?<span class="id" title="var">Σ</span> <a class="idref" href="ConCert.Extraction.WcbvEvalAux.html#e49f44d96100960446bedaca1e4a4428"><span class="id" title="notation">e</span></a><a class="idref" href="ConCert.Extraction.WcbvEvalAux.html#e49f44d96100960446bedaca1e4a4428"><span class="id" title="notation">⊢</span></a> ?<span class="id" title="var">t</span> <a class="idref" href="ConCert.Extraction.WcbvEvalAux.html#e49f44d96100960446bedaca1e4a4428"><span class="id" title="notation">▷</span></a> ?<span class="id" title="var">v</span> |- <span class="id" title="var">_</span>] =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| [<span class="id" title="var">H'</span>: <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#is_true"><span class="id" title="definition">is_true</span></a> (<a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#valid_cases"><span class="id" title="abbreviation">valid_cases</span></a> <span class="id" title="var">v</span>) |- <span class="id" title="var">_</span>] =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">fail</span> 1<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">_</span> =&gt; <span class="id" title="tactic">idtac</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#valid_cases"><span class="id" title="abbreviation">valid_cases</span></a> <span class="id" title="var">v</span>) <span class="id" title="tactic">by</span> (<span class="id" title="tactic">apply</span> (<a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#eval_valid_cases"><span class="id" title="lemma">eval_valid_cases</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">H</span>); <span class="id" title="tactic">trivial</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>);<br/>
&nbsp;&nbsp;(<span class="id" title="tactic">repeat</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| [<span class="id" title="var">H</span>: ?<span class="id" title="var">Σ</span> <a class="idref" href="ConCert.Extraction.WcbvEvalAux.html#e49f44d96100960446bedaca1e4a4428"><span class="id" title="notation">e</span></a><a class="idref" href="ConCert.Extraction.WcbvEvalAux.html#e49f44d96100960446bedaca1e4a4428"><span class="id" title="notation">⊢</span></a> ?<span class="id" title="var">t</span> <a class="idref" href="ConCert.Extraction.WcbvEvalAux.html#e49f44d96100960446bedaca1e4a4428"><span class="id" title="notation">▷</span></a> ?<span class="id" title="var">v</span> |- <span class="id" title="var">_</span>] =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| [<span class="id" title="var">H'</span>: <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#is_true"><span class="id" title="definition">is_true</span></a> (<a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#is_expanded"><span class="id" title="abbreviation">is_expanded</span></a> <span class="id" title="var">v</span>) |- <span class="id" title="var">_</span>] =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">fail</span> 1<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">_</span> =&gt; <span class="id" title="tactic">idtac</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#is_expanded"><span class="id" title="abbreviation">is_expanded</span></a> <span class="id" title="var">v</span>) <span class="id" title="tactic">by</span> (<span class="id" title="tactic">apply</span> (<a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#eval_is_expanded_aux"><span class="id" title="lemma">eval_is_expanded_aux</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> 0 <span class="id" title="var">H</span>); <span class="id" title="tactic">trivial</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>).<br/>

<br/>
<span class="id" title="keyword">Section</span> <a name="dearg_correct.dearg"><span class="id" title="section">dearg</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Context</span> {<span class="id" title="var">wfl</span>:<span class="id" title="class">WcbvFlags</span>}.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Context</span> (<span class="id" title="var">n</span> : <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a>).<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Context</span> (<span class="id" title="var">Σ</span> : <a class="idref" href="ConCert.Extraction.ExAst.html#global_env"><span class="id" title="definition">global_env</span></a>).<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Context</span> (<span class="id" title="var">clos_Σ</span> : <a class="idref" href="ConCert.Extraction.ClosedAux.html#env_closed"><span class="id" title="definition">env_closed</span></a> (<a class="idref" href="ConCert.Extraction.ExAst.html#trans_env"><span class="id" title="definition">trans_env</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#768b9254b7286c340e72d39183e874a7"><span class="id" title="variable">Σ</span></a>)).<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Context</span> (<span class="id" title="var">valid_Σ</span> : <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#valid_masks_env"><span class="id" title="abbreviation">valid_masks_env</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#768b9254b7286c340e72d39183e874a7"><span class="id" title="variable">Σ</span></a>).<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Context</span> (<span class="id" title="var">exp_Σ</span> : <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#is_expanded_env"><span class="id" title="abbreviation">is_expanded_env</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#768b9254b7286c340e72d39183e874a7"><span class="id" title="variable">Σ</span></a>).<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Context</span> (<span class="id" title="var">IH</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">t</span> <span class="id" title="var">v</span> : <span class="id" title="inductive">term</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="abbreviation">closed</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#t"><span class="id" title="variable">t</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#valid_cases"><span class="id" title="abbreviation">valid_cases</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#t"><span class="id" title="variable">t</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#is_expanded"><span class="id" title="abbreviation">is_expanded</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#t"><span class="id" title="variable">t</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">forall</span> <span class="id" title="var">ev</span> : <a class="idref" href="ConCert.Extraction.ExAst.html#trans_env"><span class="id" title="definition">trans_env</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#768b9254b7286c340e72d39183e874a7"><span class="id" title="variable">Σ</span></a> <a class="idref" href="ConCert.Extraction.WcbvEvalAux.html#e49f44d96100960446bedaca1e4a4428"><span class="id" title="notation">e</span></a><a class="idref" href="ConCert.Extraction.WcbvEvalAux.html#e49f44d96100960446bedaca1e4a4428"><span class="id" title="notation">⊢</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#t"><span class="id" title="variable">t</span></a> <a class="idref" href="ConCert.Extraction.WcbvEvalAux.html#e49f44d96100960446bedaca1e4a4428"><span class="id" title="notation">▷</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#v"><span class="id" title="variable">v</span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Extraction.WcbvEvalAux.html#deriv_length"><span class="id" title="definition">deriv_length</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#ev"><span class="id" title="variable">ev</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Peano.html#cb53cf0ee22c036a03b4a9281c68b5a3"><span class="id" title="notation">&lt;=</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#dearg_correct.dearg.n"><span class="id" title="variable">n</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Extraction.ExAst.html#trans_env"><span class="id" title="definition">trans_env</span></a> (<a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#dearg_env"><span class="id" title="abbreviation">dearg_env</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#768b9254b7286c340e72d39183e874a7"><span class="id" title="variable">Σ</span></a>) <a class="idref" href="ConCert.Extraction.WcbvEvalAux.html#e49f44d96100960446bedaca1e4a4428"><span class="id" title="notation">e</span></a><a class="idref" href="ConCert.Extraction.WcbvEvalAux.html#e49f44d96100960446bedaca1e4a4428"><span class="id" title="notation">⊢</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#dearg"><span class="id" title="abbreviation">dearg</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#t"><span class="id" title="variable">t</span></a> <a class="idref" href="ConCert.Extraction.WcbvEvalAux.html#e49f44d96100960446bedaca1e4a4428"><span class="id" title="notation">▷</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#dearg"><span class="id" title="abbreviation">dearg</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#v"><span class="id" title="variable">v</span></a>).<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a name="eval_tApp_dearg"><span class="id" title="lemma">eval_tApp_dearg</span></a> {<span class="id" title="var">hd</span> <span class="id" title="var">arg</span> <span class="id" title="var">v</span>} :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="abbreviation">closed</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#hd"><span class="id" title="variable">hd</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#valid_cases"><span class="id" title="abbreviation">valid_cases</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#hd"><span class="id" title="variable">hd</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#is_expanded"><span class="id" title="abbreviation">is_expanded</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#hd"><span class="id" title="variable">hd</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="abbreviation">closed</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#arg"><span class="id" title="variable">arg</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#valid_cases"><span class="id" title="abbreviation">valid_cases</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#arg"><span class="id" title="variable">arg</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#is_expanded"><span class="id" title="abbreviation">is_expanded</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#arg"><span class="id" title="variable">arg</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">forall</span> (<span class="id" title="var">ev</span> : <a class="idref" href="ConCert.Extraction.ExAst.html#trans_env"><span class="id" title="definition">trans_env</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#768b9254b7286c340e72d39183e874a7"><span class="id" title="variable">Σ</span></a> <a class="idref" href="ConCert.Extraction.WcbvEvalAux.html#e49f44d96100960446bedaca1e4a4428"><span class="id" title="notation">e</span></a><a class="idref" href="ConCert.Extraction.WcbvEvalAux.html#e49f44d96100960446bedaca1e4a4428"><span class="id" title="notation">⊢</span></a> <span class="id" title="constructor">tApp</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#hd"><span class="id" title="variable">hd</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#arg"><span class="id" title="variable">arg</span></a> <a class="idref" href="ConCert.Extraction.WcbvEvalAux.html#e49f44d96100960446bedaca1e4a4428"><span class="id" title="notation">▷</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#v"><span class="id" title="variable">v</span></a>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Extraction.WcbvEvalAux.html#deriv_length"><span class="id" title="definition">deriv_length</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#ev"><span class="id" title="variable">ev</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Peano.html#cb53cf0ee22c036a03b4a9281c68b5a3"><span class="id" title="notation">&lt;=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#S"><span class="id" title="constructor">S</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#dearg_correct.dearg.n"><span class="id" title="variable">n</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Extraction.ExAst.html#trans_env"><span class="id" title="definition">trans_env</span></a> (<a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#dearg_env"><span class="id" title="abbreviation">dearg_env</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#768b9254b7286c340e72d39183e874a7"><span class="id" title="variable">Σ</span></a>) <a class="idref" href="ConCert.Extraction.WcbvEvalAux.html#e49f44d96100960446bedaca1e4a4428"><span class="id" title="notation">e</span></a><a class="idref" href="ConCert.Extraction.WcbvEvalAux.html#e49f44d96100960446bedaca1e4a4428"><span class="id" title="notation">⊢</span></a> <span class="id" title="constructor">tApp</span> (<a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#dearg"><span class="id" title="abbreviation">dearg</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#hd"><span class="id" title="variable">hd</span></a>) (<a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#dearg"><span class="id" title="abbreviation">dearg</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#arg"><span class="id" title="variable">arg</span></a>) <a class="idref" href="ConCert.Extraction.WcbvEvalAux.html#e49f44d96100960446bedaca1e4a4428"><span class="id" title="notation">▷</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#dearg"><span class="id" title="abbreviation">dearg</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#v"><span class="id" title="variable">v</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span> <span class="id" title="keyword">with</span> <span class="id" title="tactic">auto</span> <span class="id" title="keyword">with</span> <span class="id" title="var">dearg</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">clos_hd</span> <span class="id" title="var">valid_hd</span> <span class="id" title="var">exp_hd</span> <span class="id" title="var">clos_arg</span> <span class="id" title="var">valid_arg</span> <span class="id" title="var">exp_arg</span> <span class="id" title="var">ev</span> <span class="id" title="var">ev_len</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">depind</span> <span class="id" title="var">ev</span>; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <span class="id" title="constructor">eval_box</span> <span class="id" title="keyword">with</span> (<a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#dearg"><span class="id" title="abbreviation">dearg</span></a> <span class="id" title="var">t'</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">now</span> <span class="id" title="var">unshelve</span> <span class="id" title="tactic">eapply</span> (<a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#dearg_correct.dearg.IH"><span class="id" title="variable">IH</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">ev1</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">now</span> <span class="id" title="var">unshelve</span> <span class="id" title="tactic">eapply</span> (<a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#dearg_correct.dearg.IH"><span class="id" title="variable">IH</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">ev2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> (<span class="id" title="constructor">eval_beta</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">na</span> (<a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#dearg"><span class="id" title="abbreviation">dearg</span></a> <span class="id" title="var">b</span>) <span class="id" title="var">_</span> (<a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#dearg"><span class="id" title="abbreviation">dearg</span></a> <span class="id" title="var">a'</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">now</span> <span class="id" title="var">unshelve</span> <span class="id" title="tactic">eapply</span> (<a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#dearg_correct.dearg.IH"><span class="id" title="variable">IH</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">ev1</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">now</span> <span class="id" title="var">unshelve</span> <span class="id" title="tactic">eapply</span> (<a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#dearg_correct.dearg.IH"><span class="id" title="variable">IH</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">ev2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">facts</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">clear</span> <span class="id" title="var">IHev1</span> <span class="id" title="var">IHev2</span> <span class="id" title="var">IHev3</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">revert</span> <span class="id" title="var">ev3</span> <span class="id" title="var">ev_len</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> !<span class="id" title="lemma">closed_subst</span>; [|<span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#closedn_dearg_aux"><span class="id" title="lemma">closedn_dearg_aux</span></a>|<span class="id" title="var">easy</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- (<a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#dearg_subst"><span class="id" title="lemma">dearg_subst</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#ddd65c2f7ee73ecec433744948d846bb"><span class="id" title="notation">[</span></a><span class="id" title="var">a'</span><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#ddd65c2f7ee73ecec433744948d846bb"><span class="id" title="notation">]</span></a>) <span class="id" title="tactic">by</span> <span class="id" title="var">easy</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">unshelve</span> <span class="id" title="tactic">eapply</span> (<a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#dearg_correct.dearg.IH"><span class="id" title="variable">IH</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">ev3</span>)...<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="tactic">apply</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#is_expanded_aux_subst"><span class="id" title="lemma">is_expanded_aux_subst</span></a>...<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="var">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="var">facts</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<span class="id" title="constructor">eval_fix</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">_</span> <span class="id" title="var">_</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#map"><span class="id" title="definition">map</span></a> (<span class="id" title="definition">map_def</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#dearg"><span class="id" title="abbreviation">dearg</span></a>) <span class="id" title="var">mfix</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">idx</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#map"><span class="id" title="definition">map</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#dearg"><span class="id" title="abbreviation">dearg</span></a> <span class="id" title="var">argsv</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">_</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#dearg"><span class="id" title="abbreviation">dearg</span></a> <span class="id" title="var">av</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#dearg"><span class="id" title="abbreviation">dearg</span></a> <span class="id" title="var">fn</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">unshelve</span> <span class="id" title="var">epose</span> <span class="id" title="var">proof</span> (<a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#dearg_correct.dearg.IH"><span class="id" title="variable">IH</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">ev1</span> <span class="id" title="var">_</span>) <span class="id" title="keyword">as</span> <span class="id" title="var">ev</span>; <span class="id" title="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1: <span class="id" title="var">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#dearg_mkApps"><span class="id" title="lemma">dearg_mkApps</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">ev</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">ev</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">now</span> <span class="id" title="var">unshelve</span> <span class="id" title="tactic">eapply</span> (<a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#dearg_correct.dearg.IH"><span class="id" title="variable">IH</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">ev2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">apply</span> <a class="idref" href="ConCert.Extraction.ClosedAux.html#closed_mkApps_inv"><span class="id" title="lemma">closed_mkApps_inv</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">H0</span> <span class="id" title="keyword">as</span> (? &amp; ?).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#valid_cases_mkApps_inv"><span class="id" title="lemma">valid_cases_mkApps_inv</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">H2</span> <span class="id" title="keyword">as</span> (? &amp; ?).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#is_expanded_aux_mkApps_inv"><span class="id" title="lemma">is_expanded_aux_mkApps_inv</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">H4</span> <span class="id" title="keyword">as</span> (? &amp; ?).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#map_length"><span class="id" title="lemma">map_length</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#dearg_cunfold_fix"><span class="id" title="lemma">dearg_cunfold_fix</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">apply</span> <a class="idref" href="ConCert.Extraction.ClosedAux.html#closed_mkApps_inv"><span class="id" title="lemma">closed_mkApps_inv</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">H0</span> <span class="id" title="keyword">as</span> (? &amp; ?).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#valid_cases_mkApps_inv"><span class="id" title="lemma">valid_cases_mkApps_inv</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">H2</span> <span class="id" title="keyword">as</span> (? &amp; ?).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#is_expanded_aux_mkApps_inv"><span class="id" title="lemma">is_expanded_aux_mkApps_inv</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">H4</span> <span class="id" title="keyword">as</span> (? &amp; ?).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="ConCert.Extraction.WcbvEvalAux.html#closed_cunfold_fix"><span class="id" title="lemma">closed_cunfold_fix</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">e</span> <span class="id" title="keyword">as</span> ?; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#valid_cases_cunfold_fix"><span class="id" title="lemma">valid_cases_cunfold_fix</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">e</span> <span class="id" title="keyword">as</span> ?; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="lemma">forallb_Forall</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H4</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#is_expanded_cunfold_fix"><span class="id" title="lemma">is_expanded_cunfold_fix</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">e</span> <span class="id" title="keyword">as</span> ?; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#dearg_mkApps"><span class="id" title="lemma">dearg_mkApps</span></a>, <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#dearg_expanded"><span class="id" title="lemma">dearg_expanded</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">IHev3</span> <span class="id" title="tactic">by</span> <span class="id" title="var">easy</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">IHev3</span>...<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="tactic">apply</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#valid_cases_mkApps"><span class="id" title="lemma">valid_cases_mkApps</span></a>...<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="tactic">apply</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#is_expanded_aux_mkApps"><span class="id" title="lemma">is_expanded_aux_mkApps</span></a>...<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">erewrite</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#is_expanded_aux_upwards"><span class="id" title="lemma">is_expanded_aux_upwards</span></a>; [|<span class="id" title="var">eassumption</span>|<span class="id" title="var">easy</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">easy</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="var">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="var">facts</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#dearg_expanded"><span class="id" title="lemma">dearg_expanded</span></a> <span class="id" title="tactic">by</span> <span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#dearg_mkApps"><span class="id" title="lemma">dearg_mkApps</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> -[<span class="id" title="var">map_subterms</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<span class="id" title="constructor">eval_fix_value</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">narg</span> (<a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#dearg"><span class="id" title="abbreviation">dearg</span></a> <span class="id" title="var">fn</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">unshelve</span> <span class="id" title="var">epose</span> <span class="id" title="var">proof</span> (<a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#dearg_correct.dearg.IH"><span class="id" title="variable">IH</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">ev1</span> <span class="id" title="var">_</span>) <span class="id" title="keyword">as</span> <span class="id" title="var">ev</span>; <span class="id" title="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1: <span class="id" title="var">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#dearg_mkApps"><span class="id" title="lemma">dearg_mkApps</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">ev</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">ev</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">now</span> <span class="id" title="var">unshelve</span> <span class="id" title="tactic">eapply</span> (<a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#dearg_correct.dearg.IH"><span class="id" title="variable">IH</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">ev2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">apply</span> <a class="idref" href="ConCert.Extraction.ClosedAux.html#closed_mkApps_inv"><span class="id" title="lemma">closed_mkApps_inv</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">H0</span> <span class="id" title="keyword">as</span> (? &amp; ?).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#valid_cases_mkApps_inv"><span class="id" title="lemma">valid_cases_mkApps_inv</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">H2</span> <span class="id" title="keyword">as</span> (? &amp; ?).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#is_expanded_aux_mkApps_inv"><span class="id" title="lemma">is_expanded_aux_mkApps_inv</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">H4</span> <span class="id" title="keyword">as</span> (? &amp; ?).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#dearg_cunfold_fix"><span class="id" title="lemma">dearg_cunfold_fix</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#map_length"><span class="id" title="lemma">map_length</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="var">facts</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#dearg_expanded"><span class="id" title="lemma">dearg_expanded</span></a> <span class="id" title="tactic">by</span> <span class="id" title="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="constructor">eval_app_cong</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">now</span> <span class="id" title="var">unshelve</span> <span class="id" title="tactic">eapply</span> (<a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#dearg_correct.dearg.IH"><span class="id" title="variable">IH</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">ev1</span> <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">destruct</span> (<a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#dearg_elim"><span class="id" title="lemma">dearg_elim</span></a> <span class="id" title="var">f'</span>); <span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="tactic">apply</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#is_expanded_aux_mkApps_inv"><span class="id" title="lemma">is_expanded_aux_mkApps_inv</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">H4</span> <span class="id" title="keyword">as</span> (? &amp; ?).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *; <span class="id" title="var">propify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#dearg_single_masked"><span class="id" title="lemma">dearg_single_masked</span></a> <span class="id" title="tactic">by</span> (<span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#map_length"><span class="id" title="lemma">map_length</span></a>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#isLambda_mkApps"><span class="id" title="lemma">isLambda_mkApps</span></a>, <span class="id" title="lemma">isFixApp_mkApps</span>, <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#isBox_mkApps"><span class="id" title="lemma">isBox_mkApps</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="tactic">apply</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#is_expanded_aux_mkApps_inv"><span class="id" title="lemma">is_expanded_aux_mkApps_inv</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">H4</span> <span class="id" title="keyword">as</span> (? &amp; ?).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *; <span class="id" title="var">propify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#dearg_single_masked"><span class="id" title="lemma">dearg_single_masked</span></a> <span class="id" title="tactic">by</span> (<span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#map_length"><span class="id" title="lemma">map_length</span></a>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#isLambda_mkApps"><span class="id" title="lemma">isLambda_mkApps</span></a>, <span class="id" title="lemma">isFixApp_mkApps</span>, <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#isBox_mkApps"><span class="id" title="lemma">isBox_mkApps</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="tactic">unfold</span> <span class="id" title="var">dearg_case</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">destruct</span> (<a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#get_mib_masks"><span class="id" title="abbreviation">get_mib_masks</span></a> <span class="id" title="var">_</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#isLambda_mkApps"><span class="id" title="lemma">isLambda_mkApps</span></a>, <span class="id" title="lemma">isFixApp_mkApps</span>, <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#isBox_mkApps"><span class="id" title="lemma">isBox_mkApps</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="tactic">unfold</span> <span class="id" title="var">dearg_proj</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">destruct</span> (<a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#get_mib_masks"><span class="id" title="abbreviation">get_mib_masks</span></a> <span class="id" title="var">_</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#isLambda_mkApps"><span class="id" title="lemma">isLambda_mkApps</span></a>, <span class="id" title="lemma">isFixApp_mkApps</span>, <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#isBox_mkApps"><span class="id" title="lemma">isBox_mkApps</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="tactic">rewrite</span> !<a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#isLambda_mkApps"><span class="id" title="lemma">isLambda_mkApps</span></a>, !<span class="id" title="lemma">isFixApp_mkApps</span>, !<a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#isBox_mkApps"><span class="id" title="lemma">isBox_mkApps</span></a> <span class="id" title="tactic">in</span> *<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="var">now</span> <span class="id" title="tactic">destruct</span> <span class="id" title="var">hd</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#map_length"><span class="id" title="lemma">map_length</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">destruct</span> <span class="id" title="var">hd</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">now</span> <span class="id" title="var">unshelve</span> <span class="id" title="tactic">eapply</span> (<a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#dearg_correct.dearg.IH"><span class="id" title="variable">IH</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">ev2</span> <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="var">easy</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a name="eval_mkApps_dearg"><span class="id" title="lemma">eval_mkApps_dearg</span></a> <span class="id" title="var">hd</span> <span class="id" title="var">args</span> <span class="id" title="var">v</span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="abbreviation">closed</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#hd"><span class="id" title="variable">hd</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#valid_cases"><span class="id" title="abbreviation">valid_cases</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#hd"><span class="id" title="variable">hd</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#is_expanded"><span class="id" title="abbreviation">is_expanded</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#hd"><span class="id" title="variable">hd</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#Forall"><span class="id" title="inductive">Forall</span></a> (<span class="id" title="definition">closedn</span> 0) <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#args"><span class="id" title="variable">args</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#Forall"><span class="id" title="inductive">Forall</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#valid_cases"><span class="id" title="abbreviation">valid_cases</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#args"><span class="id" title="variable">args</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#Forall"><span class="id" title="inductive">Forall</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#is_expanded"><span class="id" title="abbreviation">is_expanded</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#args"><span class="id" title="variable">args</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">forall</span> (<span class="id" title="var">ev</span> : <a class="idref" href="ConCert.Extraction.ExAst.html#trans_env"><span class="id" title="definition">trans_env</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#768b9254b7286c340e72d39183e874a7"><span class="id" title="variable">Σ</span></a> <a class="idref" href="ConCert.Extraction.WcbvEvalAux.html#e49f44d96100960446bedaca1e4a4428"><span class="id" title="notation">e</span></a><a class="idref" href="ConCert.Extraction.WcbvEvalAux.html#e49f44d96100960446bedaca1e4a4428"><span class="id" title="notation">⊢</span></a> <span class="id" title="definition">mkApps</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#hd"><span class="id" title="variable">hd</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#args"><span class="id" title="variable">args</span></a> <a class="idref" href="ConCert.Extraction.WcbvEvalAux.html#e49f44d96100960446bedaca1e4a4428"><span class="id" title="notation">▷</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#v"><span class="id" title="variable">v</span></a>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Extraction.WcbvEvalAux.html#deriv_length"><span class="id" title="definition">deriv_length</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#ev"><span class="id" title="variable">ev</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Peano.html#cb53cf0ee22c036a03b4a9281c68b5a3"><span class="id" title="notation">&lt;=</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#dearg_correct.dearg.n"><span class="id" title="variable">n</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Extraction.ExAst.html#trans_env"><span class="id" title="definition">trans_env</span></a> (<a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#dearg_env"><span class="id" title="abbreviation">dearg_env</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#768b9254b7286c340e72d39183e874a7"><span class="id" title="variable">Σ</span></a>) <a class="idref" href="ConCert.Extraction.WcbvEvalAux.html#e49f44d96100960446bedaca1e4a4428"><span class="id" title="notation">e</span></a><a class="idref" href="ConCert.Extraction.WcbvEvalAux.html#e49f44d96100960446bedaca1e4a4428"><span class="id" title="notation">⊢</span></a> <span class="id" title="definition">mkApps</span> (<a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#dearg"><span class="id" title="abbreviation">dearg</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#hd"><span class="id" title="variable">hd</span></a>) (<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#map"><span class="id" title="definition">map</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#dearg"><span class="id" title="abbreviation">dearg</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#args"><span class="id" title="variable">args</span></a>) <a class="idref" href="ConCert.Extraction.WcbvEvalAux.html#e49f44d96100960446bedaca1e4a4428"><span class="id" title="notation">▷</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#dearg"><span class="id" title="abbreviation">dearg</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#v"><span class="id" title="variable">v</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">clos_hd</span> <span class="id" title="var">valid_hd</span> <span class="id" title="var">exp_hd</span> <span class="id" title="var">clos_args</span> <span class="id" title="var">valid_args</span> <span class="id" title="var">exp_args</span> <span class="id" title="var">ev</span> <span class="id" title="var">ev_len</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">pose</span> <span class="id" title="var">proof</span> (<a class="idref" href="ConCert.Extraction.WcbvEvalAux.html#eval_mkApps_deriv"><span class="id" title="lemma">eval_mkApps_deriv</span></a> <span class="id" title="var">ev</span>) <span class="id" title="keyword">as</span> (<span class="id" title="var">hdv</span> &amp; <span class="id" title="var">ev_hd</span> &amp; <span class="id" title="var">argsv</span> &amp; <span class="id" title="var">ev_args</span> &amp; <span class="id" title="var">ev_args_len</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">ev_args</span> <span class="id" title="keyword">using</span> <a class="idref" href="ConCert.Extraction.WcbvEvalAux.html#All2_rev_rect"><span class="id" title="lemma">All2_rev_rect</span></a>; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">assert</span> (<span class="id" title="var">hdv</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <span class="id" title="var">v</span>) <span class="id" title="keyword">as</span> -&gt; <span class="id" title="tactic">by</span> (<span class="id" title="var">now</span> <span class="id" title="tactic">eapply</span> <span class="id" title="lemma">eval_deterministic</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">unshelve</span> <span class="id" title="tactic">eapply</span> (<a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#dearg_correct.dearg.IH"><span class="id" title="variable">IH</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">ev_hd</span> <span class="id" title="var">_</span>); <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="var">revert</span> <span class="id" title="var">ev</span> <span class="id" title="var">ev_len</span> <span class="id" title="var">ev_args_len</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#map_app"><span class="id" title="lemma">map_app</span></a>, !<span class="id" title="lemma">mkApps_app</span> <span class="id" title="tactic">by</span> <span class="id" title="var">easy</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#dearg_expanded"><span class="id" title="lemma">dearg_expanded</span></a>, &lt;- <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#dearg_mkApps"><span class="id" title="lemma">dearg_mkApps</span></a> <span class="id" title="tactic">by</span> <span class="id" title="var">easy</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">unshelve</span> <span class="id" title="tactic">eapply</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#eval_tApp_dearg"><span class="id" title="lemma">eval_tApp_dearg</span></a>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">apply</span> <a class="idref" href="ConCert.Extraction.ClosedAux.html#closed_mkApps"><span class="id" title="lemma">closed_mkApps</span></a>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <a class="idref" href="ConCert.Extraction.Utils.html#Forall_snoc"><span class="id" title="lemma">Forall_snoc</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">clos_args</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">apply</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#valid_cases_mkApps"><span class="id" title="lemma">valid_cases_mkApps</span></a>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <a class="idref" href="ConCert.Extraction.Utils.html#Forall_snoc"><span class="id" title="lemma">Forall_snoc</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">valid_args</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">apply</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#is_expanded_aux_mkApps"><span class="id" title="lemma">is_expanded_aux_mkApps</span></a>; [<span class="id" title="var">now</span> <span class="id" title="tactic">eapply</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#is_expanded_aux_upwards"><span class="id" title="lemma">is_expanded_aux_upwards</span></a>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <a class="idref" href="ConCert.Extraction.Utils.html#Forall_snoc"><span class="id" title="lemma">Forall_snoc</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">exp_args</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <a class="idref" href="ConCert.Extraction.Utils.html#Forall_snoc"><span class="id" title="lemma">Forall_snoc</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">clos_args</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <a class="idref" href="ConCert.Extraction.Utils.html#Forall_snoc"><span class="id" title="lemma">Forall_snoc</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">valid_args</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <a class="idref" href="ConCert.Extraction.Utils.html#Forall_snoc"><span class="id" title="lemma">Forall_snoc</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">exp_args</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a name="eval_mkApps_dearg_reduce"><span class="id" title="lemma">eval_mkApps_dearg_reduce</span></a> {<span class="id" title="var">hd</span> <span class="id" title="var">args</span> <span class="id" title="var">v</span>} :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="abbreviation">closed</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#hd"><span class="id" title="variable">hd</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#valid_cases"><span class="id" title="abbreviation">valid_cases</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#hd"><span class="id" title="variable">hd</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#is_expanded"><span class="id" title="abbreviation">is_expanded</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#hd"><span class="id" title="variable">hd</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#Forall"><span class="id" title="inductive">Forall</span></a> (<span class="id" title="definition">closedn</span> 0) <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#args"><span class="id" title="variable">args</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#Forall"><span class="id" title="inductive">Forall</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#valid_cases"><span class="id" title="abbreviation">valid_cases</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#args"><span class="id" title="variable">args</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#Forall"><span class="id" title="inductive">Forall</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#is_expanded"><span class="id" title="abbreviation">is_expanded</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#args"><span class="id" title="variable">args</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#args"><span class="id" title="variable">args</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#ae9a5e1034e143b218b09d8e454472bd"><span class="id" title="notation">[]</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="ConCert.Extraction.ExAst.html#trans_env"><span class="id" title="definition">trans_env</span></a> (<a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#dearg_env"><span class="id" title="abbreviation">dearg_env</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#768b9254b7286c340e72d39183e874a7"><span class="id" title="variable">Σ</span></a>) <a class="idref" href="ConCert.Extraction.WcbvEvalAux.html#e49f44d96100960446bedaca1e4a4428"><span class="id" title="notation">e</span></a><a class="idref" href="ConCert.Extraction.WcbvEvalAux.html#e49f44d96100960446bedaca1e4a4428"><span class="id" title="notation">⊢</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#dearg"><span class="id" title="abbreviation">dearg</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#hd"><span class="id" title="variable">hd</span></a> <a class="idref" href="ConCert.Extraction.WcbvEvalAux.html#e49f44d96100960446bedaca1e4a4428"><span class="id" title="notation">▷</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#dearg"><span class="id" title="abbreviation">dearg</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#v"><span class="id" title="variable">v</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">forall</span> (<span class="id" title="var">ev</span> : <a class="idref" href="ConCert.Extraction.ExAst.html#trans_env"><span class="id" title="definition">trans_env</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#768b9254b7286c340e72d39183e874a7"><span class="id" title="variable">Σ</span></a> <a class="idref" href="ConCert.Extraction.WcbvEvalAux.html#e49f44d96100960446bedaca1e4a4428"><span class="id" title="notation">e</span></a><a class="idref" href="ConCert.Extraction.WcbvEvalAux.html#e49f44d96100960446bedaca1e4a4428"><span class="id" title="notation">⊢</span></a> <span class="id" title="definition">mkApps</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#hd"><span class="id" title="variable">hd</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#args"><span class="id" title="variable">args</span></a> <a class="idref" href="ConCert.Extraction.WcbvEvalAux.html#e49f44d96100960446bedaca1e4a4428"><span class="id" title="notation">▷</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#v"><span class="id" title="variable">v</span></a>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Extraction.WcbvEvalAux.html#deriv_length"><span class="id" title="definition">deriv_length</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#ev"><span class="id" title="variable">ev</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Peano.html#cb53cf0ee22c036a03b4a9281c68b5a3"><span class="id" title="notation">&lt;=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#S"><span class="id" title="constructor">S</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#dearg_correct.dearg.n"><span class="id" title="variable">n</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Extraction.ExAst.html#trans_env"><span class="id" title="definition">trans_env</span></a> (<a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#dearg_env"><span class="id" title="abbreviation">dearg_env</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#768b9254b7286c340e72d39183e874a7"><span class="id" title="variable">Σ</span></a>) <a class="idref" href="ConCert.Extraction.WcbvEvalAux.html#e49f44d96100960446bedaca1e4a4428"><span class="id" title="notation">e</span></a><a class="idref" href="ConCert.Extraction.WcbvEvalAux.html#e49f44d96100960446bedaca1e4a4428"><span class="id" title="notation">⊢</span></a> <span class="id" title="definition">mkApps</span> (<a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#dearg"><span class="id" title="abbreviation">dearg</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#hd"><span class="id" title="variable">hd</span></a>) (<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#map"><span class="id" title="definition">map</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#dearg"><span class="id" title="abbreviation">dearg</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#args"><span class="id" title="variable">args</span></a>) <a class="idref" href="ConCert.Extraction.WcbvEvalAux.html#e49f44d96100960446bedaca1e4a4428"><span class="id" title="notation">▷</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#dearg"><span class="id" title="abbreviation">dearg</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#v"><span class="id" title="variable">v</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">clos_hd</span> <span class="id" title="var">valid_hd</span> <span class="id" title="var">exp_hd</span> <span class="id" title="var">clos_args</span> <span class="id" title="var">valid_args</span> <span class="id" title="var">exp_args</span> <span class="id" title="var">no_args</span> <span class="id" title="var">ev</span> <span class="id" title="var">ev_len</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">args</span> <span class="id" title="keyword">as</span> [|? ? <span class="id" title="var">_</span>] <span class="id" title="keyword">using</span> <span class="id" title="lemma">MCList.rev_ind</span>; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *; [<span class="id" title="var">easy</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">revert</span> <span class="id" title="var">ev</span> <span class="id" title="var">ev_len</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#map_app"><span class="id" title="lemma">map_app</span></a>, !<span class="id" title="lemma">mkApps_app</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">pose</span> <span class="id" title="var">proof</span> (<a class="idref" href="ConCert.Extraction.WcbvEvalAux.html#eval_tApp_deriv"><span class="id" title="lemma">eval_tApp_deriv</span></a> <span class="id" title="var">ev</span>) <span class="id" title="keyword">as</span> (? &amp; ? &amp; ? &amp; ? &amp; ?).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="ConCert.Extraction.WcbvEvalAux.html#eval_tApp_heads"><span class="id" title="lemma">eval_tApp_heads</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;2: { <span class="id" title="var">unshelve</span> <span class="id" title="tactic">eapply</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#eval_mkApps_dearg"><span class="id" title="lemma">eval_mkApps_dearg</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2: <span class="id" title="var">eassumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">all</span>: <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <a class="idref" href="ConCert.Extraction.Utils.html#Forall_snoc"><span class="id" title="lemma">Forall_snoc</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">clos_args</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <a class="idref" href="ConCert.Extraction.Utils.html#Forall_snoc"><span class="id" title="lemma">Forall_snoc</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">valid_args</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <a class="idref" href="ConCert.Extraction.Utils.html#Forall_snoc"><span class="id" title="lemma">Forall_snoc</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">exp_args</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="var">lia</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;1: { <span class="id" title="var">unshelve</span> <span class="id" title="tactic">eapply</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#dearg_correct.dearg.IH"><span class="id" title="variable">IH</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2: <span class="id" title="var">eassumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <a class="idref" href="ConCert.Extraction.Utils.html#Forall_snoc"><span class="id" title="lemma">Forall_snoc</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">clos_args</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <a class="idref" href="ConCert.Extraction.ClosedAux.html#closed_mkApps"><span class="id" title="lemma">closed_mkApps</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <a class="idref" href="ConCert.Extraction.Utils.html#Forall_snoc"><span class="id" title="lemma">Forall_snoc</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">valid_args</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#valid_cases_mkApps"><span class="id" title="lemma">valid_cases_mkApps</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#is_expanded_aux_mkApps"><span class="id" title="lemma">is_expanded_aux_mkApps</span></a>; [<span class="id" title="var">now</span> <span class="id" title="tactic">eapply</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#is_expanded_aux_upwards"><span class="id" title="lemma">is_expanded_aux_upwards</span></a>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <a class="idref" href="ConCert.Extraction.Utils.html#Forall_snoc"><span class="id" title="lemma">Forall_snoc</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">exp_args</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="var">lia</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">unshelve</span> <span class="id" title="tactic">eapply</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#eval_tApp_dearg"><span class="id" title="lemma">eval_tApp_dearg</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">all</span>: <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <a class="idref" href="ConCert.Extraction.Utils.html#Forall_snoc"><span class="id" title="lemma">Forall_snoc</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">clos_args</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <a class="idref" href="ConCert.Extraction.ClosedAux.html#closed_mkApps"><span class="id" title="lemma">closed_mkApps</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <a class="idref" href="ConCert.Extraction.Utils.html#Forall_snoc"><span class="id" title="lemma">Forall_snoc</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">valid_args</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#valid_cases_mkApps"><span class="id" title="lemma">valid_cases_mkApps</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <a class="idref" href="ConCert.Extraction.Utils.html#Forall_snoc"><span class="id" title="lemma">Forall_snoc</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">exp_args</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#is_expanded_aux_mkApps"><span class="id" title="lemma">is_expanded_aux_mkApps</span></a>; [|<span class="id" title="var">easy</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">eapply</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#is_expanded_aux_upwards"><span class="id" title="lemma">is_expanded_aux_upwards</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <a class="idref" href="ConCert.Extraction.Utils.html#Forall_snoc"><span class="id" title="lemma">Forall_snoc</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">clos_args</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <a class="idref" href="ConCert.Extraction.Utils.html#Forall_snoc"><span class="id" title="lemma">Forall_snoc</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">valid_args</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <a class="idref" href="ConCert.Extraction.Utils.html#Forall_snoc"><span class="id" title="lemma">Forall_snoc</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">exp_args</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>
<span class="id" title="keyword">End</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#dearg_correct.dearg"><span class="id" title="section">dearg</span></a>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a name="env_closed_dearg"><span class="id" title="lemma">env_closed_dearg</span></a> <span class="id" title="var">Σ</span> :<br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Extraction.ClosedAux.html#env_closed"><span class="id" title="definition">env_closed</span></a> (<a class="idref" href="ConCert.Extraction.ExAst.html#trans_env"><span class="id" title="definition">trans_env</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#e15c0eb40e61adefe95778c26e7840f6"><span class="id" title="variable">Σ</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Extraction.ClosedAux.html#env_closed"><span class="id" title="definition">env_closed</span></a> (<a class="idref" href="ConCert.Extraction.ExAst.html#trans_env"><span class="id" title="definition">trans_env</span></a> (<a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#dearg_env"><span class="id" title="abbreviation">dearg_env</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#e15c0eb40e61adefe95778c26e7840f6"><span class="id" title="variable">Σ</span></a>)).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">clos</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">Σ</span> <span class="id" title="keyword">as</span> [|((<span class="id" title="var">kn</span> &amp; <span class="id" title="var">has_deps</span>) &amp; <span class="id" title="var">decl</span>) <span class="id" title="var">Σ</span> <span class="id" title="var">IH</span>]; [<span class="id" title="var">easy</span>|].<br/>
&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">decl</span>; [|<span class="id" title="var">easy</span>|].<br/>
&nbsp;&nbsp;- <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">propify</span>; <span class="id" title="tactic">split</span>; [|<span class="id" title="var">easy</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<a class="idref" href="ConCert.Extraction.ExAst.html#cst_body"><span class="id" title="projection">cst_body</span></a> <span class="id" title="var">c</span>); [|<span class="id" title="var">easy</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#closedn_dearg_aux"><span class="id" title="lemma">closedn_dearg_aux</span></a>; [|<span class="id" title="var">easy</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">eapply</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#closedn_dearg_lambdas"><span class="id" title="lemma">closedn_dearg_lambdas</span></a>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">destruct</span> <span class="id" title="var">o</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a name="valid_dearg_mask_dearg_aux"><span class="id" title="lemma">valid_dearg_mask_dearg_aux</span></a> <span class="id" title="var">mask</span> <span class="id" title="var">t</span> :<br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Extraction.Optimize.html#valid_dearg_mask"><span class="id" title="definition">valid_dearg_mask</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#mask"><span class="id" title="variable">mask</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#t"><span class="id" title="variable">t</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Extraction.Optimize.html#valid_dearg_mask"><span class="id" title="definition">valid_dearg_mask</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#mask"><span class="id" title="variable">mask</span></a> (<a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#dearg"><span class="id" title="abbreviation">dearg</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#t"><span class="id" title="variable">t</span></a>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">valid</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">t</span> <span class="id" title="tactic">in</span> <span class="id" title="var">mask</span>, <span class="id" title="var">t</span>, <span class="id" title="var">valid</span> |- *; <span class="id" title="tactic">auto</span>; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">try</span> (<span class="id" title="var">now</span> <span class="id" title="tactic">destruct</span> <span class="id" title="var">mask</span>; [<span class="id" title="tactic">apply</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#valid_dearg_mask_nil"><span class="id" title="lemma">valid_dearg_mask_nil</span></a>|]).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">mask</span>; [<span class="id" title="var">easy</span>|].<br/>
&nbsp;&nbsp;<span class="id" title="var">propify</span>; <span class="id" title="tactic">split</span>; [|<span class="id" title="var">easy</span>].<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">b</span>; [|<span class="id" title="var">easy</span>].<br/>
&nbsp;&nbsp;<span class="id" title="var">propify</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#is_dead_dearg_aux"><span class="id" title="lemma">is_dead_dearg_aux</span></a>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a name="masked_length"><span class="id" title="lemma">masked_length</span></a> {<span class="id" title="var">X</span>} <span class="id" title="var">m</span> (<span class="id" title="var">xs</span> : <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#list"><span class="id" title="inductive">list</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#X"><span class="id" title="variable">X</span></a>) :<br/>
&nbsp;&nbsp;<span class="id" title="notation">#|</span><a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#m"><span class="id" title="variable">m</span></a><span class="id" title="notation">|</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Peano.html#cb53cf0ee22c036a03b4a9281c68b5a3"><span class="id" title="notation">&lt;=</span></a> <span class="id" title="notation">#|</span><a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#xs"><span class="id" title="variable">xs</span></a><span class="id" title="notation">|</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<span class="id" title="notation">#|</span><a class="idref" href="ConCert.Extraction.Optimize.html#masked"><span class="id" title="definition">masked</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#m"><span class="id" title="variable">m</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#xs"><span class="id" title="variable">xs</span></a><span class="id" title="notation">|</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="ConCert.Extraction.Optimize.html#count_zeros"><span class="id" title="definition">count_zeros</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#m"><span class="id" title="variable">m</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Peano.html#0dacc1786c5ba797d47dd85006231633"><span class="id" title="notation">+</span></a> <span class="id" title="notation">#|</span><a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#xs"><span class="id" title="variable">xs</span></a><span class="id" title="notation">|</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Peano.html#7825ccc99f23b0d30c9d40c317ba7af0"><span class="id" title="notation">-</span></a> <span class="id" title="notation">#|</span><a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#m"><span class="id" title="variable">m</span></a><span class="id" title="notation">|</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">len</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">m</span> <span class="id" title="tactic">in</span> <span class="id" title="var">xs</span>, <span class="id" title="var">len</span> |- *; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;- <span class="id" title="var">now</span> <span class="id" title="tactic">destruct</span> <span class="id" title="var">xs</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">destruct</span> <span class="id" title="var">xs</span>; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *; [<span class="id" title="var">easy</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">a</span>; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">rewrite</span> <span class="id" title="var">IHm</span> <span class="id" title="tactic">by</span> <span class="id" title="var">easy</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">unfold</span> <a class="idref" href="ConCert.Extraction.Optimize.html#count_zeros"><span class="id" title="definition">count_zeros</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">rewrite</span> <span class="id" title="var">IHm</span> <span class="id" title="tactic">by</span> <span class="id" title="var">easy</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">unfold</span> <a class="idref" href="ConCert.Extraction.Optimize.html#count_zeros"><span class="id" title="definition">count_zeros</span></a>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a name="masked_app"><span class="id" title="lemma">masked_app</span></a> {<span class="id" title="var">X</span>} <span class="id" title="var">m</span> <span class="id" title="var">m'</span> (<span class="id" title="var">xs</span> : <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#list"><span class="id" title="inductive">list</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#X"><span class="id" title="variable">X</span></a>) :<br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Extraction.Optimize.html#masked"><span class="id" title="definition">masked</span></a> (<a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#m"><span class="id" title="variable">m</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#bc347c51eaf667706ae54503b26d52c6"><span class="id" title="notation">++</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#m'"><span class="id" title="variable">m'</span></a>) <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#xs"><span class="id" title="variable">xs</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#firstn"><span class="id" title="definition">firstn</span></a> (<a class="idref" href="ConCert.Extraction.Optimize.html#count_zeros"><span class="id" title="definition">count_zeros</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#m"><span class="id" title="variable">m</span></a>) (<a class="idref" href="ConCert.Extraction.Optimize.html#masked"><span class="id" title="definition">masked</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#m"><span class="id" title="variable">m</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#xs"><span class="id" title="variable">xs</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#bc347c51eaf667706ae54503b26d52c6"><span class="id" title="notation">++</span></a> <a class="idref" href="ConCert.Extraction.Optimize.html#masked"><span class="id" title="definition">masked</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#m'"><span class="id" title="variable">m'</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#skipn"><span class="id" title="definition">skipn</span></a> <span class="id" title="notation">#|</span><a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#m"><span class="id" title="variable">m</span></a><span class="id" title="notation">|</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#xs"><span class="id" title="variable">xs</span></a>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">m</span> <span class="id" title="tactic">in</span> <span class="id" title="var">m'</span>, <span class="id" title="var">xs</span> |- *; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *; [<span class="id" title="var">easy</span>|].<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">xs</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">destruct</span> <span class="id" title="var">a</span>; <span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#firstn_nil"><span class="id" title="lemma">firstn_nil</span></a>, <span class="id" title="lemma">skipn_nil</span>, <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#masked_nil"><span class="id" title="lemma">masked_nil</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">skipn_nil</span>, <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#masked_nil"><span class="id" title="lemma">masked_nil</span></a>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">destruct</span> <span class="id" title="var">a</span>; <span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="var">IHm</span>, <span class="id" title="lemma">skipn_S</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">IHm</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a name="masked_map"><span class="id" title="lemma">masked_map</span></a> {<span class="id" title="var">X</span> <span class="id" title="var">Y</span>} <span class="id" title="var">m</span> (<span class="id" title="var">f</span> : <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#X"><span class="id" title="variable">X</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#Y"><span class="id" title="variable">Y</span></a>) <span class="id" title="var">xs</span> :<br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Extraction.Optimize.html#masked"><span class="id" title="definition">masked</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#m"><span class="id" title="variable">m</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#map"><span class="id" title="definition">map</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#f"><span class="id" title="variable">f</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#xs"><span class="id" title="variable">xs</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#map"><span class="id" title="definition">map</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#f"><span class="id" title="variable">f</span></a> (<a class="idref" href="ConCert.Extraction.Optimize.html#masked"><span class="id" title="definition">masked</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#m"><span class="id" title="variable">m</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#xs"><span class="id" title="variable">xs</span></a>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">m</span> <span class="id" title="keyword">as</span> [|[] <span class="id" title="var">m</span> <span class="id" title="var">IH</span>] <span class="id" title="tactic">in</span> <span class="id" title="var">xs</span> |- *; [<span class="id" title="var">easy</span>| |]; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">destruct</span> <span class="id" title="var">xs</span>; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *; [<span class="id" title="var">easy</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">IH</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">destruct</span> <span class="id" title="var">xs</span>; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *; [<span class="id" title="var">easy</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">f_equal</span>; <span class="id" title="tactic">apply</span> <span class="id" title="var">IH</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a name="filter_length"><span class="id" title="lemma">filter_length</span></a> {<span class="id" title="var">X</span>} (<span class="id" title="var">f</span> : <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#X"><span class="id" title="variable">X</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#bool"><span class="id" title="inductive">bool</span></a>) (<span class="id" title="var">xs</span> : <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#list"><span class="id" title="inductive">list</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#X"><span class="id" title="variable">X</span></a>) :<br/>
&nbsp;&nbsp;<span class="id" title="notation">#|</span><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#filter"><span class="id" title="definition">filter</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#f"><span class="id" title="variable">f</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#xs"><span class="id" title="variable">xs</span></a><span class="id" title="notation">|</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Peano.html#cb53cf0ee22c036a03b4a9281c68b5a3"><span class="id" title="notation">&lt;=</span></a> <span class="id" title="notation">#|</span><a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#xs"><span class="id" title="variable">xs</span></a><span class="id" title="notation">|</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">xs</span>; [<span class="id" title="var">easy</span>|].<br/>
&nbsp;&nbsp;<span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<span class="id" title="var">f</span> <span class="id" title="var">a</span>); <span class="id" title="var">cbn</span>; <span class="id" title="var">lia</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a name="map_repeat"><span class="id" title="lemma">map_repeat</span></a> {<span class="id" title="var">X</span> <span class="id" title="var">Y</span>} (<span class="id" title="var">f</span> : <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#X"><span class="id" title="variable">X</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#Y"><span class="id" title="variable">Y</span></a>) <span class="id" title="var">x</span> <span class="id" title="var">n</span> :<br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#map"><span class="id" title="definition">map</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#f"><span class="id" title="variable">f</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#repeat"><span class="id" title="definition">repeat</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#x"><span class="id" title="variable">x</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#n"><span class="id" title="variable">n</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#repeat"><span class="id" title="definition">repeat</span></a> (<a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#f"><span class="id" title="variable">f</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#x"><span class="id" title="variable">x</span></a>) <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#n"><span class="id" title="variable">n</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">n</span>; [<span class="id" title="var">easy</span>|].<br/>
&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="var">cbn</span>; <span class="id" title="tactic">rewrite</span> <span class="id" title="var">IHn</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a name="nth_error_masked"><span class="id" title="lemma">nth_error_masked</span></a> {<span class="id" title="var">X</span>} <span class="id" title="var">m</span> (<span class="id" title="var">xs</span> : <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#list"><span class="id" title="inductive">list</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#X"><span class="id" title="variable">X</span></a>) <span class="id" title="var">n</span> :<br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#nth"><span class="id" title="definition">nth</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#n"><span class="id" title="variable">n</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#m"><span class="id" title="variable">m</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#false"><span class="id" title="constructor">false</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#false"><span class="id" title="constructor">false</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#nth_error"><span class="id" title="definition">nth_error</span></a> (<a class="idref" href="ConCert.Extraction.Optimize.html#masked"><span class="id" title="definition">masked</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#m"><span class="id" title="variable">m</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#xs"><span class="id" title="variable">xs</span></a>) (<a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#n"><span class="id" title="variable">n</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Peano.html#7825ccc99f23b0d30c9d40c317ba7af0"><span class="id" title="notation">-</span></a> <a class="idref" href="ConCert.Extraction.Optimize.html#count_ones"><span class="id" title="definition">count_ones</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#firstn"><span class="id" title="definition">firstn</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#n"><span class="id" title="variable">n</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#m"><span class="id" title="variable">m</span></a>)) <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#nth_error"><span class="id" title="definition">nth_error</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#xs"><span class="id" title="variable">xs</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#n"><span class="id" title="variable">n</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">not_removed</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">n</span> <span class="id" title="tactic">in</span> <span class="id" title="var">m</span>, <span class="id" title="var">xs</span>, <span class="id" title="var">not_removed</span> |- *; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">destruct</span> <span class="id" title="var">xs</span>; [<span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#masked_nil"><span class="id" title="lemma">masked_nil</span></a>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">m</span>; [<span class="id" title="var">easy</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">destruct</span> <span class="id" title="var">b</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">destruct</span> <span class="id" title="var">m</span>; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *; [<span class="id" title="var">easy</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">xs</span>; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">nth_error_nil</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">destruct</span> <span class="id" title="var">b</span>; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <span class="id" title="var">IHn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Arith.PeanoNat.html#Nat.sub_succ_l"><span class="id" title="lemma">Nat.sub_succ_l</span></a>; [<span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <span class="id" title="var">IHn</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">transitivity</span> <span class="id" title="notation">#|</span><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#firstn"><span class="id" title="definition">firstn</span></a> <span class="id" title="var">n</span> <span class="id" title="var">m</span><span class="id" title="notation">|</span>; [|<span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#firstn_length"><span class="id" title="lemma">firstn_length</span></a>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#filter_length"><span class="id" title="lemma">filter_length</span></a>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a name="is_propositional_ind_trans_env_dearg_env"><span class="id" title="lemma">is_propositional_ind_trans_env_dearg_env</span></a> <span class="id" title="var">Σ</span> <span class="id" title="var">ind</span> :<br/>
&nbsp;&nbsp;<span class="id" title="definition">is_propositional_ind</span> (<a class="idref" href="ConCert.Extraction.ExAst.html#trans_env"><span class="id" title="definition">trans_env</span></a> (<a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#dearg_env"><span class="id" title="abbreviation">dearg_env</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#e15c0eb40e61adefe95778c26e7840f6"><span class="id" title="variable">Σ</span></a>)) <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#ind"><span class="id" title="variable">ind</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a><br/>
&nbsp;&nbsp;<span class="id" title="definition">is_propositional_ind</span> (<a class="idref" href="ConCert.Extraction.ExAst.html#trans_env"><span class="id" title="definition">trans_env</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#e15c0eb40e61adefe95778c26e7840f6"><span class="id" title="variable">Σ</span></a>) <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#ind"><span class="id" title="variable">ind</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="definition">is_propositional_ind</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> !<a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#lookup_env_trans_env"><span class="id" title="lemma">lookup_env_trans_env</span></a>, <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#lookup_env_dearg_env"><span class="id" title="lemma">lookup_env_dearg_env</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <a class="idref" href="ConCert.Extraction.ExAst.html#lookup_env"><span class="id" title="definition">lookup_env</span></a>; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *; [|<span class="id" title="tactic">reflexivity</span>].<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">g</span>; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> !<span class="id" title="lemma">nth_error_map</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="ConCert.Extraction.Optimize.html#dearg_mib"><span class="id" title="definition">dearg_mib</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#get_mib_masks"><span class="id" title="abbreviation">get_mib_masks</span></a>; [|<span class="id" title="tactic">reflexivity</span>].<br/>
&nbsp;&nbsp;<span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">nth_error_mapi</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">destruct</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#nth_error"><span class="id" title="definition">nth_error</span></a>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a name="dearg_correct"><span class="id" title="lemma">dearg_correct</span></a> {<span class="id" title="var">wfl</span>:<span class="id" title="class">WcbvFlags</span>} <span class="id" title="var">Σ</span> <span class="id" title="var">t</span> <span class="id" title="var">v</span> :<br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Extraction.ClosedAux.html#env_closed"><span class="id" title="definition">env_closed</span></a> (<a class="idref" href="ConCert.Extraction.ExAst.html#trans_env"><span class="id" title="definition">trans_env</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#e15c0eb40e61adefe95778c26e7840f6"><span class="id" title="variable">Σ</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<span class="id" title="abbreviation">closed</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#t"><span class="id" title="variable">t</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
<br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#valid_masks_env"><span class="id" title="abbreviation">valid_masks_env</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#e15c0eb40e61adefe95778c26e7840f6"><span class="id" title="variable">Σ</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#valid_cases"><span class="id" title="abbreviation">valid_cases</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#t"><span class="id" title="variable">t</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
<br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#is_expanded_env"><span class="id" title="abbreviation">is_expanded_env</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#e15c0eb40e61adefe95778c26e7840f6"><span class="id" title="variable">Σ</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#is_expanded"><span class="id" title="abbreviation">is_expanded</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#t"><span class="id" title="variable">t</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
<br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Extraction.ExAst.html#trans_env"><span class="id" title="definition">trans_env</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#e15c0eb40e61adefe95778c26e7840f6"><span class="id" title="variable">Σ</span></a> <a class="idref" href="ConCert.Extraction.WcbvEvalAux.html#e49f44d96100960446bedaca1e4a4428"><span class="id" title="notation">e</span></a><a class="idref" href="ConCert.Extraction.WcbvEvalAux.html#e49f44d96100960446bedaca1e4a4428"><span class="id" title="notation">⊢</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#t"><span class="id" title="variable">t</span></a> <a class="idref" href="ConCert.Extraction.WcbvEvalAux.html#e49f44d96100960446bedaca1e4a4428"><span class="id" title="notation">▷</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#v"><span class="id" title="variable">v</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Extraction.ExAst.html#trans_env"><span class="id" title="definition">trans_env</span></a> (<a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#dearg_env"><span class="id" title="abbreviation">dearg_env</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#e15c0eb40e61adefe95778c26e7840f6"><span class="id" title="variable">Σ</span></a>) <a class="idref" href="ConCert.Extraction.WcbvEvalAux.html#e49f44d96100960446bedaca1e4a4428"><span class="id" title="notation">e</span></a><a class="idref" href="ConCert.Extraction.WcbvEvalAux.html#e49f44d96100960446bedaca1e4a4428"><span class="id" title="notation">⊢</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#dearg"><span class="id" title="abbreviation">dearg</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#t"><span class="id" title="variable">t</span></a> <a class="idref" href="ConCert.Extraction.WcbvEvalAux.html#e49f44d96100960446bedaca1e4a4428"><span class="id" title="notation">▷</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#dearg"><span class="id" title="abbreviation">dearg</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#v"><span class="id" title="variable">v</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">clos_env</span> <span class="id" title="var">clos_t</span> <span class="id" title="var">valid_env</span> <span class="id" title="var">valid_t</span> <span class="id" title="var">exp_env</span> <span class="id" title="var">exp_t</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">enough</span> (<span class="id" title="keyword">forall</span> <span class="id" title="var">n</span> (<span class="id" title="var">ev</span> : <a class="idref" href="ConCert.Extraction.ExAst.html#trans_env"><span class="id" title="definition">trans_env</span></a> <span class="id" title="var">Σ</span> <a class="idref" href="ConCert.Extraction.WcbvEvalAux.html#e49f44d96100960446bedaca1e4a4428"><span class="id" title="notation">e</span></a><a class="idref" href="ConCert.Extraction.WcbvEvalAux.html#e49f44d96100960446bedaca1e4a4428"><span class="id" title="notation">⊢</span></a> <span class="id" title="var">t</span> <a class="idref" href="ConCert.Extraction.WcbvEvalAux.html#e49f44d96100960446bedaca1e4a4428"><span class="id" title="notation">▷</span></a> <span class="id" title="var">v</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Extraction.WcbvEvalAux.html#deriv_length"><span class="id" title="definition">deriv_length</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#ev"><span class="id" title="variable">ev</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Peano.html#cb53cf0ee22c036a03b4a9281c68b5a3"><span class="id" title="notation">&lt;=</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#n"><span class="id" title="variable">n</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Extraction.ExAst.html#trans_env"><span class="id" title="definition">trans_env</span></a> (<a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#dearg_env"><span class="id" title="abbreviation">dearg_env</span></a> <span class="id" title="var">Σ</span>) <a class="idref" href="ConCert.Extraction.WcbvEvalAux.html#e49f44d96100960446bedaca1e4a4428"><span class="id" title="notation">e</span></a><a class="idref" href="ConCert.Extraction.WcbvEvalAux.html#e49f44d96100960446bedaca1e4a4428"><span class="id" title="notation">⊢</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#dearg"><span class="id" title="abbreviation">dearg</span></a> <span class="id" title="var">t</span> <a class="idref" href="ConCert.Extraction.WcbvEvalAux.html#e49f44d96100960446bedaca1e4a4428"><span class="id" title="notation">▷</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#dearg"><span class="id" title="abbreviation">dearg</span></a> <span class="id" title="var">v</span>).<br/>
&nbsp;&nbsp;{ <span class="id" title="tactic">intros</span> <span class="id" title="var">ev</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> (<span class="id" title="var">H</span> <span class="id" title="var">_</span> <span class="id" title="var">ev</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Arith.Le.html#le_refl"><span class="id" title="abbreviation">le_refl</span></a>. }<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">n</span> <span class="id" title="keyword">as</span> [|<span class="id" title="var">n</span> <span class="id" title="var">IH</span>] <span class="id" title="tactic">in</span> <span class="id" title="var">t</span>, <span class="id" title="var">v</span>, <span class="id" title="var">clos_t</span>, <span class="id" title="var">valid_t</span>, <span class="id" title="var">exp_t</span> |- *; <span class="id" title="tactic">intros</span> <span class="id" title="var">ev</span> <span class="id" title="var">deriv_len</span>.<br/>
&nbsp;&nbsp;{ <span class="id" title="var">now</span> <span class="id" title="tactic">pose</span> <span class="id" title="var">proof</span> (<a class="idref" href="ConCert.Extraction.WcbvEvalAux.html#deriv_length_min"><span class="id" title="lemma">deriv_length_min</span></a> <span class="id" title="var">ev</span>). }<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#dearg_elim"><span class="id" title="lemma">dearg_elim</span></a> <span class="id" title="var">t</span>).<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#is_expanded_aux_mkApps_inv"><span class="id" title="lemma">is_expanded_aux_mkApps_inv</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">exp_t</span> <span class="id" title="keyword">as</span> (<span class="id" title="var">exp_hd</span> &amp; <span class="id" title="var">exp_args</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *; <span class="id" title="var">propify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#dearg_single_masked"><span class="id" title="lemma">dearg_single_masked</span></a> <span class="id" title="tactic">by</span> (<span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#map_length"><span class="id" title="lemma">map_length</span></a>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">specialize</span> (<a class="idref" href="ConCert.Extraction.WcbvEvalAux.html#eval_mkApps_deriv"><span class="id" title="lemma">eval_mkApps_deriv</span></a> <span class="id" title="var">ev</span>) <span class="id" title="keyword">as</span> (? &amp; <span class="id" title="var">ev_const</span> &amp; <span class="id" title="var">argsv</span> &amp; <span class="id" title="var">ev_args</span> &amp; <span class="id" title="var">deriv</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">depelim</span> <span class="id" title="var">ev_const</span>; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *; [|<span class="id" title="var">easy</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#declared_constant_dearg"><span class="id" title="lemma">declared_constant_dearg</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">isdecl</span> <span class="id" title="keyword">as</span> <span class="id" title="var">isdecl_dearg</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">isdecl_dearg</span> <span class="id" title="keyword">as</span> (<span class="id" title="var">cst_dearg</span> &amp; <span class="id" title="var">decl_dearg</span> &amp; <span class="id" title="var">body_dearg</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">e</span> <span class="id" title="tactic">in</span> <span class="id" title="var">body_dearg</span>; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">enough</span> (<a class="idref" href="ConCert.Extraction.ExAst.html#trans_env"><span class="id" title="definition">trans_env</span></a> (<a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#dearg_env"><span class="id" title="abbreviation">dearg_env</span></a> <span class="id" title="var">Σ</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Extraction.WcbvEvalAux.html#e49f44d96100960446bedaca1e4a4428"><span class="id" title="notation">e</span></a><a class="idref" href="ConCert.Extraction.WcbvEvalAux.html#e49f44d96100960446bedaca1e4a4428"><span class="id" title="notation">⊢</span></a> <span class="id" title="definition">mkApps</span> (<a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#dearg"><span class="id" title="abbreviation">dearg</span></a> (<a class="idref" href="ConCert.Extraction.Optimize.html#dearg_lambdas"><span class="id" title="definition">dearg_lambdas</span></a> (<a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#get_const_mask"><span class="id" title="abbreviation">get_const_mask</span></a> <span class="id" title="var">kn</span>) <span class="id" title="var">body</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="ConCert.Extraction.Optimize.html#masked"><span class="id" title="definition">masked</span></a> (<a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#get_const_mask"><span class="id" title="abbreviation">get_const_mask</span></a> <span class="id" title="var">kn</span>) (<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#map"><span class="id" title="definition">map</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#dearg"><span class="id" title="abbreviation">dearg</span></a> <span class="id" title="var">args</span>)) <a class="idref" href="ConCert.Extraction.WcbvEvalAux.html#e49f44d96100960446bedaca1e4a4428"><span class="id" title="notation">▷</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#dearg"><span class="id" title="abbreviation">dearg</span></a> <span class="id" title="var">v</span>) <span class="id" title="keyword">as</span> <span class="id" title="var">ev'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">eapply</span> <a class="idref" href="ConCert.Extraction.WcbvEvalAux.html#eval_mkApps_head"><span class="id" title="lemma">eval_mkApps_head</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">ev'</span> <span class="id" title="keyword">as</span> <span class="id" title="var">ev_hd</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">ev_hd</span> <span class="id" title="keyword">as</span> (<span class="id" title="var">hdv</span> &amp; <span class="id" title="var">ev_hd</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="ConCert.Extraction.WcbvEvalAux.html#eval_mkApps_heads"><span class="id" title="lemma">eval_mkApps_heads</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;3: <span class="id" title="var">eassumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1: <span class="id" title="var">eassumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">econstructor</span>; <span class="id" title="var">eassumption</span>. }<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#dearg_dearg_lambdas"><span class="id" title="lemma">dearg_dearg_lambdas</span></a> <span class="id" title="tactic">by</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eauto</span> <span class="id" title="keyword">using</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#valid_dearg_mask_constant"><span class="id" title="lemma">valid_dearg_mask_constant</span></a>, <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#valid_cases_constant"><span class="id" title="lemma">valid_cases_constant</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="notation">∑</span> <span class="id" title="var">ev'</span> : <a class="idref" href="ConCert.Extraction.ExAst.html#trans_env"><span class="id" title="definition">trans_env</span></a> <span class="id" title="var">Σ</span> <a class="idref" href="ConCert.Extraction.WcbvEvalAux.html#e49f44d96100960446bedaca1e4a4428"><span class="id" title="notation">e</span></a><a class="idref" href="ConCert.Extraction.WcbvEvalAux.html#e49f44d96100960446bedaca1e4a4428"><span class="id" title="notation">⊢</span></a> <span class="id" title="definition">mkApps</span> <span class="id" title="var">body</span> <span class="id" title="var">args</span> <a class="idref" href="ConCert.Extraction.WcbvEvalAux.html#e49f44d96100960446bedaca1e4a4428"><span class="id" title="notation">▷</span></a> <span class="id" title="var">v</span><span class="id" title="notation">,</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Extraction.WcbvEvalAux.html#deriv_length"><span class="id" title="definition">deriv_length</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#ev'"><span class="id" title="variable">ev'</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Peano.html#00fe0eaf5e6949f0a31725357afa4bba"><span class="id" title="notation">&lt;</span></a> <a class="idref" href="ConCert.Extraction.WcbvEvalAux.html#deriv_length"><span class="id" title="definition">deriv_length</span></a> <span class="id" title="var">ev</span>) <span class="id" title="keyword">as</span> (<span class="id" title="var">ev_body</span> &amp; <span class="id" title="var">deriv_body</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="var">unshelve</span> <span class="id" title="var">epose</span> <span class="id" title="var">proof</span> (<a class="idref" href="ConCert.Extraction.WcbvEvalAux.html#eval_mkApps_heads_deriv"><span class="id" title="lemma">eval_mkApps_heads_deriv</span></a> <span class="id" title="var">_</span> <span class="id" title="var">ev_const</span> <span class="id" title="var">ev</span>) <span class="id" title="keyword">as</span> (<span class="id" title="var">ev'</span> &amp; ?).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="var">now</span> <span class="id" title="tactic">econstructor</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">exists</span> <span class="id" title="var">ev'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *. }<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#dearg_lambdas_correct"><span class="id" title="lemma">dearg_lambdas_correct</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#env_closed_dearg"><span class="id" title="lemma">env_closed_dearg</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">apply</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#closedn_dearg_aux"><span class="id" title="lemma">closedn_dearg_aux</span></a>; [|<span class="id" title="var">easy</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">eapply</span> <a class="idref" href="ConCert.Extraction.WcbvEvalAux.html#closed_constant"><span class="id" title="lemma">closed_constant</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">apply</span> <span class="id" title="lemma">Forall_map</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="ConCert.Extraction.ClosedAux.html#closed_mkApps_inv"><span class="id" title="lemma">closed_mkApps_inv</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">clos_t</span> <span class="id" title="keyword">as</span> (? &amp; <span class="id" title="var">clos_args</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <span class="id" title="lemma">Forall_impl</span>; [<span class="id" title="tactic">exact</span> <span class="id" title="var">clos_args</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#closedn_dearg_aux"><span class="id" title="lemma">closedn_dearg_aux</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">apply</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#valid_dearg_mask_dearg_aux"><span class="id" title="lemma">valid_dearg_mask_dearg_aux</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">eapply</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#valid_dearg_mask_constant"><span class="id" title="lemma">valid_dearg_mask_constant</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#map_length"><span class="id" title="lemma">map_length</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">unshelve</span> <span class="id" title="tactic">eapply</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#eval_mkApps_dearg"><span class="id" title="lemma">eval_mkApps_dearg</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;6: <span class="id" title="tactic">exact</span> <span class="id" title="var">IH</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">all</span>: <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="var">now</span> <span class="id" title="tactic">eapply</span> <a class="idref" href="ConCert.Extraction.WcbvEvalAux.html#closed_constant"><span class="id" title="lemma">closed_constant</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="var">now</span> <span class="id" title="tactic">eapply</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#valid_cases_constant"><span class="id" title="lemma">valid_cases_constant</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="var">now</span> <span class="id" title="tactic">eapply</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#is_expanded_constant"><span class="id" title="lemma">is_expanded_constant</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <a class="idref" href="ConCert.Extraction.ClosedAux.html#closed_mkApps_inv"><span class="id" title="lemma">closed_mkApps_inv</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">clos_t</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#valid_cases_mkApps_inv"><span class="id" title="lemma">valid_cases_mkApps_inv</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">valid_t</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="var">lia</span>.<br/>

<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">specialize</span> (<a class="idref" href="ConCert.Extraction.WcbvEvalAux.html#eval_mkApps_deriv"><span class="id" title="lemma">eval_mkApps_deriv</span></a> <span class="id" title="var">ev</span>) <span class="id" title="keyword">as</span> (? &amp; <span class="id" title="var">ev_constr</span> &amp; <span class="id" title="var">argsv</span> &amp; <span class="id" title="var">ev_args</span> &amp; <span class="id" title="var">deriv</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">v</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <span class="id" title="definition">mkApps</span> (<span class="id" title="constructor">tConstruct</span> <span class="id" title="var">ind</span> <span class="id" title="var">c</span>) <span class="id" title="var">argsv</span>) <span class="id" title="keyword">as</span> -&gt;.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">eapply</span> <span class="id" title="lemma">eval_deterministic</span>; <span class="id" title="tactic">try</span> <span class="id" title="var">eassumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#eval_mkApps_tConstruct"><span class="id" title="lemma">eval_mkApps_tConstruct</span></a>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#dearg_mkApps"><span class="id" title="lemma">dearg_mkApps</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="lemma">All2_length</span> <span class="id" title="tactic">in</span> <span class="id" title="var">ev_args</span> <span class="id" title="keyword">as</span> ?.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#is_expanded_aux_mkApps_inv"><span class="id" title="lemma">is_expanded_aux_mkApps_inv</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">exp_t</span> <span class="id" title="keyword">as</span> (<span class="id" title="var">exp_hd</span> &amp; <span class="id" title="var">exp_args</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *; <span class="id" title="var">propify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> !<a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#dearg_single_masked"><span class="id" title="lemma">dearg_single_masked</span></a> <span class="id" title="tactic">by</span> (<span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#map_length"><span class="id" title="lemma">map_length</span></a>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">ev_args_dearg</span>: <span class="id" title="inductive">All2</span> (<span class="id" title="inductive">eval</span> (<a class="idref" href="ConCert.Extraction.ExAst.html#trans_env"><span class="id" title="definition">trans_env</span></a> (<a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#dearg_env"><span class="id" title="abbreviation">dearg_env</span></a> <span class="id" title="var">Σ</span>))) (<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#map"><span class="id" title="definition">map</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#dearg"><span class="id" title="abbreviation">dearg</span></a> <span class="id" title="var">args</span>) (<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#map"><span class="id" title="definition">map</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#dearg"><span class="id" title="abbreviation">dearg</span></a> <span class="id" title="var">argsv</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">assert</span> (<span class="id" title="var">all_smaller</span>: <a class="idref" href="ConCert.Extraction.WcbvEvalAux.html#sum_deriv_lengths"><span class="id" title="definition">sum_deriv_lengths</span></a> <span class="id" title="var">ev_args</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Peano.html#cb53cf0ee22c036a03b4a9281c68b5a3"><span class="id" title="notation">&lt;=</span></a> <span class="id" title="var">n</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">pose</span> <span class="id" title="var">proof</span> (<a class="idref" href="ConCert.Extraction.WcbvEvalAux.html#deriv_length_min"><span class="id" title="lemma">deriv_length_min</span></a> <span class="id" title="var">ev_constr</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">lia</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="ConCert.Extraction.ClosedAux.html#closed_mkApps_inv"><span class="id" title="lemma">closed_mkApps_inv</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">clos_t</span> <span class="id" title="keyword">as</span> (<span class="id" title="var">_</span> &amp; <span class="id" title="var">clos_apps</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#valid_cases_mkApps_inv"><span class="id" title="lemma">valid_cases_mkApps_inv</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">valid_t</span> <span class="id" title="keyword">as</span> (<span class="id" title="var">_</span> &amp; <span class="id" title="var">valid_apps</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">clear</span> -<span class="id" title="var">clos_apps</span> <span class="id" title="var">valid_apps</span> <span class="id" title="var">exp_args</span> <span class="id" title="var">IH</span> <span class="id" title="var">ev_args</span> <span class="id" title="var">all_smaller</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">ev_args</span>; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="var">now</span> <span class="id" title="tactic">constructor</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="var">unshelve</span> <span class="id" title="var">epose</span> <span class="id" title="var">proof</span> (<span class="id" title="var">IHev_args</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>) <span class="id" title="keyword">as</span> <span class="id" title="var">ev_suf</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">now</span> <span class="id" title="var">depelim</span> <span class="id" title="var">clos_apps</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">now</span> <span class="id" title="var">depelim</span> <span class="id" title="var">valid_apps</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">now</span> <span class="id" title="var">depelim</span> <span class="id" title="var">exp_args</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">unshelve</span> <span class="id" title="var">epose</span> <span class="id" title="var">proof</span> (<span class="id" title="var">IH</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">r</span> <span class="id" title="var">_</span>) <span class="id" title="keyword">as</span> <span class="id" title="var">ev_dearg</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="var">now</span> <span class="id" title="var">depelim</span> <span class="id" title="var">clos_apps</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="var">now</span> <span class="id" title="var">depelim</span> <span class="id" title="var">valid_apps</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="var">now</span> <span class="id" title="var">depelim</span> <span class="id" title="var">exp_args</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="var">lia</span>. }<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#eval_mkApps_tConstruct"><span class="id" title="lemma">eval_mkApps_tConstruct</span></a>, <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#All2_masked"><span class="id" title="lemma">All2_masked</span></a>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">facts</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="ConCert.Extraction.ClosedAux.html#closed_mkApps_inv"><span class="id" title="lemma">closed_mkApps_inv</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">clos_t</span> <span class="id" title="keyword">as</span> (<span class="id" title="var">clos_t</span> &amp; <span class="id" title="var">clos_args</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#valid_cases_mkApps_inv"><span class="id" title="lemma">valid_cases_mkApps_inv</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">valid_t</span> <span class="id" title="keyword">as</span> (<span class="id" title="var">valid_t</span> &amp; <span class="id" title="var">valid_args</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#is_expanded_aux_mkApps_inv"><span class="id" title="lemma">is_expanded_aux_mkApps_inv</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">exp_t</span> <span class="id" title="keyword">as</span> (<span class="id" title="var">exp_hd</span> &amp; <span class="id" title="var">exp_args</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">unshelve</span> <span class="id" title="tactic">eapply</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#eval_mkApps_dearg_reduce"><span class="id" title="lemma">eval_mkApps_dearg_reduce</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;6: <span class="id" title="tactic">exact</span> <span class="id" title="var">IH</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">all</span>: <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> -&gt;.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *; <span class="id" title="var">propify</span>; <span class="id" title="var">refold'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">clos_t</span> <span class="id" title="keyword">as</span> (<span class="id" title="var">clos_discr</span> &amp; <span class="id" title="var">clos_brs</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">valid_t</span> <span class="id" title="keyword">as</span> ((<span class="id" title="var">valid_discr</span> &amp; <span class="id" title="var">valid_brs</span>) &amp; <span class="id" title="var">valid_brs_masks</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">exp_hd</span> <span class="id" title="keyword">as</span> (<span class="id" title="var">exp_discr</span> &amp; <span class="id" title="var">exp_brs</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">dearg_case</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;We&nbsp;need&nbsp;induction&nbsp;as&nbsp;casing&nbsp;on&nbsp;a&nbsp;cofix&nbsp;involves&nbsp;casing&nbsp;on&nbsp;whatever&nbsp;it&nbsp;evaluates&nbsp;to&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">depind</span> <span class="id" title="var">ev</span>; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="comment">(*&nbsp;Normal&nbsp;pattern&nbsp;match&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">clear</span> <span class="id" title="var">IHev1</span> <span class="id" title="var">IHev2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">facts</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">clear</span> <span class="id" title="var">clos_args</span> <span class="id" title="var">valid_args</span> <span class="id" title="var">exp_args</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="ConCert.Extraction.ClosedAux.html#closed_mkApps_inv"><span class="id" title="lemma">closed_mkApps_inv</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">H2</span> <span class="id" title="keyword">as</span> (<span class="id" title="var">clos_hd</span> &amp; <span class="id" title="var">clos_args</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#valid_cases_mkApps_inv"><span class="id" title="lemma">valid_cases_mkApps_inv</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">H3</span> <span class="id" title="keyword">as</span> (<span class="id" title="var">valid_hd</span> &amp; <span class="id" title="var">valid_args</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#is_expanded_aux_mkApps_inv"><span class="id" title="lemma">is_expanded_aux_mkApps_inv</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">H4</span> <span class="id" title="keyword">as</span> (<span class="id" title="var">exp_hd</span> &amp; <span class="id" title="var">exp_args</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *; <span class="id" title="var">propify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<span class="id" title="constructor">eval_iota</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">c</span> (<a class="idref" href="ConCert.Extraction.Optimize.html#masked"><span class="id" title="definition">masked</span></a> (<a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#get_ctor_mask"><span class="id" title="abbreviation">get_ctor_mask</span></a> <span class="id" title="var">ind</span> <span class="id" title="var">c</span>) (<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#map"><span class="id" title="definition">map</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#dearg"><span class="id" title="abbreviation">dearg</span></a> <span class="id" title="var">args</span>))).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="var">unshelve</span> <span class="id" title="var">epose</span> <span class="id" title="var">proof</span> (<span class="id" title="var">IH</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">ev1</span> <span class="id" title="var">_</span>); <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1: <span class="id" title="var">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#dearg_mkApps"><span class="id" title="lemma">dearg_mkApps</span></a> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#dearg_single_masked"><span class="id" title="lemma">dearg_single_masked</span></a> <span class="id" title="tactic">in</span> * <span class="id" title="tactic">by</span> (<span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#map_length"><span class="id" title="lemma">map_length</span></a>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="tactic">rewrite</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#is_propositional_ind_trans_env_dearg_env"><span class="id" title="lemma">is_propositional_ind_trans_env_dearg_env</span></a>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="tactic">destruct</span> (<a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#get_mib_masks"><span class="id" title="abbreviation">get_mib_masks</span></a> <span class="id" title="var">_</span>) <span class="id" title="var">eqn</span>:<span class="id" title="var">mm</span>; <span class="id" title="var">cycle</span> 1.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">get_ctor_mask</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">mm</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="definition">iota_red</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="lemma">map_skipn</span>, <span class="id" title="lemma">nth_map</span> <span class="id" title="tactic">by</span> <span class="id" title="var">easy</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">unshelve</span> <span class="id" title="tactic">eapply</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#eval_mkApps_dearg"><span class="id" title="lemma">eval_mkApps_dearg</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;6: <span class="id" title="tactic">exact</span> <span class="id" title="var">IH</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">all</span>: <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1-3: <span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">nth_nth_error</span>; <span class="id" title="tactic">destruct</span> (<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#nth_error"><span class="id" title="definition">nth_error</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span>) <span class="id" title="var">eqn</span>:<span class="id" title="var">nth</span>; [|<span class="id" title="var">easy</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="var">now</span> <span class="id" title="tactic">eapply</span> <span class="id" title="lemma">nth_error_forallb</span> <span class="id" title="tactic">in</span> <span class="id" title="var">clos_brs</span>; <span class="id" title="tactic">rewrite</span> <span class="id" title="var">nth</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="var">now</span> <span class="id" title="tactic">eapply</span> <span class="id" title="lemma">nth_error_forallb</span> <span class="id" title="tactic">in</span> <span class="id" title="var">valid_brs</span>; <span class="id" title="tactic">rewrite</span> <span class="id" title="var">nth</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="var">now</span> <span class="id" title="tactic">eapply</span> <span class="id" title="lemma">nth_error_forallb</span> <span class="id" title="tactic">in</span> <span class="id" title="var">exp_brs</span>; <span class="id" title="tactic">rewrite</span> <span class="id" title="var">nth</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <span class="id" title="lemma">Forall_skipn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <span class="id" title="lemma">Forall_skipn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <span class="id" title="lemma">Forall_skipn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="var">lia</span>. }<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">get_ctor_mask</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">mm</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="definition">iota_red</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">revert</span> <span class="id" title="var">ev2</span> <span class="id" title="var">deriv_len</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> !<span class="id" title="lemma">nth_nth_error</span>, <span class="id" title="lemma">nth_error_mapi</span>, <span class="id" title="lemma">nth_error_map</span>, <span class="id" title="lemma">option_map_two</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#nth_error"><span class="id" title="definition">nth_error</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span>) <span class="id" title="var">eqn</span>:<span class="id" title="var">nth</span>; <span class="id" title="var">cycle</span> 1.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="ConCert.Extraction.WcbvEvalAux.html#eval_mkApps_head"><span class="id" title="lemma">eval_mkApps_head</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">ev2</span> <span class="id" title="keyword">as</span> <span class="id" title="var">ev'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">ev'</span> <span class="id" title="keyword">as</span> (? &amp; <span class="id" title="var">ev_contra</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="var">depelim</span> <span class="id" title="var">ev_contra</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">replace</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#skipn"><span class="id" title="definition">skipn</span></a> (<a class="idref" href="ConCert.Extraction.Optimize.html#count_zeros"><span class="id" title="definition">count_zeros</span></a> (<a class="idref" href="ConCert.Extraction.Optimize.html#param_mask"><span class="id" title="projection">param_mask</span></a> <span class="id" title="var">m</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="ConCert.Extraction.Optimize.html#masked"><span class="id" title="definition">masked</span></a> (<a class="idref" href="ConCert.Extraction.Optimize.html#param_mask"><span class="id" title="projection">param_mask</span></a> <span class="id" title="var">m</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#bc347c51eaf667706ae54503b26d52c6"><span class="id" title="notation">++</span></a> <a class="idref" href="ConCert.Extraction.Optimize.html#get_branch_mask"><span class="id" title="definition">get_branch_mask</span></a> <span class="id" title="var">m</span> <span class="id" title="var">ind</span> <span class="id" title="var">c</span>) (<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#map"><span class="id" title="definition">map</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#dearg"><span class="id" title="abbreviation">dearg</span></a> <span class="id" title="var">args</span>)))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="ConCert.Extraction.Optimize.html#masked"><span class="id" title="definition">masked</span></a> (<a class="idref" href="ConCert.Extraction.Optimize.html#get_branch_mask"><span class="id" title="definition">get_branch_mask</span></a> <span class="id" title="var">m</span> <span class="id" title="var">ind</span> <span class="id" title="var">c</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#skipn"><span class="id" title="definition">skipn</span></a> <span class="id" title="notation">#|</span><a class="idref" href="ConCert.Extraction.Optimize.html#param_mask"><span class="id" title="projection">param_mask</span></a> <span class="id" title="var">m</span><span class="id" title="notation">|</span> (<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#map"><span class="id" title="definition">map</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#dearg"><span class="id" title="abbreviation">dearg</span></a> <span class="id" title="var">args</span>))); <span class="id" title="var">cycle</span> 1.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">clear</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">generalize</span> (<a class="idref" href="ConCert.Extraction.Optimize.html#get_branch_mask"><span class="id" title="definition">get_branch_mask</span></a> <span class="id" title="var">m</span> <span class="id" title="var">ind</span> <span class="id" title="var">c</span>) <span class="id" title="keyword">as</span> <span class="id" title="var">m2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">generalize</span> (<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#map"><span class="id" title="definition">map</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#dearg"><span class="id" title="abbreviation">dearg</span></a> <span class="id" title="var">args</span>) <span class="id" title="keyword">as</span> <span class="id" title="var">ts</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">generalize</span> (<a class="idref" href="ConCert.Extraction.Optimize.html#param_mask"><span class="id" title="projection">param_mask</span></a> <span class="id" title="var">m</span>) <span class="id" title="keyword">as</span> <span class="id" title="var">m1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">m1</span> <span class="id" title="var">ts</span> <span class="id" title="var">m2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">m1</span> <span class="id" title="tactic">in</span> <span class="id" title="var">ts</span>, <span class="id" title="var">m2</span> |- *; <span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> !<span class="id" title="lemma">skipn_0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">destruct</span> <span class="id" title="var">a</span>; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">destruct</span> <span class="id" title="var">ts</span>; [<span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> !<span class="id" title="lemma">skipn_nil</span>, !<a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#masked_nil"><span class="id" title="lemma">masked_nil</span></a>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">skipn_S</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <span class="id" title="var">IHm1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">destruct</span> <span class="id" title="var">ts</span>; [<span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> !<span class="id" title="lemma">skipn_nil</span>, !<a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#masked_nil"><span class="id" title="lemma">masked_nil</span></a>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> !<span class="id" title="lemma">skipn_S</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <span class="id" title="var">IHm1</span>. }<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">valid_case_masks</span> <span class="id" title="tactic">in</span> <span class="id" title="var">valid_brs_masks</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">mm</span> <span class="id" title="tactic">in</span> <span class="id" title="var">valid_brs_masks</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">propify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">valid_brs_masks</span> <span class="id" title="keyword">as</span> (&lt;- &amp; <span class="id" title="var">valid_brs_masks</span>).<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#dearg_lambdas_correct"><span class="id" title="lemma">dearg_lambdas_correct</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- <span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#env_closed_dearg"><span class="id" title="lemma">env_closed_dearg</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- <span class="id" title="tactic">eapply</span> <span class="id" title="lemma">nth_error_forallb</span> <span class="id" title="tactic">in</span> <span class="id" title="var">clos_brs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">nth</span> <span class="id" title="tactic">in</span> <span class="id" title="var">clos_brs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#closedn_dearg_aux"><span class="id" title="lemma">closedn_dearg_aux</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- <span class="id" title="tactic">apply</span> <span class="id" title="lemma">Forall_skipn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="lemma">Forall_map</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <span class="id" title="lemma">Forall_impl</span>; [<span class="id" title="tactic">exact</span> <span class="id" title="var">clos_args</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span>; <span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#closedn_dearg_aux"><span class="id" title="lemma">closedn_dearg_aux</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- <span class="id" title="tactic">apply</span> <a class="idref" href="ConCert.Extraction.Utils.html#alli_Alli"><span class="id" title="lemma">alli_Alli</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">valid_brs_masks</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">unshelve</span> <span class="id" title="tactic">eapply</span> <span class="id" title="lemma">Alli_nth_error</span> <span class="id" title="tactic">in</span> <span class="id" title="var">valid_brs_masks</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;4: <span class="id" title="var">eassumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">p</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *; <span class="id" title="var">propify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#valid_dearg_mask_dearg_aux"><span class="id" title="lemma">valid_dearg_mask_dearg_aux</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- <span class="id" title="tactic">unfold</span> <span class="id" title="var">get_ctor_mask</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">mm</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#app_length"><span class="id" title="lemma">app_length</span></a> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="lemma">map_skipn</span>, <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#map_length"><span class="id" title="lemma">map_length</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">skipn_length</span> <span class="id" title="tactic">by</span> <span class="id" title="var">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- <span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="lemma">map_skipn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">unshelve</span> <span class="id" title="tactic">eapply</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#eval_mkApps_dearg"><span class="id" title="lemma">eval_mkApps_dearg</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;6: <span class="id" title="tactic">exact</span> <span class="id" title="var">IH</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">all</span>: <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;++ <span class="id" title="var">now</span> <span class="id" title="tactic">eapply</span> <span class="id" title="lemma">nth_error_forallb</span> <span class="id" title="tactic">in</span> <span class="id" title="var">clos_brs</span>; <span class="id" title="tactic">rewrite</span> <span class="id" title="var">nth</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;++ <span class="id" title="var">now</span> <span class="id" title="tactic">eapply</span> <span class="id" title="lemma">nth_error_forallb</span> <span class="id" title="tactic">in</span> <span class="id" title="var">valid_brs</span>; <span class="id" title="tactic">rewrite</span> <span class="id" title="var">nth</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;++ <span class="id" title="var">now</span> <span class="id" title="tactic">eapply</span> <span class="id" title="lemma">nth_error_forallb</span> <span class="id" title="tactic">in</span> <span class="id" title="var">exp_brs</span>; <span class="id" title="tactic">rewrite</span> <span class="id" title="var">nth</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;++ <span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <span class="id" title="lemma">Forall_skipn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;++ <span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <span class="id" title="lemma">Forall_skipn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;++ <span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <span class="id" title="lemma">Forall_skipn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;++ <span class="id" title="var">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">clear</span> <span class="id" title="var">IHev1</span> <span class="id" title="var">IHev2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;Singleton&nbsp;pattern&nbsp;match&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">subst</span> <span class="id" title="var">brs</span>; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *; <span class="id" title="var">propify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">set</span> (<span class="id" title="var">branch_mask</span> := <span class="id" title="keyword">match</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#get_mib_masks"><span class="id" title="abbreviation">get_mib_masks</span></a> (<span class="id" title="projection">inductive_mind</span> <span class="id" title="var">ind</span>) <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <span class="id" title="var">mm</span> =&gt; <a class="idref" href="ConCert.Extraction.Optimize.html#get_branch_mask"><span class="id" title="definition">get_branch_mask</span></a> <span class="id" title="var">mm</span> <span class="id" title="var">ind</span> 0<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a> =&gt; <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#ae9a5e1034e143b218b09d8e454472bd"><span class="id" title="notation">[]</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<span class="id" title="constructor">eval_iota_sing</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> (<span class="id" title="var">n</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Peano.html#7825ccc99f23b0d30c9d40c317ba7af0"><span class="id" title="notation">-</span></a> <a class="idref" href="ConCert.Extraction.Optimize.html#count_ones"><span class="id" title="definition">count_ones</span></a> <span class="id" title="var">branch_mask</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="ConCert.Extraction.Optimize.html#dearg_lambdas"><span class="id" title="definition">dearg_lambdas</span></a> <span class="id" title="var">branch_mask</span> (<a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#dearg"><span class="id" title="abbreviation">dearg</span></a> <span class="id" title="var">f</span>))).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="var">unshelve</span> <span class="id" title="tactic">eapply</span> (<span class="id" title="var">IH</span> <span class="id" title="var">_</span> <span class="id" title="constructor">tBox</span>); <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="tactic">rewrite</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#is_propositional_ind_trans_env_dearg_env"><span class="id" title="lemma">is_propositional_ind_trans_env_dearg_env</span></a>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="tactic">destruct</span> (<a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#get_mib_masks"><span class="id" title="abbreviation">get_mib_masks</span></a> <span class="id" title="var">_</span>); <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *; [<span class="id" title="var">easy</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#dearg_lambdas_nil"><span class="id" title="lemma">dearg_lambdas_nil</span></a>, <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Arith.PeanoNat.html#Nat.sub_0_r"><span class="id" title="lemma">Nat.sub_0_r</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="tactic">replace</span> (<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#repeat"><span class="id" title="definition">repeat</span></a> <span class="id" title="constructor">tBox</span> <span class="id" title="var">_</span>) <span class="id" title="keyword">with</span> (<a class="idref" href="ConCert.Extraction.Optimize.html#masked"><span class="id" title="definition">masked</span></a> <span class="id" title="var">branch_mask</span> (<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#repeat"><span class="id" title="definition">repeat</span></a> <span class="id" title="constructor">tBox</span> <span class="id" title="var">n</span>)); <span class="id" title="var">cycle</span> 1.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">unfold</span> <span class="id" title="var">valid_case_masks</span> <span class="id" title="tactic">in</span> <span class="id" title="var">valid_brs_masks</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#get_mib_masks"><span class="id" title="abbreviation">get_mib_masks</span></a> <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">clear</span> -<span class="id" title="var">valid_brs_masks</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *; <span class="id" title="var">propify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">valid_brs_masks</span> <span class="id" title="keyword">as</span> (<span class="id" title="var">_</span> &amp; (<span class="id" title="var">bound</span> &amp; <span class="id" title="var">_</span>) &amp; <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">change</span> (<a class="idref" href="ConCert.Extraction.Optimize.html#get_branch_mask"><span class="id" title="definition">get_branch_mask</span></a> <span class="id" title="var">m</span> <span class="id" title="var">ind</span> 0) <span class="id" title="keyword">with</span> <span class="id" title="var">branch_mask</span> <span class="id" title="tactic">in</span> <span class="id" title="var">bound</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">branch_mask</span> <span class="id" title="tactic">in</span> <span class="id" title="var">n</span>, <span class="id" title="var">bound</span> |- *; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Arith.PeanoNat.html#Nat.sub_0_r"><span class="id" title="lemma">Nat.sub_0_r</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">destruct</span> <span class="id" title="var">n</span>; [<span class="id" title="var">easy</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">a</span>; <span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <span class="id" title="var">IHbranch_mask</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="tactic">pose</span> <span class="id" title="var">proof</span> (<a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#filter_length"><span class="id" title="lemma">filter_length</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#id"><span class="id" title="definition">id</span></a> <span class="id" title="var">branch_mask</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Arith.PeanoNat.html#Nat.sub_succ_l"><span class="id" title="lemma">Nat.sub_succ_l</span></a> <span class="id" title="tactic">by</span> <span class="id" title="var">easy</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span>; <span class="id" title="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <span class="id" title="var">IHbranch_mask</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Arith.PeanoNat.html#Nat.sub_0_r"><span class="id" title="lemma">Nat.sub_0_r</span></a>. }<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#dearg_lambdas_correct"><span class="id" title="lemma">dearg_lambdas_correct</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- <span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#env_closed_dearg"><span class="id" title="lemma">env_closed_dearg</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- <span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#closedn_dearg_aux"><span class="id" title="lemma">closedn_dearg_aux</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- <span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <a class="idref" href="ConCert.Extraction.Utils.html#Forall_repeat"><span class="id" title="lemma">Forall_repeat</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- <span class="id" title="tactic">apply</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#valid_dearg_mask_dearg_aux"><span class="id" title="lemma">valid_dearg_mask_dearg_aux</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">valid_case_masks</span> <span class="id" title="tactic">in</span> <span class="id" title="var">valid_brs_masks</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#get_mib_masks"><span class="id" title="abbreviation">get_mib_masks</span></a> <span class="id" title="var">_</span>); <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *; <span class="id" title="var">propify</span>; [<span class="id" title="var">easy</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#valid_dearg_mask_nil"><span class="id" title="lemma">valid_dearg_mask_nil</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- <span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#repeat_length"><span class="id" title="lemma">repeat_length</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">valid_case_masks</span> <span class="id" title="tactic">in</span> <span class="id" title="var">valid_brs_masks</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#get_mib_masks"><span class="id" title="abbreviation">get_mib_masks</span></a> <span class="id" title="var">_</span>); <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *; [|<span class="id" title="var">easy</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="var">propify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- <span class="id" title="tactic">change</span> <span class="id" title="constructor">tBox</span> <span class="id" title="keyword">with</span> (<a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#dearg"><span class="id" title="abbreviation">dearg</span></a> <span class="id" title="constructor">tBox</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#map_repeat"><span class="id" title="lemma">map_repeat</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">unshelve</span> <span class="id" title="tactic">eapply</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#eval_mkApps_dearg"><span class="id" title="lemma">eval_mkApps_dearg</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;6: <span class="id" title="tactic">exact</span> <span class="id" title="var">IH</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">all</span>: <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;++ <span class="id" title="var">easy</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;++ <span class="id" title="var">easy</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;++ <span class="id" title="var">easy</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;++ <span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <a class="idref" href="ConCert.Extraction.Utils.html#Forall_repeat"><span class="id" title="lemma">Forall_repeat</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;++ <span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <a class="idref" href="ConCert.Extraction.Utils.html#Forall_repeat"><span class="id" title="lemma">Forall_repeat</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;++ <span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <a class="idref" href="ConCert.Extraction.Utils.html#Forall_repeat"><span class="id" title="lemma">Forall_repeat</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;++ <span class="id" title="var">lia</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="comment">(*&nbsp;Unfold&nbsp;cofix&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">clear</span> <span class="id" title="var">clos_args</span> <span class="id" title="var">valid_args</span> <span class="id" title="var">exp_args</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="ConCert.Extraction.ClosedAux.html#closed_mkApps_inv"><span class="id" title="lemma">closed_mkApps_inv</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">clos_discr</span> <span class="id" title="keyword">as</span> (<span class="id" title="var">clos_hd</span> &amp; <span class="id" title="var">clos_args</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#valid_cases_mkApps_inv"><span class="id" title="lemma">valid_cases_mkApps_inv</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">valid_discr</span> <span class="id" title="keyword">as</span> (<span class="id" title="var">valid_hd</span> &amp; <span class="id" title="var">valid_args</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#is_expanded_aux_mkApps_inv"><span class="id" title="lemma">is_expanded_aux_mkApps_inv</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">exp_discr</span> <span class="id" title="keyword">as</span> (<span class="id" title="var">exp_hd</span> &amp; <span class="id" title="var">exp_args</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *; <span class="id" title="var">propify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#dearg_mkApps"><span class="id" title="lemma">dearg_mkApps</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<span class="id" title="constructor">red_cofix_case</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">narg</span> (<a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#dearg"><span class="id" title="abbreviation">dearg</span></a> <span class="id" title="var">fn</span>)); [<span class="id" title="var">now</span> <span class="id" title="tactic">eapply</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#dearg_cunfold_cofix"><span class="id" title="lemma">dearg_cunfold_cofix</span></a>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="abbreviation">closed</span> <span class="id" title="var">fn</span>) <span class="id" title="tactic">by</span> <span class="id" title="var">now</span> <span class="id" title="tactic">eapply</span> <a class="idref" href="ConCert.Extraction.WcbvEvalAux.html#closed_cunfold_cofix"><span class="id" title="lemma">closed_cunfold_cofix</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#valid_cases"><span class="id" title="abbreviation">valid_cases</span></a> <span class="id" title="var">fn</span>) <span class="id" title="tactic">by</span> <span class="id" title="var">now</span> <span class="id" title="tactic">eapply</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#valid_cases_cunfold_cofix"><span class="id" title="lemma">valid_cases_cunfold_cofix</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#is_expanded"><span class="id" title="abbreviation">is_expanded</span></a> <span class="id" title="var">fn</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">eapply</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#is_expanded_cunfold_cofix"><span class="id" title="lemma">is_expanded_cunfold_cofix</span></a>; [<span class="id" title="var">eassumption</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <span class="id" title="lemma">forallb_Forall</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#dearg_expanded"><span class="id" title="lemma">dearg_expanded</span></a>, &lt;- <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#dearg_mkApps"><span class="id" title="lemma">dearg_mkApps</span></a> <span class="id" title="tactic">by</span> <span class="id" title="var">easy</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">unshelve</span> <span class="id" title="tactic">eapply</span> (<span class="id" title="var">IHev</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">n</span> <span class="id" title="var">IH</span> <span class="id" title="var">ev</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">all</span>: <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <a class="idref" href="ConCert.Extraction.ClosedAux.html#closed_mkApps"><span class="id" title="lemma">closed_mkApps</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#valid_cases_mkApps"><span class="id" title="lemma">valid_cases_mkApps</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="tactic">apply</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#is_expanded_aux_mkApps"><span class="id" title="lemma">is_expanded_aux_mkApps</span></a>; [|<span class="id" title="var">easy</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">eapply</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#is_expanded_aux_upwards"><span class="id" title="lemma">is_expanded_aux_upwards</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="var">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">congruence</span>.<br/>

<br/>
&nbsp;&nbsp;- <span class="id" title="var">facts</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="ConCert.Extraction.ClosedAux.html#closed_mkApps_inv"><span class="id" title="lemma">closed_mkApps_inv</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">clos_t</span> <span class="id" title="keyword">as</span> (<span class="id" title="var">clos_hd</span> &amp; <span class="id" title="var">clos_args</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#valid_cases_mkApps_inv"><span class="id" title="lemma">valid_cases_mkApps_inv</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">valid_t</span> <span class="id" title="keyword">as</span> (<span class="id" title="var">valid_hd</span> &amp; <span class="id" title="var">valid_args</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#is_expanded_aux_mkApps_inv"><span class="id" title="lemma">is_expanded_aux_mkApps_inv</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">exp_t</span> <span class="id" title="keyword">as</span> (<span class="id" title="var">exp_hd</span> &amp; <span class="id" title="var">exp_args</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> * |-.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">unshelve</span> <span class="id" title="tactic">eapply</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#eval_mkApps_dearg_reduce"><span class="id" title="lemma">eval_mkApps_dearg_reduce</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;6: <span class="id" title="tactic">exact</span> <span class="id" title="var">IH</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">all</span>: <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> -&gt;.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *; <span class="id" title="var">refold'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">clear</span> <span class="id" title="var">clos_args</span> <span class="id" title="var">valid_args</span> <span class="id" title="var">exp_args</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">depind</span> <span class="id" title="var">ev</span>; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="comment">(*&nbsp;Cofix&nbsp;projection&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">propify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">valid_hd</span> <span class="id" title="keyword">as</span> (<span class="id" title="var">valid_hd</span> &amp; <span class="id" title="var">valid_proj</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="ConCert.Extraction.ClosedAux.html#closed_mkApps_inv"><span class="id" title="lemma">closed_mkApps_inv</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">clos_hd</span> <span class="id" title="keyword">as</span> (<span class="id" title="var">clos_hd</span> &amp; <span class="id" title="var">clos_args</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#valid_cases_mkApps_inv"><span class="id" title="lemma">valid_cases_mkApps_inv</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">valid_hd</span> <span class="id" title="keyword">as</span> (<span class="id" title="var">valid_hd</span> &amp; <span class="id" title="var">valid_args</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#is_expanded_aux_mkApps_inv"><span class="id" title="lemma">is_expanded_aux_mkApps_inv</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">exp_hd</span> <span class="id" title="keyword">as</span> (<span class="id" title="var">exp_hd</span> &amp; <span class="id" title="var">exp_args</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *; <span class="id" title="var">propify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#dearg_mkApps"><span class="id" title="lemma">dearg_mkApps</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">dearg_proj</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<span class="id" title="constructor">red_cofix_proj</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">narg</span> (<a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#dearg"><span class="id" title="abbreviation">dearg</span></a> <span class="id" title="var">fn</span>)); [<span class="id" title="var">now</span> <span class="id" title="tactic">eapply</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#dearg_cunfold_cofix"><span class="id" title="lemma">dearg_cunfold_cofix</span></a>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="abbreviation">closed</span> <span class="id" title="var">fn</span>) <span class="id" title="tactic">by</span> <span class="id" title="var">now</span> <span class="id" title="tactic">eapply</span> <a class="idref" href="ConCert.Extraction.WcbvEvalAux.html#closed_cunfold_cofix"><span class="id" title="lemma">closed_cunfold_cofix</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#valid_cases"><span class="id" title="abbreviation">valid_cases</span></a> <span class="id" title="var">fn</span>) <span class="id" title="tactic">by</span> <span class="id" title="var">now</span> <span class="id" title="tactic">eapply</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#valid_cases_cunfold_cofix"><span class="id" title="lemma">valid_cases_cunfold_cofix</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#is_expanded"><span class="id" title="abbreviation">is_expanded</span></a> <span class="id" title="var">fn</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">eapply</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#is_expanded_cunfold_cofix"><span class="id" title="lemma">is_expanded_cunfold_cofix</span></a>; [<span class="id" title="var">eassumption</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <span class="id" title="lemma">forallb_Forall</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#dearg_expanded"><span class="id" title="lemma">dearg_expanded</span></a>, &lt;- <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#dearg_mkApps"><span class="id" title="lemma">dearg_mkApps</span></a> <span class="id" title="tactic">by</span> <span class="id" title="var">easy</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">unshelve</span> <span class="id" title="tactic">eapply</span> <span class="id" title="var">IHev</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;8: <span class="id" title="tactic">exact</span> <span class="id" title="var">IH</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">all</span>: <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <a class="idref" href="ConCert.Extraction.ClosedAux.html#closed_mkApps"><span class="id" title="lemma">closed_mkApps</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="var">propify</span>; <span class="id" title="tactic">split</span>; [|<span class="id" title="var">easy</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#valid_cases_mkApps"><span class="id" title="lemma">valid_cases_mkApps</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="tactic">apply</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#is_expanded_aux_mkApps"><span class="id" title="lemma">is_expanded_aux_mkApps</span></a>; [|<span class="id" title="var">easy</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">eapply</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#is_expanded_aux_upwards"><span class="id" title="lemma">is_expanded_aux_upwards</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="var">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="comment">(*&nbsp;Regular&nbsp;projection&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">clear</span> <span class="id" title="var">IHev1</span> <span class="id" title="var">IHev2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">propify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">valid_hd</span> <span class="id" title="keyword">as</span> (<span class="id" title="var">valid_hd</span> &amp; <span class="id" title="var">valid_p</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">facts</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="ConCert.Extraction.ClosedAux.html#closed_mkApps_inv"><span class="id" title="lemma">closed_mkApps_inv</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">H2</span> <span class="id" title="keyword">as</span> (<span class="id" title="var">clos_constr</span> &amp; <span class="id" title="var">clos_args</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#valid_cases_mkApps_inv"><span class="id" title="lemma">valid_cases_mkApps_inv</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">H3</span> <span class="id" title="keyword">as</span> (<span class="id" title="var">valid_constr</span> &amp; <span class="id" title="var">valid_args</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#is_expanded_aux_mkApps_inv"><span class="id" title="lemma">is_expanded_aux_mkApps_inv</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">H4</span> <span class="id" title="keyword">as</span> (<span class="id" title="var">exp_constr</span> &amp; <span class="id" title="var">exp_args</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *; <span class="id" title="var">propify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">dearg_proj</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<span class="id" title="constructor">eval_proj</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> (<a class="idref" href="ConCert.Extraction.Optimize.html#masked"><span class="id" title="definition">masked</span></a> (<a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#get_ctor_mask"><span class="id" title="abbreviation">get_ctor_mask</span></a> <span class="id" title="var">i</span> 0) (<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#map"><span class="id" title="definition">map</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#dearg"><span class="id" title="abbreviation">dearg</span></a> <span class="id" title="var">args</span>))).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="var">unshelve</span> <span class="id" title="var">epose</span> <span class="id" title="var">proof</span> (<span class="id" title="var">IH</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">ev1</span> <span class="id" title="var">_</span>); <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1: <span class="id" title="var">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#dearg_mkApps"><span class="id" title="lemma">dearg_mkApps</span></a> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#dearg_single_masked"><span class="id" title="lemma">dearg_single_masked</span></a> <span class="id" title="tactic">in</span> * <span class="id" title="tactic">by</span> (<span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#map_length"><span class="id" title="lemma">map_length</span></a>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="tactic">rewrite</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#is_propositional_ind_trans_env_dearg_env"><span class="id" title="lemma">is_propositional_ind_trans_env_dearg_env</span></a>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="tactic">clear</span> <span class="id" title="var">clos_constr</span> <span class="id" title="var">valid_constr</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">get_ctor_mask</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">revert</span> <span class="id" title="var">ev2</span> <span class="id" title="var">deriv_len</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> !<span class="id" title="lemma">nth_nth_error</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#get_mib_masks"><span class="id" title="abbreviation">get_mib_masks</span></a> <span class="id" title="var">_</span>) <span class="id" title="var">eqn</span>:<span class="id" title="var">mm</span>; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *; <span class="id" title="var">cycle</span> 1.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">nth_error_map</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#nth_error"><span class="id" title="definition">nth_error</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span>) <span class="id" title="var">eqn</span>:<span class="id" title="var">nth</span>; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *; [|<span class="id" title="var">now</span> <span class="id" title="var">depelim</span> <span class="id" title="var">ev2</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">unshelve</span> <span class="id" title="tactic">eapply</span> (<span class="id" title="var">IH</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">ev2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="var">now</span> <span class="id" title="tactic">eapply</span> <span class="id" title="lemma">nth_error_forall</span> <span class="id" title="tactic">in</span> <span class="id" title="var">clos_args</span>; [|<span class="id" title="var">eassumption</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="var">now</span> <span class="id" title="tactic">eapply</span> <span class="id" title="lemma">nth_error_forall</span> <span class="id" title="tactic">in</span> <span class="id" title="var">valid_args</span>; [|<span class="id" title="var">eassumption</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="var">now</span> <span class="id" title="tactic">eapply</span> <span class="id" title="lemma">nth_error_forall</span> <span class="id" title="tactic">in</span> <span class="id" title="var">exp_args</span>; [|<span class="id" title="var">eassumption</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="var">lia</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#nth_error"><span class="id" title="definition">nth_error</span></a> <span class="id" title="var">args</span> <span class="id" title="var">_</span>) <span class="id" title="var">eqn</span>:<span class="id" title="var">nth</span>; [|<span class="id" title="var">now</span> <span class="id" title="var">depelim</span> <span class="id" title="var">ev2</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#app_length"><span class="id" title="lemma">app_length</span></a> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">valid_proj</span> <span class="id" title="tactic">in</span> <span class="id" title="var">valid_p</span>; <span class="id" title="tactic">rewrite</span> <span class="id" title="var">mm</span> <span class="id" title="tactic">in</span> <span class="id" title="var">valid_p</span>; <span class="id" title="var">propify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">valid_p</span> <span class="id" title="keyword">as</span> (&lt;- &amp; <span class="id" title="var">arg_unused</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#masked_map"><span class="id" title="lemma">masked_map</span></a>, <span class="id" title="lemma">nth_error_map</span>, <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#masked_app"><span class="id" title="lemma">masked_app</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#nth_error_app2"><span class="id" title="lemma">nth_error_app2</span></a>; <span class="id" title="var">cycle</span> 1.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#firstn_length"><span class="id" title="lemma">firstn_length</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">lia</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#firstn_length"><span class="id" title="lemma">firstn_length</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Arith.PeanoNat.html#Nat.min_l"><span class="id" title="lemma">Nat.min_l</span></a>; <span class="id" title="var">cycle</span> 1.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">rewrite</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#masked_length"><span class="id" title="lemma">masked_length</span></a> <span class="id" title="tactic">by</span> <span class="id" title="var">easy</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">lia</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">replace</span> (<a class="idref" href="ConCert.Extraction.Optimize.html#count_zeros"><span class="id" title="definition">count_zeros</span></a> (<a class="idref" href="ConCert.Extraction.Optimize.html#param_mask"><span class="id" title="projection">param_mask</span></a> <span class="id" title="var">m</span>) <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Peano.html#0dacc1786c5ba797d47dd85006231633"><span class="id" title="notation">+</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Peano.html#0dacc1786c5ba797d47dd85006231633"><span class="id" title="notation">(</span></a><span class="id" title="var">arg</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Peano.html#7825ccc99f23b0d30c9d40c317ba7af0"><span class="id" title="notation">-</span></a> <a class="idref" href="ConCert.Extraction.Optimize.html#count_ones"><span class="id" title="definition">count_ones</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#firstn"><span class="id" title="definition">firstn</span></a> <span class="id" title="var">arg</span> (<a class="idref" href="ConCert.Extraction.Optimize.html#get_branch_mask"><span class="id" title="definition">get_branch_mask</span></a> <span class="id" title="var">m</span> <span class="id" title="var">i</span> 0))<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Peano.html#0dacc1786c5ba797d47dd85006231633"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Peano.html#7825ccc99f23b0d30c9d40c317ba7af0"><span class="id" title="notation">-</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Extraction.Optimize.html#count_zeros"><span class="id" title="definition">count_zeros</span></a> (<a class="idref" href="ConCert.Extraction.Optimize.html#param_mask"><span class="id" title="projection">param_mask</span></a> <span class="id" title="var">m</span>)) <span class="id" title="keyword">with</span> (<span class="id" title="var">arg</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Peano.html#7825ccc99f23b0d30c9d40c317ba7af0"><span class="id" title="notation">-</span></a> <a class="idref" href="ConCert.Extraction.Optimize.html#count_ones"><span class="id" title="definition">count_ones</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#firstn"><span class="id" title="definition">firstn</span></a> <span class="id" title="var">arg</span> (<a class="idref" href="ConCert.Extraction.Optimize.html#get_branch_mask"><span class="id" title="definition">get_branch_mask</span></a> <span class="id" title="var">m</span> <span class="id" title="var">i</span> 0)))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="var">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#nth_error_masked"><span class="id" title="lemma">nth_error_masked</span></a> <span class="id" title="tactic">by</span> <span class="id" title="var">easy</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">nth_error_skipn</span>, <span class="id" title="var">nth</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">unshelve</span> <span class="id" title="tactic">eapply</span> (<span class="id" title="var">IH</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">ev2</span> <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- <span class="id" title="var">now</span> <span class="id" title="tactic">eapply</span> <span class="id" title="lemma">nth_error_forall</span> <span class="id" title="tactic">in</span> <span class="id" title="var">clos_args</span>; [|<span class="id" title="var">eassumption</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- <span class="id" title="var">now</span> <span class="id" title="tactic">eapply</span> <span class="id" title="lemma">nth_error_forall</span> <span class="id" title="tactic">in</span> <span class="id" title="var">valid_args</span>; [|<span class="id" title="var">eassumption</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- <span class="id" title="var">now</span> <span class="id" title="tactic">eapply</span> <span class="id" title="lemma">nth_error_forall</span> <span class="id" title="tactic">in</span> <span class="id" title="var">exp_args</span>; [|<span class="id" title="var">eassumption</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- <span class="id" title="var">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="comment">(*&nbsp;Project&nbsp;out&nbsp;of&nbsp;box&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">clear</span> <span class="id" title="var">IHev</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">propify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">valid_hd</span> <span class="id" title="keyword">as</span> (<span class="id" title="var">valid_hd</span> &amp; <span class="id" title="var">valid_p</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">dearg_proj</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="constructor">eval_proj_prop</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="var">unshelve</span> <span class="id" title="tactic">eapply</span> (<span class="id" title="var">IH</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">ev</span> <span class="id" title="var">_</span>); <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="tactic">rewrite</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#is_propositional_ind_trans_env_dearg_env"><span class="id" title="lemma">is_propositional_ind_trans_env_dearg_env</span></a>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">congruence</span>.<br/>

<br/>
&nbsp;&nbsp;- <span class="id" title="var">facts</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="ConCert.Extraction.ClosedAux.html#closed_mkApps_inv"><span class="id" title="lemma">closed_mkApps_inv</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">clos_t</span> <span class="id" title="keyword">as</span> (<span class="id" title="var">clos_t</span> &amp; <span class="id" title="var">clos_args</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#valid_cases_mkApps_inv"><span class="id" title="lemma">valid_cases_mkApps_inv</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">valid_t</span> <span class="id" title="keyword">as</span> (<span class="id" title="var">valid_t</span> &amp; <span class="id" title="var">valid_args</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#is_expanded_aux_mkApps_inv"><span class="id" title="lemma">is_expanded_aux_mkApps_inv</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">exp_t</span> <span class="id" title="keyword">as</span> (<span class="id" title="var">exp_t</span> &amp; <span class="id" title="var">exp_args</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">unshelve</span> <span class="id" title="tactic">eapply</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#eval_mkApps_dearg_reduce"><span class="id" title="lemma">eval_mkApps_dearg_reduce</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;6: <span class="id" title="tactic">exact</span> <span class="id" title="var">IH</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">all</span>: <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;1: <span class="id" title="var">now</span> <span class="id" title="tactic">destruct</span> <span class="id" title="var">hd</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> -&gt;.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">depelim</span> <span class="id" title="var">ev</span>; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *; <span class="id" title="var">propify</span>; <span class="id" title="tactic">try</span> <span class="id" title="tactic">destruct</span> <span class="id" title="var">y</span>; <span class="id" title="var">refold'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">intuition</span> <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">facts</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">econstructor</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="var">now</span> <span class="id" title="var">unshelve</span> <span class="id" title="tactic">eapply</span> (<span class="id" title="var">IH</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">ev1</span> <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="var">revert</span> <span class="id" title="var">ev2</span> <span class="id" title="var">deriv_len</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> !<span class="id" title="lemma">closed_subst</span> <span class="id" title="tactic">by</span> (<span class="id" title="tactic">auto</span>; <span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#closedn_dearg_aux"><span class="id" title="lemma">closedn_dearg_aux</span></a>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">change</span> (<span class="id" title="abbreviation">subst0</span> ?<span class="id" title="var">a</span> ?<span class="id" title="var">t</span>) <span class="id" title="keyword">with</span> (<span class="id" title="abbreviation">subst0</span> (<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#map"><span class="id" title="definition">map</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#dearg"><span class="id" title="abbreviation">dearg</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#ddd65c2f7ee73ecec433744948d846bb"><span class="id" title="notation">[</span></a><span class="id" title="var">b0'</span><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#ddd65c2f7ee73ecec433744948d846bb"><span class="id" title="notation">]</span></a>) <span class="id" title="var">t</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#dearg_subst"><span class="id" title="lemma">dearg_subst</span></a> <span class="id" title="tactic">by</span> <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">unshelve</span> <span class="id" title="tactic">eapply</span> (<span class="id" title="var">IH</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">ev2</span> <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- <span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <a class="idref" href="ConCert.Extraction.ClosedAux.html#closedn_subst0"><span class="id" title="lemma">closedn_subst0</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- <span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#valid_cases_subst"><span class="id" title="lemma">valid_cases_subst</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- <span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#is_expanded_aux_subst"><span class="id" title="lemma">is_expanded_aux_subst</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- <span class="id" title="var">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">destruct</span> <span class="id" title="var">t</span>; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *; <span class="id" title="tactic">try</span> <span class="id" title="tactic">destruct</span> <span class="id" title="var">y</span>; <span class="id" title="tactic">try</span> <span class="id" title="tactic">congruence</span>; <span class="id" title="var">now</span> <span class="id" title="tactic">constructor</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>
<span class="id" title="keyword">End</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#dearg_correct"><span class="id" title="section">dearg_correct</span></a>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a name="lookup_env_debox_env_types"><span class="id" title="lemma">lookup_env_debox_env_types</span></a> <span class="id" title="var">Σ</span> <span class="id" title="var">kn</span> :<br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Extraction.ExAst.html#lookup_env"><span class="id" title="definition">lookup_env</span></a> (<a class="idref" href="ConCert.Extraction.Optimize.html#debox_env_types"><span class="id" title="definition">debox_env_types</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#e15c0eb40e61adefe95778c26e7840f6"><span class="id" title="variable">Σ</span></a>) <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#kn"><span class="id" title="variable">kn</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#option_map"><span class="id" title="definition">option_map</span></a> (<a class="idref" href="ConCert.Extraction.Optimize.html#debox_type_decl"><span class="id" title="definition">debox_type_decl</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#e15c0eb40e61adefe95778c26e7840f6"><span class="id" title="variable">Σ</span></a>) (<a class="idref" href="ConCert.Extraction.ExAst.html#lookup_env"><span class="id" title="definition">lookup_env</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#e15c0eb40e61adefe95778c26e7840f6"><span class="id" title="variable">Σ</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#kn"><span class="id" title="variable">kn</span></a>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="ConCert.Extraction.Optimize.html#debox_env_types"><span class="id" title="definition">debox_env_types</span></a>, <a class="idref" href="ConCert.Extraction.ExAst.html#lookup_env"><span class="id" title="definition">lookup_env</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">generalize</span> <span class="id" title="var">Σ</span> <span class="id" title="tactic">at</span> 1 3.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">masks</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">Σ</span> <span class="id" title="keyword">as</span> [|((<span class="id" title="var">kn'</span>, <span class="id" title="var">has_deps</span>), <span class="id" title="var">decl</span>) <span class="id" title="var">Σ</span> <span class="id" title="var">IH</span>]; [<span class="id" title="var">easy</span>|].<br/>
&nbsp;&nbsp;<span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="definition">eq_kername</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="definition">kername_eq_dec</span> <span class="id" title="keyword">as</span> [-&gt;|]; [<span class="id" title="var">easy</span>|].<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">IH</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a name="is_propositional_ind_trans_env_debox_env_types"><span class="id" title="lemma">is_propositional_ind_trans_env_debox_env_types</span></a> <span class="id" title="var">Σ</span> <span class="id" title="var">ind</span> :<br/>
&nbsp;&nbsp;<span class="id" title="definition">is_propositional_ind</span> (<a class="idref" href="ConCert.Extraction.ExAst.html#trans_env"><span class="id" title="definition">trans_env</span></a> (<a class="idref" href="ConCert.Extraction.Optimize.html#debox_env_types"><span class="id" title="definition">debox_env_types</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#e15c0eb40e61adefe95778c26e7840f6"><span class="id" title="variable">Σ</span></a>)) <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#ind"><span class="id" title="variable">ind</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a><br/>
&nbsp;&nbsp;<span class="id" title="definition">is_propositional_ind</span> (<a class="idref" href="ConCert.Extraction.ExAst.html#trans_env"><span class="id" title="definition">trans_env</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#e15c0eb40e61adefe95778c26e7840f6"><span class="id" title="variable">Σ</span></a>) <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#ind"><span class="id" title="variable">ind</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="definition">is_propositional_ind</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> !<a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#lookup_env_trans_env"><span class="id" title="lemma">lookup_env_trans_env</span></a>, <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#lookup_env_debox_env_types"><span class="id" title="lemma">lookup_env_debox_env_types</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <a class="idref" href="ConCert.Extraction.ExAst.html#lookup_env"><span class="id" title="definition">lookup_env</span></a>; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *; [|<span class="id" title="tactic">reflexivity</span>].<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">g</span>; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *;<span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;* <span class="id" title="tactic">rewrite</span> !<span class="id" title="lemma">nth_error_map</span>. <span class="id" title="var">now</span> <span class="id" title="tactic">destruct</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#nth_error"><span class="id" title="definition">nth_error</span></a>.<br/>
&nbsp;&nbsp;* <span class="id" title="tactic">destruct</span> <span class="id" title="var">o</span>;<span class="id" title="tactic">auto</span>. <span class="id" title="var">now</span> <span class="id" title="tactic">destruct</span> <span class="id" title="var">p</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a name="eval_debox_env_types"><span class="id" title="lemma">eval_debox_env_types</span></a> {<span class="id" title="var">wfl</span>:<span class="id" title="class">WcbvFlags</span>} <span class="id" title="var">Σ</span> <span class="id" title="var">t</span> <span class="id" title="var">v</span> :<br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Extraction.ExAst.html#trans_env"><span class="id" title="definition">trans_env</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#e15c0eb40e61adefe95778c26e7840f6"><span class="id" title="variable">Σ</span></a> <a class="idref" href="ConCert.Extraction.WcbvEvalAux.html#e49f44d96100960446bedaca1e4a4428"><span class="id" title="notation">e</span></a><a class="idref" href="ConCert.Extraction.WcbvEvalAux.html#e49f44d96100960446bedaca1e4a4428"><span class="id" title="notation">⊢</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#t"><span class="id" title="variable">t</span></a> <a class="idref" href="ConCert.Extraction.WcbvEvalAux.html#e49f44d96100960446bedaca1e4a4428"><span class="id" title="notation">▷</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#v"><span class="id" title="variable">v</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Extraction.ExAst.html#trans_env"><span class="id" title="definition">trans_env</span></a> (<a class="idref" href="ConCert.Extraction.Optimize.html#debox_env_types"><span class="id" title="definition">debox_env_types</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#e15c0eb40e61adefe95778c26e7840f6"><span class="id" title="variable">Σ</span></a>) <a class="idref" href="ConCert.Extraction.WcbvEvalAux.html#e49f44d96100960446bedaca1e4a4428"><span class="id" title="notation">e</span></a><a class="idref" href="ConCert.Extraction.WcbvEvalAux.html#e49f44d96100960446bedaca1e4a4428"><span class="id" title="notation">⊢</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#t"><span class="id" title="variable">t</span></a> <a class="idref" href="ConCert.Extraction.WcbvEvalAux.html#e49f44d96100960446bedaca1e4a4428"><span class="id" title="notation">▷</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#v"><span class="id" title="variable">v</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> 1; <span class="id" title="tactic">try</span> <span class="id" title="tactic">solve</span> [<span class="id" title="tactic">econstructor</span>; <span class="id" title="tactic">eauto</span>].<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">eapply</span> <span class="id" title="constructor">eval_iota</span>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#is_propositional_ind_trans_env_debox_env_types"><span class="id" title="lemma">is_propositional_ind_trans_env_debox_env_types</span></a>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">eapply</span> <span class="id" title="constructor">eval_iota_sing</span>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#is_propositional_ind_trans_env_debox_env_types"><span class="id" title="lemma">is_propositional_ind_trans_env_debox_env_types</span></a>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">eapply</span> <span class="id" title="constructor">eval_delta</span>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="definition">declared_constant</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> !<a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#lookup_env_trans_env"><span class="id" title="lemma">lookup_env_trans_env</span></a>, <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#lookup_env_debox_env_types"><span class="id" title="lemma">lookup_env_debox_env_types</span></a> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <a class="idref" href="ConCert.Extraction.ExAst.html#lookup_env"><span class="id" title="definition">lookup_env</span></a>; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *; [|<span class="id" title="tactic">congruence</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">g</span>; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *;<span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="tactic">destruct</span> <span class="id" title="var">o</span>;<span class="id" title="tactic">auto</span>. <span class="id" title="var">now</span> <span class="id" title="tactic">destruct</span> <span class="id" title="var">p</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">eapply</span> <span class="id" title="constructor">eval_proj</span>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#is_propositional_ind_trans_env_debox_env_types"><span class="id" title="lemma">is_propositional_ind_trans_env_debox_env_types</span></a>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">eapply</span> <span class="id" title="constructor">eval_proj_prop</span>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#is_propositional_ind_trans_env_debox_env_types"><span class="id" title="lemma">is_propositional_ind_trans_env_debox_env_types</span></a>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a name="eval_const_construct_expanded"><span class="id" title="lemma">eval_const_construct_expanded</span></a> {<span class="id" title="var">wfl</span>:<span class="id" title="class">WcbvFlags</span>} <span class="id" title="var">Σ</span> <span class="id" title="var">kn</span> <span class="id" title="var">ind</span> <span class="id" title="var">c</span> <span class="id" title="var">im</span> <span class="id" title="var">cm</span> :<br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Extraction.ExAst.html#trans_env"><span class="id" title="definition">trans_env</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#e15c0eb40e61adefe95778c26e7840f6"><span class="id" title="variable">Σ</span></a> <a class="idref" href="ConCert.Extraction.WcbvEvalAux.html#e49f44d96100960446bedaca1e4a4428"><span class="id" title="notation">e</span></a><a class="idref" href="ConCert.Extraction.WcbvEvalAux.html#e49f44d96100960446bedaca1e4a4428"><span class="id" title="notation">⊢</span></a> <span class="id" title="constructor">tConst</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#kn"><span class="id" title="variable">kn</span></a> <a class="idref" href="ConCert.Extraction.WcbvEvalAux.html#e49f44d96100960446bedaca1e4a4428"><span class="id" title="notation">▷</span></a> <span class="id" title="constructor">tConstruct</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#ind"><span class="id" title="variable">ind</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#c"><span class="id" title="variable">c</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Extraction.Optimize.html#valid_masks_env"><span class="id" title="definition">valid_masks_env</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#im"><span class="id" title="variable">im</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#cm"><span class="id" title="variable">cm</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#e15c0eb40e61adefe95778c26e7840f6"><span class="id" title="variable">Σ</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Extraction.Optimize.html#is_expanded"><span class="id" title="definition">is_expanded</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#im"><span class="id" title="variable">im</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#cm"><span class="id" title="variable">cm</span></a> (<span class="id" title="constructor">tConst</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#kn"><span class="id" title="variable">kn</span></a>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">ev</span> <span class="id" title="var">valid</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">depelim</span> <span class="id" title="var">ev</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#valid_dearg_mask_constant"><span class="id" title="lemma">valid_dearg_mask_constant</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">valid</span>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#valid_dearg_mask_spec"><span class="id" title="lemma">valid_dearg_mask_spec</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">valid</span> <span class="id" title="keyword">as</span> (<span class="id" title="var">Γ</span> &amp; <span class="id" title="var">inner</span> &amp; &lt;- &amp; &lt;-).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">clear</span> -<span class="id" title="var">ev</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="notation">#|</span><span class="id" title="var">Γ</span><span class="id" title="notation">|</span> <span class="id" title="keyword">as</span> [|<span class="id" title="var">Γlen</span> <span class="id" title="var">IH</span>] <span class="id" title="var">eqn</span>:<span class="id" title="var">eq</span> <span class="id" title="tactic">in</span> <span class="id" title="var">Γ</span>, <span class="id" title="var">inner</span>, <span class="id" title="var">ev</span> |- *.<br/>
&nbsp;&nbsp;- <span class="id" title="var">now</span> <span class="id" title="tactic">destruct</span> <span class="id" title="var">Γ</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">destruct</span> <span class="id" title="var">Γ</span> <span class="id" title="keyword">as</span> [|[<span class="id" title="var">na</span> [<span class="id" title="var">body</span>|]] <span class="id" title="var">Γ</span>]; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">easy</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">depelim</span> <span class="id" title="var">ev</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">refold</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#subst_it_mkLambda_or_LetIn"><span class="id" title="lemma">subst_it_mkLambda_or_LetIn</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">ev2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">erewrite</span> &lt;- <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#vasses_subst_context"><span class="id" title="lemma">vasses_subst_context</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <span class="id" title="var">IH</span>; [<span class="id" title="var">eassumption</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#length_subst_context"><span class="id" title="lemma">length_subst_context</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">depelim</span> <span class="id" title="var">ev</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a name="dearg_transform_correct"><span class="id" title="lemma">dearg_transform_correct</span></a> <span class="id" title="var">overridden_masks</span> <span class="id" title="var">do_trim_const_masks</span> <span class="id" title="var">do_trim_ctor_masks</span> :<br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Extraction.Transform.html#ExtractTransformCorrect"><span class="id" title="definition">ExtractTransformCorrect</span></a> (<a class="idref" href="ConCert.Extraction.Optimize.html#dearg_transform"><span class="id" title="definition">dearg_transform</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#overridden_masks"><span class="id" title="variable">overridden_masks</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#do_trim_const_masks"><span class="id" title="variable">do_trim_const_masks</span></a> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#do_trim_ctor_masks"><span class="id" title="variable">do_trim_ctor_masks</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#true"><span class="id" title="constructor">true</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#true"><span class="id" title="constructor">true</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#true"><span class="id" title="constructor">true</span></a>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">red</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">Σ</span> <span class="id" title="var">Σopt</span> <span class="id" title="var">kn</span> <span class="id" title="var">ind</span> <span class="id" title="var">c</span> <span class="id" title="var">opt</span> <span class="id" title="var">ev</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> <span class="id" title="var">opt</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <a class="idref" href="ConCert.Extraction.ClosedAux.html#env_closed"><span class="id" title="definition">env_closed</span></a> <span class="id" title="var">eqn</span>:<span class="id" title="var">clos</span>; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *; [|<span class="id" title="tactic">congruence</span>].<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <a class="idref" href="ConCert.Extraction.Optimize.html#analyze_env"><span class="id" title="definition">analyze_env</span></a>; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <a class="idref" href="ConCert.Extraction.Optimize.html#is_expanded_env"><span class="id" title="definition">is_expanded_env</span></a> <span class="id" title="var">eqn</span>:<span class="id" title="var">exp</span>; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *; [|<span class="id" title="tactic">congruence</span>].<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <a class="idref" href="ConCert.Extraction.Optimize.html#valid_masks_env"><span class="id" title="definition">valid_masks_env</span></a> <span class="id" title="var">eqn</span>:<span class="id" title="var">valid</span>; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *; [|<span class="id" title="tactic">congruence</span>].<br/>
&nbsp;&nbsp;<span class="id" title="tactic">injection</span> <span class="id" title="var">opt</span> <span class="id" title="keyword">as</span> &lt;-.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">set</span> (<span class="id" title="var">im</span> := (<span class="id" title="keyword">if</span> <span class="id" title="var">do_trim_ctor_masks</span> <span class="id" title="keyword">then</span> <a class="idref" href="ConCert.Extraction.Optimize.html#trim_ind_masks"><span class="id" title="definition">trim_ind_masks</span></a> <span class="id" title="keyword">else</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#id"><span class="id" title="definition">id</span></a>) <span class="id" title="var">ind_masks</span>) <span class="id" title="tactic">in</span> *; <span class="id" title="var">clearbody</span> <span class="id" title="var">im</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">set</span> (<span class="id" title="var">cm</span> := (<span class="id" title="keyword">if</span> <span class="id" title="var">do_trim_const_masks</span> <span class="id" title="keyword">then</span> <a class="idref" href="ConCert.Extraction.Optimize.html#trim_const_masks"><span class="id" title="definition">trim_const_masks</span></a> <span class="id" title="keyword">else</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#id"><span class="id" title="definition">id</span></a>) <span class="id" title="var">const_masks</span>) <span class="id" title="tactic">in</span> *; <span class="id" title="var">clearbody</span> <span class="id" title="var">cm</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#eval_debox_env_types"><span class="id" title="lemma">eval_debox_env_types</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#eval_const_construct_expanded"><span class="id" title="lemma">eval_const_construct_expanded</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">ev</span> <span class="id" title="keyword">as</span> <span class="id" title="var">expanded_const</span>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#eval_is_expanded_aux"><span class="id" title="lemma">eval_is_expanded_aux</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">ev</span> <span class="id" title="keyword">as</span> <span class="id" title="var">empty_ctor_mask</span>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">replace</span> (<span class="id" title="constructor">tConst</span> <span class="id" title="var">kn</span>) <span class="id" title="keyword">with</span> (<a class="idref" href="ConCert.Extraction.Optimize.html#dearg"><span class="id" title="definition">dearg</span></a> <span class="id" title="var">im</span> <span class="id" title="var">cm</span> (<span class="id" title="constructor">tConst</span> <span class="id" title="var">kn</span>)).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">replace</span> (<span class="id" title="constructor">tConstruct</span> <span class="id" title="var">ind</span> <span class="id" title="var">c</span>) <span class="id" title="keyword">with</span> (<a class="idref" href="ConCert.Extraction.Optimize.html#dearg"><span class="id" title="definition">dearg</span></a> <span class="id" title="var">im</span> <span class="id" title="var">cm</span> (<span class="id" title="constructor">tConstruct</span> <span class="id" title="var">ind</span> <span class="id" title="var">c</span>)).<br/>
&nbsp;&nbsp;2-3: <span class="id" title="var">now</span> <span class="id" title="var">cbn</span>; <span class="id" title="tactic">destruct</span> <a class="idref" href="ConCert.Extraction.Optimize.html#get_const_mask"><span class="id" title="definition">get_const_mask</span></a>, <a class="idref" href="ConCert.Extraction.Optimize.html#get_ctor_mask"><span class="id" title="definition">get_ctor_mask</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="ConCert.Extraction.OptimizeCorrectness.html#dearg_correct"><span class="id" title="lemma">dearg_correct</span></a>; <span class="id" title="tactic">eauto</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>
</div>
</div>
<div id="footer">
  Generated by <a href="https://coq.inria.fr/">coqdoc</a> and improved with <a href="https://github.com/tebbi/coqdocjs">CoqdocJS</a> and <a href="https://github.com/jgallen23/toc">TOC</a>
</div>
</div>
<script>
  const elements = document.getElementsByClassName("libtitle");
  while(elements.length > 0){
        elements[0].parentNode.removeChild(elements[0]);
  }
  if (window.location.pathname.endsWith("/toc.html")) {
      const jstocDiv = document.getElementById("js-toc");
      jstocDiv.classList.remove("toc");
      jstocDiv.classList.add("jstoc-hidden");
      const jstocHeaderDiv = document.getElementById("js-toc-header");
      jstocHeaderDiv.classList.add("jstoc-hidden");
  }
  console.log(window.location.pathname);
</script>
<script type="text/javascript" src="toc.js"></script>
</body>

</html>
